   1               		.file	"ServerLLDN.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.text
   9               	.Ltext0:
  10               		.cfi_sections	.debug_frame
  11               		.comm	n,1,1
  12               		.comm	tTS,4,1
  14               	sysclk_get_main_hz:
  15               	.LFB67:
  16               		.file 1 "../../../platform/common/services/clock/mega/sysclk.h"
   1:../../../platform/common/services/clock/mega/sysclk.h **** /**
   2:../../../platform/common/services/clock/mega/sysclk.h ****  * \file
   3:../../../platform/common/services/clock/mega/sysclk.h ****  *
   4:../../../platform/common/services/clock/mega/sysclk.h ****  * \brief Chip-specific system clock management functions
   5:../../../platform/common/services/clock/mega/sysclk.h ****  *
   6:../../../platform/common/services/clock/mega/sysclk.h ****  * Copyright (c) 2012 Atmel Corporation. All rights reserved.
   7:../../../platform/common/services/clock/mega/sysclk.h ****  *
   8:../../../platform/common/services/clock/mega/sysclk.h ****  * \asf_license_start
   9:../../../platform/common/services/clock/mega/sysclk.h ****  *
  10:../../../platform/common/services/clock/mega/sysclk.h ****  * \page License
  11:../../../platform/common/services/clock/mega/sysclk.h ****  *
  12:../../../platform/common/services/clock/mega/sysclk.h ****  * Redistribution and use in source and binary forms, with or without
  13:../../../platform/common/services/clock/mega/sysclk.h ****  * modification, are permitted provided that the following conditions are met:
  14:../../../platform/common/services/clock/mega/sysclk.h ****  *
  15:../../../platform/common/services/clock/mega/sysclk.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  16:../../../platform/common/services/clock/mega/sysclk.h ****  *    this list of conditions and the following disclaimer.
  17:../../../platform/common/services/clock/mega/sysclk.h ****  *
  18:../../../platform/common/services/clock/mega/sysclk.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  19:../../../platform/common/services/clock/mega/sysclk.h ****  *    this list of conditions and the following disclaimer in the documentation
  20:../../../platform/common/services/clock/mega/sysclk.h ****  *    and/or other materials provided with the distribution.
  21:../../../platform/common/services/clock/mega/sysclk.h ****  *
  22:../../../platform/common/services/clock/mega/sysclk.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  23:../../../platform/common/services/clock/mega/sysclk.h ****  *    from this software without specific prior written permission.
  24:../../../platform/common/services/clock/mega/sysclk.h ****  *
  25:../../../platform/common/services/clock/mega/sysclk.h ****  * 4. This software may only be redistributed and used in connection with an
  26:../../../platform/common/services/clock/mega/sysclk.h ****  *    Atmel microcontroller product.
  27:../../../platform/common/services/clock/mega/sysclk.h ****  *
  28:../../../platform/common/services/clock/mega/sysclk.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  29:../../../platform/common/services/clock/mega/sysclk.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  30:../../../platform/common/services/clock/mega/sysclk.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  31:../../../platform/common/services/clock/mega/sysclk.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  32:../../../platform/common/services/clock/mega/sysclk.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  33:../../../platform/common/services/clock/mega/sysclk.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  34:../../../platform/common/services/clock/mega/sysclk.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  35:../../../platform/common/services/clock/mega/sysclk.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  36:../../../platform/common/services/clock/mega/sysclk.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  37:../../../platform/common/services/clock/mega/sysclk.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  38:../../../platform/common/services/clock/mega/sysclk.h ****  * POSSIBILITY OF SUCH DAMAGE.
  39:../../../platform/common/services/clock/mega/sysclk.h ****  *
  40:../../../platform/common/services/clock/mega/sysclk.h ****  * \asf_license_stop
  41:../../../platform/common/services/clock/mega/sysclk.h ****  *
  42:../../../platform/common/services/clock/mega/sysclk.h ****  */
  43:../../../platform/common/services/clock/mega/sysclk.h **** #ifndef MEGA_SYSCLK_H_INCLUDED
  44:../../../platform/common/services/clock/mega/sysclk.h **** #define MEGA_SYSCLK_H_INCLUDED
  45:../../../platform/common/services/clock/mega/sysclk.h **** 
  46:../../../platform/common/services/clock/mega/sysclk.h **** #include <board.h>
  47:../../../platform/common/services/clock/mega/sysclk.h **** #include <compiler.h>
  48:../../../platform/common/services/clock/mega/sysclk.h **** #include <parts.h>
  49:../../../platform/common/services/clock/mega/sysclk.h **** 
  50:../../../platform/common/services/clock/mega/sysclk.h **** /* Include clock configuration for the project. */
  51:../../../platform/common/services/clock/mega/sysclk.h **** #include <conf_clock.h>
  52:../../../platform/common/services/clock/mega/sysclk.h **** 
  53:../../../platform/common/services/clock/mega/sysclk.h **** #ifdef __cplusplus
  54:../../../platform/common/services/clock/mega/sysclk.h **** extern "C" {
  55:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  56:../../../platform/common/services/clock/mega/sysclk.h **** #define ASM __asm__
  57:../../../platform/common/services/clock/mega/sysclk.h **** 
  58:../../../platform/common/services/clock/mega/sysclk.h **** /* CONFIG_SYSCLK_PSDIV  to use default if not defined*/
  59:../../../platform/common/services/clock/mega/sysclk.h **** #ifndef CONFIG_SYSCLK_PSDIV
  60:../../../platform/common/services/clock/mega/sysclk.h **** # define CONFIG_SYSCLK_PSDIV    SYSCLK_PSDIV_8
  61:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  62:../../../platform/common/services/clock/mega/sysclk.h **** 
  63:../../../platform/common/services/clock/mega/sysclk.h **** /* ! \name Prescaler Setting (relative to CLKsys) */
  64:../../../platform/common/services/clock/mega/sysclk.h **** /* @{ */
  65:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_1      0   /* !< Do not prescale */
  66:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_2      1   /* !< Prescale CLKper4 by 2 */
  67:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_4      2   /* !< Prescale CLKper4 by 4 */
  68:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_8      3   /* !< Prescale CLKper4 by 8 */
  69:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_16     4   /* !< Prescale CLKper4 by 16 */
  70:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_32     5   /* !< Prescale CLKper4 by 32 */
  71:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_64     6   /* !< Prescale CLKper4 by 64 */
  72:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_128    7   /* !< Prescale CLKper4 by 128 */
  73:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_256    8   /* !< Prescale CLKper4 by 256 */
  74:../../../platform/common/services/clock/mega/sysclk.h **** 
  75:../../../platform/common/services/clock/mega/sysclk.h **** /* @} */
  76:../../../platform/common/services/clock/mega/sysclk.h **** 
  77:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF || MEGA_XX0_1 || MEGA_XX4 || MEGA_XX4_A
  78:../../../platform/common/services/clock/mega/sysclk.h **** 
  79:../../../platform/common/services/clock/mega/sysclk.h **** #define NUMBER_OF_POWER_REG       2
  80:../../../platform/common/services/clock/mega/sysclk.h **** /*Starting Address for power reduction*/
  81:../../../platform/common/services/clock/mega/sysclk.h **** #define POWER_REG_ADD             PRR0
  82:../../../platform/common/services/clock/mega/sysclk.h **** 
  83:../../../platform/common/services/clock/mega/sysclk.h **** /* ! \name Power Reduction  Clock Port Numbers */
  84:../../../platform/common/services/clock/mega/sysclk.h **** enum power_red_id {
  85:../../../platform/common/services/clock/mega/sysclk.h **** 	POWER_RED_REG0,     /* !< Devices on PRR0 */
  86:../../../platform/common/services/clock/mega/sysclk.h **** #if !MEGA_XX4 || !MEGA_XX4_A || MEGA_XX0_1
  87:../../../platform/common/services/clock/mega/sysclk.h **** 	POWER_RED_REG1,     /* !< Devices on PRR1 */
  88:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  89:../../../platform/common/services/clock/mega/sysclk.h **** };
  90:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  91:../../../platform/common/services/clock/mega/sysclk.h **** 
  92:../../../platform/common/services/clock/mega/sysclk.h **** /****************************************************
  93:../../../platform/common/services/clock/mega/sysclk.h ****  * Given a dummy type but not used for these groups
  94:../../../platform/common/services/clock/mega/sysclk.h ****  * to support for otherthen megaRF device.
  95:../../../platform/common/services/clock/mega/sysclk.h ****  **************************************************/
  96:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_XX8 || MEGA_XX8_A || MEGA_UNSPECIFIED
  97:../../../platform/common/services/clock/mega/sysclk.h **** #define NUMBER_OF_POWER_REG       1
  98:../../../platform/common/services/clock/mega/sysclk.h **** /*Starting Address for power reduction*/
  99:../../../platform/common/services/clock/mega/sysclk.h **** #define POWER_REG_ADD             PRR
 100:../../../platform/common/services/clock/mega/sysclk.h **** 
 101:../../../platform/common/services/clock/mega/sysclk.h **** /* ! \name Power Reduction  Clock Port Numbers */
 102:../../../platform/common/services/clock/mega/sysclk.h **** enum power_red_id {
 103:../../../platform/common/services/clock/mega/sysclk.h **** 	POWER_RED_REG0,     /* !< Devices on PRR */
 104:../../../platform/common/services/clock/mega/sysclk.h **** };
 105:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 106:../../../platform/common/services/clock/mega/sysclk.h **** 
 107:../../../platform/common/services/clock/mega/sysclk.h **** /* Bit mask for the power reduction register based on */
 108:../../../platform/common/services/clock/mega/sysclk.h **** /*   MCU ARCH.                                        */
 109:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 110:../../../platform/common/services/clock/mega/sysclk.h **** /*Bit mask for PRR2 */
 111:../../../platform/common/services/clock/mega/sysclk.h **** 
 112:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM0_bm                       1 << PRRAM0
 113:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM1_bm                       1 << PRRAM1
 114:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM2_bm                       1 << PRRAM2
 115:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM3_bm                       1 << PRRAM3
 116:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 117:../../../platform/common/services/clock/mega/sysclk.h **** 
 118:../../../platform/common/services/clock/mega/sysclk.h **** /*Bit mask for the power reduction 0 or PRR*/
 119:../../../platform/common/services/clock/mega/sysclk.h **** #if !MEGA_XX_UN0 && !MEGA_XX_UN0
 120:../../../platform/common/services/clock/mega/sysclk.h **** #define PRADC_bm                        1 << PRADC
 121:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART0_bm                     1 << PRUSART0
 122:../../../platform/common/services/clock/mega/sysclk.h **** #define PRSPI_bm                        1 << PRSPI
 123:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM1_bm                       1 << PRTIM1
 124:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 125:../../../platform/common/services/clock/mega/sysclk.h **** 
 126:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 127:../../../platform/common/services/clock/mega/sysclk.h **** #define PRPGA_bm                        1 << PRPGA
 128:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 129:../../../platform/common/services/clock/mega/sysclk.h **** 
 130:../../../platform/common/services/clock/mega/sysclk.h **** #if !MEGA_UNSPECIFIED
 131:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM0_bm                       1 << PRTIM0
 132:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM2_bm                       1 << PRTIM2
 133:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTWI_bm                        1 << PRTWI
 134:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 135:../../../platform/common/services/clock/mega/sysclk.h **** 
 136:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_XX_UN2
 137:../../../platform/common/services/clock/mega/sysclk.h **** #define PRLCD_bm                        1 << PRLCD
 138:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 139:../../../platform/common/services/clock/mega/sysclk.h **** 
 140:../../../platform/common/services/clock/mega/sysclk.h **** /*Bit mask for  PRR1  */
 141:../../../platform/common/services/clock/mega/sysclk.h **** #ifdef PRR1
 142:../../../platform/common/services/clock/mega/sysclk.h **** #if (MEGA_XX4 || MEGA_XX4_A)
 143:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM3_bm                       1 << PRTIM3
 144:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 145:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 146:../../../platform/common/services/clock/mega/sysclk.h **** 
 147:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF || MEGA_XX4 || MEGA_XX4_A
 148:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART1_bm                     1 << PRUSART1
 149:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART2_bm                     1 << PRUSART2
 150:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART3_bm                     1 << PRUSART3
 151:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM3_bm                       1 << PRTIM3
 152:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM4_bm                       1 << PRTIM4
 153:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM5_bm                       1 << PRTIM5
 154:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 155:../../../platform/common/services/clock/mega/sysclk.h **** 
 156:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 157:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTRX24_bm                      1 << PRTRX24
 158:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 159:../../../platform/common/services/clock/mega/sysclk.h **** 
 160:../../../platform/common/services/clock/mega/sysclk.h **** /**
 161:../../../platform/common/services/clock/mega/sysclk.h ****  * \name Querying the system clock and its derived clocks
 162:../../../platform/common/services/clock/mega/sysclk.h ****  */
 163:../../../platform/common/services/clock/mega/sysclk.h **** /* @{ */
 164:../../../platform/common/services/clock/mega/sysclk.h **** 
 165:../../../platform/common/services/clock/mega/sysclk.h **** /**
 166:../../../platform/common/services/clock/mega/sysclk.h ****  * \brief Return the current rate in Hz of the main system clock
 167:../../../platform/common/services/clock/mega/sysclk.h ****  * To know the clock value at what frequency the main clock is running
 168:../../../platform/common/services/clock/mega/sysclk.h ****  * \return Frequency of the main system clock, in Hz.
 169:../../../platform/common/services/clock/mega/sysclk.h ****  * \todo : please initialize the SYSCLK_SOURCE in conf_clock.h file for
 170:../../../platform/common/services/clock/mega/sysclk.h ****  * configured source clock using fuses.
 171:../../../platform/common/services/clock/mega/sysclk.h ****  * \eg. #define SYSCLK_SOURCE SYSCLK_SRC_RC16MHZ to use internal RC
 172:../../../platform/common/services/clock/mega/sysclk.h ****  * oscillator for clock source.
 173:../../../platform/common/services/clock/mega/sysclk.h ****  */
 174:../../../platform/common/services/clock/mega/sysclk.h **** static inline uint32_t sysclk_get_main_hz(void)
 175:../../../platform/common/services/clock/mega/sysclk.h **** {
  17               		.loc 1 175 0
  18               		.cfi_startproc
  19 0000 CF93      		push r28
  20               	.LCFI0:
  21               		.cfi_def_cfa_offset 3
  22               		.cfi_offset 28, -2
  23 0002 DF93      		push r29
  24               	.LCFI1:
  25               		.cfi_def_cfa_offset 4
  26               		.cfi_offset 29, -3
  27 0004 CDB7      		in r28,__SP_L__
  28 0006 DEB7      		in r29,__SP_H__
  29               	.LCFI2:
  30               		.cfi_def_cfa_register 28
  31               	/* prologue: function */
  32               	/* frame size = 0 */
  33               	/* stack size = 2 */
  34               	.L__stack_usage = 2
 176:../../../platform/common/services/clock/mega/sysclk.h **** 	switch (SYSCLK_SOURCE) {
 177:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_RC16MHZ:
 178:../../../platform/common/services/clock/mega/sysclk.h **** 		return 16000000UL;
 179:../../../platform/common/services/clock/mega/sysclk.h **** 
 180:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_RC128KHZ:
 181:../../../platform/common/services/clock/mega/sysclk.h **** 		return 128000UL;
 182:../../../platform/common/services/clock/mega/sysclk.h **** 
 183:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 184:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_TRS16MHZ:
 185:../../../platform/common/services/clock/mega/sysclk.h **** 		return 16000000UL;
  35               		.loc 1 185 0
  36 0008 80E0      		ldi r24,0
  37 000a 94E2      		ldi r25,lo8(36)
  38 000c A4EF      		ldi r26,lo8(-12)
  39 000e B0E0      		ldi r27,0
 186:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 187:../../../platform/common/services/clock/mega/sysclk.h **** #ifdef BOARD_EXTERNAL_CLK
 188:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_EXTERNAL:
 189:../../../platform/common/services/clock/mega/sysclk.h **** 		return BOARD_EXTERNAL_CLK;
 190:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 191:../../../platform/common/services/clock/mega/sysclk.h **** 	default:
 192:../../../platform/common/services/clock/mega/sysclk.h **** 
 193:../../../platform/common/services/clock/mega/sysclk.h **** 		return 1000000UL;
 194:../../../platform/common/services/clock/mega/sysclk.h **** 	}
 195:../../../platform/common/services/clock/mega/sysclk.h **** }
  40               		.loc 1 195 0
  41 0010 BC01      		movw r22,r24
  42 0012 CD01      		movw r24,r26
  43               	/* epilogue start */
  44 0014 DF91      		pop r29
  45 0016 CF91      		pop r28
  46 0018 0895      		ret
  47               		.cfi_endproc
  48               	.LFE67:
  51               	sysclk_get_source_clock_hz:
  52               	.LFB68:
 196:../../../platform/common/services/clock/mega/sysclk.h **** 
 197:../../../platform/common/services/clock/mega/sysclk.h **** /**
 198:../../../platform/common/services/clock/mega/sysclk.h ****  * \brief Return the current rate in Hz of source clock in Hz.
 199:../../../platform/common/services/clock/mega/sysclk.h ****  *
 200:../../../platform/common/services/clock/mega/sysclk.h ****  * This clock always runs at the same rate as the CPU clock unless the divider
 201:../../../platform/common/services/clock/mega/sysclk.h ****  * is set.
 202:../../../platform/common/services/clock/mega/sysclk.h ****  *
 203:../../../platform/common/services/clock/mega/sysclk.h ****  * \return Frequency of the system clock, in Hz.
 204:../../../platform/common/services/clock/mega/sysclk.h ****  */
 205:../../../platform/common/services/clock/mega/sysclk.h **** static inline uint32_t sysclk_get_source_clock_hz(void)
 206:../../../platform/common/services/clock/mega/sysclk.h **** {
  53               		.loc 1 206 0
  54               		.cfi_startproc
  55 001a CF93      		push r28
  56               	.LCFI3:
  57               		.cfi_def_cfa_offset 3
  58               		.cfi_offset 28, -2
  59 001c DF93      		push r29
  60               	.LCFI4:
  61               		.cfi_def_cfa_offset 4
  62               		.cfi_offset 29, -3
  63 001e CDB7      		in r28,__SP_L__
  64 0020 DEB7      		in r29,__SP_H__
  65               	.LCFI5:
  66               		.cfi_def_cfa_register 28
  67               	/* prologue: function */
  68               	/* frame size = 0 */
  69               	/* stack size = 2 */
  70               	.L__stack_usage = 2
 207:../../../platform/common/services/clock/mega/sysclk.h **** 	switch (CONFIG_SYSCLK_PSDIV) {
 208:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_1: /* Fall through */
 209:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 210:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 211:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 2;
 212:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 213:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz();
  71               		.loc 1 213 0
  72 0022 0E94 0000 		call sysclk_get_main_hz
  73 0026 DC01      		movw r26,r24
  74 0028 CB01      		movw r24,r22
 214:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 215:../../../platform/common/services/clock/mega/sysclk.h **** 
 216:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_2:
 217:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 218:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 219:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 4;
 220:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 221:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 2;
 222:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 223:../../../platform/common/services/clock/mega/sysclk.h **** 
 224:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_4:
 225:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 226:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 227:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 8;
 228:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 229:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 4;
 230:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 231:../../../platform/common/services/clock/mega/sysclk.h **** 
 232:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_8:
 233:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 234:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 235:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 16;
 236:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 237:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 8;
 238:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 239:../../../platform/common/services/clock/mega/sysclk.h **** 
 240:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_16:
 241:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 242:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 243:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 32;
 244:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 245:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 16;
 246:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 247:../../../platform/common/services/clock/mega/sysclk.h **** 
 248:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_32:
 249:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 250:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 251:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 64;
 252:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 253:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 32;
 254:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 255:../../../platform/common/services/clock/mega/sysclk.h **** 
 256:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_64:
 257:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 258:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 259:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 128;
 260:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 261:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 64;
 262:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 263:../../../platform/common/services/clock/mega/sysclk.h **** 
 264:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_128:
 265:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 266:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 267:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 256;
 268:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 269:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 128;
 270:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 271:../../../platform/common/services/clock/mega/sysclk.h **** 
 272:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_256:
 273:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 274:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 275:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 512;
 276:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 277:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 256;
 278:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 279:../../../platform/common/services/clock/mega/sysclk.h **** 
 280:../../../platform/common/services/clock/mega/sysclk.h **** 	default:
 281:../../../platform/common/services/clock/mega/sysclk.h **** 		/*Invalide case*/
 282:../../../platform/common/services/clock/mega/sysclk.h **** 		return 0;
 283:../../../platform/common/services/clock/mega/sysclk.h **** 	}
 284:../../../platform/common/services/clock/mega/sysclk.h **** }
  75               		.loc 1 284 0
  76 002a BC01      		movw r22,r24
  77 002c CD01      		movw r24,r26
  78               	/* epilogue start */
  79 002e DF91      		pop r29
  80 0030 CF91      		pop r28
  81 0032 0895      		ret
  82               		.cfi_endproc
  83               	.LFE68:
  85               		.section	.progmem.data.baudctrl_1mhz,"a",@progbits
  88               	baudctrl_1mhz:
  89 0000 3300      		.word	51
  90 0002 1900      		.word	25
  91 0004 0C00      		.word	12
  92 0006 0600      		.word	6
  93 0008 0300      		.word	3
  94 000a 0200      		.word	2
  95 000c 0100      		.word	1
  96 000e FF00      		.word	255
  97               		.section	.progmem.data.baudctrl_8mhz,"a",@progbits
 100               	baudctrl_8mhz:
 101 0000 A001      		.word	416
 102 0002 CF00      		.word	207
 103 0004 6700      		.word	103
 104 0006 3300      		.word	51
 105 0008 1900      		.word	25
 106 000a 0C00      		.word	12
 107 000c 0700      		.word	7
 108 000e 0800      		.word	8
 109               		.section	.progmem.data.baudctrl_16mhz,"a",@progbits
 112               	baudctrl_16mhz:
 113 0000 4003      		.word	832
 114 0002 A001      		.word	416
 115 0004 CF00      		.word	207
 116 0006 6700      		.word	103
 117 0008 3300      		.word	51
 118 000a 1900      		.word	25
 119 000c 1000      		.word	16
 120 000e 1000      		.word	16
 121               		.text
 123               	usart_double_baud_enable:
 124               	.LFB101:
 125               		.file 2 "../../../platform/mega_rf/drivers/usart/usart_megarf.h"
   1:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
   2:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \file
   3:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
   4:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief USART driver for AVR MEGARF.
   5:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
   6:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * This file contains basic functions for the AVR MEGA USART, with support for
   7:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * all modes, settings and clock speeds.
   8:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
   9:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Copyright (c) 2013-2015 Atmel Corporation. All rights reserved.
  10:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  11:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \asf_license_start
  12:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  13:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \page License
  14:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  15:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Redistribution and use in source and binary forms, with or without
  16:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * modification, are permitted provided that the following conditions are met:
  17:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  18:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  19:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    this list of conditions and the following disclaimer.
  20:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  21:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  22:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    this list of conditions and the following disclaimer in the documentation
  23:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    and/or other materials provided with the distribution.
  24:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  25:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  26:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    from this software without specific prior written permission.
  27:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  28:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 4. This software may only be redistributed and used in connection with an
  29:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    Atmel microcontroller product.
  30:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  31:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  32:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  33:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  34:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  35:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  36:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  37:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  38:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  39:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  40:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  41:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * POSSIBILITY OF SUCH DAMAGE.
  42:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  43:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \asf_license_stop
  44:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  45:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
  46:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #ifndef _USART_MEGARF_H_
  47:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define _USART_MEGARF_H_
  48:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  49:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #ifdef __cplusplus
  50:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** extern "C" {
  51:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #endif
  52:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  53:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #include "compiler.h"
  54:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #include "status_codes.h"
  55:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  56:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
  57:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \defgroup megarf_usart_group USART module (USART)
  58:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  59:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * See \ref megarf_usart_quickstart.
  60:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  61:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * This is a driver for configuring, enabling, disabling and use of the on-chip
  62:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * USART.
  63:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  64:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \section dependencies Dependencies
  65:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  66:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * The USART module depends on the following modules:
  67:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  - \ref sysclk_group for peripheral clock control.
  68:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  - \ref port_driver_group for peripheral io port control.
  69:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  70:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * @{
  71:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
  72:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  73:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 1200 */
  74:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_1200      0x00
  75:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 2400 */
  76:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_2400      0x01
  77:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 4800 */
  78:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_4800      0x02
  79:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 9600 */
  80:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_9600      0x03
  81:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 19200 */
  82:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_19200     0x04
  83:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 38400 */
  84:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_38400     0x05
  85:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 57600 */
  86:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_57600     0x06
  87:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 115200 */
  88:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_115200    0x07
  89:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Baudrate not in lookup table */
  90:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_UNDEFINED 0xFF
  91:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  92:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef volatile uint8_t register8_t;
  93:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef volatile uint16_t register16_t;
  94:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Universal Synchronous/Asynchronous Receiver/Transmitter */
  95:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef struct USART_struct {
  96:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UCSRnA;  /* Control Register A */
  97:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UCSRnB;  /* Control Register B */
  98:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UCSRnC;  /* Control Register C */
  99:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t reserved;
 100:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register16_t UBRR;  /* Baud Rate Register Value */
 101:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UDR;  /* I/O Data Register */
 102:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_t;
 103:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 104:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USARTA0    (*(USART_t *)0xC0)   /* Universal Asynchronous
 105:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                 * Receiver-Transmitter A0 */
 106:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USARTA1    (*(USART_t *)0XC8)   /* Universal Asynchronous
 107:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                 * Receiver-Transmitter A1 */
 108:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 109:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* USART.UCSRxA  bit masks and bit positions */
 110:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXC_bm  0x80 /* RX complete bit mask.*/
 111:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXC_bp  7 /* RX complete bit position.*/
 112:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 113:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXC_bm  0x40 /* TX complete bit mask.*/
 114:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXC_bp  6 /* TX complete bit position.*/
 115:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 116:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRE_bm  0x20 /* DATA Register Empty Bit mask.*/
 117:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRE_bp  5 /*  DATA Register Empty bit position.*/
 118:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 119:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_FE_bm   0x10 /* Frame Error bit mask.*/
 120:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_FE_bp   4 /*Frame error bit position.*/
 121:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 122:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DOR_bm  0x08 /* Data Over Run bit mask.*/
 123:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DOR_bp  3 /* Data Over Run bit position.*/
 124:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 125:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UPE_bm  0x04 /* Parity error bit mask.*/
 126:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UPE_bp  2 /* Parity error bit position.*/
 127:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 128:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_U2X_bm  0x02 /* Double TX speed bit mask.*/
 129:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_U2X_bp  1 /* Double TX speed bit position.*/
 130:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 131:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_MPCM_bm  0x01 /* Multi Processor bit mask.*/
 132:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_MPMC_bp  0 /* Multi processor bit position.*/
 133:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 134:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* USART.UCSRxB  bit masks and bit positions */
 135:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXCIE_bm  0x80 /* RX complete interrupt Enable bit mask.*/
 136:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXCIE_bp  7 /* RX complete interrupt Enable bit position.*/
 137:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 138:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXCIE_bm  0x40 /* TX complete interrupt Enable bit mask.*/
 139:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXCIE_bp  6 /* TX complete interrupt Enable bit position.*/
 140:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 141:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRIE_bm  0x20 /* Data register empty interrupt Enable bit mask.*/
 142:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRIE_bp  5 /* Data register empty interrupt Enable bit position.*/
 143:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 144:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXEN_bm  0x10  /* Receiver Enable bit mask. */
 145:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXEN_bp  4  /* Receiver Enable bit position. */
 146:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 147:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXEN_bm  0x08  /* Transmitter Enable bit mask. */
 148:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXEN_bp  3  /* Transmitter Enable bit position. */
 149:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 150:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE2_bm  0x04  /* Character Size bit mask. */
 151:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE2_bp  2 /* Character Size bit position. */
 152:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 153:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXB8_bm  0x02  /* Transmit bit 8 bit mask. */
 154:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXB8_bp  1  /* Transmit bit 8 bit position. */
 155:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 156:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXB8_bm  0x01  /* Transmit bit 8 bit mask. */
 157:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXB8_bp  0  /* Transmit bit 8 bit position. */
 158:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 159:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* USART.UCSRxC  bit masks and bit positions */
 160:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_gm  0xC0 /* USART Mode Select 01 grp mask.*/
 161:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_gp  6 /* USART Mode Select 01 grp position.*/
 162:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 163:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_bm  0x80 /* USART Mode Select 01 bit mask.*/
 164:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_bp  7 /* USART Mode Select 01 bit position.*/
 165:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 166:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL00_bm  0x40 /* USART Mode Select 00 bit mask.*/
 167:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL00_bp  6 /* USART Mode Select 00 bit position.*/
 168:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 169:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE_gm  0x30 /* USART Parity Mode Select grp mask.*/
 170:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE_gp  4 /* USART Parity Mode Select grp position.*/
 171:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 172:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE01_bm  0x20 /* USART Parity Mode Select 01 bit mask.*/
 173:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE01_bp  5 /* USART Parity Mode Select 01 bit position.*/
 174:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 175:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE00_bm  0x10 /* USART Parity Mode Select 00 bit mask.*/
 176:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE00_bp  4 /* USART Parity Mode Select 00 bit position.*/
 177:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 178:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_STOPB_bm  0x08 /* USART stop bit mask.*/
 179:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_STOPB_bp  3 /* USART stop bit Position.*/
 180:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 181:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01C_gm  0x06  /* Character Size 10 bit 1 mask. */
 182:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01C_gp  1 /* Character Size 10 bit position. */
 183:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 184:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01_bm  0x04  /* Character Size 10 bit 1 mask. */
 185:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01_bp  2 /* Character Size 10 bit position. */
 186:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 187:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE00_bm  0x02  /* Character Size 00 bit 1 mask. */
 188:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE00_bp  1 /* Character Size bit 00 position. */
 189:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 190:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPOL_bm  0x01  /* Sync mode Pol bit 1 mask. */
 191:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPOL_bp  0 /*Sync mode Pol bit 0 position */
 192:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 193:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPHA_bm 0x02 /* Clock Phase bit mask. */
 194:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPHA_bp 1 /* Clock Phase bit position. */
 195:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 196:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DORD_bm 0x04 /* Data order bit mask. */
 197:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DORD_bp 2 /* Data order bit position. */
 198:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 199:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Character Size */
 200:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef enum USART_CHSIZE_enum {
 201:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_5BIT_gc = (0x00),  /* Character size: 5 bit */
 202:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_6BIT_gc = (0x01),  /* Character size: 6 bit */
 203:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_7BIT_gc = (0x02),  /* Character size: 7 bit */
 204:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_8BIT_gc = (0x03),  /* Character size: 8 bit */
 205:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_9BIT_gc = (0x07),  /* Character size: 9 bit */
 206:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_CHSIZE_t;
 207:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 208:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Communication Mode */
 209:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef enum USART_CMODE_enum {
 210:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_ASYNCHRONOUS_gc = (0x00 << USART_UMSEL01_gp),  /*
 211:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            *
 212:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            *
 213:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            *Asynchronous
 214:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            * Mode */
 215:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_SYNCHRONOUS_gc = (0x01 << USART_UMSEL01_gp),  /* Synchronous
 216:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                           * Mode */
 217:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_IRDA_gc = (0x02 << USART_UMSEL01_gp),  /* IrDA Mode */
 218:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_MSPI_gc = (0x03 << USART_UMSEL01_gp),  /* Master SPI Mode */
 219:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_CMODE_t;
 220:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 221:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Parity Mode */
 222:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef enum USART_PMODE_enum {
 223:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_DISABLED_gc = (0x00 << USART_PMODE_gp),  /* No Parity */
 224:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_EVEN_gc = (0x02 << USART_PMODE_gp),  /* Even Parity */
 225:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_ODD_gc = (0x03 << USART_PMODE_gp),  /* Odd Parity */
 226:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_PMODE_t;
 227:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 228:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Lookup table containing baudctrl values for CPU frequency 1 Mhz */
 229:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static PROGMEM_DECLARE(uint16_t, baudctrl_1mhz[]) = {
 230:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0033, /* Baud: 1200 */
 231:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0019, /* Baud: 2400 */
 232:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x000C, /* Baud: 4800 */
 233:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0006, /* Baud: 9600 */
 234:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0003, /* Baud: 19200 */
 235:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0002, /* Baud: 38400 */
 236:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0001, /* Baud: 57600 */
 237:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_BAUD_UNDEFINED, /* Baud: 115200 */
 238:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** };
 239:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 240:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Lookup table containing baudctrl values for CPU frequency 8 Mhz */
 241:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static PROGMEM_DECLARE(uint16_t, baudctrl_8mhz[]) = {
 242:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x01A0, /* Baud: 1200 */
 243:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x00CF, /* Baud: 2400 */
 244:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0067, /* Baud: 4800 */
 245:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0033, /* Baud: 9600 */
 246:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0019, /* Baud: 19200 */
 247:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x000C, /* Baud: 38400 */
 248:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0007, /* Baud: 57600 */
 249:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0008, /* Baud: 115200 */
 250:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** };
 251:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 252:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Lookup table containing baudctrl values for CPU frequency 16 Mhz */
 253:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static PROGMEM_DECLARE(uint16_t, baudctrl_16mhz[]) = {
 254:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0340, /* Baud: 1200 */
 255:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x01A0, /* Baud: 2400 */
 256:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x00CF, /* Baud: 4800 */
 257:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0067, /* Baud: 9600 */
 258:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0033, /* Baud: 19200 */
 259:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0019, /* Baud: 38400 */
 260:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0010, /* Baud: 57600 */
 261:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0010, /* Baud: 115200 */
 262:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** };
 263:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 264:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 265:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Input parameters when initializing RS232 and similar modes. */
 266:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef struct usart_rs232_options {
 267:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Set baud rate of the USART (unused in slave modes). */
 268:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint32_t baudrate;
 269:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 270:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Number of bits to transmit as a character (5 to 9). */
 271:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_t charlength;
 272:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 273:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Parity type: USART_PMODE_DISABLED_gc, USART_PMODE_EVEN_gc, */
 274:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! USART_PMODE_ODD_gc. */
 275:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_t paritytype;
 276:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 277:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Number of stop bits between two characters: */
 278:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! true: 2 stop bits */
 279:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! false: 1 stop bit */
 280:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	bool stopbits;
 281:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } usart_rs232_options_t;
 282:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 283:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Input parameters when initializing SPI master mode. */
 284:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef struct usart_spi_options {
 285:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Set baud rate of the USART in SPI mode. */
 286:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint32_t baudrate;
 287:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 288:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! SPI transmission mode. */
 289:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint8_t spimode;
 290:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 291:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint8_t data_order;
 292:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } usart_spi_options_t;
 293:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 294:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 295:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 296:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART receiver.
 297:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 298:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module
 299:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 300:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_enable(USART_t *usart)
 301:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 302:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_RXEN_bm;
 303:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 304:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 305:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 306:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART receiver.
 307:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 308:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 309:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 310:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_disable(USART_t *usart)
 311:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 312:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_RXEN_bm;
 313:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 314:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 315:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 316:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief  Configure the USART frame format.
 317:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 318:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  Sets the frame format, Frame Size, parity mode and number of stop bits.
 319:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 320:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param usart Pointer to the USART module
 321:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param charSize The character size. Use USART_CHSIZE_t type.
 322:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param parityMode The parity Mode. Use USART_PMODE_t type.
 323:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param twoStopBits Enable two stop bit mode. Use bool type.
 324:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 325:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_format_set(USART_t *usart, USART_CHSIZE_t charSize,
 326:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 		USART_PMODE_t parityMode, bool twoStopBits)
 327:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 328:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC
 329:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 		= ((usart)->UCSRnC &
 330:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			(~USART_CHSIZE01C_gm)) | ((charSize & 0x03)
 331:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			<< USART_CHSIZE01C_gp);
 332:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB
 333:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 		= ((usart)->UCSRnB &
 334:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			(~USART_CHSIZE2_bm)) | ((charSize & 0x04)
 335:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			<< USART_CHSIZE2_bp);
 336:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 337:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC = ((usart)->UCSRnC & (~USART_PMODE_gm)) | parityMode;
 338:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 339:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC = ((usart)->UCSRnC & (~USART_STOPB_bm)) | (twoStopBits
 340:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			<< USART_STOPB_bp);
 341:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 342:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 343:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 344:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART transmitter.
 345:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 346:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 347:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 348:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_enable(USART_t *usart)
 349:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 350:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_TXEN_bm;
 351:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 352:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 353:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 354:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART transmitter.
 355:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 356:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 357:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 358:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_disable(USART_t *usart)
 359:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 360:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_TXEN_bm;
 361:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 362:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 363:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 364:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART transmit complete interrupt.
 365:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 366:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 367:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 368:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_complete_interrupt_enable(USART_t *usart)
 369:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 370:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_TXC_bm;
 371:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 372:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 373:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 374:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART receive complete interrupt.
 375:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 376:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 377:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 378:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_complete_interrupt_enable(USART_t *usart)
 379:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 380:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_RXC_bm;
 381:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 382:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 383:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 384:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART data register empty interrupt.
 385:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 386:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 387:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 388:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_data_empty_interrupt_enable(USART_t *usart)
 389:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 390:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_DRIE_bm;
 391:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 392:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 393:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 394:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART transmit complete interrupt.
 395:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 396:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 397:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 398:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_complete_interrupt_disable(USART_t *usart)
 399:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 400:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_TXC_bm;
 401:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 402:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 403:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 404:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART receive complete interrupt.
 405:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 406:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 407:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 408:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_complete_interrupt_disable(USART_t *usart)
 409:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 410:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_RXC_bm;
 411:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 412:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 413:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 414:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART data register empty interrupt.
 415:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 416:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 417:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 418:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_data_empty_interrupt_disable(USART_t *usart)
 419:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 420:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_DRIE_bm;
 421:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 422:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 423:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 424:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Set the mode the USART run in.
 425:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 426:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Set the mode the USART run in. The default mode is asynchronous mode.
 427:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 428:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module register section.
 429:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usartmode Selects the USART mode. Use USART_CMODE_t type.
 430:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 431:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * USART modes:
 432:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x0        : Asynchronous mode.
 433:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x1        : Synchronous mode.
 434:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x2        : IrDA mode.
 435:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x3        : Master SPI mode.
 436:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 437:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_set_mode(USART_t *usart, USART_CMODE_t usartmode)
 438:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 439:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC = ((usart)->UCSRnC & (~USART_UMSEL01_gm)) | usartmode;
 440:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 441:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 442:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 443:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Check if data register empty flag is set.
 444:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 445:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 446:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 447:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline bool usart_data_register_is_empty(USART_t *usart)
 448:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 449:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UCSRnA & USART_DRE_bm;
 450:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 451:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 452:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 453:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Checks if the RX complete interrupt flag is set.
 454:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 455:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Checks if the RX complete interrupt flag is set.
 456:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 457:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 458:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 459:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline bool usart_rx_is_complete(USART_t *usart)
 460:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 461:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UCSRnA & USART_RXC_bm;
 462:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 463:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 464:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 465:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Checks if the TX complete interrupt flag is set.
 466:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 467:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Checks if the TX complete interrupt flag is set.
 468:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 469:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 470:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 471:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline bool usart_tx_is_complete(USART_t *usart)
 472:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 473:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UCSRnA & USART_TXC_bm;
 474:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 475:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 476:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 477:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Clear TX complete interrupt flag.
 478:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * TX flag is clear after complete transmission, automatically.
 479:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 480:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 481:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_clear_tx_complete(USART_t *usart)
 482:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 483:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****          usart->UCSRnA |=  USART_TXC_bm;
 484:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 485:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 486:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 487:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Write a data to the USART data register.
 488:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 489:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 490:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param txdata The data to be transmitted.
 491:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 492:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_put(USART_t *usart, uint8_t txdata)
 493:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 494:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UDR = txdata;
 495:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 496:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 497:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 498:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief  Read a data to the USART data register.
 499:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 500:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 501:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 502:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \return The received data
 503:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 504:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline uint8_t usart_get(USART_t *usart)
 505:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 506:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UDR;
 507:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 508:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 509:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 510:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Double the USART transmission speed.
 511:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 512:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 513:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 514:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_double_baud_enable(USART_t *usart)
 515:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 126               		.loc 2 515 0
 127               		.cfi_startproc
 128 0034 CF93      		push r28
 129               	.LCFI6:
 130               		.cfi_def_cfa_offset 3
 131               		.cfi_offset 28, -2
 132 0036 DF93      		push r29
 133               	.LCFI7:
 134               		.cfi_def_cfa_offset 4
 135               		.cfi_offset 29, -3
 136 0038 00D0      		rcall .
 137               	.LCFI8:
 138               		.cfi_def_cfa_offset 6
 139 003a CDB7      		in r28,__SP_L__
 140 003c DEB7      		in r29,__SP_H__
 141               	.LCFI9:
 142               		.cfi_def_cfa_register 28
 143               	/* prologue: function */
 144               	/* frame size = 2 */
 145               	/* stack size = 4 */
 146               	.L__stack_usage = 4
 147 003e 9A83      		std Y+2,r25
 148 0040 8983      		std Y+1,r24
 516:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	usart->UCSRnA |=  USART_U2X_bm;
 149               		.loc 2 516 0
 150 0042 8981      		ldd r24,Y+1
 151 0044 9A81      		ldd r25,Y+2
 152 0046 FC01      		movw r30,r24
 153 0048 8081      		ld r24,Z
 154 004a 282F      		mov r18,r24
 155 004c 2260      		ori r18,lo8(2)
 156 004e 8981      		ldd r24,Y+1
 157 0050 9A81      		ldd r25,Y+2
 158 0052 FC01      		movw r30,r24
 159 0054 2083      		st Z,r18
 517:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 160               		.loc 2 517 0
 161 0056 0000      		nop
 162               	/* epilogue start */
 163 0058 0F90      		pop __tmp_reg__
 164 005a 0F90      		pop __tmp_reg__
 165 005c DF91      		pop r29
 166 005e CF91      		pop r28
 167 0060 0895      		ret
 168               		.cfi_endproc
 169               	.LFE101:
 172               	usart_serial_init:
 173               	.LFB104:
 174               		.file 3 "../../../platform/common/services/serial/megarf_usart/usart_serial.h"
   1:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /**
   2:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \file
   3:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
   4:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \brief This file defines a useful set of functions for the Serial interface on 
   5:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * AVR MEGARF devices.
   6:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
   7:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * Copyright (c) 2013 Atmel Corporation. All rights reserved.
   8:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
   9:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \asf_license_start
  10:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  11:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \page License
  12:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  13:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * Redistribution and use in source and binary forms, with or without
  14:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * modification, are permitted provided that the following conditions are met:
  15:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  16:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  17:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    this list of conditions and the following disclaimer.
  18:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  19:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  20:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    this list of conditions and the following disclaimer in the documentation
  21:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    and/or other materials provided with the distribution.
  22:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  23:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  24:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    from this software without specific prior written permission.
  25:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  26:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 4. This software may only be redistributed and used in connection with an
  27:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    Atmel microcontroller product.
  28:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  29:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  30:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  31:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  32:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  33:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  34:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  35:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  36:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  37:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  38:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  39:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * POSSIBILITY OF SUCH DAMAGE.
  40:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  41:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \asf_license_stop
  42:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  43:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  44:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #ifndef _USART_SERIAL_H_
  45:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #define _USART_SERIAL_H_
  46:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  47:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #ifdef __cplusplus
  48:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** extern "C" {
  49:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #endif
  50:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  51:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "compiler.h"
  52:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "sysclk.h"
  53:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "status_codes.h"
  54:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "usart_megarf.h"
  55:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  56:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \name Serial Management Configuration
  57:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  58:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /* ! @{ */
  59:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "conf_usart_serial.h"
  60:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /* ! @} */
  61:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  62:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** typedef usart_rs232_options_t usart_serial_options_t;
  63:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  64:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** typedef USART_t *usart_if;
  65:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  66:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \brief Initializes the Usart in master mode.
  67:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  68:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param usart       Base address of the USART instance.
  69:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param options     Options needed to set up RS232 communication (see \ref
  70:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * usart_serial_options_t).
  71:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  72:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \retval true if the initialization was successful
  73:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \retval false if initialization failed (error in baud rate calculation)
  74:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  75:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** static inline bool usart_serial_init(usart_if usart, const
  76:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 		usart_serial_options_t *options)
  77:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** {
 175               		.loc 3 77 0
 176               		.cfi_startproc
 177 0062 CF93      		push r28
 178               	.LCFI10:
 179               		.cfi_def_cfa_offset 3
 180               		.cfi_offset 28, -2
 181 0064 DF93      		push r29
 182               	.LCFI11:
 183               		.cfi_def_cfa_offset 4
 184               		.cfi_offset 29, -3
 185 0066 CDB7      		in r28,__SP_L__
 186 0068 DEB7      		in r29,__SP_H__
 187               	.LCFI12:
 188               		.cfi_def_cfa_register 28
 189 006a 2B97      		sbiw r28,11
 190               	.LCFI13:
 191               		.cfi_def_cfa_offset 15
 192 006c 0FB6      		in __tmp_reg__,__SREG__
 193 006e F894      		cli
 194 0070 DEBF      		out __SP_H__,r29
 195 0072 0FBE      		out __SREG__,__tmp_reg__
 196 0074 CDBF      		out __SP_L__,r28
 197               	/* prologue: function */
 198               	/* frame size = 11 */
 199               	/* stack size = 13 */
 200               	.L__stack_usage = 13
 201 0076 9987      		std Y+9,r25
 202 0078 8887      		std Y+8,r24
 203 007a 7B87      		std Y+11,r23
 204 007c 6A87      		std Y+10,r22
  78:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	/* USART options. */
  79:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options_t usart_rs232_options;
  80:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.charlength   = options->charlength;
 205               		.loc 3 80 0
 206 007e 8A85      		ldd r24,Y+10
 207 0080 9B85      		ldd r25,Y+11
 208 0082 FC01      		movw r30,r24
 209 0084 8481      		ldd r24,Z+4
 210 0086 8D83      		std Y+5,r24
  81:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.paritytype   = options->paritytype;
 211               		.loc 3 81 0
 212 0088 8A85      		ldd r24,Y+10
 213 008a 9B85      		ldd r25,Y+11
 214 008c FC01      		movw r30,r24
 215 008e 8581      		ldd r24,Z+5
 216 0090 8E83      		std Y+6,r24
  82:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.stopbits     = options->stopbits;
 217               		.loc 3 82 0
 218 0092 8A85      		ldd r24,Y+10
 219 0094 9B85      		ldd r25,Y+11
 220 0096 FC01      		movw r30,r24
 221 0098 8681      		ldd r24,Z+6
 222 009a 8F83      		std Y+7,r24
  83:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.baudrate     = options->baudrate;
 223               		.loc 3 83 0
 224 009c 8A85      		ldd r24,Y+10
 225 009e 9B85      		ldd r25,Y+11
 226 00a0 FC01      		movw r30,r24
 227 00a2 8081      		ld r24,Z
 228 00a4 9181      		ldd r25,Z+1
 229 00a6 A281      		ldd r26,Z+2
 230 00a8 B381      		ldd r27,Z+3
 231 00aa 8983      		std Y+1,r24
 232 00ac 9A83      		std Y+2,r25
 233 00ae AB83      		std Y+3,r26
 234 00b0 BC83      		std Y+4,r27
  84:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  85:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	if (usart_init_rs232(usart, &usart_rs232_options)) {
 235               		.loc 3 85 0
 236 00b2 8885      		ldd r24,Y+8
 237 00b4 9985      		ldd r25,Y+9
 238 00b6 9E01      		movw r18,r28
 239 00b8 2F5F      		subi r18,-1
 240 00ba 3F4F      		sbci r19,-1
 241 00bc B901      		movw r22,r18
 242 00be 0E94 0000 		call usart_init_rs232
 243 00c2 8823      		tst r24
 244 00c4 01F0      		breq .L7
  86:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 		return true;
 245               		.loc 3 86 0
 246 00c6 81E0      		ldi r24,lo8(1)
 247 00c8 00C0      		rjmp .L9
 248               	.L7:
  87:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	} else {
  88:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 		return false;
 249               		.loc 3 88 0
 250 00ca 80E0      		ldi r24,0
 251               	.L9:
 252               	/* epilogue start */
  89:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	}
  90:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** }
 253               		.loc 3 90 0 discriminator 1
 254 00cc 2B96      		adiw r28,11
 255 00ce 0FB6      		in __tmp_reg__,__SREG__
 256 00d0 F894      		cli
 257 00d2 DEBF      		out __SP_H__,r29
 258 00d4 0FBE      		out __SREG__,__tmp_reg__
 259 00d6 CDBF      		out __SP_L__,r28
 260 00d8 DF91      		pop r29
 261 00da CF91      		pop r28
 262 00dc 0895      		ret
 263               		.cfi_endproc
 264               	.LFE104:
 267               	usart_serial_putchar:
 268               	.LFB105:
  91:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  92:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \brief Sends a character with the USART.
  93:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  94:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param usart   Base address of the USART instance.
  95:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param c       Character to write.
  96:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  97:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \return Status code
  98:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  99:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** static inline status_code_t usart_serial_putchar(usart_if usart, uint8_t c)
 100:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** {
 269               		.loc 3 100 0
 270               		.cfi_startproc
 271 00de CF93      		push r28
 272               	.LCFI14:
 273               		.cfi_def_cfa_offset 3
 274               		.cfi_offset 28, -2
 275 00e0 DF93      		push r29
 276               	.LCFI15:
 277               		.cfi_def_cfa_offset 4
 278               		.cfi_offset 29, -3
 279 00e2 00D0      		rcall .
 280 00e4 1F92      		push __zero_reg__
 281               	.LCFI16:
 282               		.cfi_def_cfa_offset 7
 283 00e6 CDB7      		in r28,__SP_L__
 284 00e8 DEB7      		in r29,__SP_H__
 285               	.LCFI17:
 286               		.cfi_def_cfa_register 28
 287               	/* prologue: function */
 288               	/* frame size = 3 */
 289               	/* stack size = 5 */
 290               	.L__stack_usage = 5
 291 00ea 9A83      		std Y+2,r25
 292 00ec 8983      		std Y+1,r24
 293 00ee 6B83      		std Y+3,r22
 101:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	return usart_putchar(usart, c);
 294               		.loc 3 101 0
 295 00f0 8981      		ldd r24,Y+1
 296 00f2 9A81      		ldd r25,Y+2
 297 00f4 6B81      		ldd r22,Y+3
 298 00f6 0E94 0000 		call usart_putchar
 299               	/* epilogue start */
 102:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** }
 300               		.loc 3 102 0
 301 00fa 0F90      		pop __tmp_reg__
 302 00fc 0F90      		pop __tmp_reg__
 303 00fe 0F90      		pop __tmp_reg__
 304 0100 DF91      		pop r29
 305 0102 CF91      		pop r28
 306 0104 0895      		ret
 307               		.cfi_endproc
 308               	.LFE105:
 311               	usart_serial_getchar:
 312               	.LFB106:
 103:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
 104:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \brief Waits until a character is received, and returns it.
 105:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
 106:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param usart   Base address of the USART instance.
 107:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param data   Data to read
 108:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
 109:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
 110:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** static inline void usart_serial_getchar(usart_if usart, uint8_t *data)
 111:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** {
 313               		.loc 3 111 0
 314               		.cfi_startproc
 315 0106 CF93      		push r28
 316               	.LCFI18:
 317               		.cfi_def_cfa_offset 3
 318               		.cfi_offset 28, -2
 319 0108 DF93      		push r29
 320               	.LCFI19:
 321               		.cfi_def_cfa_offset 4
 322               		.cfi_offset 29, -3
 323 010a 00D0      		rcall .
 324 010c 00D0      		rcall .
 325               	.LCFI20:
 326               		.cfi_def_cfa_offset 8
 327 010e CDB7      		in r28,__SP_L__
 328 0110 DEB7      		in r29,__SP_H__
 329               	.LCFI21:
 330               		.cfi_def_cfa_register 28
 331               	/* prologue: function */
 332               	/* frame size = 4 */
 333               	/* stack size = 6 */
 334               	.L__stack_usage = 6
 335 0112 9A83      		std Y+2,r25
 336 0114 8983      		std Y+1,r24
 337 0116 7C83      		std Y+4,r23
 338 0118 6B83      		std Y+3,r22
 112:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	*data = usart_getchar(usart);
 339               		.loc 3 112 0
 340 011a 8981      		ldd r24,Y+1
 341 011c 9A81      		ldd r25,Y+2
 342 011e 0E94 0000 		call usart_getchar
 343 0122 282F      		mov r18,r24
 344 0124 8B81      		ldd r24,Y+3
 345 0126 9C81      		ldd r25,Y+4
 346 0128 FC01      		movw r30,r24
 347 012a 2083      		st Z,r18
 113:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** }
 348               		.loc 3 113 0
 349 012c 0000      		nop
 350               	/* epilogue start */
 351 012e 0F90      		pop __tmp_reg__
 352 0130 0F90      		pop __tmp_reg__
 353 0132 0F90      		pop __tmp_reg__
 354 0134 0F90      		pop __tmp_reg__
 355 0136 DF91      		pop r29
 356 0138 CF91      		pop r28
 357 013a 0895      		ret
 358               		.cfi_endproc
 359               	.LFE106:
 362               	stdio_serial_init:
 363               	.LFB107:
 364               		.file 4 "../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h"
   1:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** /**
   2:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
   3:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \file
   4:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
   5:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \brief Common Standard I/O Serial Management.
   6:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
   7:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * This file defines a useful set of functions for the Stdio Serial interface on AVR
   8:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * and SAM devices.
   9:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  10:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * Copyright (c) 2009-2013 Atmel Corporation. All rights reserved.
  11:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  12:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \asf_license_start
  13:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  14:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \page License
  15:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  16:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * Redistribution and use in source and binary forms, with or without
  17:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * modification, are permitted provided that the following conditions are met:
  18:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  19:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  20:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    this list of conditions and the following disclaimer.
  21:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  22:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  23:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    this list of conditions and the following disclaimer in the documentation
  24:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    and/or other materials provided with the distribution.
  25:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  26:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  27:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    from this software without specific prior written permission.
  28:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  29:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 4. This software may only be redistributed and used in connection with an
  30:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    Atmel microcontroller product.
  31:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  32:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  33:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  34:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  35:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  36:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  37:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  38:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  39:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  40:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  41:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  42:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * POSSIBILITY OF SUCH DAMAGE.
  43:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  44:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \asf_license_stop
  45:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  46:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  ******************************************************************************/
  47:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  48:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  49:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #ifndef _STDIO_SERIAL_H_
  50:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #define _STDIO_SERIAL_H_
  51:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  52:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** /**
  53:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \defgroup group_common_utils_stdio_stdio_serial Standard serial I/O (stdio)
  54:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \ingroup group_common_utils_stdio
  55:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  56:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * Common standard serial I/O management driver that
  57:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * implements a stdio serial interface on AVR and SAM devices.
  58:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  59:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \{
  60:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  */
  61:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  62:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #include <stdio.h>
  63:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #include "compiler.h"
  64:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #ifndef SAMD20
  65:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # include "sysclk.h"
  66:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #endif
  67:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #include "serial.h"
  68:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  69:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #if (XMEGA || MEGA_RF) && defined(__GNUC__)
  70:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	extern int _write (char c, int *f);
  71:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	extern int _read (int *f);
  72:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #endif
  73:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  74:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  75:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** //! Pointer to the base of the USART module instance to use for stdio.
  76:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** extern volatile void *volatile stdio_base;
  77:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** //! Pointer to the external low level write function.
  78:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** extern int (*ptr_put)(void volatile*, char);
  79:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  80:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** //! Pointer to the external low level read function.
  81:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** extern void (*ptr_get)(void volatile*, char*);
  82:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  83:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** /*! \brief Initializes the stdio in Serial Mode.
  84:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  85:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \param usart       Base address of the USART instance.
  86:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \param opt         Options needed to set up RS232 communication (see \ref usart_options_t).
  87:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  88:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  */
  89:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** static inline void stdio_serial_init(volatile void *usart, const usart_serial_options_t *opt)
  90:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** {
 365               		.loc 4 90 0
 366               		.cfi_startproc
 367 013c CF93      		push r28
 368               	.LCFI22:
 369               		.cfi_def_cfa_offset 3
 370               		.cfi_offset 28, -2
 371 013e DF93      		push r29
 372               	.LCFI23:
 373               		.cfi_def_cfa_offset 4
 374               		.cfi_offset 29, -3
 375 0140 00D0      		rcall .
 376 0142 00D0      		rcall .
 377               	.LCFI24:
 378               		.cfi_def_cfa_offset 8
 379 0144 CDB7      		in r28,__SP_L__
 380 0146 DEB7      		in r29,__SP_H__
 381               	.LCFI25:
 382               		.cfi_def_cfa_register 28
 383               	/* prologue: function */
 384               	/* frame size = 4 */
 385               	/* stack size = 6 */
 386               	.L__stack_usage = 6
 387 0148 9A83      		std Y+2,r25
 388 014a 8983      		std Y+1,r24
 389 014c 7C83      		std Y+4,r23
 390 014e 6B83      		std Y+3,r22
  91:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	stdio_base = (void *)usart;
 391               		.loc 4 91 0
 392 0150 8981      		ldd r24,Y+1
 393 0152 9A81      		ldd r25,Y+2
 394 0154 9093 0000 		sts stdio_base+1,r25
 395 0158 8093 0000 		sts stdio_base,r24
  92:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	ptr_put = (int (*)(void volatile*,char))&usart_serial_putchar;
 396               		.loc 4 92 0
 397 015c 80E0      		ldi r24,lo8(gs(usart_serial_putchar))
 398 015e 90E0      		ldi r25,hi8(gs(usart_serial_putchar))
 399 0160 9093 0000 		sts ptr_put+1,r25
 400 0164 8093 0000 		sts ptr_put,r24
  93:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	ptr_get = (void (*)(void volatile*,char*))&usart_serial_getchar;
 401               		.loc 4 93 0
 402 0168 80E0      		ldi r24,lo8(gs(usart_serial_getchar))
 403 016a 90E0      		ldi r25,hi8(gs(usart_serial_getchar))
 404 016c 9093 0000 		sts ptr_get+1,r25
 405 0170 8093 0000 		sts ptr_get,r24
  94:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # if (XMEGA || MEGA_RF)
  95:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	usart_serial_init((USART_t *)usart,opt);
 406               		.loc 4 95 0
 407 0174 2B81      		ldd r18,Y+3
 408 0176 3C81      		ldd r19,Y+4
 409 0178 8981      		ldd r24,Y+1
 410 017a 9A81      		ldd r25,Y+2
 411 017c B901      		movw r22,r18
 412 017e 0E94 0000 		call usart_serial_init
  96:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # elif UC3
  97:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	usart_serial_init(usart,(usart_serial_options_t *)opt);
  98:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # elif SAM
  99:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	usart_serial_init((Usart *)usart,(usart_serial_options_t *)opt);
 100:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # else
 101:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  error Unsupported chip type
 102:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # endif
 103:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
 104:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # if defined(__GNUC__)
 105:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  if (XMEGA || MEGA_RF)
 106:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// For AVR GCC libc print redirection uses fdevopen.
 107:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	fdevopen((int (*)(char, FILE*))(_write),(int (*)(FILE*))(_read));
 413               		.loc 4 107 0
 414 0182 60E0      		ldi r22,lo8(gs(_read))
 415 0184 70E0      		ldi r23,hi8(gs(_read))
 416 0186 80E0      		ldi r24,lo8(gs(_write))
 417 0188 90E0      		ldi r25,hi8(gs(_write))
 418 018a 0E94 0000 		call fdevopen
 108:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  endif
 109:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  if UC3 || SAM
 110:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// For AVR32 and SAM GCC
 111:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// Specify that stdout and stdin should not be buffered.
 112:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	setbuf(stdout, NULL);
 113:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	setbuf(stdin, NULL);
 114:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// Note: Already the case in IAR's Normal DLIB default configuration
 115:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// and AVR GCC library:
 116:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// - printf() emits one character at a time.
 117:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// - getchar() requests only 1 byte to exit.
 118:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  endif
 119:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # endif
 120:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** }
 419               		.loc 4 120 0
 420 018e 0000      		nop
 421               	/* epilogue start */
 422 0190 0F90      		pop __tmp_reg__
 423 0192 0F90      		pop __tmp_reg__
 424 0194 0F90      		pop __tmp_reg__
 425 0196 0F90      		pop __tmp_reg__
 426 0198 DF91      		pop r29
 427 019a CF91      		pop r28
 428 019c 0895      		ret
 429               		.cfi_endproc
 430               	.LFE107:
 433               	macsc_enable_manual_bts:
 434               	.LFB121:
 435               		.file 5 "../../../platform/mega_rf/drivers/macsc/macsc_megarf.h"
   1:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
   2:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \file
   3:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
   4:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief AVR MEGARF MAC Symbol Counter Driver Definitions
   5:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
   6:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Copyright (c) 2013 Atmel Corporation. All rights reserved.
   7:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
   8:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \asf_license_start
   9:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  10:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \page License
  11:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  12:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Redistribution and use in source and binary forms, with or without
  13:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * modification, are permitted provided that the following conditions are met:
  14:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  15:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  16:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    this list of conditions and the following disclaimer.
  17:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  18:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  19:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    this list of conditions and the following disclaimer in the documentation
  20:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    and/or other materials provided with the distribution.
  21:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  22:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  23:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    from this software without specific prior written permission.
  24:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  25:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 4. This software may only be redistributed and used in connection with an
  26:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    Atmel microcontroller product.
  27:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  28:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  29:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  30:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  31:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  32:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  33:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  34:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  35:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  36:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  37:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  38:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * POSSIBILITY OF SUCH DAMAGE.
  39:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  40:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \asf_license_stop
  41:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  42:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  43:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #ifndef MACSC_MEGARF_H
  44:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_MEGARF_H
  45:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  46:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #include <compiler.h>
  47:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #include <parts.h>
  48:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #include "status_codes.h"
  49:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  50:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #ifdef __cplusplus
  51:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** extern "C" {
  52:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #endif
  53:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  54:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
  55:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \defgroup macsc_group MAC Symbol Counter Driver(MACSC)
  56:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  57:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * See \ref megarf_macsc_quickstart
  58:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  59:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This is a driver for the AVR MEGARF MAC Symbol Counter Driver(MACSC).
  60:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * It provides functions for enabling, disabling and configuring the module.
  61:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  62:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \section dependencies Dependencies
  63:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This driver depends on the following modules:
  64:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * - \ref interrupt_group for ISR definition and disabling interrupts during
  65:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * critical code sections.
  66:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @{
  67:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  68:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  69:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
  70:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Interrupt event callback function type
  71:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  72:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * The interrupt handler can be configured to do a function callback,
  73:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * the callback function must match the macsc_callback_t type.
  74:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  75:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  76:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** typedef void (*macsc_callback_t)(void);
  77:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  78:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /* ! MAC symbol counter compare Channel index */
  79:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** enum macsc_cc_channel {
  80:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! Channel 1 */
  81:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_CC1 = 1,
  82:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! Channel 2 */
  83:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_CC2 = 2,
  84:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! Channel 3 */
  85:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_CC3 = 3,
  86:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** };
  87:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
  88:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief MAC SC clock source select
  89:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  90:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * uses the SCCKSEL bit in SSCR register to select macsc clk src
  91:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  92:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * If the bit is one,the RTC clock from TOSC1 is selected, otherwise the symbol
  93:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * counter operates with the clock from XTAL1.
  94:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * During transceiver sleep modes the clock falls back to the RTC clock source,
  95:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * regardless of the selected clock. After wakeup, it switches back to the
  96:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * previosly
  97:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * selected clock source.
  98:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  99:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 100:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** enum macsc_xtal {
 101:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! 16MHz as macsc clock */
 102:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_16MHz = 0,
 103:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_32KHz = 1,
 104:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** };
 105:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 106:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 107:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @brief Reads the 32-bit timer register in the required order of bytes
 108:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 109:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param hh hh octet of 32-bit register
 110:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param hl hl octet of 32-bit register
 111:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param lh lh octet of 32-bit register
 112:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param ll ll octet of 32-bit register
 113:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 114:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @returns uint32_t Value of timer register
 115:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 116:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read32(volatile uint8_t *hh,
 117:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		volatile uint8_t *hl,
 118:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		volatile uint8_t *lh,
 119:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		volatile uint8_t *ll)
 120:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 121:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	union {
 122:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		uint8_t a[4];
 123:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		uint32_t rv;
 124:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	}
 125:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x;
 126:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 127:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[0] = *ll;
 128:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[1] = *lh;
 129:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[2] = *hl;
 130:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[3] = *hh;
 131:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 132:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return x.rv;
 133:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 134:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 135:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /* ! compare modes */
 136:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_ABSOLUTE_CMP 0
 137:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_RELATIVE_CMP 1
 138:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 139:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /** String concatenation by preprocessor used to create proper register names.
 140:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  **/
 141:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define CONCAT(a, b) a ## b
 142:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 143:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /** Creates proper subregister names and reads the corresponding values. */
 144:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_READ32(reg)                  macsc_read32(&CONCAT(reg, HH), \
 145:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		&CONCAT(reg, HL), \
 146:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		&CONCAT(reg, LH), \
 147:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		&CONCAT(reg, LL))
 148:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 149:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_WRITE32(reg, val)	\
 150:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	do { \
 151:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		union { uint8_t a[4]; uint32_t v; } \
 152:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		x; \
 153:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		x.v = val; \
 154:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, HH) = x.a[3]; \
 155:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, HL) = x.a[2]; \
 156:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, LH) = x.a[1]; \
 157:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, LL) = x.a[0]; \
 158:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	} \
 159:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	while (0)
 160:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 161:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 162:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Enable MAC SC
 163:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 164:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Enables the SC
 165:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 166:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param clk_src selection of clk source,avalable options in macsc_xtal,fixed
 167:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *  prescalar
 168:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param sleep_enable enable RTC as clock source during sleep
 169:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param auto_ts enable automatic timestamping
 170:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 171:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 172:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_enable(void);
 173:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 174:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 175:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Check if MACSC is enabled
 176:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 177:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * check if the MACSC is enabled.
 178:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 179:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 180:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 181:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 182:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** bool is_macsc_enable(void);
 183:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 184:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 185:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disable MAC SC
 186:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 187:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Disables the MAC SC
 188:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 189:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 190:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 191:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 192:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_disable(void);
 193:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 194:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 195:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Check if back-off slot counter is enabled
 196:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 197:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * check if the back-off slot counter is enabled.
 198:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 199:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 200:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 201:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 202:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** bool is_macsc_backoff_enable(void);
 203:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 204:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 205:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Enables compare interrupts of the MACSC
 206:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 207:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param channel Compare channel
 208:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 209:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_enable_cmp_int(enum macsc_cc_channel channel);
 210:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 211:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 212:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disables compare interrupts of the MACSC
 213:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 214:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param channel Compare channel
 215:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */void macsc_disable_cmp_int(enum macsc_cc_channel channel);
 216:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 217:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 218:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Usage of Absolute compare mode of the MACSC
 219:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 220:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param abs_rel  0 for absoulte cmp;1 for relative cmp
 221:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param cmp compare value for SCOCRx register
 222:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param channel Compare channel
 223:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 224:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_use_cmp(bool abs_rel, uint32_t cmp,enum macsc_cc_channel channel);
 225:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 226:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 227:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \ingroup macsc_group
 228:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \defgroup macsc_interrupt_group MAC Symbol Counter (MACSC) interrupt
 229:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * management
 230:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This group provides functions to configure MACSC module interrupts
 231:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 232:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @{
 233:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 234:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 235:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 236:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC overflow interrupt callback function
 237:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 238:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 239:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 240:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 241:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 242:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 243:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 244:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_ovf_int_cb(macsc_callback_t callback);
 245:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 246:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 247:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC Compare Channel 1 interrupt callback function
 248:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 249:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 250:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 251:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 252:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 253:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 254:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 255:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_cmp1_int_cb(macsc_callback_t callback);
 256:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 257:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 258:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC Compare Channel 2 interrupt callback function
 259:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 260:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 261:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 262:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 263:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 264:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 265:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 266:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_cmp2_int_cb(macsc_callback_t callback);
 267:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 268:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 269:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC Compare Channel 3 interrupt callback function
 270:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 271:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 272:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 273:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 274:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 275:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 276:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 277:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_cmp3_int_cb(macsc_callback_t callback);
 278:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 279:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 280:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC backoff slot counter interrupt callback function
 281:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 282:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 283:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 284:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 285:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 286:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 287:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 288:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_backoff_slot_cntr_int_cb(macsc_callback_t callback);
 289:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** //@}
 290:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 291:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 292:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Enable 32.768KHz clk using timer 2 async register
 293:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 294:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 295:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 296:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 297:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_sleep_clk_enable(void)
 298:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 299:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	ASSR |= (1 << AS2);
 300:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 301:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 302:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 303:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disable 32.768KHz clk using timer 2 async register
 304:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 305:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 306:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 307:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_sleep_clk_disable(void)
 308:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 309:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	ASSR &= ~(1 << AS2);
 310:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 311:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 312:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /* @} */
 313:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 314:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 315:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Configure MAC Symbol Counter Clock Source
 316:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 317:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param macsc macsc clk src
 318:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 319:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_write_clock_source(enum macsc_xtal source)
 320:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 321:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	if (source == MACSC_16MHz) {
 322:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCCR0 |= (source << SCCKSEL);
 323:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	} else if (source == MACSC_32KHz) {
 324:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCCR0 &= ~(1 << SCCKSEL);
 325:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	}
 326:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 327:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 328:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 329:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Read MAC SC Clock Source
 330:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 331:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 332:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return macsc_xtal enum Clock source selection
 333:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 334:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline enum macsc_xtal macsc_read_clock_source(void)
 335:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 336:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (enum macsc_xtal)(SCCR0 & (1 << SCCKSEL));
 337:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 338:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 339:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 340:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Write the Counter value of the MAC Symbol counter
 341:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 342:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param cnt_value Counter value
 343:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 344:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_write_count(uint32_t cnt_value)
 345:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 346:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_WRITE32(SCCNT, cnt_value);
 347:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 348:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 349:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 350:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Reads the Counter value of the MAC Symbol counter
 351:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 352:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note Output the Counter value
 353:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 354:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read_count(void)
 355:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 356:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (MACSC_READ32(SCCNT));
 357:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 358:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 359:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 360:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief enable back-off slot counter
 361:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 362:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 363:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note  Enables interrupt as well	.
 364:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note This counter works only if transceiver clock is running.So check Trx
 365:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * state in app before using this function in IEEE802.15.4 applications.
 366:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 367:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline bool macsc_backoff_slot_cnt_enable(void)
 368:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 369:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	if (!(PRR1 & (1 << PRTRX24))) {
 370:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCCR1 = (1 << SCENBO);
 371:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCIRQS |= (1 << IRQSBO);
 372:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCIRQM |= (1 << IRQMBO);
 373:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		return true;
 374:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	}
 375:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	else return false;
 376:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 377:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 378:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 379:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disable back-off slot counter
 380:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 381:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 382:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note    Disables interrupt as well	.
 383:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note This counter works only if transceiver clock is running.So check Trx
 384:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * state in app before using this function in IEEE802.15.4 applications.
 385:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 386:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_backoff_slot_cnt_disable(void)
 387:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 388:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCCR1 &= ~(1 << SCENBO);
 389:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCIRQM &= ~(1 << IRQMBO);
 390:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 391:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 392:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 393:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Tests if the Backoff slot cntr interrupt flag is set
 394:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 395:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return  backoff slot cntr interrupt has occurred or not : IRQSBO
 396:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 397:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline bool macsc_is_slot_cntr_interrupt_flag_set(void)
 398:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 399:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (SCIRQS & (1 << IRQSBO));
 400:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 401:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 402:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 403:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Clears the Backoff Slot cntr interrupt flag
 404:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 405:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note  IRQSBO is cleared
 406:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 407:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_clear_slot_cntr_interrupt_flag(void)
 408:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 409:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCIRQS |= (1 << IRQSBO);
 410:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 411:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 412:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 413:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Reads the SFD Timestamp register
 414:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 415:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return Timestamp of last received frame :SCTSR(read-only register)
 416:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 417:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read_ts(void)
 418:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 419:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (MACSC_READ32(SCTSR));
 420:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 421:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 422:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 423:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Reads the Beacon Timestamp register
 424:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 425:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return Timestamp of last received beacon frame :SCBTSR
 426:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 427:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read_bts(void)
 428:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 429:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (MACSC_READ32(SCBTSR));
 430:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 431:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 432:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 433:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Write the Beacon Timestamp register of the MAC Symbol counter
 434:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * The manual beacon timestamping can be used in conjunction with the
 435:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * relative compare mode of the three compare units to generate compare match
 436:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * interrupts without having a beacon frame received
 437:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 438:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * If set to 1, the current symbol counter value is stored into the beacon
 439:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * timestamp register.
 440:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * The bit is cleared afterwards.
 441:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 442:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 443:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_enable_manual_bts(void)
 444:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 436               		.loc 5 444 0
 437               		.cfi_startproc
 438 019e CF93      		push r28
 439               	.LCFI26:
 440               		.cfi_def_cfa_offset 3
 441               		.cfi_offset 28, -2
 442 01a0 DF93      		push r29
 443               	.LCFI27:
 444               		.cfi_def_cfa_offset 4
 445               		.cfi_offset 29, -3
 446 01a2 CDB7      		in r28,__SP_L__
 447 01a4 DEB7      		in r29,__SP_H__
 448               	.LCFI28:
 449               		.cfi_def_cfa_register 28
 450               	/* prologue: function */
 451               	/* frame size = 0 */
 452               	/* stack size = 2 */
 453               	.L__stack_usage = 2
 445:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCCR0 |= (1 << SCMBTS);
 454               		.loc 5 445 0
 455 01a6 8CED      		ldi r24,lo8(-36)
 456 01a8 90E0      		ldi r25,0
 457 01aa 2CED      		ldi r18,lo8(-36)
 458 01ac 30E0      		ldi r19,0
 459 01ae F901      		movw r30,r18
 460 01b0 2081      		ld r18,Z
 461 01b2 2064      		ori r18,lo8(64)
 462 01b4 FC01      		movw r30,r24
 463 01b6 2083      		st Z,r18
 446:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCCR0 &= ~(1 << SCTSE);
 464               		.loc 5 446 0
 465 01b8 8CED      		ldi r24,lo8(-36)
 466 01ba 90E0      		ldi r25,0
 467 01bc 2CED      		ldi r18,lo8(-36)
 468 01be 30E0      		ldi r19,0
 469 01c0 F901      		movw r30,r18
 470 01c2 2081      		ld r18,Z
 471 01c4 277F      		andi r18,lo8(-9)
 472 01c6 FC01      		movw r30,r24
 473 01c8 2083      		st Z,r18
 447:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 474               		.loc 5 447 0
 475 01ca 0000      		nop
 476               	/* epilogue start */
 477 01cc DF91      		pop r29
 478 01ce CF91      		pop r28
 479 01d0 0895      		ret
 480               		.cfi_endproc
 481               	.LFE121:
 483               	.global	appState
 484               		.section	.bss.appState,"aw",@nobits
 487               	appState:
 488 0000 00        		.zero	1
 489               		.section	.bss.msgReq,"aw",@nobits
 492               	msgReq:
 493 0000 0000 0000 		.zero	20
 493      0000 0000 
 493      0000 0000 
 493      0000 0000 
 493      0000 0000 
 494               		.section	.bss.PanId,"aw",@nobits
 497               	PanId:
 498 0000 00        		.zero	1
 499               		.section	.rodata
 500               	.LC1:
 501 0000 0A4D 5347 		.string	"\nMSG REQ SENT %d"
 501      2052 4551 
 501      2053 454E 
 501      5420 2564 
 501      00
 502               		.text
 503               	.global	appSendData
 505               	appSendData:
 506               	.LFB130:
 507               		.file 6 "ServerLLDN.c"
   1:ServerLLDN.c  **** /*
   2:ServerLLDN.c  **** 	* ServerLLDN.c
   3:ServerLLDN.c  **** 	*
   4:ServerLLDN.c  **** 	* Created: 10/18/2019 5:15:37 PM
   5:ServerLLDN.c  **** 	*  Author: guilherme
   6:ServerLLDN.c  **** 	*/ 
   7:ServerLLDN.c  **** 
   8:ServerLLDN.c  **** #include <stdlib.h>
   9:ServerLLDN.c  **** #include <stdio.h>
  10:ServerLLDN.c  **** #include <string.h>
  11:ServerLLDN.c  **** #include <inttypes.h>
  12:ServerLLDN.c  **** #include "config.h"
  13:ServerLLDN.c  **** #include "sys.h"
  14:ServerLLDN.c  **** #include "phy.h"
  15:ServerLLDN.c  **** #include "sys.h"
  16:ServerLLDN.c  **** #include "nwk.h"
  17:ServerLLDN.c  **** #include "sysclk.h"
  18:ServerLLDN.c  **** #include "sysTimer.h"
  19:ServerLLDN.c  **** #include "sleep_mgr.h"
  20:ServerLLDN.c  **** #include "sleepmgr.h"
  21:ServerLLDN.c  **** #include "led.h"
  22:ServerLLDN.c  **** #include "ioport.h"
  23:ServerLLDN.c  **** #include "conf_sleepmgr.h"
  24:ServerLLDN.c  **** #include "board.h"
  25:ServerLLDN.c  **** #include "platform.h"
  26:ServerLLDN.c  **** 
  27:ServerLLDN.c  **** #include "lldn.h"
  28:ServerLLDN.c  **** 
  29:ServerLLDN.c  **** #if 1
  30:ServerLLDN.c  **** #if (SIO2HOST_CHANNEL == SIO_USB)
  31:ServerLLDN.c  **** /* Only ARM */
  32:ServerLLDN.c  **** #include "hw_timer_lldn.h"
  33:ServerLLDN.c  **** #include "stdio_usb.h"
  34:ServerLLDN.c  **** #define MASTER_MACSC	0
  35:ServerLLDN.c  **** #else
  36:ServerLLDN.c  **** /* Only megarf series */
  37:ServerLLDN.c  **** #include "conf_sio2host.h"
  38:ServerLLDN.c  **** #define MASTER_MACSC	1
  39:ServerLLDN.c  **** #endif
  40:ServerLLDN.c  **** #else
  41:ServerLLDN.c  **** /* Only megarf series */
  42:ServerLLDN.c  **** #define MASTER_MACSC		1
  43:ServerLLDN.c  **** #endif
  44:ServerLLDN.c  **** 
  45:ServerLLDN.c  **** #define HUMAM_READABLE			1
  46:ServerLLDN.c  **** 
  47:ServerLLDN.c  **** #if (MASTER_MACSC == 1)
  48:ServerLLDN.c  **** #include "macsc_megarf.h"
  49:ServerLLDN.c  **** #define TIMESLOT_TIMER 0
  50:ServerLLDN.c  **** #else
  51:ServerLLDN.c  **** static SYS_Timer_t				tmrBeaconInterval;			// Beacon
  52:ServerLLDN.c  **** static SYS_Timer_t				tmrComputeData;				// Compute data
  53:ServerLLDN.c  **** #endif
  54:ServerLLDN.c  **** 
  55:ServerLLDN.c  **** #define PRINT 1
  56:ServerLLDN.c  **** 
  57:ServerLLDN.c  **** 	
  58:ServerLLDN.c  **** // equation for tTS gives time in seconds, the division by SYMBOL_TIME changes to symbols for count
  59:ServerLLDN.c  **** AppState_t	appState = APP_STATE_INITIAL;
  60:ServerLLDN.c  **** static NWK_DataReq_t msgReq;
  61:ServerLLDN.c  **** static uint8_t PanId;
  62:ServerLLDN.c  **** 
  63:ServerLLDN.c  ****  void appSendData(void)
  64:ServerLLDN.c  **** {
 508               		.loc 6 64 0
 509               		.cfi_startproc
 510 01d2 CF93      		push r28
 511               	.LCFI29:
 512               		.cfi_def_cfa_offset 3
 513               		.cfi_offset 28, -2
 514 01d4 DF93      		push r29
 515               	.LCFI30:
 516               		.cfi_def_cfa_offset 4
 517               		.cfi_offset 29, -3
 518 01d6 CDB7      		in r28,__SP_L__
 519 01d8 DEB7      		in r29,__SP_H__
 520               	.LCFI31:
 521               		.cfi_def_cfa_register 28
 522               	/* prologue: function */
 523               	/* frame size = 0 */
 524               	/* stack size = 2 */
 525               	.L__stack_usage = 2
  65:ServerLLDN.c  **** 	if(msgReq.options != 0)
 526               		.loc 6 65 0
 527 01da 8091 0000 		lds r24,msgReq+9
 528 01de 9091 0000 		lds r25,msgReq+9+1
 529 01e2 892B      		or r24,r25
 530 01e4 01F0      		breq .L17
  66:ServerLLDN.c  **** 	{
  67:ServerLLDN.c  **** 		printf("\nMSG REQ SENT %d",msgReq.options);
 531               		.loc 6 67 0
 532 01e6 8091 0000 		lds r24,msgReq+9
 533 01ea 9091 0000 		lds r25,msgReq+9+1
 534 01ee 292F      		mov r18,r25
 535 01f0 2F93      		push r18
 536 01f2 8F93      		push r24
 537 01f4 80E0      		ldi r24,lo8(.LC1)
 538 01f6 90E0      		ldi r25,hi8(.LC1)
 539 01f8 892F      		mov r24,r25
 540 01fa 8F93      		push r24
 541 01fc 80E0      		ldi r24,lo8(.LC1)
 542 01fe 90E0      		ldi r25,hi8(.LC1)
 543 0200 8F93      		push r24
 544 0202 0E94 0000 		call printf
 545 0206 0F90      		pop __tmp_reg__
 546 0208 0F90      		pop __tmp_reg__
 547 020a 0F90      		pop __tmp_reg__
 548 020c 0F90      		pop __tmp_reg__
  68:ServerLLDN.c  **** 		NWK_DataReq(&msgReq);
 549               		.loc 6 68 0
 550 020e 80E0      		ldi r24,lo8(msgReq)
 551 0210 90E0      		ldi r25,hi8(msgReq)
 552 0212 0E94 0000 		call NWK_DataReq
 553               	.L17:
  69:ServerLLDN.c  **** 	#if !APP_COORDINATOR
  70:ServerLLDN.c  **** 	#endif
  71:ServerLLDN.c  **** 	}
  72:ServerLLDN.c  **** }
 554               		.loc 6 72 0
 555 0216 0000      		nop
 556               	/* epilogue start */
 557 0218 DF91      		pop r29
 558 021a CF91      		pop r28
 559 021c 0895      		ret
 560               		.cfi_endproc
 561               	.LFE130:
 563               	.global	appPanState
 564               		.section	.data.appPanState,"aw",@progbits
 567               	appPanState:
 568 0000 01        		.byte	1
 569               		.comm	nodes_info_arr,3700,1
 570               	.global	config_request_frame
 571               		.section	.data.config_request_frame,"aw",@progbits
 574               	config_request_frame:
 575 0000 0F        		.byte	15
 576 0001 00        		.byte	0
 577 0002 0F        		.byte	15
 578 0003 0000      		.zero	2
 579 0005 80        		.byte	128
 580               	.global	conf_req_list
 581               		.section	.bss.conf_req_list,"aw",@nobits
 584               	conf_req_list:
 585 0000 0000      		.zero	2
 586               		.comm	ACKFrame,33,1
 587               	.global	ACKFrame_size
 588               		.section	.bss.ACKFrame_size,"aw",@nobits
 591               	ACKFrame_size:
 592 0000 0000      		.zero	2
 593               	.global	beaconInterval
 594               		.section	.bss.beaconInterval,"aw",@nobits
 597               	beaconInterval:
 598 0000 0000 0000 		.zero	4
 599               	.global	beaconInterval_association
 600               		.section	.bss.beaconInterval_association,"aw",@nobits
 603               	beaconInterval_association:
 604 0000 0000 0000 		.zero	4
 605               	.global	macLLDNnumUplinkTS
 606               		.section	.bss.macLLDNnumUplinkTS,"aw",@nobits
 609               	macLLDNnumUplinkTS:
 610 0000 0000      		.zero	2
 611               		.section	.bss.tmrDelay,"aw",@nobits
 614               	tmrDelay:
 615 0000 0000 0000 		.zero	13
 615      0000 0000 
 615      0000 0000 
 615      00
 616               	.global	assTimeSlot
 617               		.section	.bss.assTimeSlot,"aw",@nobits
 620               	assTimeSlot:
 621 0000 0000      		.zero	2
 622               	.global	timeslot_counter
 623               		.section	.bss.timeslot_counter,"aw",@nobits
 626               	timeslot_counter:
 627 0000 00        		.zero	1
 628               	.global	counter_associados
 629               		.section	.bss.counter_associados,"aw",@nobits
 632               	counter_associados:
 633 0000 0000      		.zero	2
 634               	.global	cycles_counter
 635               		.section	.data.cycles_counter,"aw",@progbits
 638               	cycles_counter:
 639 0000 01        		.byte	1
 640               	.global	association_request
 641               		.section	.bss.association_request,"aw",@nobits
 644               	association_request:
 645 0000 00        		.zero	1
 646               		.comm	msg_info_array,6600,1
 647               	.global	size_msg_info
 648               		.section	.bss.size_msg_info,"aw",@nobits
 651               	size_msg_info:
 652 0000 0000      		.zero	2
 653               	.global	data_received
 654               		.section	.bss.data_received,"aw",@nobits
 657               	data_received:
 658 0000 00        		.zero	1
 659               	.global	succes_rate
 660               		.section	.bss.succes_rate,"aw",@nobits
 663               	succes_rate:
 664 0000 0000 0000 		.zero	4
 665               		.section	.rodata
 666               	.LC2:
 667 0011 0A64 656C 		.string	"\ndelay handler"
 667      6179 2068 
 667      616E 646C 
 667      6572 00
 668               		.text
 670               	tmrDelayHandler:
 671               	.LFB131:
  73:ServerLLDN.c  **** 
  74:ServerLLDN.c  **** #if APP_COORDINATOR
  75:ServerLLDN.c  **** 
  76:ServerLLDN.c  **** 	#define NODOS_ASSOCIADOS_ESPERADOS 12
  77:ServerLLDN.c  **** 	
  78:ServerLLDN.c  **** 	AppPanState_t appPanState = APP_PAN_STATE_RESET; // Initial state of PAN node
  79:ServerLLDN.c  **** 	
  80:ServerLLDN.c  **** 	/* Configuration Request Frames */
  81:ServerLLDN.c  **** 	/* Da pra mudar o envio do confrequest pra ja usar essa array com as informas dos nodos */	
  82:ServerLLDN.c  **** 	nodes_info_t nodes_info_arr[50]; // Array for Configure Request messages, one position per node, 2
  83:ServerLLDN.c  **** 	NWK_ConfigRequest_t config_request_frame = { .id = LL_CONFIGURATION_REQUEST,
  84:ServerLLDN.c  **** 												 .s_macAddr = APP_ADDR,
  85:ServerLLDN.c  **** 												 .tx_channel = APP_CHANNEL,
  86:ServerLLDN.c  **** 												 .conf.macLLDNmgmtTS = MacLLDNMgmtTS };
  87:ServerLLDN.c  **** 	nodes_info_list_t *conf_req_list = NULL;
  88:ServerLLDN.c  **** 
  89:ServerLLDN.c  **** 	/* Acknowledge Frame and Array */
  90:ServerLLDN.c  **** 	NWK_ACKFormat_t ACKFrame;	// ACK Frame Payload used in Discovery State
  91:ServerLLDN.c  **** 	int ACKFrame_size = 0;
  92:ServerLLDN.c  **** 
  93:ServerLLDN.c  **** 	float beaconInterval = 0; // no precisa ser global
  94:ServerLLDN.c  **** 	float beaconInterval_association = 0;
  95:ServerLLDN.c  **** 	int macLLDNnumUplinkTS = 0;		// Number of uplink timeslots, is also the control of associated node
  96:ServerLLDN.c  **** 	
  97:ServerLLDN.c  **** 	/* This timer implements a delay between messages, 
  98:ServerLLDN.c  **** 	 * if not used the nodes are not able to receive the message
  99:ServerLLDN.c  **** 	 */
 100:ServerLLDN.c  **** 	static SYS_Timer_t tmrDelay;	
 101:ServerLLDN.c  **** 	
 102:ServerLLDN.c  **** 	/*  Control variables for testing */	
 103:ServerLLDN.c  **** 	int assTimeSlot = 0;
 104:ServerLLDN.c  **** 	uint8_t timeslot_counter = 0;
 105:ServerLLDN.c  **** 
 106:ServerLLDN.c  **** 	int counter_associados = 0;		// Associated nodes counter
 107:ServerLLDN.c  **** 	uint8_t cycles_counter = macLLDNdiscoveryModeTimeout;
 108:ServerLLDN.c  **** 
 109:ServerLLDN.c  **** 	bool association_request = false;
 110:ServerLLDN.c  **** 
 111:ServerLLDN.c  **** 	/* data related variables */
 112:ServerLLDN.c  **** 	msg_info_t msg_info_array[50]; // size of array limited by hardware
 113:ServerLLDN.c  **** 	unsigned int size_msg_info = 0;
 114:ServerLLDN.c  **** 	bool data_received = false;	
 115:ServerLLDN.c  **** 	float succes_rate = 0;
 116:ServerLLDN.c  **** 	
 117:ServerLLDN.c  **** 	static void tmrDelayHandler(SYS_Timer_t *timer)
 118:ServerLLDN.c  **** 	{
 672               		.loc 6 118 0
 673               		.cfi_startproc
 674 021e CF93      		push r28
 675               	.LCFI32:
 676               		.cfi_def_cfa_offset 3
 677               		.cfi_offset 28, -2
 678 0220 DF93      		push r29
 679               	.LCFI33:
 680               		.cfi_def_cfa_offset 4
 681               		.cfi_offset 29, -3
 682 0222 00D0      		rcall .
 683               	.LCFI34:
 684               		.cfi_def_cfa_offset 6
 685 0224 CDB7      		in r28,__SP_L__
 686 0226 DEB7      		in r29,__SP_H__
 687               	.LCFI35:
 688               		.cfi_def_cfa_register 28
 689               	/* prologue: function */
 690               	/* frame size = 2 */
 691               	/* stack size = 4 */
 692               	.L__stack_usage = 4
 693 0228 9A83      		std Y+2,r25
 694 022a 8983      		std Y+1,r24
 119:ServerLLDN.c  **** 		printf("\ndelay handler");
 695               		.loc 6 119 0
 696 022c 80E0      		ldi r24,lo8(.LC2)
 697 022e 90E0      		ldi r25,hi8(.LC2)
 698 0230 892F      		mov r24,r25
 699 0232 8F93      		push r24
 700 0234 80E0      		ldi r24,lo8(.LC2)
 701 0236 90E0      		ldi r25,hi8(.LC2)
 702 0238 8F93      		push r24
 703 023a 0E94 0000 		call printf
 704 023e 0F90      		pop __tmp_reg__
 705 0240 0F90      		pop __tmp_reg__
 120:ServerLLDN.c  **** 		appState = APP_STATE_SEND;
 706               		.loc 6 120 0
 707 0242 82E0      		ldi r24,lo8(2)
 708 0244 8093 0000 		sts appState,r24
 121:ServerLLDN.c  **** 	}
 709               		.loc 6 121 0
 710 0248 0000      		nop
 711               	/* epilogue start */
 712 024a 0F90      		pop __tmp_reg__
 713 024c 0F90      		pop __tmp_reg__
 714 024e DF91      		pop r29
 715 0250 CF91      		pop r28
 716 0252 0895      		ret
 717               		.cfi_endproc
 718               	.LFE131:
 721               	lldn_server_beacon:
 722               	.LFB132:
 122:ServerLLDN.c  **** 	
 123:ServerLLDN.c  **** 	static void lldn_server_beacon(void)
 124:ServerLLDN.c  **** 	{
 723               		.loc 6 124 0
 724               		.cfi_startproc
 725 0254 CF93      		push r28
 726               	.LCFI36:
 727               		.cfi_def_cfa_offset 3
 728               		.cfi_offset 28, -2
 729 0256 DF93      		push r29
 730               	.LCFI37:
 731               		.cfi_def_cfa_offset 4
 732               		.cfi_offset 29, -3
 733 0258 CDB7      		in r28,__SP_L__
 734 025a DEB7      		in r29,__SP_H__
 735               	.LCFI38:
 736               		.cfi_def_cfa_register 28
 737               	/* prologue: function */
 738               	/* frame size = 0 */
 739               	/* stack size = 2 */
 740               	.L__stack_usage = 2
 125:ServerLLDN.c  **** 		macsc_enable_manual_bts();
 741               		.loc 6 125 0
 742 025c 0E94 0000 		call macsc_enable_manual_bts
 126:ServerLLDN.c  **** 		appState = APP_STATE_SEND;
 743               		.loc 6 126 0
 744 0260 82E0      		ldi r24,lo8(2)
 745 0262 8093 0000 		sts appState,r24
 127:ServerLLDN.c  **** 	}
 746               		.loc 6 127 0
 747 0266 0000      		nop
 748               	/* epilogue start */
 749 0268 DF91      		pop r29
 750 026a CF91      		pop r28
 751 026c 0895      		ret
 752               		.cfi_endproc
 753               	.LFE132:
 755               	.global	__divsf3
 756               	.global	__fixunssfsi
 758               	time_slot_handler:
 759               	.LFB133:
 128:ServerLLDN.c  **** 	
 129:ServerLLDN.c  **** 	static void time_slot_handler(void)
 130:ServerLLDN.c  **** 	{
 760               		.loc 6 130 0
 761               		.cfi_startproc
 762 026e CF93      		push r28
 763               	.LCFI39:
 764               		.cfi_def_cfa_offset 3
 765               		.cfi_offset 28, -2
 766 0270 DF93      		push r29
 767               	.LCFI40:
 768               		.cfi_def_cfa_offset 4
 769               		.cfi_offset 29, -3
 770 0272 CDB7      		in r28,__SP_L__
 771 0274 DEB7      		in r29,__SP_H__
 772               	.LCFI41:
 773               		.cfi_def_cfa_register 28
 774               	/* prologue: function */
 775               	/* frame size = 0 */
 776               	/* stack size = 2 */
 777               	.L__stack_usage = 2
 131:ServerLLDN.c  **** 		if (timeslot_counter > 0)
 778               		.loc 6 131 0
 779 0276 8091 0000 		lds r24,timeslot_counter
 780 027a 8823      		tst r24
 781 027c 01F0      		breq .L21
 132:ServerLLDN.c  **** 			macsc_use_cmp(MACSC_RELATIVE_CMP, tTS / (SYMBOL_TIME), MACSC_CC1);
 782               		.loc 6 132 0
 783 027e 8091 0000 		lds r24,tTS
 784 0282 9091 0000 		lds r25,tTS+1
 785 0286 A091 0000 		lds r26,tTS+2
 786 028a B091 0000 		lds r27,tTS+3
 787 028e 2DEB      		ldi r18,lo8(-67)
 788 0290 37E3      		ldi r19,lo8(55)
 789 0292 46E8      		ldi r20,lo8(-122)
 790 0294 57E3      		ldi r21,lo8(55)
 791 0296 BC01      		movw r22,r24
 792 0298 CD01      		movw r24,r26
 793 029a 0E94 0000 		call __divsf3
 794 029e DC01      		movw r26,r24
 795 02a0 CB01      		movw r24,r22
 796 02a2 BC01      		movw r22,r24
 797 02a4 CD01      		movw r24,r26
 798 02a6 0E94 0000 		call __fixunssfsi
 799 02aa DC01      		movw r26,r24
 800 02ac CB01      		movw r24,r22
 801 02ae 21E0      		ldi r18,lo8(1)
 802 02b0 AC01      		movw r20,r24
 803 02b2 BD01      		movw r22,r26
 804 02b4 81E0      		ldi r24,lo8(1)
 805 02b6 0E94 0000 		call macsc_use_cmp
 806               	.L21:
 133:ServerLLDN.c  **** 		
 134:ServerLLDN.c  **** 		macsc_enable_manual_bts();
 807               		.loc 6 134 0
 808 02ba 0E94 0000 		call macsc_enable_manual_bts
 135:ServerLLDN.c  **** 		appState = APP_STATE_ATT_PAN_STATE;
 809               		.loc 6 135 0
 810 02be 83E0      		ldi r24,lo8(3)
 811 02c0 8093 0000 		sts appState,r24
 136:ServerLLDN.c  **** 	}
 812               		.loc 6 136 0
 813 02c4 0000      		nop
 814               	/* epilogue start */
 815 02c6 DF91      		pop r29
 816 02c8 CF91      		pop r28
 817 02ca 0895      		ret
 818               		.cfi_endproc
 819               	.LFE133:
 822               	downlink_delay_handler:
 823               	.LFB134:
 137:ServerLLDN.c  **** 	
 138:ServerLLDN.c  **** 	static void downlink_delay_handler(void)
 139:ServerLLDN.c  **** 	{
 824               		.loc 6 139 0
 825               		.cfi_startproc
 826 02cc CF93      		push r28
 827               	.LCFI42:
 828               		.cfi_def_cfa_offset 3
 829               		.cfi_offset 28, -2
 830 02ce DF93      		push r29
 831               	.LCFI43:
 832               		.cfi_def_cfa_offset 4
 833               		.cfi_offset 29, -3
 834 02d0 CDB7      		in r28,__SP_L__
 835 02d2 DEB7      		in r29,__SP_H__
 836               	.LCFI44:
 837               		.cfi_def_cfa_register 28
 838               	/* prologue: function */
 839               	/* frame size = 0 */
 840               	/* stack size = 2 */
 841               	.L__stack_usage = 2
 140:ServerLLDN.c  **** 		if(msgReq.options == NWK_OPT_LLDN_ACK)
 842               		.loc 6 140 0
 843 02d4 8091 0000 		lds r24,msgReq+9
 844 02d8 9091 0000 		lds r25,msgReq+9+1
 845 02dc 8115      		cp r24,__zero_reg__
 846 02de 9044      		sbci r25,64
 847 02e0 01F4      		brne .L24
 141:ServerLLDN.c  **** 		{
 142:ServerLLDN.c  **** 		appState = APP_STATE_SEND;
 848               		.loc 6 142 0
 849 02e2 82E0      		ldi r24,lo8(2)
 850 02e4 8093 0000 		sts appState,r24
 851               	.L24:
 143:ServerLLDN.c  **** 		}
 144:ServerLLDN.c  **** 	}
 852               		.loc 6 144 0
 853 02e8 0000      		nop
 854               	/* epilogue start */
 855 02ea DF91      		pop r29
 856 02ec CF91      		pop r28
 857 02ee 0895      		ret
 858               		.cfi_endproc
 859               	.LFE134:
 862               	end_of_association_delay_handler:
 863               	.LFB135:
 145:ServerLLDN.c  **** 
 146:ServerLLDN.c  **** 	static void end_of_association_delay_handler(void)
 147:ServerLLDN.c  **** 	{
 864               		.loc 6 147 0
 865               		.cfi_startproc
 866 02f0 CF93      		push r28
 867               	.LCFI45:
 868               		.cfi_def_cfa_offset 3
 869               		.cfi_offset 28, -2
 870 02f2 DF93      		push r29
 871               	.LCFI46:
 872               		.cfi_def_cfa_offset 4
 873               		.cfi_offset 29, -3
 874 02f4 CDB7      		in r28,__SP_L__
 875 02f6 DEB7      		in r29,__SP_H__
 876               	.LCFI47:
 877               		.cfi_def_cfa_register 28
 878               	/* prologue: function */
 879               	/* frame size = 0 */
 880               	/* stack size = 2 */
 881               	.L__stack_usage = 2
 148:ServerLLDN.c  **** 		appState = APP_STATE_ATT_PAN_STATE;
 882               		.loc 6 148 0
 883 02f8 83E0      		ldi r24,lo8(3)
 884 02fa 8093 0000 		sts appState,r24
 149:ServerLLDN.c  **** 		appPanState = APP_PAN_STATE_ONLINE_INITIAL;
 885               		.loc 6 149 0
 886 02fe 89E0      		ldi r24,lo8(9)
 887 0300 8093 0000 		sts appPanState,r24
 150:ServerLLDN.c  **** 	}
 888               		.loc 6 150 0
 889 0304 0000      		nop
 890               	/* epilogue start */
 891 0306 DF91      		pop r29
 892 0308 CF91      		pop r28
 893 030a 0895      		ret
 894               		.cfi_endproc
 895               	.LFE135:
 897               		.section	.rodata
 898               	.LC3:
 899 0020 0A41 6464 		.string	"\nAddr rep %d"
 899      7220 7265 
 899      7020 2564 
 899      00
 900               		.text
 902               	addToAckArray:
 903               	.LFB136:
 151:ServerLLDN.c  **** 	
 152:ServerLLDN.c  **** 	#if TIMESLOT_TIMER
 153:ServerLLDN.c  **** 	static void teste_handler(void)
 154:ServerLLDN.c  **** 	{
 155:ServerLLDN.c  **** 		if(msgReq.options)
 156:ServerLLDN.c  **** 			printf("\n***TIMESLOT****");
 157:ServerLLDN.c  **** 		macsc_disable_cmp_int(MACSC_CC3);
 158:ServerLLDN.c  **** 	}
 159:ServerLLDN.c  **** 	#endif
 160:ServerLLDN.c  **** 	
 161:ServerLLDN.c  **** 	static bool addToAckArray(uint8_t addres)
 162:ServerLLDN.c  **** 	{	
 904               		.loc 6 162 0
 905               		.cfi_startproc
 906 030c CF93      		push r28
 907               	.LCFI48:
 908               		.cfi_def_cfa_offset 3
 909               		.cfi_offset 28, -2
 910 030e DF93      		push r29
 911               	.LCFI49:
 912               		.cfi_def_cfa_offset 4
 913               		.cfi_offset 29, -3
 914 0310 00D0      		rcall .
 915 0312 00D0      		rcall .
 916 0314 1F92      		push __zero_reg__
 917               	.LCFI50:
 918               		.cfi_def_cfa_offset 9
 919 0316 CDB7      		in r28,__SP_L__
 920 0318 DEB7      		in r29,__SP_H__
 921               	.LCFI51:
 922               		.cfi_def_cfa_register 28
 923               	/* prologue: function */
 924               	/* frame size = 5 */
 925               	/* stack size = 7 */
 926               	.L__stack_usage = 7
 927 031a 8D83      		std Y+5,r24
 163:ServerLLDN.c  **** 		int pos =(int) addres / 8;
 928               		.loc 6 163 0
 929 031c 8D81      		ldd r24,Y+5
 930 031e 8695      		lsr r24
 931 0320 8695      		lsr r24
 932 0322 8695      		lsr r24
 933 0324 882F      		mov r24,r24
 934 0326 90E0      		ldi r25,0
 935 0328 9A83      		std Y+2,r25
 936 032a 8983      		std Y+1,r24
 164:ServerLLDN.c  **** 		int bit_shift = 8 - (addres % 8);
 937               		.loc 6 164 0
 938 032c 8D81      		ldd r24,Y+5
 939 032e 882F      		mov r24,r24
 940 0330 90E0      		ldi r25,0
 941 0332 8770      		andi r24,7
 942 0334 9927      		clr r25
 943 0336 28E0      		ldi r18,lo8(8)
 944 0338 30E0      		ldi r19,0
 945 033a A901      		movw r20,r18
 946 033c 481B      		sub r20,r24
 947 033e 590B      		sbc r21,r25
 948 0340 CA01      		movw r24,r20
 949 0342 9C83      		std Y+4,r25
 950 0344 8B83      		std Y+3,r24
 165:ServerLLDN.c  **** 		
 166:ServerLLDN.c  **** 		if(ACKFrame.ackFlags[pos] & 1 << bit_shift)
 951               		.loc 6 166 0
 952 0346 8981      		ldd r24,Y+1
 953 0348 9A81      		ldd r25,Y+2
 954 034a 8050      		subi r24,lo8(-(ACKFrame+1))
 955 034c 9040      		sbci r25,hi8(-(ACKFrame+1))
 956 034e FC01      		movw r30,r24
 957 0350 8081      		ld r24,Z
 958 0352 882F      		mov r24,r24
 959 0354 90E0      		ldi r25,0
 960 0356 0B80      		ldd r0,Y+3
 961 0358 00C0      		rjmp 2f
 962               		1:
 963 035a 9595      		asr r25
 964 035c 8795      		ror r24
 965               		2:
 966 035e 0A94      		dec r0
 967 0360 02F4      		brpl 1b
 968 0362 8170      		andi r24,1
 969 0364 9927      		clr r25
 970 0366 892B      		or r24,r25
 971 0368 01F0      		breq .L27
 167:ServerLLDN.c  **** 		{
 168:ServerLLDN.c  **** 			printf("\nAddr rep %d", addres);
 972               		.loc 6 168 0
 973 036a 8D81      		ldd r24,Y+5
 974 036c 882F      		mov r24,r24
 975 036e 90E0      		ldi r25,0
 976 0370 292F      		mov r18,r25
 977 0372 2F93      		push r18
 978 0374 8F93      		push r24
 979 0376 80E0      		ldi r24,lo8(.LC3)
 980 0378 90E0      		ldi r25,hi8(.LC3)
 981 037a 892F      		mov r24,r25
 982 037c 8F93      		push r24
 983 037e 80E0      		ldi r24,lo8(.LC3)
 984 0380 90E0      		ldi r25,hi8(.LC3)
 985 0382 8F93      		push r24
 986 0384 0E94 0000 		call printf
 987 0388 0F90      		pop __tmp_reg__
 988 038a 0F90      		pop __tmp_reg__
 989 038c 0F90      		pop __tmp_reg__
 990 038e 0F90      		pop __tmp_reg__
 169:ServerLLDN.c  **** 			return false;
 991               		.loc 6 169 0
 992 0390 80E0      		ldi r24,0
 993 0392 00C0      		rjmp .L28
 994               	.L27:
 170:ServerLLDN.c  **** 		}
 171:ServerLLDN.c  **** 		ACKFrame.ackFlags[pos] = 1 << bit_shift;
 995               		.loc 6 171 0
 996 0394 81E0      		ldi r24,lo8(1)
 997 0396 90E0      		ldi r25,0
 998 0398 0B80      		ldd r0,Y+3
 999 039a 00C0      		rjmp 2f
 1000               		1:
 1001 039c 880F      		lsl r24
 1002 039e 991F      		rol r25
 1003               		2:
 1004 03a0 0A94      		dec r0
 1005 03a2 02F4      		brpl 1b
 1006 03a4 282F      		mov r18,r24
 1007 03a6 8981      		ldd r24,Y+1
 1008 03a8 9A81      		ldd r25,Y+2
 1009 03aa 8050      		subi r24,lo8(-(ACKFrame+1))
 1010 03ac 9040      		sbci r25,hi8(-(ACKFrame+1))
 1011 03ae FC01      		movw r30,r24
 1012 03b0 2083      		st Z,r18
 172:ServerLLDN.c  **** 		if (pos + 1 > ACKFrame_size)
 1013               		.loc 6 172 0
 1014 03b2 8981      		ldd r24,Y+1
 1015 03b4 9A81      		ldd r25,Y+2
 1016 03b6 9C01      		movw r18,r24
 1017 03b8 2F5F      		subi r18,-1
 1018 03ba 3F4F      		sbci r19,-1
 1019 03bc 8091 0000 		lds r24,ACKFrame_size
 1020 03c0 9091 0000 		lds r25,ACKFrame_size+1
 1021 03c4 8217      		cp r24,r18
 1022 03c6 9307      		cpc r25,r19
 1023 03c8 04F4      		brge .L29
 173:ServerLLDN.c  **** 			ACKFrame_size = pos + 1;
 1024               		.loc 6 173 0
 1025 03ca 8981      		ldd r24,Y+1
 1026 03cc 9A81      		ldd r25,Y+2
 1027 03ce 0196      		adiw r24,1
 1028 03d0 9093 0000 		sts ACKFrame_size+1,r25
 1029 03d4 8093 0000 		sts ACKFrame_size,r24
 1030               	.L29:
 174:ServerLLDN.c  **** 		
 175:ServerLLDN.c  **** 		return true;
 1031               		.loc 6 175 0
 1032 03d8 81E0      		ldi r24,lo8(1)
 1033               	.L28:
 1034               	/* epilogue start */
 176:ServerLLDN.c  **** 	}
 1035               		.loc 6 176 0
 1036 03da 0F90      		pop __tmp_reg__
 1037 03dc 0F90      		pop __tmp_reg__
 1038 03de 0F90      		pop __tmp_reg__
 1039 03e0 0F90      		pop __tmp_reg__
 1040 03e2 0F90      		pop __tmp_reg__
 1041 03e4 DF91      		pop r29
 1042 03e6 CF91      		pop r28
 1043 03e8 0895      		ret
 1044               		.cfi_endproc
 1045               	.LFE136:
 1048               	addConfRequestArray:
 1049               	.LFB137:
 177:ServerLLDN.c  **** 
 178:ServerLLDN.c  **** 	static void addConfRequestArray(NWK_ConfigStatus_t *node)
 179:ServerLLDN.c  **** 	{
 1050               		.loc 6 179 0
 1051               		.cfi_startproc
 1052 03ea CF93      		push r28
 1053               	.LCFI52:
 1054               		.cfi_def_cfa_offset 3
 1055               		.cfi_offset 28, -2
 1056 03ec DF93      		push r29
 1057               	.LCFI53:
 1058               		.cfi_def_cfa_offset 4
 1059               		.cfi_offset 29, -3
 1060 03ee 00D0      		rcall .
 1061 03f0 00D0      		rcall .
 1062 03f2 1F92      		push __zero_reg__
 1063               	.LCFI54:
 1064               		.cfi_def_cfa_offset 9
 1065 03f4 CDB7      		in r28,__SP_L__
 1066 03f6 DEB7      		in r29,__SP_H__
 1067               	.LCFI55:
 1068               		.cfi_def_cfa_register 28
 1069               	/* prologue: function */
 1070               	/* frame size = 5 */
 1071               	/* stack size = 7 */
 1072               	.L__stack_usage = 7
 1073 03f8 9D83      		std Y+5,r25
 1074 03fa 8C83      		std Y+4,r24
 180:ServerLLDN.c  **** 
 181:ServerLLDN.c  **** 		uint8_t i;
 182:ServerLLDN.c  **** 		for (i= 0;i < 256 && nodes_info_arr[i].mac_addr != 0; i++);
 1075               		.loc 6 182 0
 1076 03fc 1982      		std Y+1,__zero_reg__
 1077 03fe 00C0      		rjmp .L31
 1078               	.L32:
 1079               		.loc 6 182 0 is_stmt 0 discriminator 3
 1080 0400 8981      		ldd r24,Y+1
 1081 0402 8F5F      		subi r24,lo8(-(1))
 1082 0404 8983      		std Y+1,r24
 1083               	.L31:
 1084               		.loc 6 182 0 discriminator 1
 1085 0406 8981      		ldd r24,Y+1
 1086 0408 282F      		mov r18,r24
 1087 040a 30E0      		ldi r19,0
 1088 040c 4AE4      		ldi r20,lo8(74)
 1089 040e 429F      		mul r20,r18
 1090 0410 C001      		movw r24,r0
 1091 0412 439F      		mul r20,r19
 1092 0414 900D      		add r25,r0
 1093 0416 1124      		clr __zero_reg__
 1094 0418 8050      		subi r24,lo8(-(nodes_info_arr+1))
 1095 041a 9040      		sbci r25,hi8(-(nodes_info_arr+1))
 1096 041c FC01      		movw r30,r24
 1097 041e 8081      		ld r24,Z
 1098 0420 9181      		ldd r25,Z+1
 1099 0422 892B      		or r24,r25
 1100 0424 01F4      		brne .L32
 183:ServerLLDN.c  **** 		
 184:ServerLLDN.c  **** 		assTimeSlot++;
 1101               		.loc 6 184 0 is_stmt 1
 1102 0426 8091 0000 		lds r24,assTimeSlot
 1103 042a 9091 0000 		lds r25,assTimeSlot+1
 1104 042e 0196      		adiw r24,1
 1105 0430 9093 0000 		sts assTimeSlot+1,r25
 1106 0434 8093 0000 		sts assTimeSlot,r24
 185:ServerLLDN.c  **** 	
 186:ServerLLDN.c  **** 		if(node->ts_dir.tsDuration > config_request_frame.conf.tsDuration)
 1107               		.loc 6 186 0
 1108 0438 8C81      		ldd r24,Y+4
 1109 043a 9D81      		ldd r25,Y+5
 1110 043c FC01      		movw r30,r24
 1111 043e 8481      		ldd r24,Z+4
 1112 0440 8F77      		andi r24,lo8(127)
 1113 0442 282F      		mov r18,r24
 1114 0444 30E0      		ldi r19,0
 1115 0446 8091 0000 		lds r24,config_request_frame+5
 1116 044a 8F77      		andi r24,lo8(127)
 1117 044c 882F      		mov r24,r24
 1118 044e 90E0      		ldi r25,0
 1119 0450 8217      		cp r24,r18
 1120 0452 9307      		cpc r25,r19
 1121 0454 04F4      		brge .L33
 187:ServerLLDN.c  **** 			config_request_frame.conf.tsDuration =  node->ts_dir.tsDuration;
 1122               		.loc 6 187 0
 1123 0456 8C81      		ldd r24,Y+4
 1124 0458 9D81      		ldd r25,Y+5
 1125 045a FC01      		movw r30,r24
 1126 045c 8481      		ldd r24,Z+4
 1127 045e 8F77      		andi r24,lo8(127)
 1128 0460 8F77      		andi r24,lo8(127)
 1129 0462 9091 0000 		lds r25,config_request_frame+5
 1130 0466 9078      		andi r25,lo8(-128)
 1131 0468 892B      		or r24,r25
 1132 046a 8093 0000 		sts config_request_frame+5,r24
 1133               	.L33:
 188:ServerLLDN.c  **** 		
 189:ServerLLDN.c  **** 		nodes_info_arr[i].req_timeslot_duration = node->ts_dir.tsDuration;
 1134               		.loc 6 189 0
 1135 046e 8981      		ldd r24,Y+1
 1136 0470 282F      		mov r18,r24
 1137 0472 30E0      		ldi r19,0
 1138 0474 8C81      		ldd r24,Y+4
 1139 0476 9D81      		ldd r25,Y+5
 1140 0478 FC01      		movw r30,r24
 1141 047a 8481      		ldd r24,Z+4
 1142 047c 8F77      		andi r24,lo8(127)
 1143 047e 582F      		mov r21,r24
 1144 0480 4AE4      		ldi r20,lo8(74)
 1145 0482 429F      		mul r20,r18
 1146 0484 C001      		movw r24,r0
 1147 0486 439F      		mul r20,r19
 1148 0488 900D      		add r25,r0
 1149 048a 1124      		clr __zero_reg__
 1150 048c 8050      		subi r24,lo8(-(nodes_info_arr+3))
 1151 048e 9040      		sbci r25,hi8(-(nodes_info_arr+3))
 1152 0490 FC01      		movw r30,r24
 1153 0492 5083      		st Z,r21
 190:ServerLLDN.c  **** 		nodes_info_arr[i].mac_addr = node->macAddr;
 1154               		.loc 6 190 0
 1155 0494 8981      		ldd r24,Y+1
 1156 0496 482F      		mov r20,r24
 1157 0498 50E0      		ldi r21,0
 1158 049a 8C81      		ldd r24,Y+4
 1159 049c 9D81      		ldd r25,Y+5
 1160 049e FC01      		movw r30,r24
 1161 04a0 8381      		ldd r24,Z+3
 1162 04a2 282F      		mov r18,r24
 1163 04a4 30E0      		ldi r19,0
 1164 04a6 6AE4      		ldi r22,lo8(74)
 1165 04a8 649F      		mul r22,r20
 1166 04aa C001      		movw r24,r0
 1167 04ac 659F      		mul r22,r21
 1168 04ae 900D      		add r25,r0
 1169 04b0 1124      		clr __zero_reg__
 1170 04b2 8050      		subi r24,lo8(-(nodes_info_arr+1))
 1171 04b4 9040      		sbci r25,hi8(-(nodes_info_arr+1))
 1172 04b6 FC01      		movw r30,r24
 1173 04b8 3183      		std Z+1,r19
 1174 04ba 2083      		st Z,r18
 191:ServerLLDN.c  **** 		nodes_info_arr[i].assigned_time_slot = (uint8_t)i;
 1175               		.loc 6 191 0
 1176 04bc 8981      		ldd r24,Y+1
 1177 04be 282F      		mov r18,r24
 1178 04c0 30E0      		ldi r19,0
 1179 04c2 4AE4      		ldi r20,lo8(74)
 1180 04c4 429F      		mul r20,r18
 1181 04c6 C001      		movw r24,r0
 1182 04c8 439F      		mul r20,r19
 1183 04ca 900D      		add r25,r0
 1184 04cc 1124      		clr __zero_reg__
 1185 04ce 8050      		subi r24,lo8(-(nodes_info_arr))
 1186 04d0 9040      		sbci r25,hi8(-(nodes_info_arr))
 1187 04d2 2981      		ldd r18,Y+1
 1188 04d4 FC01      		movw r30,r24
 1189 04d6 2083      		st Z,r18
 192:ServerLLDN.c  **** 		
 193:ServerLLDN.c  **** 		if(conf_req_list != NULL)
 1190               		.loc 6 193 0
 1191 04d8 8091 0000 		lds r24,conf_req_list
 1192 04dc 9091 0000 		lds r25,conf_req_list+1
 1193 04e0 892B      		or r24,r25
 1194 04e2 01F0      		breq .L34
 1195               	.LBB2:
 194:ServerLLDN.c  **** 		{
 195:ServerLLDN.c  **** 			nodes_info_list_t *tmp = (nodes_info_list_t*)malloc(sizeof(nodes_info_list_t));
 1196               		.loc 6 195 0
 1197 04e4 84E0      		ldi r24,lo8(4)
 1198 04e6 90E0      		ldi r25,0
 1199 04e8 0E94 0000 		call malloc
 1200 04ec 9B83      		std Y+3,r25
 1201 04ee 8A83      		std Y+2,r24
 196:ServerLLDN.c  **** 			tmp->node = &nodes_info_arr[i];
 1202               		.loc 6 196 0
 1203 04f0 8981      		ldd r24,Y+1
 1204 04f2 282F      		mov r18,r24
 1205 04f4 30E0      		ldi r19,0
 1206 04f6 4AE4      		ldi r20,lo8(74)
 1207 04f8 429F      		mul r20,r18
 1208 04fa C001      		movw r24,r0
 1209 04fc 439F      		mul r20,r19
 1210 04fe 900D      		add r25,r0
 1211 0500 1124      		clr __zero_reg__
 1212 0502 9C01      		movw r18,r24
 1213 0504 2050      		subi r18,lo8(-(nodes_info_arr))
 1214 0506 3040      		sbci r19,hi8(-(nodes_info_arr))
 1215 0508 8A81      		ldd r24,Y+2
 1216 050a 9B81      		ldd r25,Y+3
 1217 050c FC01      		movw r30,r24
 1218 050e 3183      		std Z+1,r19
 1219 0510 2083      		st Z,r18
 197:ServerLLDN.c  **** 			tmp->next = conf_req_list;
 1220               		.loc 6 197 0
 1221 0512 2091 0000 		lds r18,conf_req_list
 1222 0516 3091 0000 		lds r19,conf_req_list+1
 1223 051a 8A81      		ldd r24,Y+2
 1224 051c 9B81      		ldd r25,Y+3
 1225 051e FC01      		movw r30,r24
 1226 0520 3383      		std Z+3,r19
 1227 0522 2283      		std Z+2,r18
 198:ServerLLDN.c  **** 			conf_req_list = tmp;
 1228               		.loc 6 198 0
 1229 0524 8A81      		ldd r24,Y+2
 1230 0526 9B81      		ldd r25,Y+3
 1231 0528 9093 0000 		sts conf_req_list+1,r25
 1232 052c 8093 0000 		sts conf_req_list,r24
 1233               	.LBE2:
 199:ServerLLDN.c  **** 		}
 200:ServerLLDN.c  **** 		else
 201:ServerLLDN.c  **** 		{
 202:ServerLLDN.c  **** 			conf_req_list = (nodes_info_list_t*)malloc(sizeof(nodes_info_list_t));
 203:ServerLLDN.c  **** 			conf_req_list->node = &nodes_info_arr[i];
 204:ServerLLDN.c  **** 			conf_req_list->next = NULL;
 205:ServerLLDN.c  **** 		}
 206:ServerLLDN.c  **** 	}
 1234               		.loc 6 206 0
 1235 0530 00C0      		rjmp .L36
 1236               	.L34:
 202:ServerLLDN.c  **** 			conf_req_list->node = &nodes_info_arr[i];
 1237               		.loc 6 202 0
 1238 0532 84E0      		ldi r24,lo8(4)
 1239 0534 90E0      		ldi r25,0
 1240 0536 0E94 0000 		call malloc
 1241 053a 9093 0000 		sts conf_req_list+1,r25
 1242 053e 8093 0000 		sts conf_req_list,r24
 203:ServerLLDN.c  **** 			conf_req_list->next = NULL;
 1243               		.loc 6 203 0
 1244 0542 8091 0000 		lds r24,conf_req_list
 1245 0546 9091 0000 		lds r25,conf_req_list+1
 1246 054a 2981      		ldd r18,Y+1
 1247 054c 422F      		mov r20,r18
 1248 054e 50E0      		ldi r21,0
 1249 0550 6AE4      		ldi r22,lo8(74)
 1250 0552 649F      		mul r22,r20
 1251 0554 9001      		movw r18,r0
 1252 0556 659F      		mul r22,r21
 1253 0558 300D      		add r19,r0
 1254 055a 1124      		clr __zero_reg__
 1255 055c 2050      		subi r18,lo8(-(nodes_info_arr))
 1256 055e 3040      		sbci r19,hi8(-(nodes_info_arr))
 1257 0560 FC01      		movw r30,r24
 1258 0562 3183      		std Z+1,r19
 1259 0564 2083      		st Z,r18
 204:ServerLLDN.c  **** 		}
 1260               		.loc 6 204 0
 1261 0566 8091 0000 		lds r24,conf_req_list
 1262 056a 9091 0000 		lds r25,conf_req_list+1
 1263 056e FC01      		movw r30,r24
 1264 0570 1382      		std Z+3,__zero_reg__
 1265 0572 1282      		std Z+2,__zero_reg__
 1266               	.L36:
 1267               		.loc 6 206 0
 1268 0574 0000      		nop
 1269               	/* epilogue start */
 1270 0576 0F90      		pop __tmp_reg__
 1271 0578 0F90      		pop __tmp_reg__
 1272 057a 0F90      		pop __tmp_reg__
 1273 057c 0F90      		pop __tmp_reg__
 1274 057e 0F90      		pop __tmp_reg__
 1275 0580 DF91      		pop r29
 1276 0582 CF91      		pop r28
 1277 0584 0895      		ret
 1278               		.cfi_endproc
 1279               	.LFE137:
 1282               	CopyToConfigRequest:
 1283               	.LFB138:
 207:ServerLLDN.c  **** 
 208:ServerLLDN.c  **** 	static void CopyToConfigRequest()
 209:ServerLLDN.c  **** 	{
 1284               		.loc 6 209 0
 1285               		.cfi_startproc
 1286 0586 CF93      		push r28
 1287               	.LCFI56:
 1288               		.cfi_def_cfa_offset 3
 1289               		.cfi_offset 28, -2
 1290 0588 DF93      		push r29
 1291               	.LCFI57:
 1292               		.cfi_def_cfa_offset 4
 1293               		.cfi_offset 29, -3
 1294 058a 00D0      		rcall .
 1295               	.LCFI58:
 1296               		.cfi_def_cfa_offset 6
 1297 058c CDB7      		in r28,__SP_L__
 1298 058e DEB7      		in r29,__SP_H__
 1299               	.LCFI59:
 1300               		.cfi_def_cfa_register 28
 1301               	/* prologue: function */
 1302               	/* frame size = 2 */
 1303               	/* stack size = 4 */
 1304               	.L__stack_usage = 4
 210:ServerLLDN.c  **** 		config_request_frame.assTimeSlot = conf_req_list->node->assigned_time_slot;
 1305               		.loc 6 210 0
 1306 0590 8091 0000 		lds r24,conf_req_list
 1307 0594 9091 0000 		lds r25,conf_req_list+1
 1308 0598 FC01      		movw r30,r24
 1309 059a 8081      		ld r24,Z
 1310 059c 9181      		ldd r25,Z+1
 1311 059e FC01      		movw r30,r24
 1312 05a0 8081      		ld r24,Z
 1313 05a2 8093 0000 		sts config_request_frame+3,r24
 211:ServerLLDN.c  **** 		config_request_frame.macAddr = conf_req_list->node->mac_addr;
 1314               		.loc 6 211 0
 1315 05a6 8091 0000 		lds r24,conf_req_list
 1316 05aa 9091 0000 		lds r25,conf_req_list+1
 1317 05ae FC01      		movw r30,r24
 1318 05b0 8081      		ld r24,Z
 1319 05b2 9181      		ldd r25,Z+1
 1320 05b4 FC01      		movw r30,r24
 1321 05b6 8181      		ldd r24,Z+1
 1322 05b8 9281      		ldd r25,Z+2
 1323 05ba 8093 0000 		sts config_request_frame+4,r24
 212:ServerLLDN.c  **** 		nodes_info_list_t *tmp = conf_req_list;
 1324               		.loc 6 212 0
 1325 05be 8091 0000 		lds r24,conf_req_list
 1326 05c2 9091 0000 		lds r25,conf_req_list+1
 1327 05c6 9A83      		std Y+2,r25
 1328 05c8 8983      		std Y+1,r24
 213:ServerLLDN.c  **** 		conf_req_list = conf_req_list->next;
 1329               		.loc 6 213 0
 1330 05ca 8091 0000 		lds r24,conf_req_list
 1331 05ce 9091 0000 		lds r25,conf_req_list+1
 1332 05d2 FC01      		movw r30,r24
 1333 05d4 8281      		ldd r24,Z+2
 1334 05d6 9381      		ldd r25,Z+3
 1335 05d8 9093 0000 		sts conf_req_list+1,r25
 1336 05dc 8093 0000 		sts conf_req_list,r24
 214:ServerLLDN.c  **** 		tmp->node = NULL;
 1337               		.loc 6 214 0
 1338 05e0 8981      		ldd r24,Y+1
 1339 05e2 9A81      		ldd r25,Y+2
 1340 05e4 FC01      		movw r30,r24
 1341 05e6 1182      		std Z+1,__zero_reg__
 1342 05e8 1082      		st Z,__zero_reg__
 215:ServerLLDN.c  **** 		tmp->next = NULL;
 1343               		.loc 6 215 0
 1344 05ea 8981      		ldd r24,Y+1
 1345 05ec 9A81      		ldd r25,Y+2
 1346 05ee FC01      		movw r30,r24
 1347 05f0 1382      		std Z+3,__zero_reg__
 1348 05f2 1282      		std Z+2,__zero_reg__
 216:ServerLLDN.c  **** 		free(tmp);
 1349               		.loc 6 216 0
 1350 05f4 8981      		ldd r24,Y+1
 1351 05f6 9A81      		ldd r25,Y+2
 1352 05f8 0E94 0000 		call free
 217:ServerLLDN.c  **** 	}
 1353               		.loc 6 217 0
 1354 05fc 0000      		nop
 1355               	/* epilogue start */
 1356 05fe 0F90      		pop __tmp_reg__
 1357 0600 0F90      		pop __tmp_reg__
 1358 0602 DF91      		pop r29
 1359 0604 CF91      		pop r28
 1360 0606 0895      		ret
 1361               		.cfi_endproc
 1362               	.LFE138:
 1364               		.section	.rodata
 1365               	.LC4:
 1366 002d 0A44 4953 		.string	"\nDISC %hhx"
 1366      4320 2568 
 1366      6878 00
 1367               	.LC5:
 1368 0038 0A43 4F4E 		.string	"\nCONF %d"
 1368      4620 2564 
 1368      00
 1369               		.text
 1371               	appCommandInd:
 1372               	.LFB139:
 218:ServerLLDN.c  **** 
 219:ServerLLDN.c  **** 
 220:ServerLLDN.c  **** 	static bool appCommandInd(NWK_DataInd_t *ind)
 221:ServerLLDN.c  **** 	{
 1373               		.loc 6 221 0
 1374               		.cfi_startproc
 1375 0608 CF93      		push r28
 1376               	.LCFI60:
 1377               		.cfi_def_cfa_offset 3
 1378               		.cfi_offset 28, -2
 1379 060a DF93      		push r29
 1380               	.LCFI61:
 1381               		.cfi_def_cfa_offset 4
 1382               		.cfi_offset 29, -3
 1383 060c 00D0      		rcall .
 1384 060e 00D0      		rcall .
 1385 0610 00D0      		rcall .
 1386               	.LCFI62:
 1387               		.cfi_def_cfa_offset 10
 1388 0612 CDB7      		in r28,__SP_L__
 1389 0614 DEB7      		in r29,__SP_H__
 1390               	.LCFI63:
 1391               		.cfi_def_cfa_register 28
 1392               	/* prologue: function */
 1393               	/* frame size = 6 */
 1394               	/* stack size = 8 */
 1395               	.L__stack_usage = 8
 1396 0616 9E83      		std Y+6,r25
 1397 0618 8D83      		std Y+5,r24
 222:ServerLLDN.c  **** 		if(ind->data[0] == LL_DISCOVER_RESPONSE)
 1398               		.loc 6 222 0
 1399 061a 8D81      		ldd r24,Y+5
 1400 061c 9E81      		ldd r25,Y+6
 1401 061e FC01      		movw r30,r24
 1402 0620 8085      		ldd r24,Z+8
 1403 0622 9185      		ldd r25,Z+9
 1404 0624 FC01      		movw r30,r24
 1405 0626 8081      		ld r24,Z
 1406 0628 8D30      		cpi r24,lo8(13)
 1407 062a 01F4      		brne .L39
 1408               	.LBB3:
 223:ServerLLDN.c  **** 		{
 224:ServerLLDN.c  **** 			NWK_DiscoverResponse_t *msg = (NWK_DiscoverResponse_t*)ind->data;
 1409               		.loc 6 224 0
 1410 062c 8D81      		ldd r24,Y+5
 1411 062e 9E81      		ldd r25,Y+6
 1412 0630 FC01      		movw r30,r24
 1413 0632 8085      		ldd r24,Z+8
 1414 0634 9185      		ldd r25,Z+9
 1415 0636 9C83      		std Y+4,r25
 1416 0638 8B83      		std Y+3,r24
 225:ServerLLDN.c  **** 			addToAckArray(msg->macAddr);	
 1417               		.loc 6 225 0
 1418 063a 8B81      		ldd r24,Y+3
 1419 063c 9C81      		ldd r25,Y+4
 1420 063e FC01      		movw r30,r24
 1421 0640 8181      		ldd r24,Z+1
 1422 0642 0E94 0000 		call addToAckArray
 226:ServerLLDN.c  **** 					
 227:ServerLLDN.c  **** 			#if PRINT
 228:ServerLLDN.c  **** 			printf("\nDISC %hhx", msg->macAddr);	
 1423               		.loc 6 228 0
 1424 0646 8B81      		ldd r24,Y+3
 1425 0648 9C81      		ldd r25,Y+4
 1426 064a FC01      		movw r30,r24
 1427 064c 8181      		ldd r24,Z+1
 1428 064e 882F      		mov r24,r24
 1429 0650 90E0      		ldi r25,0
 1430 0652 292F      		mov r18,r25
 1431 0654 2F93      		push r18
 1432 0656 8F93      		push r24
 1433 0658 80E0      		ldi r24,lo8(.LC4)
 1434 065a 90E0      		ldi r25,hi8(.LC4)
 1435 065c 892F      		mov r24,r25
 1436 065e 8F93      		push r24
 1437 0660 80E0      		ldi r24,lo8(.LC4)
 1438 0662 90E0      		ldi r25,hi8(.LC4)
 1439 0664 8F93      		push r24
 1440 0666 0E94 0000 		call printf
 1441 066a 0F90      		pop __tmp_reg__
 1442 066c 0F90      		pop __tmp_reg__
 1443 066e 0F90      		pop __tmp_reg__
 1444 0670 0F90      		pop __tmp_reg__
 1445               	.LBE3:
 1446 0672 00C0      		rjmp .L40
 1447               	.L39:
 229:ServerLLDN.c  **** 			#endif
 230:ServerLLDN.c  **** 		}
 231:ServerLLDN.c  **** 		else if(ind->data[0] == LL_CONFIGURATION_STATUS)
 1448               		.loc 6 231 0
 1449 0674 8D81      		ldd r24,Y+5
 1450 0676 9E81      		ldd r25,Y+6
 1451 0678 FC01      		movw r30,r24
 1452 067a 8085      		ldd r24,Z+8
 1453 067c 9185      		ldd r25,Z+9
 1454 067e FC01      		movw r30,r24
 1455 0680 8081      		ld r24,Z
 1456 0682 8E30      		cpi r24,lo8(14)
 1457 0684 01F4      		brne .L41
 1458               	.LBB4:
 232:ServerLLDN.c  **** 		{
 233:ServerLLDN.c  **** 			NWK_ConfigStatus_t *msg = (NWK_ConfigStatus_t*)ind->data;
 1459               		.loc 6 233 0
 1460 0686 8D81      		ldd r24,Y+5
 1461 0688 9E81      		ldd r25,Y+6
 1462 068a FC01      		movw r30,r24
 1463 068c 8085      		ldd r24,Z+8
 1464 068e 9185      		ldd r25,Z+9
 1465 0690 9A83      		std Y+2,r25
 1466 0692 8983      		std Y+1,r24
 234:ServerLLDN.c  **** 			addConfRequestArray(msg);
 1467               		.loc 6 234 0
 1468 0694 8981      		ldd r24,Y+1
 1469 0696 9A81      		ldd r25,Y+2
 1470 0698 0E94 0000 		call addConfRequestArray
 235:ServerLLDN.c  **** 			#if PRINT
 236:ServerLLDN.c  **** 			printf("\nCONF %d", msg->macAddr);	
 1471               		.loc 6 236 0
 1472 069c 8981      		ldd r24,Y+1
 1473 069e 9A81      		ldd r25,Y+2
 1474 06a0 FC01      		movw r30,r24
 1475 06a2 8381      		ldd r24,Z+3
 1476 06a4 882F      		mov r24,r24
 1477 06a6 90E0      		ldi r25,0
 1478 06a8 292F      		mov r18,r25
 1479 06aa 2F93      		push r18
 1480 06ac 8F93      		push r24
 1481 06ae 80E0      		ldi r24,lo8(.LC5)
 1482 06b0 90E0      		ldi r25,hi8(.LC5)
 1483 06b2 892F      		mov r24,r25
 1484 06b4 8F93      		push r24
 1485 06b6 80E0      		ldi r24,lo8(.LC5)
 1486 06b8 90E0      		ldi r25,hi8(.LC5)
 1487 06ba 8F93      		push r24
 1488 06bc 0E94 0000 		call printf
 1489 06c0 0F90      		pop __tmp_reg__
 1490 06c2 0F90      		pop __tmp_reg__
 1491 06c4 0F90      		pop __tmp_reg__
 1492 06c6 0F90      		pop __tmp_reg__
 1493               	.LBE4:
 1494 06c8 00C0      		rjmp .L40
 1495               	.L41:
 237:ServerLLDN.c  **** 			#endif
 238:ServerLLDN.c  **** 		}
 239:ServerLLDN.c  **** 		else return false;			
 1496               		.loc 6 239 0
 1497 06ca 80E0      		ldi r24,0
 1498 06cc 00C0      		rjmp .L42
 1499               	.L40:
 240:ServerLLDN.c  **** 		return true;
 1500               		.loc 6 240 0
 1501 06ce 81E0      		ldi r24,lo8(1)
 1502               	.L42:
 1503               	/* epilogue start */
 241:ServerLLDN.c  **** 	}
 1504               		.loc 6 241 0
 1505 06d0 2696      		adiw r28,6
 1506 06d2 0FB6      		in __tmp_reg__,__SREG__
 1507 06d4 F894      		cli
 1508 06d6 DEBF      		out __SP_H__,r29
 1509 06d8 0FBE      		out __SREG__,__tmp_reg__
 1510 06da CDBF      		out __SP_L__,r28
 1511 06dc DF91      		pop r29
 1512 06de CF91      		pop r28
 1513 06e0 0895      		ret
 1514               		.cfi_endproc
 1515               	.LFE139:
 1517               	.global	__floatsisf
 1518               	.global	__floatunsisf
 1519               	.global	__mulsf3
 1520               	.global	__addsf3
 1521               		.section	.rodata
 1522               	.LC6:
 1523 0041 0A20 2564 		.string	"\n %d payload: "
 1523      2070 6179 
 1523      6C6F 6164 
 1523      3A20 00
 1524               	.LC7:
 1525 0050 2568 6878 		.string	"%hhx"
 1525      00
 1526               		.text
 1528               	appDataInd:
 1529               	.LFB140:
 242:ServerLLDN.c  **** 	
 243:ServerLLDN.c  **** 	static bool appDataInd(NWK_DataInd_t *ind)
 244:ServerLLDN.c  **** 	{
 1530               		.loc 6 244 0
 1531               		.cfi_startproc
 1532 06e2 8F92      		push r8
 1533               	.LCFI64:
 1534               		.cfi_def_cfa_offset 3
 1535               		.cfi_offset 8, -2
 1536 06e4 9F92      		push r9
 1537               	.LCFI65:
 1538               		.cfi_def_cfa_offset 4
 1539               		.cfi_offset 9, -3
 1540 06e6 AF92      		push r10
 1541               	.LCFI66:
 1542               		.cfi_def_cfa_offset 5
 1543               		.cfi_offset 10, -4
 1544 06e8 BF92      		push r11
 1545               	.LCFI67:
 1546               		.cfi_def_cfa_offset 6
 1547               		.cfi_offset 11, -5
 1548 06ea CF92      		push r12
 1549               	.LCFI68:
 1550               		.cfi_def_cfa_offset 7
 1551               		.cfi_offset 12, -6
 1552 06ec DF92      		push r13
 1553               	.LCFI69:
 1554               		.cfi_def_cfa_offset 8
 1555               		.cfi_offset 13, -7
 1556 06ee EF92      		push r14
 1557               	.LCFI70:
 1558               		.cfi_def_cfa_offset 9
 1559               		.cfi_offset 14, -8
 1560 06f0 FF92      		push r15
 1561               	.LCFI71:
 1562               		.cfi_def_cfa_offset 10
 1563               		.cfi_offset 15, -9
 1564 06f2 CF93      		push r28
 1565               	.LCFI72:
 1566               		.cfi_def_cfa_offset 11
 1567               		.cfi_offset 28, -10
 1568 06f4 DF93      		push r29
 1569               	.LCFI73:
 1570               		.cfi_def_cfa_offset 12
 1571               		.cfi_offset 29, -11
 1572 06f6 00D0      		rcall .
 1573 06f8 00D0      		rcall .
 1574 06fa 00D0      		rcall .
 1575               	.LCFI74:
 1576               		.cfi_def_cfa_offset 18
 1577 06fc CDB7      		in r28,__SP_L__
 1578 06fe DEB7      		in r29,__SP_H__
 1579               	.LCFI75:
 1580               		.cfi_def_cfa_register 28
 1581               	/* prologue: function */
 1582               	/* frame size = 6 */
 1583               	/* stack size = 16 */
 1584               	.L__stack_usage = 16
 1585 0700 9E83      		std Y+6,r25
 1586 0702 8D83      		std Y+5,r24
 245:ServerLLDN.c  **** 		if(!data_received)
 1587               		.loc 6 245 0
 1588 0704 9091 0000 		lds r25,data_received
 1589 0708 81E0      		ldi r24,lo8(1)
 1590 070a 8927      		eor r24,r25
 1591 070c 8823      		tst r24
 1592 070e 01F4      		brne .+2
 1593 0710 00C0      		rjmp .L44
 1594               	.LBB5:
 246:ServerLLDN.c  **** 		{
 247:ServerLLDN.c  **** 		int curr_ts = timeslot_counter - 2*MacLLDNMgmtTS;
 1595               		.loc 6 247 0
 1596 0712 8091 0000 		lds r24,timeslot_counter
 1597 0716 882F      		mov r24,r24
 1598 0718 90E0      		ldi r25,0
 1599 071a 0297      		sbiw r24,2
 1600 071c 9C83      		std Y+4,r25
 1601 071e 8B83      		std Y+3,r24
 248:ServerLLDN.c  **** 		data_received = true;
 1602               		.loc 6 248 0
 1603 0720 81E0      		ldi r24,lo8(1)
 1604 0722 8093 0000 		sts data_received,r24
 249:ServerLLDN.c  **** 		nodes_info_arr[curr_ts].rssi = ind->rssi;
 1605               		.loc 6 249 0
 1606 0726 8D81      		ldd r24,Y+5
 1607 0728 9E81      		ldd r25,Y+6
 1608 072a FC01      		movw r30,r24
 1609 072c 8485      		ldd r24,Z+12
 1610 072e 582F      		mov r21,r24
 1611 0730 2B81      		ldd r18,Y+3
 1612 0732 3C81      		ldd r19,Y+4
 1613 0734 4AE4      		ldi r20,lo8(74)
 1614 0736 429F      		mul r20,r18
 1615 0738 C001      		movw r24,r0
 1616 073a 439F      		mul r20,r19
 1617 073c 900D      		add r25,r0
 1618 073e 1124      		clr __zero_reg__
 1619 0740 8050      		subi r24,lo8(-(nodes_info_arr+4))
 1620 0742 9040      		sbci r25,hi8(-(nodes_info_arr+4))
 1621 0744 FC01      		movw r30,r24
 1622 0746 5083      		st Z,r21
 250:ServerLLDN.c  **** 		nodes_info_arr[curr_ts].average_rssi = (nodes_info_arr[curr_ts].rssi + nodes_info_arr[curr_ts].av
 1623               		.loc 6 250 0
 1624 0748 2B81      		ldd r18,Y+3
 1625 074a 3C81      		ldd r19,Y+4
 1626 074c 4AE4      		ldi r20,lo8(74)
 1627 074e 429F      		mul r20,r18
 1628 0750 C001      		movw r24,r0
 1629 0752 439F      		mul r20,r19
 1630 0754 900D      		add r25,r0
 1631 0756 1124      		clr __zero_reg__
 1632 0758 8050      		subi r24,lo8(-(nodes_info_arr+4))
 1633 075a 9040      		sbci r25,hi8(-(nodes_info_arr+4))
 1634 075c FC01      		movw r30,r24
 1635 075e 8081      		ld r24,Z
 1636 0760 882F      		mov r24,r24
 1637 0762 90E0      		ldi r25,0
 1638 0764 092E      		mov __tmp_reg__,r25
 1639 0766 000C      		lsl r0
 1640 0768 AA0B      		sbc r26,r26
 1641 076a BB0B      		sbc r27,r27
 1642 076c BC01      		movw r22,r24
 1643 076e CD01      		movw r24,r26
 1644 0770 0E94 0000 		call __floatsisf
 1645 0774 4B01      		movw r8,r22
 1646 0776 5C01      		movw r10,r24
 1647 0778 2B81      		ldd r18,Y+3
 1648 077a 3C81      		ldd r19,Y+4
 1649 077c 4AE4      		ldi r20,lo8(74)
 1650 077e 429F      		mul r20,r18
 1651 0780 C001      		movw r24,r0
 1652 0782 439F      		mul r20,r19
 1653 0784 900D      		add r25,r0
 1654 0786 1124      		clr __zero_reg__
 1655 0788 8050      		subi r24,lo8(-(nodes_info_arr+5))
 1656 078a 9040      		sbci r25,hi8(-(nodes_info_arr+5))
 1657 078c FC01      		movw r30,r24
 1658 078e C080      		ld r12,Z
 1659 0790 D180      		ldd r13,Z+1
 1660 0792 E280      		ldd r14,Z+2
 1661 0794 F380      		ldd r15,Z+3
 1662 0796 2B81      		ldd r18,Y+3
 1663 0798 3C81      		ldd r19,Y+4
 1664 079a 4AE4      		ldi r20,lo8(74)
 1665 079c 429F      		mul r20,r18
 1666 079e C001      		movw r24,r0
 1667 07a0 439F      		mul r20,r19
 1668 07a2 900D      		add r25,r0
 1669 07a4 1124      		clr __zero_reg__
 1670 07a6 8050      		subi r24,lo8(-(nodes_info_arr+69))
 1671 07a8 9040      		sbci r25,hi8(-(nodes_info_arr+69))
 1672 07aa FC01      		movw r30,r24
 1673 07ac 8081      		ld r24,Z
 1674 07ae 9181      		ldd r25,Z+1
 1675 07b0 CC01      		movw r24,r24
 1676 07b2 A0E0      		ldi r26,0
 1677 07b4 B0E0      		ldi r27,0
 1678 07b6 BC01      		movw r22,r24
 1679 07b8 CD01      		movw r24,r26
 1680 07ba 0E94 0000 		call __floatunsisf
 1681 07be DC01      		movw r26,r24
 1682 07c0 CB01      		movw r24,r22
 1683 07c2 9C01      		movw r18,r24
 1684 07c4 AD01      		movw r20,r26
 1685 07c6 C701      		movw r24,r14
 1686 07c8 B601      		movw r22,r12
 1687 07ca 0E94 0000 		call __mulsf3
 1688 07ce DC01      		movw r26,r24
 1689 07d0 CB01      		movw r24,r22
 1690 07d2 9C01      		movw r18,r24
 1691 07d4 AD01      		movw r20,r26
 1692 07d6 C501      		movw r24,r10
 1693 07d8 B401      		movw r22,r8
 1694 07da 0E94 0000 		call __addsf3
 1695 07de DC01      		movw r26,r24
 1696 07e0 CB01      		movw r24,r22
 1697 07e2 6C01      		movw r12,r24
 1698 07e4 7D01      		movw r14,r26
 251:ServerLLDN.c  **** 															/(nodes_info_arr[curr_ts].msg_rec + 1);
 1699               		.loc 6 251 0
 1700 07e6 2B81      		ldd r18,Y+3
 1701 07e8 3C81      		ldd r19,Y+4
 1702 07ea 4AE4      		ldi r20,lo8(74)
 1703 07ec 429F      		mul r20,r18
 1704 07ee C001      		movw r24,r0
 1705 07f0 439F      		mul r20,r19
 1706 07f2 900D      		add r25,r0
 1707 07f4 1124      		clr __zero_reg__
 1708 07f6 8050      		subi r24,lo8(-(nodes_info_arr+69))
 1709 07f8 9040      		sbci r25,hi8(-(nodes_info_arr+69))
 1710 07fa FC01      		movw r30,r24
 1711 07fc 8081      		ld r24,Z
 1712 07fe 9181      		ldd r25,Z+1
 1713 0800 0196      		adiw r24,1
 1714 0802 CC01      		movw r24,r24
 1715 0804 A0E0      		ldi r26,0
 1716 0806 B0E0      		ldi r27,0
 1717 0808 BC01      		movw r22,r24
 1718 080a CD01      		movw r24,r26
 1719 080c 0E94 0000 		call __floatunsisf
 1720 0810 DC01      		movw r26,r24
 1721 0812 CB01      		movw r24,r22
 1722 0814 9C01      		movw r18,r24
 1723 0816 AD01      		movw r20,r26
 1724 0818 C701      		movw r24,r14
 1725 081a B601      		movw r22,r12
 1726 081c 0E94 0000 		call __divsf3
 1727 0820 DC01      		movw r26,r24
 1728 0822 CB01      		movw r24,r22
 250:ServerLLDN.c  **** 		nodes_info_arr[curr_ts].average_rssi = (nodes_info_arr[curr_ts].rssi + nodes_info_arr[curr_ts].av
 1729               		.loc 6 250 0
 1730 0824 4B81      		ldd r20,Y+3
 1731 0826 5C81      		ldd r21,Y+4
 1732 0828 6AE4      		ldi r22,lo8(74)
 1733 082a 649F      		mul r22,r20
 1734 082c 9001      		movw r18,r0
 1735 082e 659F      		mul r22,r21
 1736 0830 300D      		add r19,r0
 1737 0832 1124      		clr __zero_reg__
 1738 0834 2050      		subi r18,lo8(-(nodes_info_arr+5))
 1739 0836 3040      		sbci r19,hi8(-(nodes_info_arr+5))
 1740 0838 F901      		movw r30,r18
 1741 083a 8083      		st Z,r24
 1742 083c 9183      		std Z+1,r25
 1743 083e A283      		std Z+2,r26
 1744 0840 B383      		std Z+3,r27
 252:ServerLLDN.c  **** 		nodes_info_arr[curr_ts].msg_rec++;
 1745               		.loc 6 252 0
 1746 0842 2B81      		ldd r18,Y+3
 1747 0844 3C81      		ldd r19,Y+4
 1748 0846 4AE4      		ldi r20,lo8(74)
 1749 0848 429F      		mul r20,r18
 1750 084a C001      		movw r24,r0
 1751 084c 439F      		mul r20,r19
 1752 084e 900D      		add r25,r0
 1753 0850 1124      		clr __zero_reg__
 1754 0852 8050      		subi r24,lo8(-(nodes_info_arr+69))
 1755 0854 9040      		sbci r25,hi8(-(nodes_info_arr+69))
 1756 0856 FC01      		movw r30,r24
 1757 0858 8081      		ld r24,Z
 1758 085a 9181      		ldd r25,Z+1
 1759 085c 9C01      		movw r18,r24
 1760 085e 2F5F      		subi r18,-1
 1761 0860 3F4F      		sbci r19,-1
 1762 0862 4B81      		ldd r20,Y+3
 1763 0864 5C81      		ldd r21,Y+4
 1764 0866 6AE4      		ldi r22,lo8(74)
 1765 0868 649F      		mul r22,r20
 1766 086a C001      		movw r24,r0
 1767 086c 659F      		mul r22,r21
 1768 086e 900D      		add r25,r0
 1769 0870 1124      		clr __zero_reg__
 1770 0872 8050      		subi r24,lo8(-(nodes_info_arr+69))
 1771 0874 9040      		sbci r25,hi8(-(nodes_info_arr+69))
 1772 0876 FC01      		movw r30,r24
 1773 0878 3183      		std Z+1,r19
 1774 087a 2083      		st Z,r18
 253:ServerLLDN.c  **** 		
 254:ServerLLDN.c  **** 		addToAckArray(nodes_info_arr[curr_ts].mac_addr);
 1775               		.loc 6 254 0
 1776 087c 2B81      		ldd r18,Y+3
 1777 087e 3C81      		ldd r19,Y+4
 1778 0880 4AE4      		ldi r20,lo8(74)
 1779 0882 429F      		mul r20,r18
 1780 0884 C001      		movw r24,r0
 1781 0886 439F      		mul r20,r19
 1782 0888 900D      		add r25,r0
 1783 088a 1124      		clr __zero_reg__
 1784 088c 8050      		subi r24,lo8(-(nodes_info_arr+1))
 1785 088e 9040      		sbci r25,hi8(-(nodes_info_arr+1))
 1786 0890 FC01      		movw r30,r24
 1787 0892 8081      		ld r24,Z
 1788 0894 9181      		ldd r25,Z+1
 1789 0896 0E94 0000 		call addToAckArray
 255:ServerLLDN.c  **** 
 256:ServerLLDN.c  **** 		printf("\n %d payload: ", curr_ts);
 1790               		.loc 6 256 0
 1791 089a 8C81      		ldd r24,Y+4
 1792 089c 8F93      		push r24
 1793 089e 8B81      		ldd r24,Y+3
 1794 08a0 8F93      		push r24
 1795 08a2 80E0      		ldi r24,lo8(.LC6)
 1796 08a4 90E0      		ldi r25,hi8(.LC6)
 1797 08a6 892F      		mov r24,r25
 1798 08a8 8F93      		push r24
 1799 08aa 80E0      		ldi r24,lo8(.LC6)
 1800 08ac 90E0      		ldi r25,hi8(.LC6)
 1801 08ae 8F93      		push r24
 1802 08b0 0E94 0000 		call printf
 1803 08b4 0F90      		pop __tmp_reg__
 1804 08b6 0F90      		pop __tmp_reg__
 1805 08b8 0F90      		pop __tmp_reg__
 1806 08ba 0F90      		pop __tmp_reg__
 257:ServerLLDN.c  **** 		
 258:ServerLLDN.c  **** 		msg_info_array[curr_ts].size = ind->size;		
 1807               		.loc 6 258 0
 1808 08bc 8D81      		ldd r24,Y+5
 1809 08be 9E81      		ldd r25,Y+6
 1810 08c0 FC01      		movw r30,r24
 1811 08c2 4285      		ldd r20,Z+10
 1812 08c4 2B81      		ldd r18,Y+3
 1813 08c6 3C81      		ldd r19,Y+4
 1814 08c8 54E8      		ldi r21,lo8(-124)
 1815 08ca 529F      		mul r21,r18
 1816 08cc C001      		movw r24,r0
 1817 08ce 539F      		mul r21,r19
 1818 08d0 900D      		add r25,r0
 1819 08d2 1124      		clr __zero_reg__
 1820 08d4 8050      		subi r24,lo8(-(msg_info_array+4))
 1821 08d6 9040      		sbci r25,hi8(-(msg_info_array+4))
 1822 08d8 FC01      		movw r30,r24
 1823 08da 4083      		st Z,r20
 1824               	.LBB6:
 259:ServerLLDN.c  **** 		for (int i = 0; i < ind->size; i++)
 1825               		.loc 6 259 0
 1826 08dc 1A82      		std Y+2,__zero_reg__
 1827 08de 1982      		std Y+1,__zero_reg__
 1828 08e0 00C0      		rjmp .L45
 1829               	.L46:
 260:ServerLLDN.c  **** 			{
 261:ServerLLDN.c  **** 			msg_info_array[curr_ts].data_payload[i] = ind->data[i];
 1830               		.loc 6 261 0 discriminator 3
 1831 08e2 8D81      		ldd r24,Y+5
 1832 08e4 9E81      		ldd r25,Y+6
 1833 08e6 FC01      		movw r30,r24
 1834 08e8 2085      		ldd r18,Z+8
 1835 08ea 3185      		ldd r19,Z+9
 1836 08ec 8981      		ldd r24,Y+1
 1837 08ee 9A81      		ldd r25,Y+2
 1838 08f0 820F      		add r24,r18
 1839 08f2 931F      		adc r25,r19
 1840 08f4 FC01      		movw r30,r24
 1841 08f6 4081      		ld r20,Z
 1842 08f8 8B81      		ldd r24,Y+3
 1843 08fa 9C81      		ldd r25,Y+4
 1844 08fc 54E8      		ldi r21,lo8(-124)
 1845 08fe 589F      		mul r21,r24
 1846 0900 9001      		movw r18,r0
 1847 0902 599F      		mul r21,r25
 1848 0904 300D      		add r19,r0
 1849 0906 1124      		clr __zero_reg__
 1850 0908 8981      		ldd r24,Y+1
 1851 090a 9A81      		ldd r25,Y+2
 1852 090c 820F      		add r24,r18
 1853 090e 931F      		adc r25,r19
 1854 0910 8050      		subi r24,lo8(-(msg_info_array+5))
 1855 0912 9040      		sbci r25,hi8(-(msg_info_array+5))
 1856 0914 FC01      		movw r30,r24
 1857 0916 4083      		st Z,r20
 262:ServerLLDN.c  **** 			printf("%hhx", msg_info_array[curr_ts].data_payload[i]);
 1858               		.loc 6 262 0 discriminator 3
 1859 0918 8B81      		ldd r24,Y+3
 1860 091a 9C81      		ldd r25,Y+4
 1861 091c 44E8      		ldi r20,lo8(-124)
 1862 091e 489F      		mul r20,r24
 1863 0920 9001      		movw r18,r0
 1864 0922 499F      		mul r20,r25
 1865 0924 300D      		add r19,r0
 1866 0926 1124      		clr __zero_reg__
 1867 0928 8981      		ldd r24,Y+1
 1868 092a 9A81      		ldd r25,Y+2
 1869 092c 820F      		add r24,r18
 1870 092e 931F      		adc r25,r19
 1871 0930 8050      		subi r24,lo8(-(msg_info_array+5))
 1872 0932 9040      		sbci r25,hi8(-(msg_info_array+5))
 1873 0934 FC01      		movw r30,r24
 1874 0936 8081      		ld r24,Z
 1875 0938 882F      		mov r24,r24
 1876 093a 90E0      		ldi r25,0
 1877 093c 292F      		mov r18,r25
 1878 093e 2F93      		push r18
 1879 0940 8F93      		push r24
 1880 0942 80E0      		ldi r24,lo8(.LC7)
 1881 0944 90E0      		ldi r25,hi8(.LC7)
 1882 0946 892F      		mov r24,r25
 1883 0948 8F93      		push r24
 1884 094a 80E0      		ldi r24,lo8(.LC7)
 1885 094c 90E0      		ldi r25,hi8(.LC7)
 1886 094e 8F93      		push r24
 1887 0950 0E94 0000 		call printf
 1888 0954 0F90      		pop __tmp_reg__
 1889 0956 0F90      		pop __tmp_reg__
 1890 0958 0F90      		pop __tmp_reg__
 1891 095a 0F90      		pop __tmp_reg__
 259:ServerLLDN.c  **** 		for (int i = 0; i < ind->size; i++)
 1892               		.loc 6 259 0 discriminator 3
 1893 095c 8981      		ldd r24,Y+1
 1894 095e 9A81      		ldd r25,Y+2
 1895 0960 0196      		adiw r24,1
 1896 0962 9A83      		std Y+2,r25
 1897 0964 8983      		std Y+1,r24
 1898               	.L45:
 259:ServerLLDN.c  **** 		for (int i = 0; i < ind->size; i++)
 1899               		.loc 6 259 0 is_stmt 0 discriminator 1
 1900 0966 8D81      		ldd r24,Y+5
 1901 0968 9E81      		ldd r25,Y+6
 1902 096a FC01      		movw r30,r24
 1903 096c 8285      		ldd r24,Z+10
 1904 096e 282F      		mov r18,r24
 1905 0970 30E0      		ldi r19,0
 1906 0972 8981      		ldd r24,Y+1
 1907 0974 9A81      		ldd r25,Y+2
 1908 0976 8217      		cp r24,r18
 1909 0978 9307      		cpc r25,r19
 1910 097a 04F4      		brge .+2
 1911 097c 00C0      		rjmp .L46
 1912               	.L44:
 1913               	.LBE6:
 1914               	.LBE5:
 263:ServerLLDN.c  **** 			}
 264:ServerLLDN.c  **** 		}
 265:ServerLLDN.c  **** 	}
 1915               		.loc 6 265 0 is_stmt 1
 1916 097e 0000      		nop
 1917               	/* epilogue start */
 1918 0980 2696      		adiw r28,6
 1919 0982 0FB6      		in __tmp_reg__,__SREG__
 1920 0984 F894      		cli
 1921 0986 DEBF      		out __SP_H__,r29
 1922 0988 0FBE      		out __SREG__,__tmp_reg__
 1923 098a CDBF      		out __SP_L__,r28
 1924 098c DF91      		pop r29
 1925 098e CF91      		pop r28
 1926 0990 FF90      		pop r15
 1927 0992 EF90      		pop r14
 1928 0994 DF90      		pop r13
 1929 0996 CF90      		pop r12
 1930 0998 BF90      		pop r11
 1931 099a AF90      		pop r10
 1932 099c 9F90      		pop r9
 1933 099e 8F90      		pop r8
 1934 09a0 0895      		ret
 1935               		.cfi_endproc
 1936               	.LFE140:
 1939               	appPanPrepareACK:
 1940               	.LFB141:
 266:ServerLLDN.c  **** 	
 267:ServerLLDN.c  **** 	static void appPanPrepareACK(void)
 268:ServerLLDN.c  **** 	{
 1941               		.loc 6 268 0
 1942               		.cfi_startproc
 1943 09a2 CF93      		push r28
 1944               	.LCFI76:
 1945               		.cfi_def_cfa_offset 3
 1946               		.cfi_offset 28, -2
 1947 09a4 DF93      		push r29
 1948               	.LCFI77:
 1949               		.cfi_def_cfa_offset 4
 1950               		.cfi_offset 29, -3
 1951 09a6 CDB7      		in r28,__SP_L__
 1952 09a8 DEB7      		in r29,__SP_H__
 1953               	.LCFI78:
 1954               		.cfi_def_cfa_register 28
 1955               	/* prologue: function */
 1956               	/* frame size = 0 */
 1957               	/* stack size = 2 */
 1958               	.L__stack_usage = 2
 269:ServerLLDN.c  **** 		msgReq.dstAddr		= 0;
 1959               		.loc 6 269 0
 1960 09aa 1092 0000 		sts msgReq+5+1,__zero_reg__
 1961 09ae 1092 0000 		sts msgReq+5,__zero_reg__
 270:ServerLLDN.c  **** 		msgReq.dstEndpoint	= APP_BEACON_ENDPOINT;
 1962               		.loc 6 270 0
 1963 09b2 1092 0000 		sts msgReq+7,__zero_reg__
 271:ServerLLDN.c  **** 		msgReq.srcEndpoint	= APP_BEACON_ENDPOINT;
 1964               		.loc 6 271 0
 1965 09b6 1092 0000 		sts msgReq+8,__zero_reg__
 272:ServerLLDN.c  **** 		msgReq.options		= NWK_OPT_LLDN_ACK;
 1966               		.loc 6 272 0
 1967 09ba 80E0      		ldi r24,0
 1968 09bc 90E4      		ldi r25,lo8(64)
 1969 09be 9093 0000 		sts msgReq+9+1,r25
 1970 09c2 8093 0000 		sts msgReq+9,r24
 273:ServerLLDN.c  **** 		msgReq.data	= (uint8_t *)&ACKFrame;
 1971               		.loc 6 273 0
 1972 09c6 80E0      		ldi r24,lo8(ACKFrame)
 1973 09c8 90E0      		ldi r25,hi8(ACKFrame)
 1974 09ca 9093 0000 		sts msgReq+13+1,r25
 1975 09ce 8093 0000 		sts msgReq+13,r24
 274:ServerLLDN.c  **** 		msgReq.size	= sizeof(uint8_t)*(ACKFrame_size + 1);
 1976               		.loc 6 274 0
 1977 09d2 8091 0000 		lds r24,ACKFrame_size
 1978 09d6 9091 0000 		lds r25,ACKFrame_size+1
 1979 09da 8F5F      		subi r24,lo8(-(1))
 1980 09dc 8093 0000 		sts msgReq+15,r24
 275:ServerLLDN.c  **** 
 276:ServerLLDN.c  **** 	}
 1981               		.loc 6 276 0
 1982 09e0 0000      		nop
 1983               	/* epilogue start */
 1984 09e2 DF91      		pop r29
 1985 09e4 CF91      		pop r28
 1986 09e6 0895      		ret
 1987               		.cfi_endproc
 1988               	.LFE141:
 1991               	appPanReset:
 1992               	.LFB142:
 277:ServerLLDN.c  **** 
 278:ServerLLDN.c  **** 	static void appPanReset(void)
 279:ServerLLDN.c  **** 	{
 1993               		.loc 6 279 0
 1994               		.cfi_startproc
 1995 09e8 CF93      		push r28
 1996               	.LCFI79:
 1997               		.cfi_def_cfa_offset 3
 1998               		.cfi_offset 28, -2
 1999 09ea DF93      		push r29
 2000               	.LCFI80:
 2001               		.cfi_def_cfa_offset 4
 2002               		.cfi_offset 29, -3
 2003 09ec 00D0      		rcall .
 2004 09ee 00D0      		rcall .
 2005 09f0 00D0      		rcall .
 2006               	.LCFI81:
 2007               		.cfi_def_cfa_offset 10
 2008 09f2 CDB7      		in r28,__SP_L__
 2009 09f4 DEB7      		in r29,__SP_H__
 2010               	.LCFI82:
 2011               		.cfi_def_cfa_register 28
 2012               	/* prologue: function */
 2013               	/* frame size = 6 */
 2014               	/* stack size = 8 */
 2015               	.L__stack_usage = 8
 280:ServerLLDN.c  **** 		// prepare beacon reset message
 281:ServerLLDN.c  **** 		msgReq.dstAddr		= 0;
 2016               		.loc 6 281 0
 2017 09f6 1092 0000 		sts msgReq+5+1,__zero_reg__
 2018 09fa 1092 0000 		sts msgReq+5,__zero_reg__
 282:ServerLLDN.c  **** 		msgReq.dstEndpoint	= APP_BEACON_ENDPOINT;
 2019               		.loc 6 282 0
 2020 09fe 1092 0000 		sts msgReq+7,__zero_reg__
 283:ServerLLDN.c  **** 		msgReq.srcEndpoint	= APP_BEACON_ENDPOINT;
 2021               		.loc 6 283 0
 2022 0a02 1092 0000 		sts msgReq+8,__zero_reg__
 284:ServerLLDN.c  **** 		msgReq.options		= NWK_OPT_LLDN_BEACON | NWK_OPT_RESET_STATE;
 2023               		.loc 6 284 0
 2024 0a06 80E4      		ldi r24,lo8(64)
 2025 0a08 94E0      		ldi r25,lo8(4)
 2026 0a0a 9093 0000 		sts msgReq+9+1,r25
 2027 0a0e 8093 0000 		sts msgReq+9,r24
 285:ServerLLDN.c  **** 		msgReq.data			= NULL;
 2028               		.loc 6 285 0
 2029 0a12 1092 0000 		sts msgReq+13+1,__zero_reg__
 2030 0a16 1092 0000 		sts msgReq+13,__zero_reg__
 286:ServerLLDN.c  **** 		msgReq.size			= 0;
 2031               		.loc 6 286 0
 2032 0a1a 1092 0000 		sts msgReq+15,__zero_reg__
 2033               	.LBB7:
 287:ServerLLDN.c  **** 
 288:ServerLLDN.c  **** 		for(int i = 0; i < 32; i++)
 2034               		.loc 6 288 0
 2035 0a1e 1A82      		std Y+2,__zero_reg__
 2036 0a20 1982      		std Y+1,__zero_reg__
 2037 0a22 00C0      		rjmp .L49
 2038               	.L50:
 289:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 2039               		.loc 6 289 0 discriminator 3
 2040 0a24 8981      		ldd r24,Y+1
 2041 0a26 9A81      		ldd r25,Y+2
 2042 0a28 8050      		subi r24,lo8(-(ACKFrame+1))
 2043 0a2a 9040      		sbci r25,hi8(-(ACKFrame+1))
 2044 0a2c FC01      		movw r30,r24
 2045 0a2e 1082      		st Z,__zero_reg__
 288:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 2046               		.loc 6 288 0 discriminator 3
 2047 0a30 8981      		ldd r24,Y+1
 2048 0a32 9A81      		ldd r25,Y+2
 2049 0a34 0196      		adiw r24,1
 2050 0a36 9A83      		std Y+2,r25
 2051 0a38 8983      		std Y+1,r24
 2052               	.L49:
 288:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 2053               		.loc 6 288 0 is_stmt 0 discriminator 1
 2054 0a3a 8981      		ldd r24,Y+1
 2055 0a3c 9A81      		ldd r25,Y+2
 2056 0a3e 8097      		sbiw r24,32
 2057 0a40 04F0      		brlt .L50
 2058               	.LBE7:
 2059               	.LBB8:
 290:ServerLLDN.c  **** 			
 291:ServerLLDN.c  **** 		for (int i = 0; i < 50; i++)
 2060               		.loc 6 291 0 is_stmt 1
 2061 0a42 1C82      		std Y+4,__zero_reg__
 2062 0a44 1B82      		std Y+3,__zero_reg__
 2063 0a46 00C0      		rjmp .L51
 2064               	.L54:
 292:ServerLLDN.c  **** 		{
 293:ServerLLDN.c  **** 			nodes_info_arr[i].mac_addr = 0;
 2065               		.loc 6 293 0
 2066 0a48 2B81      		ldd r18,Y+3
 2067 0a4a 3C81      		ldd r19,Y+4
 2068 0a4c 4AE4      		ldi r20,lo8(74)
 2069 0a4e 429F      		mul r20,r18
 2070 0a50 C001      		movw r24,r0
 2071 0a52 439F      		mul r20,r19
 2072 0a54 900D      		add r25,r0
 2073 0a56 1124      		clr __zero_reg__
 2074 0a58 8050      		subi r24,lo8(-(nodes_info_arr+1))
 2075 0a5a 9040      		sbci r25,hi8(-(nodes_info_arr+1))
 2076 0a5c FC01      		movw r30,r24
 2077 0a5e 1182      		std Z+1,__zero_reg__
 2078 0a60 1082      		st Z,__zero_reg__
 294:ServerLLDN.c  **** 			nodes_info_arr[i].msg_rec = 0;
 2079               		.loc 6 294 0
 2080 0a62 2B81      		ldd r18,Y+3
 2081 0a64 3C81      		ldd r19,Y+4
 2082 0a66 4AE4      		ldi r20,lo8(74)
 2083 0a68 429F      		mul r20,r18
 2084 0a6a C001      		movw r24,r0
 2085 0a6c 439F      		mul r20,r19
 2086 0a6e 900D      		add r25,r0
 2087 0a70 1124      		clr __zero_reg__
 2088 0a72 8050      		subi r24,lo8(-(nodes_info_arr+69))
 2089 0a74 9040      		sbci r25,hi8(-(nodes_info_arr+69))
 2090 0a76 FC01      		movw r30,r24
 2091 0a78 1182      		std Z+1,__zero_reg__
 2092 0a7a 1082      		st Z,__zero_reg__
 295:ServerLLDN.c  **** 
 296:ServerLLDN.c  **** 			
 297:ServerLLDN.c  **** 			msg_info_array[i].mac_addr = 0;
 2093               		.loc 6 297 0
 2094 0a7c 2B81      		ldd r18,Y+3
 2095 0a7e 3C81      		ldd r19,Y+4
 2096 0a80 44E8      		ldi r20,lo8(-124)
 2097 0a82 429F      		mul r20,r18
 2098 0a84 C001      		movw r24,r0
 2099 0a86 439F      		mul r20,r19
 2100 0a88 900D      		add r25,r0
 2101 0a8a 1124      		clr __zero_reg__
 2102 0a8c 8050      		subi r24,lo8(-(msg_info_array))
 2103 0a8e 9040      		sbci r25,hi8(-(msg_info_array))
 2104 0a90 FC01      		movw r30,r24
 2105 0a92 1182      		std Z+1,__zero_reg__
 2106 0a94 1082      		st Z,__zero_reg__
 298:ServerLLDN.c  **** 			msg_info_array[i].coop_addr = 0;
 2107               		.loc 6 298 0
 2108 0a96 2B81      		ldd r18,Y+3
 2109 0a98 3C81      		ldd r19,Y+4
 2110 0a9a 44E8      		ldi r20,lo8(-124)
 2111 0a9c 429F      		mul r20,r18
 2112 0a9e C001      		movw r24,r0
 2113 0aa0 439F      		mul r20,r19
 2114 0aa2 900D      		add r25,r0
 2115 0aa4 1124      		clr __zero_reg__
 2116 0aa6 8050      		subi r24,lo8(-(msg_info_array+2))
 2117 0aa8 9040      		sbci r25,hi8(-(msg_info_array+2))
 2118 0aaa FC01      		movw r30,r24
 2119 0aac 1182      		std Z+1,__zero_reg__
 2120 0aae 1082      		st Z,__zero_reg__
 2121               	.LBB9:
 299:ServerLLDN.c  **** 			for (int j = 0; j < 50; j++)
 2122               		.loc 6 299 0
 2123 0ab0 1E82      		std Y+6,__zero_reg__
 2124 0ab2 1D82      		std Y+5,__zero_reg__
 2125 0ab4 00C0      		rjmp .L52
 2126               	.L53:
 300:ServerLLDN.c  **** 				nodes_info_arr[i].neighbors[j] = 0;
 2127               		.loc 6 300 0 discriminator 3
 2128 0ab6 8B81      		ldd r24,Y+3
 2129 0ab8 9C81      		ldd r25,Y+4
 2130 0aba 4AE4      		ldi r20,lo8(74)
 2131 0abc 489F      		mul r20,r24
 2132 0abe 9001      		movw r18,r0
 2133 0ac0 499F      		mul r20,r25
 2134 0ac2 300D      		add r19,r0
 2135 0ac4 1124      		clr __zero_reg__
 2136 0ac6 8D81      		ldd r24,Y+5
 2137 0ac8 9E81      		ldd r25,Y+6
 2138 0aca 820F      		add r24,r18
 2139 0acc 931F      		adc r25,r19
 2140 0ace 8050      		subi r24,lo8(-(nodes_info_arr+9))
 2141 0ad0 9040      		sbci r25,hi8(-(nodes_info_arr+9))
 2142 0ad2 FC01      		movw r30,r24
 2143 0ad4 1082      		st Z,__zero_reg__
 299:ServerLLDN.c  **** 			for (int j = 0; j < 50; j++)
 2144               		.loc 6 299 0 discriminator 3
 2145 0ad6 8D81      		ldd r24,Y+5
 2146 0ad8 9E81      		ldd r25,Y+6
 2147 0ada 0196      		adiw r24,1
 2148 0adc 9E83      		std Y+6,r25
 2149 0ade 8D83      		std Y+5,r24
 2150               	.L52:
 299:ServerLLDN.c  **** 			for (int j = 0; j < 50; j++)
 2151               		.loc 6 299 0 is_stmt 0 discriminator 1
 2152 0ae0 8D81      		ldd r24,Y+5
 2153 0ae2 9E81      		ldd r25,Y+6
 2154 0ae4 C297      		sbiw r24,50
 2155 0ae6 04F0      		brlt .L53
 2156               	.LBE9:
 291:ServerLLDN.c  **** 		{
 2157               		.loc 6 291 0 is_stmt 1 discriminator 2
 2158 0ae8 8B81      		ldd r24,Y+3
 2159 0aea 9C81      		ldd r25,Y+4
 2160 0aec 0196      		adiw r24,1
 2161 0aee 9C83      		std Y+4,r25
 2162 0af0 8B83      		std Y+3,r24
 2163               	.L51:
 291:ServerLLDN.c  **** 		{
 2164               		.loc 6 291 0 is_stmt 0 discriminator 1
 2165 0af2 8B81      		ldd r24,Y+3
 2166 0af4 9C81      		ldd r25,Y+4
 2167 0af6 C297      		sbiw r24,50
 2168 0af8 04F4      		brge .+2
 2169 0afa 00C0      		rjmp .L54
 2170               	.LBE8:
 301:ServerLLDN.c  **** 		}
 302:ServerLLDN.c  **** 		assTimeSlot = MacLLDNMgmtTS * 2;	
 2171               		.loc 6 302 0 is_stmt 1
 2172 0afc 82E0      		ldi r24,lo8(2)
 2173 0afe 90E0      		ldi r25,0
 2174 0b00 9093 0000 		sts assTimeSlot+1,r25
 2175 0b04 8093 0000 		sts assTimeSlot,r24
 303:ServerLLDN.c  **** 		ACKFrame_size = 0;
 2176               		.loc 6 303 0
 2177 0b08 1092 0000 		sts ACKFrame_size+1,__zero_reg__
 2178 0b0c 1092 0000 		sts ACKFrame_size,__zero_reg__
 304:ServerLLDN.c  **** 		counter_associados = 0;
 2179               		.loc 6 304 0
 2180 0b10 1092 0000 		sts counter_associados+1,__zero_reg__
 2181 0b14 1092 0000 		sts counter_associados,__zero_reg__
 305:ServerLLDN.c  **** 		n = 0;
 2182               		.loc 6 305 0
 2183 0b18 1092 0000 		sts n,__zero_reg__
 306:ServerLLDN.c  **** 	}
 2184               		.loc 6 306 0
 2185 0b1c 0000      		nop
 2186               	/* epilogue start */
 2187 0b1e 2696      		adiw r28,6
 2188 0b20 0FB6      		in __tmp_reg__,__SREG__
 2189 0b22 F894      		cli
 2190 0b24 DEBF      		out __SP_H__,r29
 2191 0b26 0FBE      		out __SREG__,__tmp_reg__
 2192 0b28 CDBF      		out __SP_L__,r28
 2193 0b2a DF91      		pop r29
 2194 0b2c CF91      		pop r28
 2195 0b2e 0895      		ret
 2196               		.cfi_endproc
 2197               	.LFE142:
 2200               	appPanDiscInit:
 2201               	.LFB143:
 307:ServerLLDN.c  **** 
 308:ServerLLDN.c  **** 	static void appPanDiscInit(void)
 309:ServerLLDN.c  **** 	{	
 2202               		.loc 6 309 0
 2203               		.cfi_startproc
 2204 0b30 CF93      		push r28
 2205               	.LCFI83:
 2206               		.cfi_def_cfa_offset 3
 2207               		.cfi_offset 28, -2
 2208 0b32 DF93      		push r29
 2209               	.LCFI84:
 2210               		.cfi_def_cfa_offset 4
 2211               		.cfi_offset 29, -3
 2212 0b34 00D0      		rcall .
 2213               	.LCFI85:
 2214               		.cfi_def_cfa_offset 6
 2215 0b36 CDB7      		in r28,__SP_L__
 2216 0b38 DEB7      		in r29,__SP_H__
 2217               	.LCFI86:
 2218               		.cfi_def_cfa_register 28
 2219               	/* prologue: function */
 2220               	/* frame size = 2 */
 2221               	/* stack size = 4 */
 2222               	.L__stack_usage = 4
 2223               	.LBB10:
 310:ServerLLDN.c  **** 		/* clear Ack array of previous discovery state */
 311:ServerLLDN.c  **** 		for(int i = 0; i < 32; i++)
 2224               		.loc 6 311 0
 2225 0b3a 1A82      		std Y+2,__zero_reg__
 2226 0b3c 1982      		std Y+1,__zero_reg__
 2227 0b3e 00C0      		rjmp .L56
 2228               	.L57:
 312:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 2229               		.loc 6 312 0 discriminator 3
 2230 0b40 8981      		ldd r24,Y+1
 2231 0b42 9A81      		ldd r25,Y+2
 2232 0b44 8050      		subi r24,lo8(-(ACKFrame+1))
 2233 0b46 9040      		sbci r25,hi8(-(ACKFrame+1))
 2234 0b48 FC01      		movw r30,r24
 2235 0b4a 1082      		st Z,__zero_reg__
 311:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 2236               		.loc 6 311 0 discriminator 3
 2237 0b4c 8981      		ldd r24,Y+1
 2238 0b4e 9A81      		ldd r25,Y+2
 2239 0b50 0196      		adiw r24,1
 2240 0b52 9A83      		std Y+2,r25
 2241 0b54 8983      		std Y+1,r24
 2242               	.L56:
 311:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 2243               		.loc 6 311 0 is_stmt 0 discriminator 1
 2244 0b56 8981      		ldd r24,Y+1
 2245 0b58 9A81      		ldd r25,Y+2
 2246 0b5a 8097      		sbiw r24,32
 2247 0b5c 04F0      		brlt .L57
 2248               	.LBE10:
 313:ServerLLDN.c  **** 		ACKFrame_size = 0;
 2249               		.loc 6 313 0 is_stmt 1
 2250 0b5e 1092 0000 		sts ACKFrame_size+1,__zero_reg__
 2251 0b62 1092 0000 		sts ACKFrame_size,__zero_reg__
 314:ServerLLDN.c  **** 		/* Prepare Beacon Message as first beacon in discovery state */		
 315:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 2252               		.loc 6 315 0
 2253 0b66 1092 0000 		sts msgReq+5+1,__zero_reg__
 2254 0b6a 1092 0000 		sts msgReq+5,__zero_reg__
 316:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_BEACON_ENDPOINT;
 2255               		.loc 6 316 0
 2256 0b6e 1092 0000 		sts msgReq+7,__zero_reg__
 317:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_BEACON_ENDPOINT;
 2257               		.loc 6 317 0
 2258 0b72 1092 0000 		sts msgReq+8,__zero_reg__
 318:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_LLDN_BEACON | NWK_OPT_DISCOVERY_STATE;
 2259               		.loc 6 318 0
 2260 0b76 80E4      		ldi r24,lo8(64)
 2261 0b78 91E0      		ldi r25,lo8(1)
 2262 0b7a 9093 0000 		sts msgReq+9+1,r25
 2263 0b7e 8093 0000 		sts msgReq+9,r24
 319:ServerLLDN.c  **** 		msgReq.data					= NULL;
 2264               		.loc 6 319 0
 2265 0b82 1092 0000 		sts msgReq+13+1,__zero_reg__
 2266 0b86 1092 0000 		sts msgReq+13,__zero_reg__
 320:ServerLLDN.c  **** 		msgReq.size					= 0;
 2267               		.loc 6 320 0
 2268 0b8a 1092 0000 		sts msgReq+15,__zero_reg__
 321:ServerLLDN.c  **** 		
 322:ServerLLDN.c  **** 		
 323:ServerLLDN.c  **** 		/* Only start timers if it is the first association process */
 324:ServerLLDN.c  **** 		if(cycles_counter == 0) 
 2269               		.loc 6 324 0
 2270 0b8e 8091 0000 		lds r24,cycles_counter
 2271 0b92 8823      		tst r24
 2272 0b94 01F0      		breq .+2
 2273 0b96 00C0      		rjmp .L59
 325:ServerLLDN.c  **** 		{
 326:ServerLLDN.c  **** 			
 327:ServerLLDN.c  **** 		/* Calculates Beacon Intervals according to 802.15.4e - 2012 p. 70 */
 328:ServerLLDN.c  **** 		n = 127; 
 2274               		.loc 6 328 0
 2275 0b98 8FE7      		ldi r24,lo8(127)
 2276 0b9a 8093 0000 		sts n,r24
 329:ServerLLDN.c  **** 		tTS =  ((p_var*sp + (m+n)*sm + macMinLIFSPeriod)/v_var);
 2277               		.loc 6 329 0
 2278 0b9e 8091 0000 		lds r24,n
 2279 0ba2 882F      		mov r24,r24
 2280 0ba4 90E0      		ldi r25,0
 2281 0ba6 0396      		adiw r24,3
 2282 0ba8 880F      		lsl r24
 2283 0baa 991F      		rol r25
 2284 0bac 092E      		mov __tmp_reg__,r25
 2285 0bae 000C      		lsl r0
 2286 0bb0 AA0B      		sbc r26,r26
 2287 0bb2 BB0B      		sbc r27,r27
 2288 0bb4 BC01      		movw r22,r24
 2289 0bb6 CD01      		movw r24,r26
 2290 0bb8 0E94 0000 		call __floatsisf
 2291 0bbc DC01      		movw r26,r24
 2292 0bbe CB01      		movw r24,r22
 2293 0bc0 20E0      		ldi r18,0
 2294 0bc2 30E0      		ldi r19,0
 2295 0bc4 40E4      		ldi r20,lo8(64)
 2296 0bc6 51E4      		ldi r21,lo8(65)
 2297 0bc8 BC01      		movw r22,r24
 2298 0bca CD01      		movw r24,r26
 2299 0bcc 0E94 0000 		call __addsf3
 2300 0bd0 DC01      		movw r26,r24
 2301 0bd2 CB01      		movw r24,r22
 2302 0bd4 20E0      		ldi r18,0
 2303 0bd6 30E0      		ldi r19,0
 2304 0bd8 40E2      		ldi r20,lo8(32)
 2305 0bda 52E4      		ldi r21,lo8(66)
 2306 0bdc BC01      		movw r22,r24
 2307 0bde CD01      		movw r24,r26
 2308 0be0 0E94 0000 		call __addsf3
 2309 0be4 DC01      		movw r26,r24
 2310 0be6 CB01      		movw r24,r22
 2311 0be8 20E0      		ldi r18,0
 2312 0bea 34E2      		ldi r19,lo8(36)
 2313 0bec 44E7      		ldi r20,lo8(116)
 2314 0bee 57E4      		ldi r21,lo8(71)
 2315 0bf0 BC01      		movw r22,r24
 2316 0bf2 CD01      		movw r24,r26
 2317 0bf4 0E94 0000 		call __divsf3
 2318 0bf8 DC01      		movw r26,r24
 2319 0bfa CB01      		movw r24,r22
 2320 0bfc 8093 0000 		sts tTS,r24
 2321 0c00 9093 0000 		sts tTS+1,r25
 2322 0c04 A093 0000 		sts tTS+2,r26
 2323 0c08 B093 0000 		sts tTS+3,r27
 330:ServerLLDN.c  **** 		#if (MASTER_MACSC == 1)
 331:ServerLLDN.c  **** 		
 332:ServerLLDN.c  **** 			beaconInterval_association = 2 * numBaseTimeSlotperMgmt_association * (tTS) / (SYMBOL_TIME);
 2324               		.loc 6 332 0
 2325 0c0c 8091 0000 		lds r24,tTS
 2326 0c10 9091 0000 		lds r25,tTS+1
 2327 0c14 A091 0000 		lds r26,tTS+2
 2328 0c18 B091 0000 		lds r27,tTS+3
 2329 0c1c 20E0      		ldi r18,0
 2330 0c1e 30E0      		ldi r19,0
 2331 0c20 40E8      		ldi r20,lo8(-128)
 2332 0c22 50E4      		ldi r21,lo8(64)
 2333 0c24 BC01      		movw r22,r24
 2334 0c26 CD01      		movw r24,r26
 2335 0c28 0E94 0000 		call __mulsf3
 2336 0c2c DC01      		movw r26,r24
 2337 0c2e CB01      		movw r24,r22
 2338 0c30 2DEB      		ldi r18,lo8(-67)
 2339 0c32 37E3      		ldi r19,lo8(55)
 2340 0c34 46E8      		ldi r20,lo8(-122)
 2341 0c36 57E3      		ldi r21,lo8(55)
 2342 0c38 BC01      		movw r22,r24
 2343 0c3a CD01      		movw r24,r26
 2344 0c3c 0E94 0000 		call __divsf3
 2345 0c40 DC01      		movw r26,r24
 2346 0c42 CB01      		movw r24,r22
 2347 0c44 8093 0000 		sts beaconInterval_association,r24
 2348 0c48 9093 0000 		sts beaconInterval_association+1,r25
 2349 0c4c A093 0000 		sts beaconInterval_association+2,r26
 2350 0c50 B093 0000 		sts beaconInterval_association+3,r27
 333:ServerLLDN.c  **** 			/*
 334:ServerLLDN.c  **** 			* Configure interrupts callback functions
 335:ServerLLDN.c  **** 			* overflow interrupt, compare 1,2,3 interrupts
 336:ServerLLDN.c  **** 			*/
 337:ServerLLDN.c  **** 			macsc_set_cmp1_int_cb(lldn_server_beacon);
 2351               		.loc 6 337 0
 2352 0c54 80E0      		ldi r24,lo8(gs(lldn_server_beacon))
 2353 0c56 90E0      		ldi r25,hi8(gs(lldn_server_beacon))
 2354 0c58 0E94 0000 		call macsc_set_cmp1_int_cb
 338:ServerLLDN.c  **** 			/*
 339:ServerLLDN.c  **** 			* Configure MACSC to generate compare interrupts from channels 1,2,3
 340:ServerLLDN.c  **** 			* Set compare mode to absolute, set compare value.
 341:ServerLLDN.c  **** 			*/
 342:ServerLLDN.c  **** 			macsc_enable_manual_bts();
 2355               		.loc 6 342 0
 2356 0c5c 0E94 0000 		call macsc_enable_manual_bts
 343:ServerLLDN.c  **** 			macsc_enable_cmp_int(MACSC_CC1);
 2357               		.loc 6 343 0
 2358 0c60 81E0      		ldi r24,lo8(1)
 2359 0c62 0E94 0000 		call macsc_enable_cmp_int
 344:ServerLLDN.c  **** 
 345:ServerLLDN.c  **** 			macsc_use_cmp(MACSC_RELATIVE_CMP, beaconInterval_association , MACSC_CC1);
 2360               		.loc 6 345 0
 2361 0c66 8091 0000 		lds r24,beaconInterval_association
 2362 0c6a 9091 0000 		lds r25,beaconInterval_association+1
 2363 0c6e A091 0000 		lds r26,beaconInterval_association+2
 2364 0c72 B091 0000 		lds r27,beaconInterval_association+3
 2365 0c76 BC01      		movw r22,r24
 2366 0c78 CD01      		movw r24,r26
 2367 0c7a 0E94 0000 		call __fixunssfsi
 2368 0c7e DC01      		movw r26,r24
 2369 0c80 CB01      		movw r24,r22
 2370 0c82 21E0      		ldi r18,lo8(1)
 2371 0c84 AC01      		movw r20,r24
 2372 0c86 BD01      		movw r22,r26
 2373 0c88 81E0      		ldi r24,lo8(1)
 2374 0c8a 0E94 0000 		call macsc_use_cmp
 2375               	.L59:
 346:ServerLLDN.c  **** 			
 347:ServerLLDN.c  **** 			/* Timer used in testing */
 348:ServerLLDN.c  **** 			#if TIMESLOT_TIMER
 349:ServerLLDN.c  **** 			macsc_set_cmp2_int_cb(teste_handler);	
 350:ServerLLDN.c  **** 			macsc_enable_cmp_int(MACSC_CC2);
 351:ServerLLDN.c  **** 			macsc_use_cmp(MACSC_RELATIVE_CMP, beaconInterval_association / 2, MACSC_CC2);
 352:ServerLLDN.c  **** 			#endif
 353:ServerLLDN.c  **** 			
 354:ServerLLDN.c  **** 		#endif
 355:ServerLLDN.c  **** 		}
 356:ServerLLDN.c  **** 	}
 2376               		.loc 6 356 0
 2377 0c8e 0000      		nop
 2378               	/* epilogue start */
 2379 0c90 0F90      		pop __tmp_reg__
 2380 0c92 0F90      		pop __tmp_reg__
 2381 0c94 DF91      		pop r29
 2382 0c96 CF91      		pop r28
 2383 0c98 0895      		ret
 2384               		.cfi_endproc
 2385               	.LFE143:
 2388               	appPanOnlineInit:
 2389               	.LFB144:
 357:ServerLLDN.c  **** 
 358:ServerLLDN.c  **** 	static void appPanOnlineInit()
 359:ServerLLDN.c  **** 	{
 2390               		.loc 6 359 0
 2391               		.cfi_startproc
 2392 0c9a EF92      		push r14
 2393               	.LCFI87:
 2394               		.cfi_def_cfa_offset 3
 2395               		.cfi_offset 14, -2
 2396 0c9c FF92      		push r15
 2397               	.LCFI88:
 2398               		.cfi_def_cfa_offset 4
 2399               		.cfi_offset 15, -3
 2400 0c9e 0F93      		push r16
 2401               	.LCFI89:
 2402               		.cfi_def_cfa_offset 5
 2403               		.cfi_offset 16, -4
 2404 0ca0 1F93      		push r17
 2405               	.LCFI90:
 2406               		.cfi_def_cfa_offset 6
 2407               		.cfi_offset 17, -5
 2408 0ca2 CF93      		push r28
 2409               	.LCFI91:
 2410               		.cfi_def_cfa_offset 7
 2411               		.cfi_offset 28, -6
 2412 0ca4 DF93      		push r29
 2413               	.LCFI92:
 2414               		.cfi_def_cfa_offset 8
 2415               		.cfi_offset 29, -7
 2416 0ca6 CDB7      		in r28,__SP_L__
 2417 0ca8 DEB7      		in r29,__SP_H__
 2418               	.LCFI93:
 2419               		.cfi_def_cfa_register 28
 2420               	/* prologue: function */
 2421               	/* frame size = 0 */
 2422               	/* stack size = 6 */
 2423               	.L__stack_usage = 6
 360:ServerLLDN.c  **** 			timeslot_counter = 0;
 2424               		.loc 6 360 0
 2425 0caa 1092 0000 		sts timeslot_counter,__zero_reg__
 361:ServerLLDN.c  **** 			
 362:ServerLLDN.c  **** 			tTS =  ((p_var*sp + (m+ config_request_frame.conf.tsDuration )*sm + macMinLIFSPeriod)/v_var);
 2426               		.loc 6 362 0
 2427 0cae 8091 0000 		lds r24,config_request_frame+5
 2428 0cb2 8F77      		andi r24,lo8(127)
 2429 0cb4 882F      		mov r24,r24
 2430 0cb6 90E0      		ldi r25,0
 2431 0cb8 0396      		adiw r24,3
 2432 0cba 880F      		lsl r24
 2433 0cbc 991F      		rol r25
 2434 0cbe 092E      		mov __tmp_reg__,r25
 2435 0cc0 000C      		lsl r0
 2436 0cc2 AA0B      		sbc r26,r26
 2437 0cc4 BB0B      		sbc r27,r27
 2438 0cc6 BC01      		movw r22,r24
 2439 0cc8 CD01      		movw r24,r26
 2440 0cca 0E94 0000 		call __floatsisf
 2441 0cce DC01      		movw r26,r24
 2442 0cd0 CB01      		movw r24,r22
 2443 0cd2 20E0      		ldi r18,0
 2444 0cd4 30E0      		ldi r19,0
 2445 0cd6 40E4      		ldi r20,lo8(64)
 2446 0cd8 51E4      		ldi r21,lo8(65)
 2447 0cda BC01      		movw r22,r24
 2448 0cdc CD01      		movw r24,r26
 2449 0cde 0E94 0000 		call __addsf3
 2450 0ce2 DC01      		movw r26,r24
 2451 0ce4 CB01      		movw r24,r22
 2452 0ce6 20E0      		ldi r18,0
 2453 0ce8 30E0      		ldi r19,0
 2454 0cea 40E2      		ldi r20,lo8(32)
 2455 0cec 52E4      		ldi r21,lo8(66)
 2456 0cee BC01      		movw r22,r24
 2457 0cf0 CD01      		movw r24,r26
 2458 0cf2 0E94 0000 		call __addsf3
 2459 0cf6 DC01      		movw r26,r24
 2460 0cf8 CB01      		movw r24,r22
 2461 0cfa 20E0      		ldi r18,0
 2462 0cfc 34E2      		ldi r19,lo8(36)
 2463 0cfe 44E7      		ldi r20,lo8(116)
 2464 0d00 57E4      		ldi r21,lo8(71)
 2465 0d02 BC01      		movw r22,r24
 2466 0d04 CD01      		movw r24,r26
 2467 0d06 0E94 0000 		call __divsf3
 2468 0d0a DC01      		movw r26,r24
 2469 0d0c CB01      		movw r24,r22
 2470 0d0e 8093 0000 		sts tTS,r24
 2471 0d12 9093 0000 		sts tTS+1,r25
 2472 0d16 A093 0000 		sts tTS+2,r26
 2473 0d1a B093 0000 		sts tTS+3,r27
 363:ServerLLDN.c  **** 			
 364:ServerLLDN.c  **** 			n = config_request_frame.conf.tsDuration;
 2474               		.loc 6 364 0
 2475 0d1e 8091 0000 		lds r24,config_request_frame+5
 2476 0d22 8F77      		andi r24,lo8(127)
 2477 0d24 8093 0000 		sts n,r24
 365:ServerLLDN.c  **** 			
 366:ServerLLDN.c  **** 			msgReq.dstAddr				= 0;
 2478               		.loc 6 366 0
 2479 0d28 1092 0000 		sts msgReq+5+1,__zero_reg__
 2480 0d2c 1092 0000 		sts msgReq+5,__zero_reg__
 367:ServerLLDN.c  **** 			msgReq.dstEndpoint			= APP_BEACON_ENDPOINT;
 2481               		.loc 6 367 0
 2482 0d30 1092 0000 		sts msgReq+7,__zero_reg__
 368:ServerLLDN.c  **** 			msgReq.srcEndpoint			= APP_BEACON_ENDPOINT;
 2483               		.loc 6 368 0
 2484 0d34 1092 0000 		sts msgReq+8,__zero_reg__
 369:ServerLLDN.c  **** 			msgReq.options				= NWK_OPT_LLDN_BEACON | NWK_OPT_ONLINE_STATE;
 2485               		.loc 6 369 0
 2486 0d38 80EC      		ldi r24,lo8(-64)
 2487 0d3a 90E0      		ldi r25,0
 2488 0d3c 9093 0000 		sts msgReq+9+1,r25
 2489 0d40 8093 0000 		sts msgReq+9,r24
 370:ServerLLDN.c  **** 			msgReq.data					= NULL;
 2490               		.loc 6 370 0
 2491 0d44 1092 0000 		sts msgReq+13+1,__zero_reg__
 2492 0d48 1092 0000 		sts msgReq+13,__zero_reg__
 371:ServerLLDN.c  **** 			msgReq.size					= 0;
 2493               		.loc 6 371 0
 2494 0d4c 1092 0000 		sts msgReq+15,__zero_reg__
 372:ServerLLDN.c  **** 			
 373:ServerLLDN.c  **** 			// (number of time slots x mgmt time solts) x base timelosts
 374:ServerLLDN.c  **** 			beaconInterval = (assTimeSlot + 2*MacLLDNMgmtTS) * tTS / (SYMBOL_TIME);
 2495               		.loc 6 374 0
 2496 0d50 8091 0000 		lds r24,assTimeSlot
 2497 0d54 9091 0000 		lds r25,assTimeSlot+1
 2498 0d58 0296      		adiw r24,2
 2499 0d5a 092E      		mov __tmp_reg__,r25
 2500 0d5c 000C      		lsl r0
 2501 0d5e AA0B      		sbc r26,r26
 2502 0d60 BB0B      		sbc r27,r27
 2503 0d62 BC01      		movw r22,r24
 2504 0d64 CD01      		movw r24,r26
 2505 0d66 0E94 0000 		call __floatsisf
 2506 0d6a 7B01      		movw r14,r22
 2507 0d6c 8C01      		movw r16,r24
 2508 0d6e 8091 0000 		lds r24,tTS
 2509 0d72 9091 0000 		lds r25,tTS+1
 2510 0d76 A091 0000 		lds r26,tTS+2
 2511 0d7a B091 0000 		lds r27,tTS+3
 2512 0d7e 9C01      		movw r18,r24
 2513 0d80 AD01      		movw r20,r26
 2514 0d82 C801      		movw r24,r16
 2515 0d84 B701      		movw r22,r14
 2516 0d86 0E94 0000 		call __mulsf3
 2517 0d8a DC01      		movw r26,r24
 2518 0d8c CB01      		movw r24,r22
 2519 0d8e 2DEB      		ldi r18,lo8(-67)
 2520 0d90 37E3      		ldi r19,lo8(55)
 2521 0d92 46E8      		ldi r20,lo8(-122)
 2522 0d94 57E3      		ldi r21,lo8(55)
 2523 0d96 BC01      		movw r22,r24
 2524 0d98 CD01      		movw r24,r26
 2525 0d9a 0E94 0000 		call __divsf3
 2526 0d9e DC01      		movw r26,r24
 2527 0da0 CB01      		movw r24,r22
 2528 0da2 8093 0000 		sts beaconInterval,r24
 2529 0da6 9093 0000 		sts beaconInterval+1,r25
 2530 0daa A093 0000 		sts beaconInterval+2,r26
 2531 0dae B093 0000 		sts beaconInterval+3,r27
 375:ServerLLDN.c  **** 			
 376:ServerLLDN.c  **** 			// Configure Timers
 377:ServerLLDN.c  **** 			macsc_set_cmp1_int_cb(time_slot_handler);
 2532               		.loc 6 377 0
 2533 0db2 80E0      		ldi r24,lo8(gs(time_slot_handler))
 2534 0db4 90E0      		ldi r25,hi8(gs(time_slot_handler))
 2535 0db6 0E94 0000 		call macsc_set_cmp1_int_cb
 378:ServerLLDN.c  **** 			
 379:ServerLLDN.c  **** 			macsc_enable_manual_bts();
 2536               		.loc 6 379 0
 2537 0dba 0E94 0000 		call macsc_enable_manual_bts
 380:ServerLLDN.c  **** 			
 381:ServerLLDN.c  **** 			macsc_enable_cmp_int(MACSC_CC1);
 2538               		.loc 6 381 0
 2539 0dbe 81E0      		ldi r24,lo8(1)
 2540 0dc0 0E94 0000 		call macsc_enable_cmp_int
 382:ServerLLDN.c  **** 			macsc_use_cmp(MACSC_RELATIVE_CMP, numBaseTimeSlotperMgmt_online * tTS / (SYMBOL_TIME), MACSC_CC1
 2541               		.loc 6 382 0
 2542 0dc4 8091 0000 		lds r24,tTS
 2543 0dc8 9091 0000 		lds r25,tTS+1
 2544 0dcc A091 0000 		lds r26,tTS+2
 2545 0dd0 B091 0000 		lds r27,tTS+3
 2546 0dd4 9C01      		movw r18,r24
 2547 0dd6 AD01      		movw r20,r26
 2548 0dd8 BC01      		movw r22,r24
 2549 0dda CD01      		movw r24,r26
 2550 0ddc 0E94 0000 		call __addsf3
 2551 0de0 DC01      		movw r26,r24
 2552 0de2 CB01      		movw r24,r22
 2553 0de4 2DEB      		ldi r18,lo8(-67)
 2554 0de6 37E3      		ldi r19,lo8(55)
 2555 0de8 46E8      		ldi r20,lo8(-122)
 2556 0dea 57E3      		ldi r21,lo8(55)
 2557 0dec BC01      		movw r22,r24
 2558 0dee CD01      		movw r24,r26
 2559 0df0 0E94 0000 		call __divsf3
 2560 0df4 DC01      		movw r26,r24
 2561 0df6 CB01      		movw r24,r22
 2562 0df8 BC01      		movw r22,r24
 2563 0dfa CD01      		movw r24,r26
 2564 0dfc 0E94 0000 		call __fixunssfsi
 2565 0e00 DC01      		movw r26,r24
 2566 0e02 CB01      		movw r24,r22
 2567 0e04 21E0      		ldi r18,lo8(1)
 2568 0e06 AC01      		movw r20,r24
 2569 0e08 BD01      		movw r22,r26
 2570 0e0a 81E0      		ldi r24,lo8(1)
 2571 0e0c 0E94 0000 		call macsc_use_cmp
 383:ServerLLDN.c  **** 			
 384:ServerLLDN.c  **** 			NWK_OpenEndpoint(APP_DATA_ENDPOINT, appDataInd);
 2572               		.loc 6 384 0
 2573 0e10 60E0      		ldi r22,lo8(gs(appDataInd))
 2574 0e12 70E0      		ldi r23,hi8(gs(appDataInd))
 2575 0e14 81E0      		ldi r24,lo8(1)
 2576 0e16 0E94 0000 		call NWK_OpenEndpoint
 385:ServerLLDN.c  **** 	}
 2577               		.loc 6 385 0
 2578 0e1a 0000      		nop
 2579               	/* epilogue start */
 2580 0e1c DF91      		pop r29
 2581 0e1e CF91      		pop r28
 2582 0e20 1F91      		pop r17
 2583 0e22 0F91      		pop r16
 2584 0e24 FF90      		pop r15
 2585 0e26 EF90      		pop r14
 2586 0e28 0895      		ret
 2587               		.cfi_endproc
 2588               	.LFE144:
 2591               	appInit:
 2592               	.LFB145:
 386:ServerLLDN.c  **** 
 387:ServerLLDN.c  **** #else 
 388:ServerLLDN.c  **** 	uint8_t payloadSize = 22;
 389:ServerLLDN.c  **** 	uint8_t assTimeSlot = 0xFF;
 390:ServerLLDN.c  **** 	uint8_t n = 0;
 391:ServerLLDN.c  **** 	
 392:ServerLLDN.c  **** 	static NwkFrameBeaconHeaderLLDN_t *rec_beacon;
 393:ServerLLDN.c  **** 	static NWK_DiscoverResponse_t msgDiscResponse = { .id = LL_DISCOVER_RESPONSE,
 394:ServerLLDN.c  **** 													 .macAddr = APP_ADDR,
 395:ServerLLDN.c  **** 													 .ts_dir.tsDuration = 22,
 396:ServerLLDN.c  **** 													 .ts_dir.dirIndicator = 0b1 };
 397:ServerLLDN.c  **** 	static NWK_ConfigStatus_t msgConfigStatus = { .id = LL_CONFIGURATION_STATUS,
 398:ServerLLDN.c  **** 												 .macAddr = APP_ADDR,
 399:ServerLLDN.c  **** 												 .s_macAddr = APP_ADDR,
 400:ServerLLDN.c  **** 												 .ts_dir.tsDuration = 22,
 401:ServerLLDN.c  **** 												 .ts_dir.dirIndicator = 1,
 402:ServerLLDN.c  **** 												 .assTimeSlot = 0xff };
 403:ServerLLDN.c  **** 	uint8_t data_payload = APP_ADDR;
 404:ServerLLDN.c  **** 	static bool ack_received;
 405:ServerLLDN.c  **** 	bool MacLLDNMgmtTS = 0; 
 406:ServerLLDN.c  **** 	bool associated = 0;
 407:ServerLLDN.c  **** 	
 408:ServerLLDN.c  **** 	static void send_message_timeHandler(void)
 409:ServerLLDN.c  **** 	{
 410:ServerLLDN.c  **** 		printf("\nmsg_hdlr");
 411:ServerLLDN.c  **** 		appState = APP_STATE_SEND;	
 412:ServerLLDN.c  **** 		#if MASTER_MACSC == 0
 413:ServerLLDN.c  **** 			timer_stop();
 414:ServerLLDN.c  **** 		#endif
 415:ServerLLDN.c  **** 	}
 416:ServerLLDN.c  **** 
 417:ServerLLDN.c  **** 	static void start_timer(int delay)
 418:ServerLLDN.c  **** 	{
 419:ServerLLDN.c  **** 		#if MASTER_MACSC
 420:ServerLLDN.c  **** 		macsc_enable_manual_bts();
 421:ServerLLDN.c  **** 		macsc_set_cmp1_int_cb(send_message_timeHandler);
 422:ServerLLDN.c  **** 		macsc_enable_cmp_int(MACSC_CC1);
 423:ServerLLDN.c  **** 		macsc_use_cmp(MACSC_RELATIVE_CMP, delay - 195, MACSC_CC1);
 424:ServerLLDN.c  **** 		#else
 425:ServerLLDN.c  **** 		timer_init();
 426:ServerLLDN.c  **** 		timer_delay(delay/2);
 427:ServerLLDN.c  **** 		hw_timer_setup_handler(send_message_timeHandler);
 428:ServerLLDN.c  **** 		timer_start();
 429:ServerLLDN.c  **** 		#endif
 430:ServerLLDN.c  **** 	}
 431:ServerLLDN.c  **** 	
 432:ServerLLDN.c  **** 	static bool appBeaconInd(NWK_DataInd_t *ind)
 433:ServerLLDN.c  **** 	{
 434:ServerLLDN.c  **** 		rec_beacon = (NwkFrameBeaconHeaderLLDN_t*)ind->data;
 435:ServerLLDN.c  **** 		PanId = rec_beacon->PanId;
 436:ServerLLDN.c  **** 		//  bom implementar rotinas pra se o nodo estiver associado a um coordeandor e se no estiver
 437:ServerLLDN.c  **** 		if( ((rec_beacon->Flags.txState == DISC_MODE && !ack_received && rec_beacon->confSeqNumber == 0x0
 438:ServerLLDN.c  **** 			(rec_beacon->Flags.txState == CONFIG_MODE && ack_received)) && associated == 0)
 439:ServerLLDN.c  **** 		{
 440:ServerLLDN.c  **** 	
 441:ServerLLDN.c  **** 			int ts_time =  ((p_var*sp + (m+ rec_beacon->TimeSlotSize  )*sm + macMinLIFSPeriod)/v_var)  / (SY
 442:ServerLLDN.c  **** 			int msg_wait_time = rec_beacon->Flags.numBaseMgmtTimeslots * rec_beacon->TimeSlotSize * 2; // sy
 443:ServerLLDN.c  **** 			
 444:ServerLLDN.c  **** 			start_timer(msg_wait_time);
 445:ServerLLDN.c  **** 			
 446:ServerLLDN.c  **** 			appState = (rec_beacon->Flags.txState == DISC_MODE) ? APP_STATE_PREP_DISC_REPONSE : APP_STATE_PR
 447:ServerLLDN.c  **** 		}
 448:ServerLLDN.c  **** 		else if (rec_beacon->Flags.txState == ONLINE_MODE && assTimeSlot != 0xFF && associated == 1)
 449:ServerLLDN.c  **** 		{
 450:ServerLLDN.c  **** 			int ts_time = ((p_var*sp + (m+ n)*sm + macMinLIFSPeriod)/v_var)  / (SYMBOL_TIME);
 451:ServerLLDN.c  **** 			int msg_wait_time = (2*rec_beacon->Flags.numBaseMgmtTimeslots + assTimeSlot) * ts_time;
 452:ServerLLDN.c  **** 			start_timer(msg_wait_time - 80);
 453:ServerLLDN.c  **** 			ack_received = false;
 454:ServerLLDN.c  **** 			appState = APP_STATE_PREP_DATA_FRAME;
 455:ServerLLDN.c  **** 		}
 456:ServerLLDN.c  **** 		else if (rec_beacon->Flags.txState == RESET_MODE)
 457:ServerLLDN.c  **** 		{
 458:ServerLLDN.c  **** 			printf("\n Reset beacon");
 459:ServerLLDN.c  **** 			ack_received = 0;
 460:ServerLLDN.c  **** 			associated = 0;
 461:ServerLLDN.c  **** 		}
 462:ServerLLDN.c  **** 		return true;
 463:ServerLLDN.c  **** 	}
 464:ServerLLDN.c  **** 	
 465:ServerLLDN.c  **** 	static bool appAckInd(NWK_DataInd_t *ind)
 466:ServerLLDN.c  **** 	{
 467:ServerLLDN.c  **** 		#if !MASTER_MACSC
 468:ServerLLDN.c  **** 		ind->data = ind->data - (uint8_t) 1;
 469:ServerLLDN.c  **** 		#endif
 470:ServerLLDN.c  **** 		NWK_ACKFormat_t *ackframe = (NWK_ACKFormat_t*)ind->data;
 471:ServerLLDN.c  **** 		if(PanId == ackframe->sourceId)
 472:ServerLLDN.c  **** 		{
 473:ServerLLDN.c  **** 			int pos = (int) APP_ADDR / 8;
 474:ServerLLDN.c  **** 			int bit_shift = 8 - APP_ADDR % 8;
 475:ServerLLDN.c  **** 			if( ackframe->ackFlags[pos] & 1 << bit_shift)	
 476:ServerLLDN.c  **** 			{
 477:ServerLLDN.c  **** 				printf("\nACK TRUE");
 478:ServerLLDN.c  **** 				ack_received = true;
 479:ServerLLDN.c  **** 			}
 480:ServerLLDN.c  **** 		}
 481:ServerLLDN.c  **** 		return true;
 482:ServerLLDN.c  **** 	}
 483:ServerLLDN.c  **** 	
 484:ServerLLDN.c  **** 	static bool appCommandInd(NWK_DataInd_t *ind)
 485:ServerLLDN.c  **** 	{
 486:ServerLLDN.c  **** 		#if !MASTER_MACSC
 487:ServerLLDN.c  **** 		ind->data = ind->data - (uint8_t) 1;
 488:ServerLLDN.c  **** 		#endif
 489:ServerLLDN.c  **** 		
 490:ServerLLDN.c  **** 		if(ind->data[0] == LL_CONFIGURATION_REQUEST)
 491:ServerLLDN.c  **** 		{
 492:ServerLLDN.c  **** 			NWK_ConfigRequest_t *msg = (NWK_ConfigRequest_t*)ind->data;
 493:ServerLLDN.c  **** 			if(msg->macAddr == APP_ADDR)
 494:ServerLLDN.c  **** 			{
 495:ServerLLDN.c  **** 				PHY_SetChannel(msg->tx_channel);
 496:ServerLLDN.c  **** 				NWK_SetPanId(msg->s_macAddr);
 497:ServerLLDN.c  **** 				PanId = msg->s_macAddr;
 498:ServerLLDN.c  **** 				assTimeSlot = msg->assTimeSlot;
 499:ServerLLDN.c  **** 				n = msg->conf.tsDuration;
 500:ServerLLDN.c  **** 				associated = 1;
 501:ServerLLDN.c  **** 				printf("\nAssociado!");
 502:ServerLLDN.c  **** 			}
 503:ServerLLDN.c  **** 		}
 504:ServerLLDN.c  **** 		return true;
 505:ServerLLDN.c  **** 	}
 506:ServerLLDN.c  **** 
 507:ServerLLDN.c  **** 	void appPrepareDiscoverResponse()
 508:ServerLLDN.c  **** 	{
 509:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 510:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_COMMAND_ENDPOINT;
 511:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_COMMAND_ENDPOINT;
 512:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_MAC_COMMAND;
 513:ServerLLDN.c  **** 		msgReq.data					= (uint8_t*)&msgDiscResponse;
 514:ServerLLDN.c  **** 		msgReq.size					= sizeof(msgDiscResponse);
 515:ServerLLDN.c  **** 	}
 516:ServerLLDN.c  **** 	
 517:ServerLLDN.c  **** 	void appPrepareConfigurationStatus()
 518:ServerLLDN.c  **** 	{		
 519:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 520:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_COMMAND_ENDPOINT;
 521:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_COMMAND_ENDPOINT;
 522:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_MAC_COMMAND;
 523:ServerLLDN.c  **** 		msgReq.data					= (uint8_t*)&msgConfigStatus;
 524:ServerLLDN.c  **** 		msgReq.size					= sizeof(msgConfigStatus);
 525:ServerLLDN.c  **** 	}
 526:ServerLLDN.c  **** 	
 527:ServerLLDN.c  **** 	void appPrepareDataFrame(void)
 528:ServerLLDN.c  **** 	{
 529:ServerLLDN.c  **** 		
 530:ServerLLDN.c  **** 		PHY_SetTdmaMode(false);
 531:ServerLLDN.c  **** 
 532:ServerLLDN.c  **** 	
 533:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 534:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_COMMAND_ENDPOINT;
 535:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_COMMAND_ENDPOINT;
 536:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_LLDN_DATA;
 537:ServerLLDN.c  **** 		msgReq.data					= (uint8_t *)&data_payload;
 538:ServerLLDN.c  **** 		msgReq.size					= sizeof(data_payload);
 539:ServerLLDN.c  **** 	}
 540:ServerLLDN.c  **** 	
 541:ServerLLDN.c  **** 	
 542:ServerLLDN.c  **** #endif // APP_COORDINATOR
 543:ServerLLDN.c  **** 
 544:ServerLLDN.c  **** static void appInit(void)
 545:ServerLLDN.c  **** {
 2593               		.loc 6 545 0
 2594               		.cfi_startproc
 2595 0e2a CF93      		push r28
 2596               	.LCFI94:
 2597               		.cfi_def_cfa_offset 3
 2598               		.cfi_offset 28, -2
 2599 0e2c DF93      		push r29
 2600               	.LCFI95:
 2601               		.cfi_def_cfa_offset 4
 2602               		.cfi_offset 29, -3
 2603 0e2e CDB7      		in r28,__SP_L__
 2604 0e30 DEB7      		in r29,__SP_H__
 2605               	.LCFI96:
 2606               		.cfi_def_cfa_register 28
 2607               	/* prologue: function */
 2608               	/* frame size = 0 */
 2609               	/* stack size = 2 */
 2610               	.L__stack_usage = 2
 546:ServerLLDN.c  **** 	NWK_SetAddr(APP_ADDR);
 2611               		.loc 6 546 0
 2612 0e32 80E0      		ldi r24,0
 2613 0e34 90E0      		ldi r25,0
 2614 0e36 0E94 0000 		call NWK_SetAddr
 547:ServerLLDN.c  **** 	PHY_SetChannel(APP_CHANNEL);
 2615               		.loc 6 547 0
 2616 0e3a 8FE0      		ldi r24,lo8(15)
 2617 0e3c 0E94 0000 		call PHY_SetChannel
 548:ServerLLDN.c  **** 	PHY_SetRxState(true);
 2618               		.loc 6 548 0
 2619 0e40 81E0      		ldi r24,lo8(1)
 2620 0e42 0E94 0000 		call PHY_SetRxState
 549:ServerLLDN.c  **** 		
 550:ServerLLDN.c  **** 	#if APP_COORDINATOR	 
 551:ServerLLDN.c  **** 		/* Timer used for delay between messages */
 552:ServerLLDN.c  **** 		tmrDelay.interval = 2;
 2621               		.loc 6 552 0
 2622 0e46 82E0      		ldi r24,lo8(2)
 2623 0e48 90E0      		ldi r25,0
 2624 0e4a A0E0      		ldi r26,0
 2625 0e4c B0E0      		ldi r27,0
 2626 0e4e 8093 0000 		sts tmrDelay+6,r24
 2627 0e52 9093 0000 		sts tmrDelay+6+1,r25
 2628 0e56 A093 0000 		sts tmrDelay+6+2,r26
 2629 0e5a B093 0000 		sts tmrDelay+6+3,r27
 553:ServerLLDN.c  **** 		tmrDelay.mode = SYS_TIMER_INTERVAL_MODE;
 2630               		.loc 6 553 0
 2631 0e5e 1092 0000 		sts tmrDelay+10,__zero_reg__
 554:ServerLLDN.c  **** 		tmrDelay.handler = tmrDelayHandler;
 2632               		.loc 6 554 0
 2633 0e62 80E0      		ldi r24,lo8(gs(tmrDelayHandler))
 2634 0e64 90E0      		ldi r25,hi8(gs(tmrDelayHandler))
 2635 0e66 9093 0000 		sts tmrDelay+11+1,r25
 2636 0e6a 8093 0000 		sts tmrDelay+11,r24
 555:ServerLLDN.c  **** 	  
 556:ServerLLDN.c  **** 		/* 
 557:ServerLLDN.c  **** 		* Disable CSMA/CA
 558:ServerLLDN.c  **** 		* Disable auto ACK
 559:ServerLLDN.c  **** 		*/
 560:ServerLLDN.c  **** 		NWK_SetPanId(APP_PANID);
 2637               		.loc 6 560 0
 2638 0e6e 8EEF      		ldi r24,lo8(-2)
 2639 0e70 9AEC      		ldi r25,lo8(-54)
 2640 0e72 0E94 0000 		call NWK_SetPanId
 561:ServerLLDN.c  **** 		PanId = APP_PANID;
 2641               		.loc 6 561 0
 2642 0e76 8EEF      		ldi r24,lo8(-2)
 2643 0e78 8093 0000 		sts PanId,r24
 562:ServerLLDN.c  **** 		ACKFrame.sourceId = APP_PANID;
 2644               		.loc 6 562 0
 2645 0e7c 8EEF      		ldi r24,lo8(-2)
 2646 0e7e 8093 0000 		sts ACKFrame,r24
 563:ServerLLDN.c  **** 		PHY_SetTdmaMode(true);
 2647               		.loc 6 563 0
 2648 0e82 81E0      		ldi r24,lo8(1)
 2649 0e84 0E94 0000 		call PHY_SetTdmaMode
 564:ServerLLDN.c  **** 	NWK_OpenEndpoint(APP_COMMAND_ENDPOINT, appCommandInd);
 2650               		.loc 6 564 0
 2651 0e88 60E0      		ldi r22,lo8(gs(appCommandInd))
 2652 0e8a 70E0      		ldi r23,hi8(gs(appCommandInd))
 2653 0e8c 83E0      		ldi r24,lo8(3)
 2654 0e8e 0E94 0000 		call NWK_OpenEndpoint
 565:ServerLLDN.c  **** 	#else
 566:ServerLLDN.c  **** 		/*
 567:ServerLLDN.c  **** 		 * Enable CSMA/CA
 568:ServerLLDN.c  **** 		 * Enable Random CSMA seed generator
 569:ServerLLDN.c  **** 		 */
 570:ServerLLDN.c  **** 		PHY_SetTdmaMode(false);
 571:ServerLLDN.c  **** 		// PHY_SetOptimizedCSMAValues();
 572:ServerLLDN.c  **** 		
 573:ServerLLDN.c  **** 		payloadSize = 127;
 574:ServerLLDN.c  **** 		NWK_OpenEndpoint(APP_BEACON_ENDPOINT, appBeaconInd);
 575:ServerLLDN.c  **** 		NWK_OpenEndpoint(APP_ACK_ENDPOINT, appAckInd);
 576:ServerLLDN.c  **** 		NWK_OpenEndpoint(APP_COMMAND_ENDPOINT, appCommandInd);
 577:ServerLLDN.c  **** 		/*
 578:ServerLLDN.c  **** 		* Configure interrupts callback functions
 579:ServerLLDN.c  **** 		*/
 580:ServerLLDN.c  **** 		
 581:ServerLLDN.c  **** 	#endif // APP_COORDENATOR
 582:ServerLLDN.c  **** 	PHY_SetPromiscuousMode(true);
 2655               		.loc 6 582 0
 2656 0e92 81E0      		ldi r24,lo8(1)
 2657 0e94 0E94 0000 		call PHY_SetPromiscuousMode
 583:ServerLLDN.c  **** 
 584:ServerLLDN.c  **** }
 2658               		.loc 6 584 0
 2659 0e98 0000      		nop
 2660               	/* epilogue start */
 2661 0e9a DF91      		pop r29
 2662 0e9c CF91      		pop r28
 2663 0e9e 0895      		ret
 2664               		.cfi_endproc
 2665               	.LFE145:
 2667               		.section	.rodata
 2668               	.LC8:
 2669 0055 0A25 642C 		.string	"\n%d, %d"
 2669      2025 6400 
 2670               	.LC9:
 2671 005d 0A61 636B 		.string	"\nackprepare"
 2671      7072 6570 
 2671      6172 6500 
 2672               	.LC10:
 2673 0069 0A46 696D 		.string	"\nFim de um Per\355odo"
 2673      2064 6520 
 2673      756D 2050 
 2673      6572 ED6F 
 2673      646F 00
 2674               	.LC11:
 2675 007c 0A2D 2D2D 		.string	"\n------- slot %d --------"
 2675      2D2D 2D2D 
 2675      2073 6C6F 
 2675      7420 2564 
 2675      202D 2D2D 
 2676               		.text
 2678               	APP_TaskHandler:
 2679               	.LFB146:
 585:ServerLLDN.c  **** 
 586:ServerLLDN.c  **** static void APP_TaskHandler(void)
 587:ServerLLDN.c  **** {
 2680               		.loc 6 587 0
 2681               		.cfi_startproc
 2682 0ea0 CF93      		push r28
 2683               	.LCFI97:
 2684               		.cfi_def_cfa_offset 3
 2685               		.cfi_offset 28, -2
 2686 0ea2 DF93      		push r29
 2687               	.LCFI98:
 2688               		.cfi_def_cfa_offset 4
 2689               		.cfi_offset 29, -3
 2690 0ea4 00D0      		rcall .
 2691               	.LCFI99:
 2692               		.cfi_def_cfa_offset 6
 2693 0ea6 CDB7      		in r28,__SP_L__
 2694 0ea8 DEB7      		in r29,__SP_H__
 2695               	.LCFI100:
 2696               		.cfi_def_cfa_register 28
 2697               	/* prologue: function */
 2698               	/* frame size = 2 */
 2699               	/* stack size = 4 */
 2700               	.L__stack_usage = 4
 588:ServerLLDN.c  **** 	switch (appState){
 2701               		.loc 6 588 0
 2702 0eaa 8091 0000 		lds r24,appState
 2703 0eae 882F      		mov r24,r24
 2704 0eb0 90E0      		ldi r25,0
 2705 0eb2 8230      		cpi r24,2
 2706 0eb4 9105      		cpc r25,__zero_reg__
 2707 0eb6 01F0      		breq .L64
 2708 0eb8 8330      		cpi r24,3
 2709 0eba 9105      		cpc r25,__zero_reg__
 2710 0ebc 01F0      		breq .L65
 2711 0ebe 892B      		or r24,r25
 2712 0ec0 01F0      		breq .L66
 589:ServerLLDN.c  **** 		case APP_STATE_INITIAL:
 590:ServerLLDN.c  **** 		{
 591:ServerLLDN.c  **** 			appInit();
 592:ServerLLDN.c  **** 			#if APP_COORDINATOR
 593:ServerLLDN.c  **** 				appState = APP_STATE_ATT_PAN_STATE;
 594:ServerLLDN.c  **** 			#else
 595:ServerLLDN.c  **** 				appState = APP_STATE_IDLE;
 596:ServerLLDN.c  **** 			#endif
 597:ServerLLDN.c  **** 			break;
 598:ServerLLDN.c  **** 		}
 599:ServerLLDN.c  **** 		case APP_STATE_SEND:
 600:ServerLLDN.c  **** 		{
 601:ServerLLDN.c  **** 			appSendData();
 602:ServerLLDN.c  **** 			#if APP_COORDINATOR
 603:ServerLLDN.c  **** 				/* Every time a message is send updates coordinator to prepare next message */
 604:ServerLLDN.c  **** 				appState = APP_STATE_ATT_PAN_STATE;
 605:ServerLLDN.c  **** 			#else
 606:ServerLLDN.c  **** 				appState = APP_STATE_IDLE;
 607:ServerLLDN.c  **** 			#endif
 608:ServerLLDN.c  **** 			break;
 609:ServerLLDN.c  **** 		}
 610:ServerLLDN.c  **** 		#if APP_COORDINATOR // COORDINATOR SPECIFIC STATE MACHINE
 611:ServerLLDN.c  **** 		case APP_STATE_ATT_PAN_STATE:
 612:ServerLLDN.c  **** 		{
 613:ServerLLDN.c  **** 			switch(appPanState)
 614:ServerLLDN.c  **** 			{
 615:ServerLLDN.c  **** 				/* Prepare beacon to desassociate all nodes */
 616:ServerLLDN.c  **** 				case APP_PAN_STATE_RESET:
 617:ServerLLDN.c  **** 				{
 618:ServerLLDN.c  **** 					appPanReset();
 619:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 620:ServerLLDN.c  **** 					appState	= APP_STATE_SEND;
 621:ServerLLDN.c  **** 					cycles_counter = 0;
 622:ServerLLDN.c  **** 					break;
 623:ServerLLDN.c  **** 				}
 624:ServerLLDN.c  **** 				/* Prepare first Beacon of Discovery */
 625:ServerLLDN.c  **** 				case APP_PAN_STATE_DISC_INITIAL:
 626:ServerLLDN.c  **** 				{
 627:ServerLLDN.c  **** 					/* if nodes associated is equal to expected number of associated nodes stop association proces
 628:ServerLLDN.c  **** 					 * this implementation was done as is to be used in tests, for real network functionality 
 629:ServerLLDN.c  **** 					 * the number of max association processes must be done through macLLDNdiscoveryModeTimeout
 630:ServerLLDN.c  **** 					 */
 631:ServerLLDN.c  **** 					if(counter_associados == NODOS_ASSOCIADOS_ESPERADOS || cycles_counter >= 2)
 632:ServerLLDN.c  **** 					{	
 633:ServerLLDN.c  **** 						printf("\n%d, %d", cycles_counter, counter_associados);
 634:ServerLLDN.c  **** 						counter_associados = 0;
 635:ServerLLDN.c  **** 						/* if all nodes expected where associated stop beacon generation interruptions */
 636:ServerLLDN.c  **** 						// macsc_disable_cmp_int(MACSC_CC1);
 637:ServerLLDN.c  **** 						macsc_disable_cmp_int(MACSC_CC2);
 638:ServerLLDN.c  **** 						msgReq.options = 0;
 639:ServerLLDN.c  **** 						/* set coordinator node to idle further implementation of online state must be done */
 640:ServerLLDN.c  **** 						appState = APP_STATE_IDLE;
 641:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_ONLINE_INITIAL; // APP_PAN_STATE_ONLINE_INIT
 642:ServerLLDN.c  **** 						cycles_counter = NUMERO_CICLOS_ONLINE;
 643:ServerLLDN.c  **** 					}
 644:ServerLLDN.c  **** 					/* if not all nodes expected where associated run through association process again */
 645:ServerLLDN.c  **** 					else 
 646:ServerLLDN.c  **** 					{
 647:ServerLLDN.c  **** 						/* prepare beacon message and start timers for beacon */
 648:ServerLLDN.c  **** 						appPanDiscInit();
 649:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 650:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_DISC_SECOND_BE;
 651:ServerLLDN.c  **** 					}
 652:ServerLLDN.c  **** 					break;
 653:ServerLLDN.c  **** 				}
 654:ServerLLDN.c  **** 				case APP_PAN_STATE_DISC_SECOND_BE:
 655:ServerLLDN.c  **** 				{
 656:ServerLLDN.c  **** 					/* Prepares message as: Discovery Beacon and Second Beacon */
 657:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_DISCOVERY_STATE | NWK_OPT_SECOND_BEACON ;
 658:ServerLLDN.c  **** 					msgReq.data = NULL;
 659:ServerLLDN.c  **** 					msgReq.size = 0;
 660:ServerLLDN.c  **** 					
 661:ServerLLDN.c  **** 					appState	= APP_PAN_STATE_DISC_PREPARE_ACK;
 662:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_PREPARE_ACK;
 663:ServerLLDN.c  **** 					break;
 664:ServerLLDN.c  **** 				}
 665:ServerLLDN.c  **** 				case APP_PAN_STATE_DISC_PREPARE_ACK:
 666:ServerLLDN.c  **** 				{
 667:ServerLLDN.c  **** 					/* This timer implements a delay between messages, 
 668:ServerLLDN.c  **** 					 * if not used the nodes are not able to receive the message
 669:ServerLLDN.c  **** 					 */
 670:ServerLLDN.c  **** 					appPanPrepareACK();
 671:ServerLLDN.c  **** 					SYS_TimerStart(&tmrDelay);
 672:ServerLLDN.c  **** 					
 673:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_CONFIG_INITIAL;
 674:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 675:ServerLLDN.c  **** 					break;
 676:ServerLLDN.c  **** 				}
 677:ServerLLDN.c  **** 				case APP_PAN_STATE_CONFIG_INITIAL:
 678:ServerLLDN.c  **** 				{
 679:ServerLLDN.c  **** 					/* Prepares the message as: Configuration Beacon and First State Beacon */
 680:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_CONFIG_STATE;
 681:ServerLLDN.c  **** 					msgReq.data = NULL;
 682:ServerLLDN.c  **** 					msgReq.size = 0;
 683:ServerLLDN.c  **** 					
 684:ServerLLDN.c  **** 					appState	= APP_STATE_IDLE;
 685:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_CONFIG_SECOND_BEACON;
 686:ServerLLDN.c  **** 					break;
 687:ServerLLDN.c  **** 
 688:ServerLLDN.c  **** 				}
 689:ServerLLDN.c  **** 				case APP_PAN_STATE_CONFIG_SECOND_BEACON:
 690:ServerLLDN.c  **** 				{
 691:ServerLLDN.c  **** 					/* Prepares the message as: Configuration Beacon and Second State Beacon */
 692:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_CONFIG_STATE | NWK_OPT_SECOND_BEACON;
 693:ServerLLDN.c  **** 					msgReq.data = NULL;
 694:ServerLLDN.c  **** 					msgReq.size = 0;
 695:ServerLLDN.c  **** 					
 696:ServerLLDN.c  **** 					appState	= APP_STATE_IDLE;
 697:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 698:ServerLLDN.c  **** 					break;
 699:ServerLLDN.c  **** 				}
 700:ServerLLDN.c  **** 				case APP_PAN_STATE_SEND_CONF_REQUEST:
 701:ServerLLDN.c  **** 				{
 702:ServerLLDN.c  **** 
 703:ServerLLDN.c  **** 					if(conf_req_list != NULL)
 704:ServerLLDN.c  **** 					{
 705:ServerLLDN.c  **** 						CopyToConfigRequest();
 706:ServerLLDN.c  **** 						msgReq.options		= NWK_OPT_MAC_COMMAND;
 707:ServerLLDN.c  **** 						msgReq.data			= (uint8_t*)&config_request_frame;
 708:ServerLLDN.c  **** 						msgReq.size			= sizeof(NWK_ConfigRequest_t);
 709:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 710:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 711:ServerLLDN.c  **** 						
 712:ServerLLDN.c  **** 						counter_associados++;
 713:ServerLLDN.c  **** 						SYS_TimerStart(&tmrDelay);
 714:ServerLLDN.c  **** 					}
 715:ServerLLDN.c  **** 					else
 716:ServerLLDN.c  **** 					{
 717:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_CONFIG_THIRD_BEACON;
 718:ServerLLDN.c  **** 					}
 719:ServerLLDN.c  **** 					break;
 720:ServerLLDN.c  **** 				}
 721:ServerLLDN.c  **** 				case APP_PAN_STATE_CONFIG_THIRD_BEACON:
 722:ServerLLDN.c  **** 				{
 723:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_CONFIG_STATE | NWK_OPT_THIRD_BEACON;
 724:ServerLLDN.c  **** 					msgReq.data = NULL;
 725:ServerLLDN.c  **** 					msgReq.size = 0;
 726:ServerLLDN.c  **** 					
 727:ServerLLDN.c  **** 					appState	= APP_STATE_IDLE;
 728:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 729:ServerLLDN.c  **** 					cycles_counter++;	
 730:ServerLLDN.c  **** 					
 731:ServerLLDN.c  **** 					break;
 732:ServerLLDN.c  **** 				}
 733:ServerLLDN.c  **** 				case APP_PAN_STATE_ONLINE_INITIAL:
 734:ServerLLDN.c  **** 				{
 735:ServerLLDN.c  **** 					if(cycles_counter != 0)
 736:ServerLLDN.c  **** 					{
 737:ServerLLDN.c  **** 					appPanOnlineInit();
 738:ServerLLDN.c  **** 					appState = APP_STATE_SEND;
 739:ServerLLDN.c  **** 					#if !GROUP_ACK
 740:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_ONLINE_PREPARE_ACK;
 741:ServerLLDN.c  **** 					#else		
 742:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_CHECK_TS;
 743:ServerLLDN.c  **** 					#endif
 744:ServerLLDN.c  **** 					cycles_counter--;
 745:ServerLLDN.c  **** 					}
 746:ServerLLDN.c  **** 					break;
 747:ServerLLDN.c  **** 				}
 748:ServerLLDN.c  **** 				#if !GROUP_ACK
 749:ServerLLDN.c  **** 				case APP_PAN_STATE_ONLINE_PREPARE_ACK:
 750:ServerLLDN.c  **** 				{
 751:ServerLLDN.c  **** 					printf("\nackprepare");
 752:ServerLLDN.c  **** 					appPanPrepareACK();
 753:ServerLLDN.c  **** 					SYS_TimerStart(&tmrDelay);
 754:ServerLLDN.c  **** 										
 755:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_CHECK_TS;
 756:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 757:ServerLLDN.c  **** 				}
 758:ServerLLDN.c  **** 				#endif
 759:ServerLLDN.c  **** 				case APP_PAN_STATE_CHECK_TS:
 760:ServerLLDN.c  **** 				{
 761:ServerLLDN.c  **** 					if(timeslot_counter >= assTimeSlot)
 762:ServerLLDN.c  **** 					{
 763:ServerLLDN.c  **** 						if(!association_request)
 764:ServerLLDN.c  **** 						{
 765:ServerLLDN.c  **** 							macsc_set_cmp1_int_cb(end_of_association_delay_handler);
 766:ServerLLDN.c  **** 							macsc_disable_cmp_int(MACSC_CC1);
 767:ServerLLDN.c  **** 							macsc_enable_manual_bts();
 768:ServerLLDN.c  **** 							macsc_enable_cmp_int(MACSC_CC1);
 769:ServerLLDN.c  **** 							macsc_use_cmp(MACSC_RELATIVE_CMP, 5 * beaconInterval_association, MACSC_CC1);
 770:ServerLLDN.c  **** 						}
 771:ServerLLDN.c  **** 						else
 772:ServerLLDN.c  **** 						{
 773:ServerLLDN.c  **** 							printf("\nFim de um Perodo");
 774:ServerLLDN.c  **** 							macsc_disable_cmp_int(MACSC_CC1);
 775:ServerLLDN.c  **** 							macsc_disable_cmp_int(MACSC_CC2);
 776:ServerLLDN.c  **** 							
 777:ServerLLDN.c  **** 						}
 778:ServerLLDN.c  **** 						appState = APP_STATE_IDLE;
 779:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_IDLE;
 780:ServerLLDN.c  **** 					}
 781:ServerLLDN.c  **** 					else
 782:ServerLLDN.c  **** 					{
 783:ServerLLDN.c  **** 						if(msgReq.options = NWK_OPT_LLDN_ACK)
 784:ServerLLDN.c  **** 						{
 785:ServerLLDN.c  **** 							msgReq.options = 0;
 786:ServerLLDN.c  **** 							ACKFrame_size = 0;		
 787:ServerLLDN.c  **** 							for(int i = 0; i < 32; i++)
 788:ServerLLDN.c  **** 								ACKFrame.ackFlags[i] = 0;
 789:ServerLLDN.c  **** 						}
 790:ServerLLDN.c  **** 						/* check if coordinator received any message in last time slot, used to calculate success rat
 791:ServerLLDN.c  **** 						if(timeslot_counter >= 2*MacLLDNMgmtTS && !data_received)
 792:ServerLLDN.c  **** 							nodes_info_arr[timeslot_counter - 2*MacLLDNMgmtTS].msg_not_rec++;
 793:ServerLLDN.c  **** 						data_received = false;
 794:ServerLLDN.c  **** 						
 795:ServerLLDN.c  **** 						printf("\n------- slot %d --------", timeslot_counter);
 796:ServerLLDN.c  **** 						appState = APP_STATE_IDLE;
 797:ServerLLDN.c  **** 						timeslot_counter++;
 798:ServerLLDN.c  **** 					}
 799:ServerLLDN.c  **** 					break;
 800:ServerLLDN.c  **** 				}
 801:ServerLLDN.c  **** 				case APP_PAN_STATE_ONLINE_END_BE:
 802:ServerLLDN.c  **** 				{
 803:ServerLLDN.c  **** 					if(0)
 804:ServerLLDN.c  **** 					{
 805:ServerLLDN.c  **** 						// implementar as condies para entrar no processo de associao
 806:ServerLLDN.c  **** 					}
 807:ServerLLDN.c  **** 					else
 808:ServerLLDN.c  **** 					{
 809:ServerLLDN.c  **** 						// posso calcular esse valor no onlineinit, o tTS precisa ser recalculado, o seu valor muda n
 810:ServerLLDN.c  **** 						// pode voltar pro state_online_initial porque precisa reconfigurar os timers
 811:ServerLLDN.c  **** 						// precisa revisar o macsc_enable_manual_bts()
 812:ServerLLDN.c  **** 						/*
 813:ServerLLDN.c  **** 						int idle_time =  2 * numBaseTimeSlotperMgmt * (tTS) * 5 / (SYMBOL_TIME); // 5 is the total of
 814:ServerLLDN.c  **** 						macsc_set_cmp1_int_cb(lldn_server_beacon); // esta funo pode s mandar o beacon do online, 
 815:ServerLLDN.c  **** 						macsc_enable_manual_bts();
 816:ServerLLDN.c  **** 						macsc_enable_cmp_int(MACSC_CC1);
 817:ServerLLDN.c  **** 						macsc_use_cmp(MACSC_RELATIVE_CMP, idle_time, MACSC_CC1);
 818:ServerLLDN.c  **** 						*/
 819:ServerLLDN.c  **** 					}
 820:ServerLLDN.c  **** 					break;
 821:ServerLLDN.c  **** 				}
 822:ServerLLDN.c  **** 				case APP_PAN_STATE_IDLE:
 823:ServerLLDN.c  **** 				{
 824:ServerLLDN.c  **** 					msgReq.options = 0;
 825:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 826:ServerLLDN.c  **** 					break;
 827:ServerLLDN.c  **** 				}
 828:ServerLLDN.c  **** 			}
 829:ServerLLDN.c  **** 			break;	
 830:ServerLLDN.c  **** 		}
 831:ServerLLDN.c  **** 		#else // NODES SPECIFIC STATE MACHINE
 832:ServerLLDN.c  **** 		case APP_STATE_PREP_DISC_REPONSE:
 833:ServerLLDN.c  **** 		{
 834:ServerLLDN.c  **** 			appPrepareDiscoverResponse();
 835:ServerLLDN.c  **** 			appState = APP_STATE_IDLE;	
 836:ServerLLDN.c  **** 			break;
 837:ServerLLDN.c  **** 		}
 838:ServerLLDN.c  **** 		
 839:ServerLLDN.c  **** 		case APP_STATE_PREP_CONFIG_STATUS:
 840:ServerLLDN.c  **** 		{
 841:ServerLLDN.c  **** 			// se o nodo recebeu ack na fase do discovery prepara a mensagem de configuration status
 842:ServerLLDN.c  **** 			if(ack_received && rec_beacon->confSeqNumber == 0 && associated == 0) {
 843:ServerLLDN.c  **** 				appPrepareConfigurationStatus();
 844:ServerLLDN.c  **** 			}
 845:ServerLLDN.c  **** 			// se o nodo no recebeu desativa o timer e fica em idle
 846:ServerLLDN.c  **** 			else {
 847:ServerLLDN.c  **** 				#if MASTER_MACSC
 848:ServerLLDN.c  **** 				macsc_disable_cmp_int(MACSC_CC1);
 849:ServerLLDN.c  **** 				#else
 850:ServerLLDN.c  **** 				timer_stop();
 851:ServerLLDN.c  **** 				#endif
 852:ServerLLDN.c  **** 			}
 853:ServerLLDN.c  **** 			ack_received = 0;
 854:ServerLLDN.c  **** 			appState = APP_STATE_IDLE;
 855:ServerLLDN.c  **** 			break;
 856:ServerLLDN.c  **** 		}
 857:ServerLLDN.c  **** 		case APP_STATE_PREP_DATA_FRAME:
 858:ServerLLDN.c  **** 		{
 859:ServerLLDN.c  **** 			appPrepareDataFrame();
 860:ServerLLDN.c  **** 			appState = APP_STATE_IDLE;
 861:ServerLLDN.c  **** 		}
 862:ServerLLDN.c  **** 		#endif
 863:ServerLLDN.c  **** 		default:
 864:ServerLLDN.c  **** 		{
 865:ServerLLDN.c  **** 			break;
 2713               		.loc 6 865 0
 2714 0ec2 00C0      		rjmp .L67
 2715               	.L66:
 591:ServerLLDN.c  **** 			#if APP_COORDINATOR
 2716               		.loc 6 591 0
 2717 0ec4 0E94 0000 		call appInit
 593:ServerLLDN.c  **** 			#else
 2718               		.loc 6 593 0
 2719 0ec8 83E0      		ldi r24,lo8(3)
 2720 0eca 8093 0000 		sts appState,r24
 597:ServerLLDN.c  **** 		}
 2721               		.loc 6 597 0
 2722 0ece 00C0      		rjmp .L67
 2723               	.L64:
 601:ServerLLDN.c  **** 			#if APP_COORDINATOR
 2724               		.loc 6 601 0
 2725 0ed0 0E94 0000 		call appSendData
 604:ServerLLDN.c  **** 			#else
 2726               		.loc 6 604 0
 2727 0ed4 83E0      		ldi r24,lo8(3)
 2728 0ed6 8093 0000 		sts appState,r24
 608:ServerLLDN.c  **** 		}
 2729               		.loc 6 608 0
 2730 0eda 00C0      		rjmp .L67
 2731               	.L65:
 613:ServerLLDN.c  **** 			{
 2732               		.loc 6 613 0
 2733 0edc 8091 0000 		lds r24,appPanState
 2734 0ee0 882F      		mov r24,r24
 2735 0ee2 90E0      		ldi r25,0
 2736 0ee4 092E      		mov __tmp_reg__,r25
 2737 0ee6 000C      		lsl r0
 2738 0ee8 AA0B      		sbc r26,r26
 2739 0eea BB0B      		sbc r27,r27
 2740 0eec 40E0      		ldi r20,0
 2741 0eee 50E0      		ldi r21,0
 2742 0ef0 2CE0      		ldi r18,lo8(12)
 2743 0ef2 30E0      		ldi r19,0
 2744 0ef4 841B      		sub r24,r20
 2745 0ef6 950B      		sbc r25,r21
 2746 0ef8 2817      		cp r18,r24
 2747 0efa 3907      		cpc r19,r25
 2748 0efc 00F4      		brsh .+2
 2749 0efe 00C0      		rjmp .L96
 2750 0f00 8050      		subi r24,lo8(-(gs(.L70)))
 2751 0f02 9040      		sbci r25,hi8(-(gs(.L70)))
 2752 0f04 FC01      		movw r30,r24
 2753 0f06 0C94 0000 		jmp __tablejump2__
 2754               		.section	.progmem.gcc_sw_table,"a",@progbits
 2755               		.p2align	1
 2756               	.L70:
 2757 0000 0000      		.word gs(.L69)
 2758 0002 0000      		.word gs(.L71)
 2759 0004 0000      		.word gs(.L72)
 2760 0006 0000      		.word gs(.L73)
 2761 0008 0000      		.word gs(.L74)
 2762 000a 0000      		.word gs(.L75)
 2763 000c 0000      		.word gs(.L76)
 2764 000e 0000      		.word gs(.L77)
 2765 0010 0000      		.word gs(.L78)
 2766 0012 0000      		.word gs(.L79)
 2767 0014 0000      		.word gs(.L97)
 2768 0016 0000      		.word gs(.L81)
 2769 0018 0000      		.word gs(.L82)
 2770               		.text
 2771               	.L71:
 618:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 2772               		.loc 6 618 0
 2773 0f0a 0E94 0000 		call appPanReset
 619:ServerLLDN.c  **** 					appState	= APP_STATE_SEND;
 2774               		.loc 6 619 0
 2775 0f0e 82E0      		ldi r24,lo8(2)
 2776 0f10 8093 0000 		sts appPanState,r24
 620:ServerLLDN.c  **** 					cycles_counter = 0;
 2777               		.loc 6 620 0
 2778 0f14 82E0      		ldi r24,lo8(2)
 2779 0f16 8093 0000 		sts appState,r24
 621:ServerLLDN.c  **** 					break;
 2780               		.loc 6 621 0
 2781 0f1a 1092 0000 		sts cycles_counter,__zero_reg__
 622:ServerLLDN.c  **** 				}
 2782               		.loc 6 622 0
 2783 0f1e 00C0      		rjmp .L68
 2784               	.L72:
 631:ServerLLDN.c  **** 					{	
 2785               		.loc 6 631 0
 2786 0f20 8091 0000 		lds r24,counter_associados
 2787 0f24 9091 0000 		lds r25,counter_associados+1
 2788 0f28 0C97      		sbiw r24,12
 2789 0f2a 01F0      		breq .L83
 631:ServerLLDN.c  **** 					{	
 2790               		.loc 6 631 0 is_stmt 0 discriminator 1
 2791 0f2c 8091 0000 		lds r24,cycles_counter
 2792 0f30 8230      		cpi r24,lo8(2)
 2793 0f32 00F0      		brlo .L84
 2794               	.L83:
 633:ServerLLDN.c  **** 						counter_associados = 0;
 2795               		.loc 6 633 0 is_stmt 1
 2796 0f34 2091 0000 		lds r18,counter_associados
 2797 0f38 3091 0000 		lds r19,counter_associados+1
 2798 0f3c 8091 0000 		lds r24,cycles_counter
 2799 0f40 882F      		mov r24,r24
 2800 0f42 90E0      		ldi r25,0
 2801 0f44 432F      		mov r20,r19
 2802 0f46 4F93      		push r20
 2803 0f48 2F93      		push r18
 2804 0f4a 292F      		mov r18,r25
 2805 0f4c 2F93      		push r18
 2806 0f4e 8F93      		push r24
 2807 0f50 80E0      		ldi r24,lo8(.LC8)
 2808 0f52 90E0      		ldi r25,hi8(.LC8)
 2809 0f54 892F      		mov r24,r25
 2810 0f56 8F93      		push r24
 2811 0f58 80E0      		ldi r24,lo8(.LC8)
 2812 0f5a 90E0      		ldi r25,hi8(.LC8)
 2813 0f5c 8F93      		push r24
 2814 0f5e 0E94 0000 		call printf
 2815 0f62 0F90      		pop __tmp_reg__
 2816 0f64 0F90      		pop __tmp_reg__
 2817 0f66 0F90      		pop __tmp_reg__
 2818 0f68 0F90      		pop __tmp_reg__
 2819 0f6a 0F90      		pop __tmp_reg__
 2820 0f6c 0F90      		pop __tmp_reg__
 634:ServerLLDN.c  **** 						/* if all nodes expected where associated stop beacon generation interruptions */
 2821               		.loc 6 634 0
 2822 0f6e 1092 0000 		sts counter_associados+1,__zero_reg__
 2823 0f72 1092 0000 		sts counter_associados,__zero_reg__
 637:ServerLLDN.c  **** 						msgReq.options = 0;
 2824               		.loc 6 637 0
 2825 0f76 82E0      		ldi r24,lo8(2)
 2826 0f78 0E94 0000 		call macsc_disable_cmp_int
 638:ServerLLDN.c  **** 						/* set coordinator node to idle further implementation of online state must be done */
 2827               		.loc 6 638 0
 2828 0f7c 1092 0000 		sts msgReq+9+1,__zero_reg__
 2829 0f80 1092 0000 		sts msgReq+9,__zero_reg__
 640:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_ONLINE_INITIAL; // APP_PAN_STATE_ONLINE_INIT
 2830               		.loc 6 640 0
 2831 0f84 81E0      		ldi r24,lo8(1)
 2832 0f86 8093 0000 		sts appState,r24
 641:ServerLLDN.c  **** 						cycles_counter = NUMERO_CICLOS_ONLINE;
 2833               		.loc 6 641 0
 2834 0f8a 89E0      		ldi r24,lo8(9)
 2835 0f8c 8093 0000 		sts appPanState,r24
 642:ServerLLDN.c  **** 					}
 2836               		.loc 6 642 0
 2837 0f90 85E0      		ldi r24,lo8(5)
 2838 0f92 8093 0000 		sts cycles_counter,r24
 652:ServerLLDN.c  **** 				}
 2839               		.loc 6 652 0
 2840 0f96 00C0      		rjmp .L68
 2841               	.L84:
 648:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 2842               		.loc 6 648 0
 2843 0f98 0E94 0000 		call appPanDiscInit
 649:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_DISC_SECOND_BE;
 2844               		.loc 6 649 0
 2845 0f9c 81E0      		ldi r24,lo8(1)
 2846 0f9e 8093 0000 		sts appState,r24
 650:ServerLLDN.c  **** 					}
 2847               		.loc 6 650 0
 2848 0fa2 83E0      		ldi r24,lo8(3)
 2849 0fa4 8093 0000 		sts appPanState,r24
 652:ServerLLDN.c  **** 				}
 2850               		.loc 6 652 0
 2851 0fa8 00C0      		rjmp .L68
 2852               	.L73:
 657:ServerLLDN.c  **** 					msgReq.data = NULL;
 2853               		.loc 6 657 0
 2854 0faa 80E4      		ldi r24,lo8(64)
 2855 0fac 99E0      		ldi r25,lo8(9)
 2856 0fae 9093 0000 		sts msgReq+9+1,r25
 2857 0fb2 8093 0000 		sts msgReq+9,r24
 658:ServerLLDN.c  **** 					msgReq.size = 0;
 2858               		.loc 6 658 0
 2859 0fb6 1092 0000 		sts msgReq+13+1,__zero_reg__
 2860 0fba 1092 0000 		sts msgReq+13,__zero_reg__
 659:ServerLLDN.c  **** 					
 2861               		.loc 6 659 0
 2862 0fbe 1092 0000 		sts msgReq+15,__zero_reg__
 661:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_PREPARE_ACK;
 2863               		.loc 6 661 0
 2864 0fc2 84E0      		ldi r24,lo8(4)
 2865 0fc4 8093 0000 		sts appState,r24
 662:ServerLLDN.c  **** 					break;
 2866               		.loc 6 662 0
 2867 0fc8 84E0      		ldi r24,lo8(4)
 2868 0fca 8093 0000 		sts appPanState,r24
 663:ServerLLDN.c  **** 				}
 2869               		.loc 6 663 0
 2870 0fce 00C0      		rjmp .L68
 2871               	.L74:
 670:ServerLLDN.c  **** 					SYS_TimerStart(&tmrDelay);
 2872               		.loc 6 670 0
 2873 0fd0 0E94 0000 		call appPanPrepareACK
 671:ServerLLDN.c  **** 					
 2874               		.loc 6 671 0
 2875 0fd4 80E0      		ldi r24,lo8(tmrDelay)
 2876 0fd6 90E0      		ldi r25,hi8(tmrDelay)
 2877 0fd8 0E94 0000 		call SYS_TimerStart
 673:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 2878               		.loc 6 673 0
 2879 0fdc 85E0      		ldi r24,lo8(5)
 2880 0fde 8093 0000 		sts appPanState,r24
 674:ServerLLDN.c  **** 					break;
 2881               		.loc 6 674 0
 2882 0fe2 81E0      		ldi r24,lo8(1)
 2883 0fe4 8093 0000 		sts appState,r24
 675:ServerLLDN.c  **** 				}
 2884               		.loc 6 675 0
 2885 0fe8 00C0      		rjmp .L68
 2886               	.L75:
 680:ServerLLDN.c  **** 					msgReq.data = NULL;
 2887               		.loc 6 680 0
 2888 0fea 80E4      		ldi r24,lo8(64)
 2889 0fec 92E0      		ldi r25,lo8(2)
 2890 0fee 9093 0000 		sts msgReq+9+1,r25
 2891 0ff2 8093 0000 		sts msgReq+9,r24
 681:ServerLLDN.c  **** 					msgReq.size = 0;
 2892               		.loc 6 681 0
 2893 0ff6 1092 0000 		sts msgReq+13+1,__zero_reg__
 2894 0ffa 1092 0000 		sts msgReq+13,__zero_reg__
 682:ServerLLDN.c  **** 					
 2895               		.loc 6 682 0
 2896 0ffe 1092 0000 		sts msgReq+15,__zero_reg__
 684:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_CONFIG_SECOND_BEACON;
 2897               		.loc 6 684 0
 2898 1002 81E0      		ldi r24,lo8(1)
 2899 1004 8093 0000 		sts appState,r24
 685:ServerLLDN.c  **** 					break;
 2900               		.loc 6 685 0
 2901 1008 87E0      		ldi r24,lo8(7)
 2902 100a 8093 0000 		sts appPanState,r24
 686:ServerLLDN.c  **** 
 2903               		.loc 6 686 0
 2904 100e 00C0      		rjmp .L68
 2905               	.L77:
 692:ServerLLDN.c  **** 					msgReq.data = NULL;
 2906               		.loc 6 692 0
 2907 1010 80E4      		ldi r24,lo8(64)
 2908 1012 9AE0      		ldi r25,lo8(10)
 2909 1014 9093 0000 		sts msgReq+9+1,r25
 2910 1018 8093 0000 		sts msgReq+9,r24
 693:ServerLLDN.c  **** 					msgReq.size = 0;
 2911               		.loc 6 693 0
 2912 101c 1092 0000 		sts msgReq+13+1,__zero_reg__
 2913 1020 1092 0000 		sts msgReq+13,__zero_reg__
 694:ServerLLDN.c  **** 					
 2914               		.loc 6 694 0
 2915 1024 1092 0000 		sts msgReq+15,__zero_reg__
 696:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 2916               		.loc 6 696 0
 2917 1028 81E0      		ldi r24,lo8(1)
 2918 102a 8093 0000 		sts appState,r24
 697:ServerLLDN.c  **** 					break;
 2919               		.loc 6 697 0
 2920 102e 86E0      		ldi r24,lo8(6)
 2921 1030 8093 0000 		sts appPanState,r24
 698:ServerLLDN.c  **** 				}
 2922               		.loc 6 698 0
 2923 1034 00C0      		rjmp .L68
 2924               	.L76:
 703:ServerLLDN.c  **** 					{
 2925               		.loc 6 703 0
 2926 1036 8091 0000 		lds r24,conf_req_list
 2927 103a 9091 0000 		lds r25,conf_req_list+1
 2928 103e 892B      		or r24,r25
 2929 1040 01F0      		breq .L86
 705:ServerLLDN.c  **** 						msgReq.options		= NWK_OPT_MAC_COMMAND;
 2930               		.loc 6 705 0
 2931 1042 0E94 0000 		call CopyToConfigRequest
 706:ServerLLDN.c  **** 						msgReq.data			= (uint8_t*)&config_request_frame;
 2932               		.loc 6 706 0
 2933 1046 80E0      		ldi r24,0
 2934 1048 90E8      		ldi r25,lo8(-128)
 2935 104a 9093 0000 		sts msgReq+9+1,r25
 2936 104e 8093 0000 		sts msgReq+9,r24
 707:ServerLLDN.c  **** 						msgReq.size			= sizeof(NWK_ConfigRequest_t);
 2937               		.loc 6 707 0
 2938 1052 80E0      		ldi r24,lo8(config_request_frame)
 2939 1054 90E0      		ldi r25,hi8(config_request_frame)
 2940 1056 9093 0000 		sts msgReq+13+1,r25
 2941 105a 8093 0000 		sts msgReq+13,r24
 708:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 2942               		.loc 6 708 0
 2943 105e 86E0      		ldi r24,lo8(6)
 2944 1060 8093 0000 		sts msgReq+15,r24
 709:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 2945               		.loc 6 709 0
 2946 1064 81E0      		ldi r24,lo8(1)
 2947 1066 8093 0000 		sts appState,r24
 710:ServerLLDN.c  **** 						
 2948               		.loc 6 710 0
 2949 106a 86E0      		ldi r24,lo8(6)
 2950 106c 8093 0000 		sts appPanState,r24
 712:ServerLLDN.c  **** 						SYS_TimerStart(&tmrDelay);
 2951               		.loc 6 712 0
 2952 1070 8091 0000 		lds r24,counter_associados
 2953 1074 9091 0000 		lds r25,counter_associados+1
 2954 1078 0196      		adiw r24,1
 2955 107a 9093 0000 		sts counter_associados+1,r25
 2956 107e 8093 0000 		sts counter_associados,r24
 713:ServerLLDN.c  **** 					}
 2957               		.loc 6 713 0
 2958 1082 80E0      		ldi r24,lo8(tmrDelay)
 2959 1084 90E0      		ldi r25,hi8(tmrDelay)
 2960 1086 0E94 0000 		call SYS_TimerStart
 719:ServerLLDN.c  **** 				}
 2961               		.loc 6 719 0
 2962 108a 00C0      		rjmp .L68
 2963               	.L86:
 717:ServerLLDN.c  **** 					}
 2964               		.loc 6 717 0
 2965 108c 88E0      		ldi r24,lo8(8)
 2966 108e 8093 0000 		sts appPanState,r24
 719:ServerLLDN.c  **** 				}
 2967               		.loc 6 719 0
 2968 1092 00C0      		rjmp .L68
 2969               	.L78:
 723:ServerLLDN.c  **** 					msgReq.data = NULL;
 2970               		.loc 6 723 0
 2971 1094 80E4      		ldi r24,lo8(64)
 2972 1096 92E1      		ldi r25,lo8(18)
 2973 1098 9093 0000 		sts msgReq+9+1,r25
 2974 109c 8093 0000 		sts msgReq+9,r24
 724:ServerLLDN.c  **** 					msgReq.size = 0;
 2975               		.loc 6 724 0
 2976 10a0 1092 0000 		sts msgReq+13+1,__zero_reg__
 2977 10a4 1092 0000 		sts msgReq+13,__zero_reg__
 725:ServerLLDN.c  **** 					
 2978               		.loc 6 725 0
 2979 10a8 1092 0000 		sts msgReq+15,__zero_reg__
 727:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 2980               		.loc 6 727 0
 2981 10ac 81E0      		ldi r24,lo8(1)
 2982 10ae 8093 0000 		sts appState,r24
 728:ServerLLDN.c  **** 					cycles_counter++;	
 2983               		.loc 6 728 0
 2984 10b2 82E0      		ldi r24,lo8(2)
 2985 10b4 8093 0000 		sts appPanState,r24
 729:ServerLLDN.c  **** 					
 2986               		.loc 6 729 0
 2987 10b8 8091 0000 		lds r24,cycles_counter
 2988 10bc 8F5F      		subi r24,lo8(-(1))
 2989 10be 8093 0000 		sts cycles_counter,r24
 731:ServerLLDN.c  **** 				}
 2990               		.loc 6 731 0
 2991 10c2 00C0      		rjmp .L68
 2992               	.L79:
 735:ServerLLDN.c  **** 					{
 2993               		.loc 6 735 0
 2994 10c4 8091 0000 		lds r24,cycles_counter
 2995 10c8 8823      		tst r24
 2996 10ca 01F4      		brne .+2
 2997 10cc 00C0      		rjmp .L98
 737:ServerLLDN.c  **** 					appState = APP_STATE_SEND;
 2998               		.loc 6 737 0
 2999 10ce 0E94 0000 		call appPanOnlineInit
 738:ServerLLDN.c  **** 					#if !GROUP_ACK
 3000               		.loc 6 738 0
 3001 10d2 82E0      		ldi r24,lo8(2)
 3002 10d4 8093 0000 		sts appState,r24
 740:ServerLLDN.c  **** 					#else		
 3003               		.loc 6 740 0
 3004 10d8 8BE0      		ldi r24,lo8(11)
 3005 10da 8093 0000 		sts appPanState,r24
 744:ServerLLDN.c  **** 					}
 3006               		.loc 6 744 0
 3007 10de 8091 0000 		lds r24,cycles_counter
 3008 10e2 8150      		subi r24,lo8(-(-1))
 3009 10e4 8093 0000 		sts cycles_counter,r24
 746:ServerLLDN.c  **** 				}
 3010               		.loc 6 746 0
 3011 10e8 00C0      		rjmp .L98
 3012               	.L81:
 751:ServerLLDN.c  **** 					appPanPrepareACK();
 3013               		.loc 6 751 0
 3014 10ea 80E0      		ldi r24,lo8(.LC9)
 3015 10ec 90E0      		ldi r25,hi8(.LC9)
 3016 10ee 892F      		mov r24,r25
 3017 10f0 8F93      		push r24
 3018 10f2 80E0      		ldi r24,lo8(.LC9)
 3019 10f4 90E0      		ldi r25,hi8(.LC9)
 3020 10f6 8F93      		push r24
 3021 10f8 0E94 0000 		call printf
 3022 10fc 0F90      		pop __tmp_reg__
 3023 10fe 0F90      		pop __tmp_reg__
 752:ServerLLDN.c  **** 					SYS_TimerStart(&tmrDelay);
 3024               		.loc 6 752 0
 3025 1100 0E94 0000 		call appPanPrepareACK
 753:ServerLLDN.c  **** 										
 3026               		.loc 6 753 0
 3027 1104 80E0      		ldi r24,lo8(tmrDelay)
 3028 1106 90E0      		ldi r25,hi8(tmrDelay)
 3029 1108 0E94 0000 		call SYS_TimerStart
 755:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 3030               		.loc 6 755 0
 3031 110c 8CE0      		ldi r24,lo8(12)
 3032 110e 8093 0000 		sts appPanState,r24
 756:ServerLLDN.c  **** 				}
 3033               		.loc 6 756 0
 3034 1112 81E0      		ldi r24,lo8(1)
 3035 1114 8093 0000 		sts appState,r24
 3036               	.L82:
 761:ServerLLDN.c  **** 					{
 3037               		.loc 6 761 0
 3038 1118 8091 0000 		lds r24,timeslot_counter
 3039 111c 282F      		mov r18,r24
 3040 111e 30E0      		ldi r19,0
 3041 1120 8091 0000 		lds r24,assTimeSlot
 3042 1124 9091 0000 		lds r25,assTimeSlot+1
 3043 1128 2817      		cp r18,r24
 3044 112a 3907      		cpc r19,r25
 3045 112c 04F4      		brge .+2
 3046 112e 00C0      		rjmp .L89
 763:ServerLLDN.c  **** 						{
 3047               		.loc 6 763 0
 3048 1130 9091 0000 		lds r25,association_request
 3049 1134 81E0      		ldi r24,lo8(1)
 3050 1136 8927      		eor r24,r25
 3051 1138 8823      		tst r24
 3052 113a 01F0      		breq .L90
 765:ServerLLDN.c  **** 							macsc_disable_cmp_int(MACSC_CC1);
 3053               		.loc 6 765 0
 3054 113c 80E0      		ldi r24,lo8(gs(end_of_association_delay_handler))
 3055 113e 90E0      		ldi r25,hi8(gs(end_of_association_delay_handler))
 3056 1140 0E94 0000 		call macsc_set_cmp1_int_cb
 766:ServerLLDN.c  **** 							macsc_enable_manual_bts();
 3057               		.loc 6 766 0
 3058 1144 81E0      		ldi r24,lo8(1)
 3059 1146 0E94 0000 		call macsc_disable_cmp_int
 767:ServerLLDN.c  **** 							macsc_enable_cmp_int(MACSC_CC1);
 3060               		.loc 6 767 0
 3061 114a 0E94 0000 		call macsc_enable_manual_bts
 768:ServerLLDN.c  **** 							macsc_use_cmp(MACSC_RELATIVE_CMP, 5 * beaconInterval_association, MACSC_CC1);
 3062               		.loc 6 768 0
 3063 114e 81E0      		ldi r24,lo8(1)
 3064 1150 0E94 0000 		call macsc_enable_cmp_int
 769:ServerLLDN.c  **** 						}
 3065               		.loc 6 769 0
 3066 1154 8091 0000 		lds r24,beaconInterval_association
 3067 1158 9091 0000 		lds r25,beaconInterval_association+1
 3068 115c A091 0000 		lds r26,beaconInterval_association+2
 3069 1160 B091 0000 		lds r27,beaconInterval_association+3
 3070 1164 20E0      		ldi r18,0
 3071 1166 30E0      		ldi r19,0
 3072 1168 40EA      		ldi r20,lo8(-96)
 3073 116a 50E4      		ldi r21,lo8(64)
 3074 116c BC01      		movw r22,r24
 3075 116e CD01      		movw r24,r26
 3076 1170 0E94 0000 		call __mulsf3
 3077 1174 DC01      		movw r26,r24
 3078 1176 CB01      		movw r24,r22
 3079 1178 BC01      		movw r22,r24
 3080 117a CD01      		movw r24,r26
 3081 117c 0E94 0000 		call __fixunssfsi
 3082 1180 DC01      		movw r26,r24
 3083 1182 CB01      		movw r24,r22
 3084 1184 21E0      		ldi r18,lo8(1)
 3085 1186 AC01      		movw r20,r24
 3086 1188 BD01      		movw r22,r26
 3087 118a 81E0      		ldi r24,lo8(1)
 3088 118c 0E94 0000 		call macsc_use_cmp
 3089 1190 00C0      		rjmp .L91
 3090               	.L90:
 773:ServerLLDN.c  **** 							macsc_disable_cmp_int(MACSC_CC1);
 3091               		.loc 6 773 0
 3092 1192 80E0      		ldi r24,lo8(.LC10)
 3093 1194 90E0      		ldi r25,hi8(.LC10)
 3094 1196 892F      		mov r24,r25
 3095 1198 8F93      		push r24
 3096 119a 80E0      		ldi r24,lo8(.LC10)
 3097 119c 90E0      		ldi r25,hi8(.LC10)
 3098 119e 8F93      		push r24
 3099 11a0 0E94 0000 		call printf
 3100 11a4 0F90      		pop __tmp_reg__
 3101 11a6 0F90      		pop __tmp_reg__
 774:ServerLLDN.c  **** 							macsc_disable_cmp_int(MACSC_CC2);
 3102               		.loc 6 774 0
 3103 11a8 81E0      		ldi r24,lo8(1)
 3104 11aa 0E94 0000 		call macsc_disable_cmp_int
 775:ServerLLDN.c  **** 							
 3105               		.loc 6 775 0
 3106 11ae 82E0      		ldi r24,lo8(2)
 3107 11b0 0E94 0000 		call macsc_disable_cmp_int
 3108               	.L91:
 778:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_IDLE;
 3109               		.loc 6 778 0
 3110 11b4 81E0      		ldi r24,lo8(1)
 3111 11b6 8093 0000 		sts appState,r24
 779:ServerLLDN.c  **** 					}
 3112               		.loc 6 779 0
 3113 11ba 1092 0000 		sts appPanState,__zero_reg__
 799:ServerLLDN.c  **** 				}
 3114               		.loc 6 799 0
 3115 11be 00C0      		rjmp .L68
 3116               	.L89:
 783:ServerLLDN.c  **** 						{
 3117               		.loc 6 783 0
 3118 11c0 80E0      		ldi r24,0
 3119 11c2 90E4      		ldi r25,lo8(64)
 3120 11c4 9093 0000 		sts msgReq+9+1,r25
 3121 11c8 8093 0000 		sts msgReq+9,r24
 785:ServerLLDN.c  **** 							ACKFrame_size = 0;		
 3122               		.loc 6 785 0
 3123 11cc 1092 0000 		sts msgReq+9+1,__zero_reg__
 3124 11d0 1092 0000 		sts msgReq+9,__zero_reg__
 786:ServerLLDN.c  **** 							for(int i = 0; i < 32; i++)
 3125               		.loc 6 786 0
 3126 11d4 1092 0000 		sts ACKFrame_size+1,__zero_reg__
 3127 11d8 1092 0000 		sts ACKFrame_size,__zero_reg__
 3128               	.LBB11:
 787:ServerLLDN.c  **** 								ACKFrame.ackFlags[i] = 0;
 3129               		.loc 6 787 0
 3130 11dc 1A82      		std Y+2,__zero_reg__
 3131 11de 1982      		std Y+1,__zero_reg__
 3132 11e0 00C0      		rjmp .L93
 3133               	.L94:
 788:ServerLLDN.c  **** 						}
 3134               		.loc 6 788 0 discriminator 3
 3135 11e2 8981      		ldd r24,Y+1
 3136 11e4 9A81      		ldd r25,Y+2
 3137 11e6 8050      		subi r24,lo8(-(ACKFrame+1))
 3138 11e8 9040      		sbci r25,hi8(-(ACKFrame+1))
 3139 11ea FC01      		movw r30,r24
 3140 11ec 1082      		st Z,__zero_reg__
 787:ServerLLDN.c  **** 								ACKFrame.ackFlags[i] = 0;
 3141               		.loc 6 787 0 discriminator 3
 3142 11ee 8981      		ldd r24,Y+1
 3143 11f0 9A81      		ldd r25,Y+2
 3144 11f2 0196      		adiw r24,1
 3145 11f4 9A83      		std Y+2,r25
 3146 11f6 8983      		std Y+1,r24
 3147               	.L93:
 787:ServerLLDN.c  **** 								ACKFrame.ackFlags[i] = 0;
 3148               		.loc 6 787 0 is_stmt 0 discriminator 1
 3149 11f8 8981      		ldd r24,Y+1
 3150 11fa 9A81      		ldd r25,Y+2
 3151 11fc 8097      		sbiw r24,32
 3152 11fe 04F0      		brlt .L94
 3153               	.LBE11:
 791:ServerLLDN.c  **** 							nodes_info_arr[timeslot_counter - 2*MacLLDNMgmtTS].msg_not_rec++;
 3154               		.loc 6 791 0 is_stmt 1
 3155 1200 8091 0000 		lds r24,timeslot_counter
 3156 1204 8230      		cpi r24,lo8(2)
 3157 1206 00F0      		brlo .L95
 791:ServerLLDN.c  **** 							nodes_info_arr[timeslot_counter - 2*MacLLDNMgmtTS].msg_not_rec++;
 3158               		.loc 6 791 0 is_stmt 0 discriminator 1
 3159 1208 9091 0000 		lds r25,data_received
 3160 120c 81E0      		ldi r24,lo8(1)
 3161 120e 8927      		eor r24,r25
 3162 1210 8823      		tst r24
 3163 1212 01F0      		breq .L95
 792:ServerLLDN.c  **** 						data_received = false;
 3164               		.loc 6 792 0 is_stmt 1
 3165 1214 8091 0000 		lds r24,timeslot_counter
 3166 1218 882F      		mov r24,r24
 3167 121a 90E0      		ldi r25,0
 3168 121c 0297      		sbiw r24,2
 3169 121e 4AE4      		ldi r20,lo8(74)
 3170 1220 489F      		mul r20,r24
 3171 1222 9001      		movw r18,r0
 3172 1224 499F      		mul r20,r25
 3173 1226 300D      		add r19,r0
 3174 1228 1124      		clr __zero_reg__
 3175 122a 2050      		subi r18,lo8(-(nodes_info_arr+71))
 3176 122c 3040      		sbci r19,hi8(-(nodes_info_arr+71))
 3177 122e F901      		movw r30,r18
 3178 1230 2081      		ld r18,Z
 3179 1232 3181      		ldd r19,Z+1
 3180 1234 2F5F      		subi r18,-1
 3181 1236 3F4F      		sbci r19,-1
 3182 1238 6AE4      		ldi r22,lo8(74)
 3183 123a 689F      		mul r22,r24
 3184 123c A001      		movw r20,r0
 3185 123e 699F      		mul r22,r25
 3186 1240 500D      		add r21,r0
 3187 1242 1124      		clr __zero_reg__
 3188 1244 CA01      		movw r24,r20
 3189 1246 8050      		subi r24,lo8(-(nodes_info_arr+71))
 3190 1248 9040      		sbci r25,hi8(-(nodes_info_arr+71))
 3191 124a FC01      		movw r30,r24
 3192 124c 3183      		std Z+1,r19
 3193 124e 2083      		st Z,r18
 3194               	.L95:
 793:ServerLLDN.c  **** 						
 3195               		.loc 6 793 0
 3196 1250 1092 0000 		sts data_received,__zero_reg__
 795:ServerLLDN.c  **** 						appState = APP_STATE_IDLE;
 3197               		.loc 6 795 0
 3198 1254 8091 0000 		lds r24,timeslot_counter
 3199 1258 882F      		mov r24,r24
 3200 125a 90E0      		ldi r25,0
 3201 125c 292F      		mov r18,r25
 3202 125e 2F93      		push r18
 3203 1260 8F93      		push r24
 3204 1262 80E0      		ldi r24,lo8(.LC11)
 3205 1264 90E0      		ldi r25,hi8(.LC11)
 3206 1266 892F      		mov r24,r25
 3207 1268 8F93      		push r24
 3208 126a 80E0      		ldi r24,lo8(.LC11)
 3209 126c 90E0      		ldi r25,hi8(.LC11)
 3210 126e 8F93      		push r24
 3211 1270 0E94 0000 		call printf
 3212 1274 0F90      		pop __tmp_reg__
 3213 1276 0F90      		pop __tmp_reg__
 3214 1278 0F90      		pop __tmp_reg__
 3215 127a 0F90      		pop __tmp_reg__
 796:ServerLLDN.c  **** 						timeslot_counter++;
 3216               		.loc 6 796 0
 3217 127c 81E0      		ldi r24,lo8(1)
 3218 127e 8093 0000 		sts appState,r24
 797:ServerLLDN.c  **** 					}
 3219               		.loc 6 797 0
 3220 1282 8091 0000 		lds r24,timeslot_counter
 3221 1286 8F5F      		subi r24,lo8(-(1))
 3222 1288 8093 0000 		sts timeslot_counter,r24
 799:ServerLLDN.c  **** 				}
 3223               		.loc 6 799 0
 3224 128c 00C0      		rjmp .L68
 3225               	.L69:
 824:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 3226               		.loc 6 824 0
 3227 128e 1092 0000 		sts msgReq+9+1,__zero_reg__
 3228 1292 1092 0000 		sts msgReq+9,__zero_reg__
 825:ServerLLDN.c  **** 					break;
 3229               		.loc 6 825 0
 3230 1296 81E0      		ldi r24,lo8(1)
 3231 1298 8093 0000 		sts appState,r24
 826:ServerLLDN.c  **** 				}
 3232               		.loc 6 826 0
 3233 129c 00C0      		rjmp .L68
 3234               	.L97:
 820:ServerLLDN.c  **** 				}
 3235               		.loc 6 820 0
 3236 129e 0000      		nop
 3237 12a0 00C0      		rjmp .L96
 3238               	.L98:
 746:ServerLLDN.c  **** 				}
 3239               		.loc 6 746 0
 3240 12a2 0000      		nop
 3241               	.L68:
 3242               	.L96:
 829:ServerLLDN.c  **** 		}
 3243               		.loc 6 829 0
 3244 12a4 0000      		nop
 3245               	.L67:
 866:ServerLLDN.c  **** 		}
 867:ServerLLDN.c  **** 	}
 868:ServerLLDN.c  **** }
 3246               		.loc 6 868 0
 3247 12a6 0000      		nop
 3248               	/* epilogue start */
 3249 12a8 0F90      		pop __tmp_reg__
 3250 12aa 0F90      		pop __tmp_reg__
 3251 12ac DF91      		pop r29
 3252 12ae CF91      		pop r28
 3253 12b0 0895      		ret
 3254               		.cfi_endproc
 3255               	.LFE146:
 3257               		.section	.rodata
 3258               	.LC0:
 3259 0096 00        		.byte	0
 3260 0097 C2        		.byte	-62
 3261 0098 01        		.byte	1
 3262 0099 00        		.byte	0
 3263 009a 03        		.byte	3
 3264 009b 00        		.byte	0
 3265 009c 00        		.byte	0
 3266               		.text
 3267               	.global	main
 3269               	main:
 3270               	.LFB147:
 869:ServerLLDN.c  **** 
 870:ServerLLDN.c  **** 	/*****************************************************************************
 871:ServerLLDN.c  **** 	*****************************************************************************/
 872:ServerLLDN.c  **** 	int main(void)
 873:ServerLLDN.c  **** 	{
 3271               		.loc 6 873 0
 3272               		.cfi_startproc
 3273 12b2 0F93      		push r16
 3274               	.LCFI101:
 3275               		.cfi_def_cfa_offset 3
 3276               		.cfi_offset 16, -2
 3277 12b4 1F93      		push r17
 3278               	.LCFI102:
 3279               		.cfi_def_cfa_offset 4
 3280               		.cfi_offset 17, -3
 3281 12b6 CF93      		push r28
 3282               	.LCFI103:
 3283               		.cfi_def_cfa_offset 5
 3284               		.cfi_offset 28, -4
 3285 12b8 DF93      		push r29
 3286               	.LCFI104:
 3287               		.cfi_def_cfa_offset 6
 3288               		.cfi_offset 29, -5
 3289 12ba CDB7      		in r28,__SP_L__
 3290 12bc DEB7      		in r29,__SP_H__
 3291               	.LCFI105:
 3292               		.cfi_def_cfa_register 28
 3293 12be 2797      		sbiw r28,7
 3294               	.LCFI106:
 3295               		.cfi_def_cfa_offset 13
 3296 12c0 0FB6      		in __tmp_reg__,__SREG__
 3297 12c2 F894      		cli
 3298 12c4 DEBF      		out __SP_H__,r29
 3299 12c6 0FBE      		out __SREG__,__tmp_reg__
 3300 12c8 CDBF      		out __SP_L__,r28
 3301               	/* prologue: function */
 3302               	/* frame size = 7 */
 3303               	/* stack size = 11 */
 3304               	.L__stack_usage = 11
 874:ServerLLDN.c  **** 		sysclk_init();
 3305               		.loc 6 874 0
 3306 12ca 0E94 0000 		call sysclk_init
 875:ServerLLDN.c  **** 		board_init();
 3307               		.loc 6 875 0
 3308 12ce 0E94 0000 		call board_init
 876:ServerLLDN.c  **** 
 877:ServerLLDN.c  **** 		SYS_Init();
 3309               		.loc 6 877 0
 3310 12d2 0E94 0000 		call SYS_Init
 878:ServerLLDN.c  **** 		/* Disable CSMA/CA
 879:ServerLLDN.c  **** 		 * Disable auto ACK
 880:ServerLLDN.c  **** 		 * Enable Rx of LLDN Frame Type as described in 802.15.4e - 2012 
 881:ServerLLDN.c  **** 		 */
 882:ServerLLDN.c  **** 
 883:ServerLLDN.c  **** 		sm_init();
 3311               		.loc 6 883 0
 3312 12d6 0E94 0000 		call sm_init
 884:ServerLLDN.c  **** 
 885:ServerLLDN.c  **** 		// Initialize interrupt vector table support.
 886:ServerLLDN.c  **** 	#if (SIO2HOST_CHANNEL == SIO_USB)
 887:ServerLLDN.c  **** 		irq_initialize_vectors();
 888:ServerLLDN.c  **** 	#endif
 889:ServerLLDN.c  **** 		cpu_irq_enable();
 3313               		.loc 6 889 0
 3314               	/* #APP */
 3315               	 ;  889 "ServerLLDN.c" 1
 3316 12da 7894      		sei
 3317               	 ;  0 "" 2
 890:ServerLLDN.c  **** 
 891:ServerLLDN.c  **** 	#if 1
 892:ServerLLDN.c  **** 	#if (SIO2HOST_CHANNEL == SIO_USB)
 893:ServerLLDN.c  **** 		stdio_usb_init();
 894:ServerLLDN.c  **** 	#else
 895:ServerLLDN.c  **** 		const usart_serial_options_t usart_serial_options =
 3318               		.loc 6 895 0
 3319               	/* #NOAPP */
 3320 12dc 27E0      		ldi r18,lo8(7)
 3321 12de E0E0      		ldi r30,lo8(.LC0)
 3322 12e0 F0E0      		ldi r31,hi8(.LC0)
 3323 12e2 CE01      		movw r24,r28
 3324 12e4 0196      		adiw r24,1
 3325 12e6 DC01      		movw r26,r24
 3326               		0:
 3327 12e8 0190      		ld r0,Z+
 3328 12ea 0D92      		st X+,r0
 3329 12ec 2A95      		dec r18
 3330 12ee 01F4      		brne 0b
 896:ServerLLDN.c  **** 		{
 897:ServerLLDN.c  **** 			.baudrate     = USART_HOST_BAUDRATE,
 898:ServerLLDN.c  **** 			.charlength   = USART_HOST_CHAR_LENGTH,
 899:ServerLLDN.c  **** 			.paritytype   = USART_HOST_PARITY,
 900:ServerLLDN.c  **** 			.stopbits     = USART_HOST_STOP_BITS
 901:ServerLLDN.c  **** 		};
 902:ServerLLDN.c  **** 
 903:ServerLLDN.c  **** 		stdio_serial_init(USART_HOST, &usart_serial_options);
 3331               		.loc 6 903 0
 3332 12f0 CE01      		movw r24,r28
 3333 12f2 0196      		adiw r24,1
 3334 12f4 BC01      		movw r22,r24
 3335 12f6 80EC      		ldi r24,lo8(-64)
 3336 12f8 90E0      		ldi r25,0
 3337 12fa 0E94 0000 		call stdio_serial_init
 904:ServerLLDN.c  **** 		usart_double_baud_enable(USART_HOST);
 3338               		.loc 6 904 0
 3339 12fe 80EC      		ldi r24,lo8(-64)
 3340 1300 90E0      		ldi r25,0
 3341 1302 0E94 0000 		call usart_double_baud_enable
 905:ServerLLDN.c  **** 		usart_set_baudrate_precalculated(USART_HOST, USART_HOST_BAUDRATE, sysclk_get_source_clock_hz());
 3342               		.loc 6 905 0
 3343 1306 0E94 0000 		call sysclk_get_source_clock_hz
 3344 130a DC01      		movw r26,r24
 3345 130c CB01      		movw r24,r22
 3346 130e 8C01      		movw r16,r24
 3347 1310 9D01      		movw r18,r26
 3348 1312 40E0      		ldi r20,0
 3349 1314 52EC      		ldi r21,lo8(-62)
 3350 1316 61E0      		ldi r22,lo8(1)
 3351 1318 70E0      		ldi r23,0
 3352 131a 80EC      		ldi r24,lo8(-64)
 3353 131c 90E0      		ldi r25,0
 3354 131e 0E94 0000 		call usart_set_baudrate_precalculated
 3355               	.L100:
 906:ServerLLDN.c  **** 
 907:ServerLLDN.c  **** 	#endif
 908:ServerLLDN.c  **** 	#endif
 909:ServerLLDN.c  **** 		for(;;)
 910:ServerLLDN.c  **** 		{
 911:ServerLLDN.c  **** 			SYS_TaskHandler();
 3356               		.loc 6 911 0 discriminator 1
 3357 1322 0E94 0000 		call SYS_TaskHandler
 912:ServerLLDN.c  **** 			APP_TaskHandler();
 3358               		.loc 6 912 0 discriminator 1
 3359 1326 0E94 0000 		call APP_TaskHandler
 913:ServerLLDN.c  **** 		}
 3360               		.loc 6 913 0 discriminator 1
 3361 132a 00C0      		rjmp .L100
 3362               		.cfi_endproc
 3363               	.LFE147:
 3365               	.Letext0:
 3366               		.file 7 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\avr8\\avr8-gnu-toolchain\\avr\\in
 3367               		.file 8 "../../../stack/LwMesh/TDMA/nwk/inc/nwkRx.h"
 3368               		.file 9 "../../../stack/LwMesh/TDMA/nwk/inc/nwkDataReq.h"
 3369               		.file 10 "../../../stack/LwMesh/TDMA/sys/inc/sysTimer.h"
 3370               		.file 11 "../../../platform/mega_rf/drivers/sleep/sleep.h"
 3371               		.file 12 "lldn.h"
 3372               		.file 13 "../../../platform/mega_rf/utils/status_codes.h"
 3373               		.file 14 "config/config.h"
 3374               		.file 15 "../../../platform/common/services/sleepmgr/mega_rf/sleepmgr.h"
DEFINED SYMBOLS
                            *ABS*:00000000 ServerLLDN.c
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:2      *ABS*:0000003e __SP_H__
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:3      *ABS*:0000003d __SP_L__
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:4      *ABS*:0000003f __SREG__
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:5      *ABS*:0000003b __RAMPZ__
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:6      *ABS*:00000000 __tmp_reg__
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:7      *ABS*:00000001 __zero_reg__
                            *COM*:00000001 n
                            *COM*:00000004 tTS
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:14     .text:00000000 sysclk_get_main_hz
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:51     .text:0000001a sysclk_get_source_clock_hz
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:88     .progmem.data.baudctrl_1mhz:00000000 baudctrl_1mhz
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:100    .progmem.data.baudctrl_8mhz:00000000 baudctrl_8mhz
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:112    .progmem.data.baudctrl_16mhz:00000000 baudctrl_16mhz
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:123    .text:00000034 usart_double_baud_enable
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:172    .text:00000062 usart_serial_init
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:267    .text:000000de usart_serial_putchar
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:311    .text:00000106 usart_serial_getchar
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:362    .text:0000013c stdio_serial_init
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:433    .text:0000019e macsc_enable_manual_bts
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:487    .bss.appState:00000000 appState
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:492    .bss.msgReq:00000000 msgReq
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:497    .bss.PanId:00000000 PanId
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:505    .text:000001d2 appSendData
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:567    .data.appPanState:00000000 appPanState
                            *COM*:00000e74 nodes_info_arr
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:574    .data.config_request_frame:00000000 config_request_frame
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:584    .bss.conf_req_list:00000000 conf_req_list
                            *COM*:00000021 ACKFrame
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:591    .bss.ACKFrame_size:00000000 ACKFrame_size
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:597    .bss.beaconInterval:00000000 beaconInterval
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:603    .bss.beaconInterval_association:00000000 beaconInterval_association
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:609    .bss.macLLDNnumUplinkTS:00000000 macLLDNnumUplinkTS
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:614    .bss.tmrDelay:00000000 tmrDelay
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:620    .bss.assTimeSlot:00000000 assTimeSlot
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:626    .bss.timeslot_counter:00000000 timeslot_counter
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:632    .bss.counter_associados:00000000 counter_associados
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:638    .data.cycles_counter:00000000 cycles_counter
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:644    .bss.association_request:00000000 association_request
                            *COM*:000019c8 msg_info_array
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:651    .bss.size_msg_info:00000000 size_msg_info
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:657    .bss.data_received:00000000 data_received
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:663    .bss.succes_rate:00000000 succes_rate
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:670    .text:0000021e tmrDelayHandler
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:721    .text:00000254 lldn_server_beacon
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:758    .text:0000026e time_slot_handler
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:822    .text:000002cc downlink_delay_handler
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:862    .text:000002f0 end_of_association_delay_handler
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:902    .text:0000030c addToAckArray
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:1048   .text:000003ea addConfRequestArray
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:1282   .text:00000586 CopyToConfigRequest
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:1371   .text:00000608 appCommandInd
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:1528   .text:000006e2 appDataInd
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:1939   .text:000009a2 appPanPrepareACK
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:1991   .text:000009e8 appPanReset
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:2200   .text:00000b30 appPanDiscInit
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:2388   .text:00000c9a appPanOnlineInit
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:2591   .text:00000e2a appInit
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:2678   .text:00000ea0 APP_TaskHandler
C:\Users\GUILHE~1\AppData\Local\Temp\ccDYoKrp.s:3269   .text:000012b2 main

UNDEFINED SYMBOLS
usart_init_rs232
usart_putchar
usart_getchar
stdio_base
ptr_put
ptr_get
_read
_write
fdevopen
printf
NWK_DataReq
__divsf3
__fixunssfsi
macsc_use_cmp
malloc
free
__floatsisf
__floatunsisf
__mulsf3
__addsf3
macsc_set_cmp1_int_cb
macsc_enable_cmp_int
NWK_OpenEndpoint
NWK_SetAddr
PHY_SetChannel
PHY_SetRxState
NWK_SetPanId
PHY_SetTdmaMode
PHY_SetPromiscuousMode
__tablejump2__
macsc_disable_cmp_int
SYS_TimerStart
sysclk_init
board_init
SYS_Init
sm_init
usart_set_baudrate_precalculated
SYS_TaskHandler
__do_copy_data
__do_clear_bss
