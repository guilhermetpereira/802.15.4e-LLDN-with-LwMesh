   1               		.file	"ServerLLDN.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.text
   9               	.Ltext0:
  10               		.cfi_sections	.debug_frame
  11               		.comm	n,1,1
  12               		.comm	tTS,4,1
  14               	sysclk_get_main_hz:
  15               	.LFB67:
  16               		.file 1 "../../../platform/common/services/clock/mega/sysclk.h"
   1:../../../platform/common/services/clock/mega/sysclk.h **** /**
   2:../../../platform/common/services/clock/mega/sysclk.h ****  * \file
   3:../../../platform/common/services/clock/mega/sysclk.h ****  *
   4:../../../platform/common/services/clock/mega/sysclk.h ****  * \brief Chip-specific system clock management functions
   5:../../../platform/common/services/clock/mega/sysclk.h ****  *
   6:../../../platform/common/services/clock/mega/sysclk.h ****  * Copyright (c) 2012 Atmel Corporation. All rights reserved.
   7:../../../platform/common/services/clock/mega/sysclk.h ****  *
   8:../../../platform/common/services/clock/mega/sysclk.h ****  * \asf_license_start
   9:../../../platform/common/services/clock/mega/sysclk.h ****  *
  10:../../../platform/common/services/clock/mega/sysclk.h ****  * \page License
  11:../../../platform/common/services/clock/mega/sysclk.h ****  *
  12:../../../platform/common/services/clock/mega/sysclk.h ****  * Redistribution and use in source and binary forms, with or without
  13:../../../platform/common/services/clock/mega/sysclk.h ****  * modification, are permitted provided that the following conditions are met:
  14:../../../platform/common/services/clock/mega/sysclk.h ****  *
  15:../../../platform/common/services/clock/mega/sysclk.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  16:../../../platform/common/services/clock/mega/sysclk.h ****  *    this list of conditions and the following disclaimer.
  17:../../../platform/common/services/clock/mega/sysclk.h ****  *
  18:../../../platform/common/services/clock/mega/sysclk.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  19:../../../platform/common/services/clock/mega/sysclk.h ****  *    this list of conditions and the following disclaimer in the documentation
  20:../../../platform/common/services/clock/mega/sysclk.h ****  *    and/or other materials provided with the distribution.
  21:../../../platform/common/services/clock/mega/sysclk.h ****  *
  22:../../../platform/common/services/clock/mega/sysclk.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  23:../../../platform/common/services/clock/mega/sysclk.h ****  *    from this software without specific prior written permission.
  24:../../../platform/common/services/clock/mega/sysclk.h ****  *
  25:../../../platform/common/services/clock/mega/sysclk.h ****  * 4. This software may only be redistributed and used in connection with an
  26:../../../platform/common/services/clock/mega/sysclk.h ****  *    Atmel microcontroller product.
  27:../../../platform/common/services/clock/mega/sysclk.h ****  *
  28:../../../platform/common/services/clock/mega/sysclk.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  29:../../../platform/common/services/clock/mega/sysclk.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  30:../../../platform/common/services/clock/mega/sysclk.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  31:../../../platform/common/services/clock/mega/sysclk.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  32:../../../platform/common/services/clock/mega/sysclk.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  33:../../../platform/common/services/clock/mega/sysclk.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  34:../../../platform/common/services/clock/mega/sysclk.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  35:../../../platform/common/services/clock/mega/sysclk.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  36:../../../platform/common/services/clock/mega/sysclk.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  37:../../../platform/common/services/clock/mega/sysclk.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  38:../../../platform/common/services/clock/mega/sysclk.h ****  * POSSIBILITY OF SUCH DAMAGE.
  39:../../../platform/common/services/clock/mega/sysclk.h ****  *
  40:../../../platform/common/services/clock/mega/sysclk.h ****  * \asf_license_stop
  41:../../../platform/common/services/clock/mega/sysclk.h ****  *
  42:../../../platform/common/services/clock/mega/sysclk.h ****  */
  43:../../../platform/common/services/clock/mega/sysclk.h **** #ifndef MEGA_SYSCLK_H_INCLUDED
  44:../../../platform/common/services/clock/mega/sysclk.h **** #define MEGA_SYSCLK_H_INCLUDED
  45:../../../platform/common/services/clock/mega/sysclk.h **** 
  46:../../../platform/common/services/clock/mega/sysclk.h **** #include <board.h>
  47:../../../platform/common/services/clock/mega/sysclk.h **** #include <compiler.h>
  48:../../../platform/common/services/clock/mega/sysclk.h **** #include <parts.h>
  49:../../../platform/common/services/clock/mega/sysclk.h **** 
  50:../../../platform/common/services/clock/mega/sysclk.h **** /* Include clock configuration for the project. */
  51:../../../platform/common/services/clock/mega/sysclk.h **** #include <conf_clock.h>
  52:../../../platform/common/services/clock/mega/sysclk.h **** 
  53:../../../platform/common/services/clock/mega/sysclk.h **** #ifdef __cplusplus
  54:../../../platform/common/services/clock/mega/sysclk.h **** extern "C" {
  55:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  56:../../../platform/common/services/clock/mega/sysclk.h **** #define ASM __asm__
  57:../../../platform/common/services/clock/mega/sysclk.h **** 
  58:../../../platform/common/services/clock/mega/sysclk.h **** /* CONFIG_SYSCLK_PSDIV  to use default if not defined*/
  59:../../../platform/common/services/clock/mega/sysclk.h **** #ifndef CONFIG_SYSCLK_PSDIV
  60:../../../platform/common/services/clock/mega/sysclk.h **** # define CONFIG_SYSCLK_PSDIV    SYSCLK_PSDIV_8
  61:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  62:../../../platform/common/services/clock/mega/sysclk.h **** 
  63:../../../platform/common/services/clock/mega/sysclk.h **** /* ! \name Prescaler Setting (relative to CLKsys) */
  64:../../../platform/common/services/clock/mega/sysclk.h **** /* @{ */
  65:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_1      0   /* !< Do not prescale */
  66:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_2      1   /* !< Prescale CLKper4 by 2 */
  67:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_4      2   /* !< Prescale CLKper4 by 4 */
  68:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_8      3   /* !< Prescale CLKper4 by 8 */
  69:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_16     4   /* !< Prescale CLKper4 by 16 */
  70:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_32     5   /* !< Prescale CLKper4 by 32 */
  71:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_64     6   /* !< Prescale CLKper4 by 64 */
  72:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_128    7   /* !< Prescale CLKper4 by 128 */
  73:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_256    8   /* !< Prescale CLKper4 by 256 */
  74:../../../platform/common/services/clock/mega/sysclk.h **** 
  75:../../../platform/common/services/clock/mega/sysclk.h **** /* @} */
  76:../../../platform/common/services/clock/mega/sysclk.h **** 
  77:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF || MEGA_XX0_1 || MEGA_XX4 || MEGA_XX4_A
  78:../../../platform/common/services/clock/mega/sysclk.h **** 
  79:../../../platform/common/services/clock/mega/sysclk.h **** #define NUMBER_OF_POWER_REG       2
  80:../../../platform/common/services/clock/mega/sysclk.h **** /*Starting Address for power reduction*/
  81:../../../platform/common/services/clock/mega/sysclk.h **** #define POWER_REG_ADD             PRR0
  82:../../../platform/common/services/clock/mega/sysclk.h **** 
  83:../../../platform/common/services/clock/mega/sysclk.h **** /* ! \name Power Reduction  Clock Port Numbers */
  84:../../../platform/common/services/clock/mega/sysclk.h **** enum power_red_id {
  85:../../../platform/common/services/clock/mega/sysclk.h **** 	POWER_RED_REG0,     /* !< Devices on PRR0 */
  86:../../../platform/common/services/clock/mega/sysclk.h **** #if !MEGA_XX4 || !MEGA_XX4_A || MEGA_XX0_1
  87:../../../platform/common/services/clock/mega/sysclk.h **** 	POWER_RED_REG1,     /* !< Devices on PRR1 */
  88:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  89:../../../platform/common/services/clock/mega/sysclk.h **** };
  90:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  91:../../../platform/common/services/clock/mega/sysclk.h **** 
  92:../../../platform/common/services/clock/mega/sysclk.h **** /****************************************************
  93:../../../platform/common/services/clock/mega/sysclk.h ****  * Given a dummy type but not used for these groups
  94:../../../platform/common/services/clock/mega/sysclk.h ****  * to support for otherthen megaRF device.
  95:../../../platform/common/services/clock/mega/sysclk.h ****  **************************************************/
  96:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_XX8 || MEGA_XX8_A || MEGA_UNSPECIFIED
  97:../../../platform/common/services/clock/mega/sysclk.h **** #define NUMBER_OF_POWER_REG       1
  98:../../../platform/common/services/clock/mega/sysclk.h **** /*Starting Address for power reduction*/
  99:../../../platform/common/services/clock/mega/sysclk.h **** #define POWER_REG_ADD             PRR
 100:../../../platform/common/services/clock/mega/sysclk.h **** 
 101:../../../platform/common/services/clock/mega/sysclk.h **** /* ! \name Power Reduction  Clock Port Numbers */
 102:../../../platform/common/services/clock/mega/sysclk.h **** enum power_red_id {
 103:../../../platform/common/services/clock/mega/sysclk.h **** 	POWER_RED_REG0,     /* !< Devices on PRR */
 104:../../../platform/common/services/clock/mega/sysclk.h **** };
 105:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 106:../../../platform/common/services/clock/mega/sysclk.h **** 
 107:../../../platform/common/services/clock/mega/sysclk.h **** /* Bit mask for the power reduction register based on */
 108:../../../platform/common/services/clock/mega/sysclk.h **** /*   MCU ARCH.                                        */
 109:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 110:../../../platform/common/services/clock/mega/sysclk.h **** /*Bit mask for PRR2 */
 111:../../../platform/common/services/clock/mega/sysclk.h **** 
 112:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM0_bm                       1 << PRRAM0
 113:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM1_bm                       1 << PRRAM1
 114:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM2_bm                       1 << PRRAM2
 115:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM3_bm                       1 << PRRAM3
 116:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 117:../../../platform/common/services/clock/mega/sysclk.h **** 
 118:../../../platform/common/services/clock/mega/sysclk.h **** /*Bit mask for the power reduction 0 or PRR*/
 119:../../../platform/common/services/clock/mega/sysclk.h **** #if !MEGA_XX_UN0 && !MEGA_XX_UN0
 120:../../../platform/common/services/clock/mega/sysclk.h **** #define PRADC_bm                        1 << PRADC
 121:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART0_bm                     1 << PRUSART0
 122:../../../platform/common/services/clock/mega/sysclk.h **** #define PRSPI_bm                        1 << PRSPI
 123:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM1_bm                       1 << PRTIM1
 124:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 125:../../../platform/common/services/clock/mega/sysclk.h **** 
 126:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 127:../../../platform/common/services/clock/mega/sysclk.h **** #define PRPGA_bm                        1 << PRPGA
 128:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 129:../../../platform/common/services/clock/mega/sysclk.h **** 
 130:../../../platform/common/services/clock/mega/sysclk.h **** #if !MEGA_UNSPECIFIED
 131:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM0_bm                       1 << PRTIM0
 132:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM2_bm                       1 << PRTIM2
 133:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTWI_bm                        1 << PRTWI
 134:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 135:../../../platform/common/services/clock/mega/sysclk.h **** 
 136:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_XX_UN2
 137:../../../platform/common/services/clock/mega/sysclk.h **** #define PRLCD_bm                        1 << PRLCD
 138:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 139:../../../platform/common/services/clock/mega/sysclk.h **** 
 140:../../../platform/common/services/clock/mega/sysclk.h **** /*Bit mask for  PRR1  */
 141:../../../platform/common/services/clock/mega/sysclk.h **** #ifdef PRR1
 142:../../../platform/common/services/clock/mega/sysclk.h **** #if (MEGA_XX4 || MEGA_XX4_A)
 143:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM3_bm                       1 << PRTIM3
 144:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 145:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 146:../../../platform/common/services/clock/mega/sysclk.h **** 
 147:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF || MEGA_XX4 || MEGA_XX4_A
 148:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART1_bm                     1 << PRUSART1
 149:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART2_bm                     1 << PRUSART2
 150:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART3_bm                     1 << PRUSART3
 151:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM3_bm                       1 << PRTIM3
 152:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM4_bm                       1 << PRTIM4
 153:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM5_bm                       1 << PRTIM5
 154:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 155:../../../platform/common/services/clock/mega/sysclk.h **** 
 156:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 157:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTRX24_bm                      1 << PRTRX24
 158:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 159:../../../platform/common/services/clock/mega/sysclk.h **** 
 160:../../../platform/common/services/clock/mega/sysclk.h **** /**
 161:../../../platform/common/services/clock/mega/sysclk.h ****  * \name Querying the system clock and its derived clocks
 162:../../../platform/common/services/clock/mega/sysclk.h ****  */
 163:../../../platform/common/services/clock/mega/sysclk.h **** /* @{ */
 164:../../../platform/common/services/clock/mega/sysclk.h **** 
 165:../../../platform/common/services/clock/mega/sysclk.h **** /**
 166:../../../platform/common/services/clock/mega/sysclk.h ****  * \brief Return the current rate in Hz of the main system clock
 167:../../../platform/common/services/clock/mega/sysclk.h ****  * To know the clock value at what frequency the main clock is running
 168:../../../platform/common/services/clock/mega/sysclk.h ****  * \return Frequency of the main system clock, in Hz.
 169:../../../platform/common/services/clock/mega/sysclk.h ****  * \todo : please initialize the SYSCLK_SOURCE in conf_clock.h file for
 170:../../../platform/common/services/clock/mega/sysclk.h ****  * configured source clock using fuses.
 171:../../../platform/common/services/clock/mega/sysclk.h ****  * \eg. #define SYSCLK_SOURCE SYSCLK_SRC_RC16MHZ to use internal RC
 172:../../../platform/common/services/clock/mega/sysclk.h ****  * oscillator for clock source.
 173:../../../platform/common/services/clock/mega/sysclk.h ****  */
 174:../../../platform/common/services/clock/mega/sysclk.h **** static inline uint32_t sysclk_get_main_hz(void)
 175:../../../platform/common/services/clock/mega/sysclk.h **** {
  17               		.loc 1 175 0
  18               		.cfi_startproc
  19 0000 CF93      		push r28
  20               	.LCFI0:
  21               		.cfi_def_cfa_offset 3
  22               		.cfi_offset 28, -2
  23 0002 DF93      		push r29
  24               	.LCFI1:
  25               		.cfi_def_cfa_offset 4
  26               		.cfi_offset 29, -3
  27 0004 CDB7      		in r28,__SP_L__
  28 0006 DEB7      		in r29,__SP_H__
  29               	.LCFI2:
  30               		.cfi_def_cfa_register 28
  31               	/* prologue: function */
  32               	/* frame size = 0 */
  33               	/* stack size = 2 */
  34               	.L__stack_usage = 2
 176:../../../platform/common/services/clock/mega/sysclk.h **** 	switch (SYSCLK_SOURCE) {
 177:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_RC16MHZ:
 178:../../../platform/common/services/clock/mega/sysclk.h **** 		return 16000000UL;
 179:../../../platform/common/services/clock/mega/sysclk.h **** 
 180:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_RC128KHZ:
 181:../../../platform/common/services/clock/mega/sysclk.h **** 		return 128000UL;
 182:../../../platform/common/services/clock/mega/sysclk.h **** 
 183:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 184:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_TRS16MHZ:
 185:../../../platform/common/services/clock/mega/sysclk.h **** 		return 16000000UL;
  35               		.loc 1 185 0
  36 0008 80E0      		ldi r24,0
  37 000a 94E2      		ldi r25,lo8(36)
  38 000c A4EF      		ldi r26,lo8(-12)
  39 000e B0E0      		ldi r27,0
 186:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 187:../../../platform/common/services/clock/mega/sysclk.h **** #ifdef BOARD_EXTERNAL_CLK
 188:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_EXTERNAL:
 189:../../../platform/common/services/clock/mega/sysclk.h **** 		return BOARD_EXTERNAL_CLK;
 190:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 191:../../../platform/common/services/clock/mega/sysclk.h **** 	default:
 192:../../../platform/common/services/clock/mega/sysclk.h **** 
 193:../../../platform/common/services/clock/mega/sysclk.h **** 		return 1000000UL;
 194:../../../platform/common/services/clock/mega/sysclk.h **** 	}
 195:../../../platform/common/services/clock/mega/sysclk.h **** }
  40               		.loc 1 195 0
  41 0010 BC01      		movw r22,r24
  42 0012 CD01      		movw r24,r26
  43               	/* epilogue start */
  44 0014 DF91      		pop r29
  45 0016 CF91      		pop r28
  46 0018 0895      		ret
  47               		.cfi_endproc
  48               	.LFE67:
  51               	sysclk_get_source_clock_hz:
  52               	.LFB68:
 196:../../../platform/common/services/clock/mega/sysclk.h **** 
 197:../../../platform/common/services/clock/mega/sysclk.h **** /**
 198:../../../platform/common/services/clock/mega/sysclk.h ****  * \brief Return the current rate in Hz of source clock in Hz.
 199:../../../platform/common/services/clock/mega/sysclk.h ****  *
 200:../../../platform/common/services/clock/mega/sysclk.h ****  * This clock always runs at the same rate as the CPU clock unless the divider
 201:../../../platform/common/services/clock/mega/sysclk.h ****  * is set.
 202:../../../platform/common/services/clock/mega/sysclk.h ****  *
 203:../../../platform/common/services/clock/mega/sysclk.h ****  * \return Frequency of the system clock, in Hz.
 204:../../../platform/common/services/clock/mega/sysclk.h ****  */
 205:../../../platform/common/services/clock/mega/sysclk.h **** static inline uint32_t sysclk_get_source_clock_hz(void)
 206:../../../platform/common/services/clock/mega/sysclk.h **** {
  53               		.loc 1 206 0
  54               		.cfi_startproc
  55 001a CF93      		push r28
  56               	.LCFI3:
  57               		.cfi_def_cfa_offset 3
  58               		.cfi_offset 28, -2
  59 001c DF93      		push r29
  60               	.LCFI4:
  61               		.cfi_def_cfa_offset 4
  62               		.cfi_offset 29, -3
  63 001e CDB7      		in r28,__SP_L__
  64 0020 DEB7      		in r29,__SP_H__
  65               	.LCFI5:
  66               		.cfi_def_cfa_register 28
  67               	/* prologue: function */
  68               	/* frame size = 0 */
  69               	/* stack size = 2 */
  70               	.L__stack_usage = 2
 207:../../../platform/common/services/clock/mega/sysclk.h **** 	switch (CONFIG_SYSCLK_PSDIV) {
 208:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_1: /* Fall through */
 209:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 210:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 211:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 2;
 212:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 213:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz();
  71               		.loc 1 213 0
  72 0022 0E94 0000 		call sysclk_get_main_hz
  73 0026 DC01      		movw r26,r24
  74 0028 CB01      		movw r24,r22
 214:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 215:../../../platform/common/services/clock/mega/sysclk.h **** 
 216:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_2:
 217:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 218:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 219:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 4;
 220:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 221:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 2;
 222:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 223:../../../platform/common/services/clock/mega/sysclk.h **** 
 224:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_4:
 225:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 226:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 227:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 8;
 228:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 229:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 4;
 230:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 231:../../../platform/common/services/clock/mega/sysclk.h **** 
 232:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_8:
 233:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 234:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 235:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 16;
 236:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 237:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 8;
 238:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 239:../../../platform/common/services/clock/mega/sysclk.h **** 
 240:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_16:
 241:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 242:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 243:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 32;
 244:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 245:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 16;
 246:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 247:../../../platform/common/services/clock/mega/sysclk.h **** 
 248:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_32:
 249:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 250:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 251:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 64;
 252:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 253:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 32;
 254:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 255:../../../platform/common/services/clock/mega/sysclk.h **** 
 256:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_64:
 257:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 258:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 259:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 128;
 260:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 261:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 64;
 262:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 263:../../../platform/common/services/clock/mega/sysclk.h **** 
 264:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_128:
 265:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 266:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 267:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 256;
 268:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 269:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 128;
 270:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 271:../../../platform/common/services/clock/mega/sysclk.h **** 
 272:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_256:
 273:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 274:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 275:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 512;
 276:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 277:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 256;
 278:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 279:../../../platform/common/services/clock/mega/sysclk.h **** 
 280:../../../platform/common/services/clock/mega/sysclk.h **** 	default:
 281:../../../platform/common/services/clock/mega/sysclk.h **** 		/*Invalide case*/
 282:../../../platform/common/services/clock/mega/sysclk.h **** 		return 0;
 283:../../../platform/common/services/clock/mega/sysclk.h **** 	}
 284:../../../platform/common/services/clock/mega/sysclk.h **** }
  75               		.loc 1 284 0
  76 002a BC01      		movw r22,r24
  77 002c CD01      		movw r24,r26
  78               	/* epilogue start */
  79 002e DF91      		pop r29
  80 0030 CF91      		pop r28
  81 0032 0895      		ret
  82               		.cfi_endproc
  83               	.LFE68:
  85               		.section	.progmem.data.baudctrl_1mhz,"a",@progbits
  88               	baudctrl_1mhz:
  89 0000 3300      		.word	51
  90 0002 1900      		.word	25
  91 0004 0C00      		.word	12
  92 0006 0600      		.word	6
  93 0008 0300      		.word	3
  94 000a 0200      		.word	2
  95 000c 0100      		.word	1
  96 000e FF00      		.word	255
  97               		.section	.progmem.data.baudctrl_8mhz,"a",@progbits
 100               	baudctrl_8mhz:
 101 0000 A001      		.word	416
 102 0002 CF00      		.word	207
 103 0004 6700      		.word	103
 104 0006 3300      		.word	51
 105 0008 1900      		.word	25
 106 000a 0C00      		.word	12
 107 000c 0700      		.word	7
 108 000e 0800      		.word	8
 109               		.section	.progmem.data.baudctrl_16mhz,"a",@progbits
 112               	baudctrl_16mhz:
 113 0000 4003      		.word	832
 114 0002 A001      		.word	416
 115 0004 CF00      		.word	207
 116 0006 6700      		.word	103
 117 0008 3300      		.word	51
 118 000a 1900      		.word	25
 119 000c 1000      		.word	16
 120 000e 1000      		.word	16
 121               		.text
 123               	usart_double_baud_enable:
 124               	.LFB101:
 125               		.file 2 "../../../platform/mega_rf/drivers/usart/usart_megarf.h"
   1:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
   2:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \file
   3:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
   4:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief USART driver for AVR MEGARF.
   5:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
   6:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * This file contains basic functions for the AVR MEGA USART, with support for
   7:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * all modes, settings and clock speeds.
   8:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
   9:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Copyright (c) 2013-2015 Atmel Corporation. All rights reserved.
  10:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  11:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \asf_license_start
  12:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  13:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \page License
  14:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  15:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Redistribution and use in source and binary forms, with or without
  16:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * modification, are permitted provided that the following conditions are met:
  17:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  18:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  19:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    this list of conditions and the following disclaimer.
  20:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  21:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  22:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    this list of conditions and the following disclaimer in the documentation
  23:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    and/or other materials provided with the distribution.
  24:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  25:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  26:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    from this software without specific prior written permission.
  27:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  28:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 4. This software may only be redistributed and used in connection with an
  29:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    Atmel microcontroller product.
  30:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  31:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  32:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  33:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  34:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  35:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  36:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  37:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  38:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  39:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  40:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  41:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * POSSIBILITY OF SUCH DAMAGE.
  42:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  43:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \asf_license_stop
  44:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  45:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
  46:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #ifndef _USART_MEGARF_H_
  47:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define _USART_MEGARF_H_
  48:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  49:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #ifdef __cplusplus
  50:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** extern "C" {
  51:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #endif
  52:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  53:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #include "compiler.h"
  54:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #include "status_codes.h"
  55:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  56:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
  57:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \defgroup megarf_usart_group USART module (USART)
  58:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  59:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * See \ref megarf_usart_quickstart.
  60:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  61:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * This is a driver for configuring, enabling, disabling and use of the on-chip
  62:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * USART.
  63:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  64:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \section dependencies Dependencies
  65:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  66:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * The USART module depends on the following modules:
  67:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  - \ref sysclk_group for peripheral clock control.
  68:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  - \ref port_driver_group for peripheral io port control.
  69:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  70:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * @{
  71:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
  72:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  73:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 1200 */
  74:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_1200      0x00
  75:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 2400 */
  76:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_2400      0x01
  77:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 4800 */
  78:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_4800      0x02
  79:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 9600 */
  80:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_9600      0x03
  81:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 19200 */
  82:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_19200     0x04
  83:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 38400 */
  84:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_38400     0x05
  85:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 57600 */
  86:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_57600     0x06
  87:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 115200 */
  88:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_115200    0x07
  89:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Baudrate not in lookup table */
  90:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_UNDEFINED 0xFF
  91:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  92:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef volatile uint8_t register8_t;
  93:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef volatile uint16_t register16_t;
  94:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Universal Synchronous/Asynchronous Receiver/Transmitter */
  95:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef struct USART_struct {
  96:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UCSRnA;  /* Control Register A */
  97:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UCSRnB;  /* Control Register B */
  98:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UCSRnC;  /* Control Register C */
  99:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t reserved;
 100:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register16_t UBRR;  /* Baud Rate Register Value */
 101:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UDR;  /* I/O Data Register */
 102:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_t;
 103:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 104:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USARTA0    (*(USART_t *)0xC0)   /* Universal Asynchronous
 105:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                 * Receiver-Transmitter A0 */
 106:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USARTA1    (*(USART_t *)0XC8)   /* Universal Asynchronous
 107:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                 * Receiver-Transmitter A1 */
 108:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 109:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* USART.UCSRxA  bit masks and bit positions */
 110:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXC_bm  0x80 /* RX complete bit mask.*/
 111:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXC_bp  7 /* RX complete bit position.*/
 112:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 113:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXC_bm  0x40 /* TX complete bit mask.*/
 114:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXC_bp  6 /* TX complete bit position.*/
 115:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 116:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRE_bm  0x20 /* DATA Register Empty Bit mask.*/
 117:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRE_bp  5 /*  DATA Register Empty bit position.*/
 118:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 119:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_FE_bm   0x10 /* Frame Error bit mask.*/
 120:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_FE_bp   4 /*Frame error bit position.*/
 121:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 122:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DOR_bm  0x08 /* Data Over Run bit mask.*/
 123:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DOR_bp  3 /* Data Over Run bit position.*/
 124:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 125:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UPE_bm  0x04 /* Parity error bit mask.*/
 126:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UPE_bp  2 /* Parity error bit position.*/
 127:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 128:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_U2X_bm  0x02 /* Double TX speed bit mask.*/
 129:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_U2X_bp  1 /* Double TX speed bit position.*/
 130:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 131:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_MPCM_bm  0x01 /* Multi Processor bit mask.*/
 132:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_MPMC_bp  0 /* Multi processor bit position.*/
 133:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 134:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* USART.UCSRxB  bit masks and bit positions */
 135:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXCIE_bm  0x80 /* RX complete interrupt Enable bit mask.*/
 136:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXCIE_bp  7 /* RX complete interrupt Enable bit position.*/
 137:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 138:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXCIE_bm  0x40 /* TX complete interrupt Enable bit mask.*/
 139:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXCIE_bp  6 /* TX complete interrupt Enable bit position.*/
 140:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 141:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRIE_bm  0x20 /* Data register empty interrupt Enable bit mask.*/
 142:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRIE_bp  5 /* Data register empty interrupt Enable bit position.*/
 143:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 144:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXEN_bm  0x10  /* Receiver Enable bit mask. */
 145:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXEN_bp  4  /* Receiver Enable bit position. */
 146:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 147:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXEN_bm  0x08  /* Transmitter Enable bit mask. */
 148:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXEN_bp  3  /* Transmitter Enable bit position. */
 149:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 150:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE2_bm  0x04  /* Character Size bit mask. */
 151:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE2_bp  2 /* Character Size bit position. */
 152:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 153:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXB8_bm  0x02  /* Transmit bit 8 bit mask. */
 154:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXB8_bp  1  /* Transmit bit 8 bit position. */
 155:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 156:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXB8_bm  0x01  /* Transmit bit 8 bit mask. */
 157:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXB8_bp  0  /* Transmit bit 8 bit position. */
 158:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 159:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* USART.UCSRxC  bit masks and bit positions */
 160:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_gm  0xC0 /* USART Mode Select 01 grp mask.*/
 161:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_gp  6 /* USART Mode Select 01 grp position.*/
 162:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 163:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_bm  0x80 /* USART Mode Select 01 bit mask.*/
 164:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_bp  7 /* USART Mode Select 01 bit position.*/
 165:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 166:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL00_bm  0x40 /* USART Mode Select 00 bit mask.*/
 167:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL00_bp  6 /* USART Mode Select 00 bit position.*/
 168:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 169:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE_gm  0x30 /* USART Parity Mode Select grp mask.*/
 170:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE_gp  4 /* USART Parity Mode Select grp position.*/
 171:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 172:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE01_bm  0x20 /* USART Parity Mode Select 01 bit mask.*/
 173:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE01_bp  5 /* USART Parity Mode Select 01 bit position.*/
 174:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 175:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE00_bm  0x10 /* USART Parity Mode Select 00 bit mask.*/
 176:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE00_bp  4 /* USART Parity Mode Select 00 bit position.*/
 177:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 178:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_STOPB_bm  0x08 /* USART stop bit mask.*/
 179:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_STOPB_bp  3 /* USART stop bit Position.*/
 180:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 181:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01C_gm  0x06  /* Character Size 10 bit 1 mask. */
 182:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01C_gp  1 /* Character Size 10 bit position. */
 183:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 184:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01_bm  0x04  /* Character Size 10 bit 1 mask. */
 185:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01_bp  2 /* Character Size 10 bit position. */
 186:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 187:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE00_bm  0x02  /* Character Size 00 bit 1 mask. */
 188:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE00_bp  1 /* Character Size bit 00 position. */
 189:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 190:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPOL_bm  0x01  /* Sync mode Pol bit 1 mask. */
 191:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPOL_bp  0 /*Sync mode Pol bit 0 position */
 192:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 193:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPHA_bm 0x02 /* Clock Phase bit mask. */
 194:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPHA_bp 1 /* Clock Phase bit position. */
 195:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 196:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DORD_bm 0x04 /* Data order bit mask. */
 197:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DORD_bp 2 /* Data order bit position. */
 198:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 199:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Character Size */
 200:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef enum USART_CHSIZE_enum {
 201:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_5BIT_gc = (0x00),  /* Character size: 5 bit */
 202:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_6BIT_gc = (0x01),  /* Character size: 6 bit */
 203:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_7BIT_gc = (0x02),  /* Character size: 7 bit */
 204:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_8BIT_gc = (0x03),  /* Character size: 8 bit */
 205:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_9BIT_gc = (0x07),  /* Character size: 9 bit */
 206:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_CHSIZE_t;
 207:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 208:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Communication Mode */
 209:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef enum USART_CMODE_enum {
 210:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_ASYNCHRONOUS_gc = (0x00 << USART_UMSEL01_gp),  /*
 211:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            *
 212:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            *
 213:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            *Asynchronous
 214:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            * Mode */
 215:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_SYNCHRONOUS_gc = (0x01 << USART_UMSEL01_gp),  /* Synchronous
 216:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                           * Mode */
 217:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_IRDA_gc = (0x02 << USART_UMSEL01_gp),  /* IrDA Mode */
 218:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_MSPI_gc = (0x03 << USART_UMSEL01_gp),  /* Master SPI Mode */
 219:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_CMODE_t;
 220:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 221:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Parity Mode */
 222:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef enum USART_PMODE_enum {
 223:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_DISABLED_gc = (0x00 << USART_PMODE_gp),  /* No Parity */
 224:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_EVEN_gc = (0x02 << USART_PMODE_gp),  /* Even Parity */
 225:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_ODD_gc = (0x03 << USART_PMODE_gp),  /* Odd Parity */
 226:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_PMODE_t;
 227:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 228:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Lookup table containing baudctrl values for CPU frequency 1 Mhz */
 229:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static PROGMEM_DECLARE(uint16_t, baudctrl_1mhz[]) = {
 230:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0033, /* Baud: 1200 */
 231:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0019, /* Baud: 2400 */
 232:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x000C, /* Baud: 4800 */
 233:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0006, /* Baud: 9600 */
 234:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0003, /* Baud: 19200 */
 235:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0002, /* Baud: 38400 */
 236:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0001, /* Baud: 57600 */
 237:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_BAUD_UNDEFINED, /* Baud: 115200 */
 238:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** };
 239:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 240:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Lookup table containing baudctrl values for CPU frequency 8 Mhz */
 241:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static PROGMEM_DECLARE(uint16_t, baudctrl_8mhz[]) = {
 242:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x01A0, /* Baud: 1200 */
 243:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x00CF, /* Baud: 2400 */
 244:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0067, /* Baud: 4800 */
 245:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0033, /* Baud: 9600 */
 246:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0019, /* Baud: 19200 */
 247:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x000C, /* Baud: 38400 */
 248:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0007, /* Baud: 57600 */
 249:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0008, /* Baud: 115200 */
 250:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** };
 251:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 252:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Lookup table containing baudctrl values for CPU frequency 16 Mhz */
 253:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static PROGMEM_DECLARE(uint16_t, baudctrl_16mhz[]) = {
 254:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0340, /* Baud: 1200 */
 255:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x01A0, /* Baud: 2400 */
 256:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x00CF, /* Baud: 4800 */
 257:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0067, /* Baud: 9600 */
 258:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0033, /* Baud: 19200 */
 259:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0019, /* Baud: 38400 */
 260:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0010, /* Baud: 57600 */
 261:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0010, /* Baud: 115200 */
 262:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** };
 263:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 264:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 265:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Input parameters when initializing RS232 and similar modes. */
 266:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef struct usart_rs232_options {
 267:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Set baud rate of the USART (unused in slave modes). */
 268:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint32_t baudrate;
 269:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 270:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Number of bits to transmit as a character (5 to 9). */
 271:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_t charlength;
 272:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 273:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Parity type: USART_PMODE_DISABLED_gc, USART_PMODE_EVEN_gc, */
 274:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! USART_PMODE_ODD_gc. */
 275:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_t paritytype;
 276:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 277:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Number of stop bits between two characters: */
 278:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! true: 2 stop bits */
 279:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! false: 1 stop bit */
 280:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	bool stopbits;
 281:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } usart_rs232_options_t;
 282:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 283:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Input parameters when initializing SPI master mode. */
 284:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef struct usart_spi_options {
 285:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Set baud rate of the USART in SPI mode. */
 286:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint32_t baudrate;
 287:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 288:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! SPI transmission mode. */
 289:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint8_t spimode;
 290:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 291:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint8_t data_order;
 292:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } usart_spi_options_t;
 293:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 294:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 295:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 296:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART receiver.
 297:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 298:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module
 299:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 300:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_enable(USART_t *usart)
 301:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 302:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_RXEN_bm;
 303:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 304:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 305:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 306:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART receiver.
 307:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 308:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 309:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 310:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_disable(USART_t *usart)
 311:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 312:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_RXEN_bm;
 313:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 314:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 315:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 316:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief  Configure the USART frame format.
 317:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 318:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  Sets the frame format, Frame Size, parity mode and number of stop bits.
 319:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 320:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param usart Pointer to the USART module
 321:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param charSize The character size. Use USART_CHSIZE_t type.
 322:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param parityMode The parity Mode. Use USART_PMODE_t type.
 323:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param twoStopBits Enable two stop bit mode. Use bool type.
 324:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 325:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_format_set(USART_t *usart, USART_CHSIZE_t charSize,
 326:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 		USART_PMODE_t parityMode, bool twoStopBits)
 327:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 328:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC
 329:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 		= ((usart)->UCSRnC &
 330:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			(~USART_CHSIZE01C_gm)) | ((charSize & 0x03)
 331:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			<< USART_CHSIZE01C_gp);
 332:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB
 333:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 		= ((usart)->UCSRnB &
 334:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			(~USART_CHSIZE2_bm)) | ((charSize & 0x04)
 335:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			<< USART_CHSIZE2_bp);
 336:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 337:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC = ((usart)->UCSRnC & (~USART_PMODE_gm)) | parityMode;
 338:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 339:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC = ((usart)->UCSRnC & (~USART_STOPB_bm)) | (twoStopBits
 340:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			<< USART_STOPB_bp);
 341:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 342:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 343:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 344:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART transmitter.
 345:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 346:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 347:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 348:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_enable(USART_t *usart)
 349:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 350:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_TXEN_bm;
 351:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 352:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 353:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 354:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART transmitter.
 355:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 356:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 357:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 358:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_disable(USART_t *usart)
 359:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 360:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_TXEN_bm;
 361:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 362:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 363:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 364:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART transmit complete interrupt.
 365:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 366:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 367:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 368:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_complete_interrupt_enable(USART_t *usart)
 369:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 370:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_TXC_bm;
 371:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 372:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 373:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 374:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART receive complete interrupt.
 375:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 376:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 377:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 378:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_complete_interrupt_enable(USART_t *usart)
 379:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 380:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_RXC_bm;
 381:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 382:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 383:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 384:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART data register empty interrupt.
 385:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 386:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 387:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 388:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_data_empty_interrupt_enable(USART_t *usart)
 389:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 390:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_DRIE_bm;
 391:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 392:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 393:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 394:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART transmit complete interrupt.
 395:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 396:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 397:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 398:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_complete_interrupt_disable(USART_t *usart)
 399:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 400:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_TXC_bm;
 401:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 402:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 403:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 404:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART receive complete interrupt.
 405:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 406:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 407:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 408:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_complete_interrupt_disable(USART_t *usart)
 409:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 410:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_RXC_bm;
 411:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 412:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 413:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 414:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART data register empty interrupt.
 415:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 416:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 417:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 418:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_data_empty_interrupt_disable(USART_t *usart)
 419:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 420:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_DRIE_bm;
 421:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 422:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 423:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 424:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Set the mode the USART run in.
 425:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 426:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Set the mode the USART run in. The default mode is asynchronous mode.
 427:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 428:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module register section.
 429:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usartmode Selects the USART mode. Use USART_CMODE_t type.
 430:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 431:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * USART modes:
 432:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x0        : Asynchronous mode.
 433:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x1        : Synchronous mode.
 434:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x2        : IrDA mode.
 435:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x3        : Master SPI mode.
 436:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 437:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_set_mode(USART_t *usart, USART_CMODE_t usartmode)
 438:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 439:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC = ((usart)->UCSRnC & (~USART_UMSEL01_gm)) | usartmode;
 440:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 441:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 442:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 443:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Check if data register empty flag is set.
 444:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 445:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 446:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 447:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline bool usart_data_register_is_empty(USART_t *usart)
 448:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 449:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UCSRnA & USART_DRE_bm;
 450:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 451:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 452:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 453:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Checks if the RX complete interrupt flag is set.
 454:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 455:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Checks if the RX complete interrupt flag is set.
 456:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 457:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 458:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 459:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline bool usart_rx_is_complete(USART_t *usart)
 460:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 461:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UCSRnA & USART_RXC_bm;
 462:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 463:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 464:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 465:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Checks if the TX complete interrupt flag is set.
 466:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 467:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Checks if the TX complete interrupt flag is set.
 468:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 469:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 470:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 471:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline bool usart_tx_is_complete(USART_t *usart)
 472:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 473:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UCSRnA & USART_TXC_bm;
 474:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 475:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 476:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 477:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Clear TX complete interrupt flag.
 478:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * TX flag is clear after complete transmission, automatically.
 479:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 480:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 481:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_clear_tx_complete(USART_t *usart)
 482:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 483:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****          usart->UCSRnA |=  USART_TXC_bm;
 484:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 485:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 486:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 487:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Write a data to the USART data register.
 488:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 489:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 490:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param txdata The data to be transmitted.
 491:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 492:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_put(USART_t *usart, uint8_t txdata)
 493:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 494:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UDR = txdata;
 495:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 496:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 497:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 498:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief  Read a data to the USART data register.
 499:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 500:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 501:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 502:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \return The received data
 503:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 504:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline uint8_t usart_get(USART_t *usart)
 505:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 506:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UDR;
 507:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 508:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 509:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 510:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Double the USART transmission speed.
 511:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 512:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 513:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 514:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_double_baud_enable(USART_t *usart)
 515:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 126               		.loc 2 515 0
 127               		.cfi_startproc
 128 0034 CF93      		push r28
 129               	.LCFI6:
 130               		.cfi_def_cfa_offset 3
 131               		.cfi_offset 28, -2
 132 0036 DF93      		push r29
 133               	.LCFI7:
 134               		.cfi_def_cfa_offset 4
 135               		.cfi_offset 29, -3
 136 0038 00D0      		rcall .
 137               	.LCFI8:
 138               		.cfi_def_cfa_offset 6
 139 003a CDB7      		in r28,__SP_L__
 140 003c DEB7      		in r29,__SP_H__
 141               	.LCFI9:
 142               		.cfi_def_cfa_register 28
 143               	/* prologue: function */
 144               	/* frame size = 2 */
 145               	/* stack size = 4 */
 146               	.L__stack_usage = 4
 147 003e 9A83      		std Y+2,r25
 148 0040 8983      		std Y+1,r24
 516:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	usart->UCSRnA |=  USART_U2X_bm;
 149               		.loc 2 516 0
 150 0042 8981      		ldd r24,Y+1
 151 0044 9A81      		ldd r25,Y+2
 152 0046 FC01      		movw r30,r24
 153 0048 8081      		ld r24,Z
 154 004a 282F      		mov r18,r24
 155 004c 2260      		ori r18,lo8(2)
 156 004e 8981      		ldd r24,Y+1
 157 0050 9A81      		ldd r25,Y+2
 158 0052 FC01      		movw r30,r24
 159 0054 2083      		st Z,r18
 517:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 160               		.loc 2 517 0
 161 0056 0000      		nop
 162               	/* epilogue start */
 163 0058 0F90      		pop __tmp_reg__
 164 005a 0F90      		pop __tmp_reg__
 165 005c DF91      		pop r29
 166 005e CF91      		pop r28
 167 0060 0895      		ret
 168               		.cfi_endproc
 169               	.LFE101:
 172               	usart_serial_init:
 173               	.LFB104:
 174               		.file 3 "../../../platform/common/services/serial/megarf_usart/usart_serial.h"
   1:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /**
   2:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \file
   3:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
   4:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \brief This file defines a useful set of functions for the Serial interface on 
   5:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * AVR MEGARF devices.
   6:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
   7:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * Copyright (c) 2013 Atmel Corporation. All rights reserved.
   8:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
   9:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \asf_license_start
  10:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  11:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \page License
  12:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  13:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * Redistribution and use in source and binary forms, with or without
  14:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * modification, are permitted provided that the following conditions are met:
  15:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  16:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  17:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    this list of conditions and the following disclaimer.
  18:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  19:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  20:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    this list of conditions and the following disclaimer in the documentation
  21:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    and/or other materials provided with the distribution.
  22:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  23:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  24:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    from this software without specific prior written permission.
  25:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  26:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 4. This software may only be redistributed and used in connection with an
  27:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    Atmel microcontroller product.
  28:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  29:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  30:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  31:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  32:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  33:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  34:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  35:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  36:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  37:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  38:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  39:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * POSSIBILITY OF SUCH DAMAGE.
  40:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  41:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \asf_license_stop
  42:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  43:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  44:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #ifndef _USART_SERIAL_H_
  45:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #define _USART_SERIAL_H_
  46:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  47:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #ifdef __cplusplus
  48:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** extern "C" {
  49:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #endif
  50:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  51:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "compiler.h"
  52:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "sysclk.h"
  53:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "status_codes.h"
  54:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "usart_megarf.h"
  55:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  56:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \name Serial Management Configuration
  57:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  58:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /* ! @{ */
  59:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "conf_usart_serial.h"
  60:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /* ! @} */
  61:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  62:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** typedef usart_rs232_options_t usart_serial_options_t;
  63:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  64:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** typedef USART_t *usart_if;
  65:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  66:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \brief Initializes the Usart in master mode.
  67:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  68:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param usart       Base address of the USART instance.
  69:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param options     Options needed to set up RS232 communication (see \ref
  70:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * usart_serial_options_t).
  71:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  72:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \retval true if the initialization was successful
  73:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \retval false if initialization failed (error in baud rate calculation)
  74:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  75:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** static inline bool usart_serial_init(usart_if usart, const
  76:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 		usart_serial_options_t *options)
  77:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** {
 175               		.loc 3 77 0
 176               		.cfi_startproc
 177 0062 CF93      		push r28
 178               	.LCFI10:
 179               		.cfi_def_cfa_offset 3
 180               		.cfi_offset 28, -2
 181 0064 DF93      		push r29
 182               	.LCFI11:
 183               		.cfi_def_cfa_offset 4
 184               		.cfi_offset 29, -3
 185 0066 CDB7      		in r28,__SP_L__
 186 0068 DEB7      		in r29,__SP_H__
 187               	.LCFI12:
 188               		.cfi_def_cfa_register 28
 189 006a 2B97      		sbiw r28,11
 190               	.LCFI13:
 191               		.cfi_def_cfa_offset 15
 192 006c 0FB6      		in __tmp_reg__,__SREG__
 193 006e F894      		cli
 194 0070 DEBF      		out __SP_H__,r29
 195 0072 0FBE      		out __SREG__,__tmp_reg__
 196 0074 CDBF      		out __SP_L__,r28
 197               	/* prologue: function */
 198               	/* frame size = 11 */
 199               	/* stack size = 13 */
 200               	.L__stack_usage = 13
 201 0076 9987      		std Y+9,r25
 202 0078 8887      		std Y+8,r24
 203 007a 7B87      		std Y+11,r23
 204 007c 6A87      		std Y+10,r22
  78:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	/* USART options. */
  79:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options_t usart_rs232_options;
  80:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.charlength   = options->charlength;
 205               		.loc 3 80 0
 206 007e 8A85      		ldd r24,Y+10
 207 0080 9B85      		ldd r25,Y+11
 208 0082 FC01      		movw r30,r24
 209 0084 8481      		ldd r24,Z+4
 210 0086 8D83      		std Y+5,r24
  81:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.paritytype   = options->paritytype;
 211               		.loc 3 81 0
 212 0088 8A85      		ldd r24,Y+10
 213 008a 9B85      		ldd r25,Y+11
 214 008c FC01      		movw r30,r24
 215 008e 8581      		ldd r24,Z+5
 216 0090 8E83      		std Y+6,r24
  82:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.stopbits     = options->stopbits;
 217               		.loc 3 82 0
 218 0092 8A85      		ldd r24,Y+10
 219 0094 9B85      		ldd r25,Y+11
 220 0096 FC01      		movw r30,r24
 221 0098 8681      		ldd r24,Z+6
 222 009a 8F83      		std Y+7,r24
  83:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.baudrate     = options->baudrate;
 223               		.loc 3 83 0
 224 009c 8A85      		ldd r24,Y+10
 225 009e 9B85      		ldd r25,Y+11
 226 00a0 FC01      		movw r30,r24
 227 00a2 8081      		ld r24,Z
 228 00a4 9181      		ldd r25,Z+1
 229 00a6 A281      		ldd r26,Z+2
 230 00a8 B381      		ldd r27,Z+3
 231 00aa 8983      		std Y+1,r24
 232 00ac 9A83      		std Y+2,r25
 233 00ae AB83      		std Y+3,r26
 234 00b0 BC83      		std Y+4,r27
  84:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  85:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	if (usart_init_rs232(usart, &usart_rs232_options)) {
 235               		.loc 3 85 0
 236 00b2 8885      		ldd r24,Y+8
 237 00b4 9985      		ldd r25,Y+9
 238 00b6 9E01      		movw r18,r28
 239 00b8 2F5F      		subi r18,-1
 240 00ba 3F4F      		sbci r19,-1
 241 00bc B901      		movw r22,r18
 242 00be 0E94 0000 		call usart_init_rs232
 243 00c2 8823      		tst r24
 244 00c4 01F0      		breq .L7
  86:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 		return true;
 245               		.loc 3 86 0
 246 00c6 81E0      		ldi r24,lo8(1)
 247 00c8 00C0      		rjmp .L9
 248               	.L7:
  87:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	} else {
  88:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 		return false;
 249               		.loc 3 88 0
 250 00ca 80E0      		ldi r24,0
 251               	.L9:
 252               	/* epilogue start */
  89:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	}
  90:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** }
 253               		.loc 3 90 0 discriminator 1
 254 00cc 2B96      		adiw r28,11
 255 00ce 0FB6      		in __tmp_reg__,__SREG__
 256 00d0 F894      		cli
 257 00d2 DEBF      		out __SP_H__,r29
 258 00d4 0FBE      		out __SREG__,__tmp_reg__
 259 00d6 CDBF      		out __SP_L__,r28
 260 00d8 DF91      		pop r29
 261 00da CF91      		pop r28
 262 00dc 0895      		ret
 263               		.cfi_endproc
 264               	.LFE104:
 267               	usart_serial_putchar:
 268               	.LFB105:
  91:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  92:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \brief Sends a character with the USART.
  93:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  94:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param usart   Base address of the USART instance.
  95:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param c       Character to write.
  96:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  97:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \return Status code
  98:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  99:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** static inline status_code_t usart_serial_putchar(usart_if usart, uint8_t c)
 100:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** {
 269               		.loc 3 100 0
 270               		.cfi_startproc
 271 00de CF93      		push r28
 272               	.LCFI14:
 273               		.cfi_def_cfa_offset 3
 274               		.cfi_offset 28, -2
 275 00e0 DF93      		push r29
 276               	.LCFI15:
 277               		.cfi_def_cfa_offset 4
 278               		.cfi_offset 29, -3
 279 00e2 00D0      		rcall .
 280 00e4 1F92      		push __zero_reg__
 281               	.LCFI16:
 282               		.cfi_def_cfa_offset 7
 283 00e6 CDB7      		in r28,__SP_L__
 284 00e8 DEB7      		in r29,__SP_H__
 285               	.LCFI17:
 286               		.cfi_def_cfa_register 28
 287               	/* prologue: function */
 288               	/* frame size = 3 */
 289               	/* stack size = 5 */
 290               	.L__stack_usage = 5
 291 00ea 9A83      		std Y+2,r25
 292 00ec 8983      		std Y+1,r24
 293 00ee 6B83      		std Y+3,r22
 101:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	return usart_putchar(usart, c);
 294               		.loc 3 101 0
 295 00f0 8981      		ldd r24,Y+1
 296 00f2 9A81      		ldd r25,Y+2
 297 00f4 6B81      		ldd r22,Y+3
 298 00f6 0E94 0000 		call usart_putchar
 299               	/* epilogue start */
 102:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** }
 300               		.loc 3 102 0
 301 00fa 0F90      		pop __tmp_reg__
 302 00fc 0F90      		pop __tmp_reg__
 303 00fe 0F90      		pop __tmp_reg__
 304 0100 DF91      		pop r29
 305 0102 CF91      		pop r28
 306 0104 0895      		ret
 307               		.cfi_endproc
 308               	.LFE105:
 311               	usart_serial_getchar:
 312               	.LFB106:
 103:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
 104:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \brief Waits until a character is received, and returns it.
 105:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
 106:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param usart   Base address of the USART instance.
 107:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param data   Data to read
 108:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
 109:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
 110:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** static inline void usart_serial_getchar(usart_if usart, uint8_t *data)
 111:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** {
 313               		.loc 3 111 0
 314               		.cfi_startproc
 315 0106 CF93      		push r28
 316               	.LCFI18:
 317               		.cfi_def_cfa_offset 3
 318               		.cfi_offset 28, -2
 319 0108 DF93      		push r29
 320               	.LCFI19:
 321               		.cfi_def_cfa_offset 4
 322               		.cfi_offset 29, -3
 323 010a 00D0      		rcall .
 324 010c 00D0      		rcall .
 325               	.LCFI20:
 326               		.cfi_def_cfa_offset 8
 327 010e CDB7      		in r28,__SP_L__
 328 0110 DEB7      		in r29,__SP_H__
 329               	.LCFI21:
 330               		.cfi_def_cfa_register 28
 331               	/* prologue: function */
 332               	/* frame size = 4 */
 333               	/* stack size = 6 */
 334               	.L__stack_usage = 6
 335 0112 9A83      		std Y+2,r25
 336 0114 8983      		std Y+1,r24
 337 0116 7C83      		std Y+4,r23
 338 0118 6B83      		std Y+3,r22
 112:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	*data = usart_getchar(usart);
 339               		.loc 3 112 0
 340 011a 8981      		ldd r24,Y+1
 341 011c 9A81      		ldd r25,Y+2
 342 011e 0E94 0000 		call usart_getchar
 343 0122 282F      		mov r18,r24
 344 0124 8B81      		ldd r24,Y+3
 345 0126 9C81      		ldd r25,Y+4
 346 0128 FC01      		movw r30,r24
 347 012a 2083      		st Z,r18
 113:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** }
 348               		.loc 3 113 0
 349 012c 0000      		nop
 350               	/* epilogue start */
 351 012e 0F90      		pop __tmp_reg__
 352 0130 0F90      		pop __tmp_reg__
 353 0132 0F90      		pop __tmp_reg__
 354 0134 0F90      		pop __tmp_reg__
 355 0136 DF91      		pop r29
 356 0138 CF91      		pop r28
 357 013a 0895      		ret
 358               		.cfi_endproc
 359               	.LFE106:
 362               	stdio_serial_init:
 363               	.LFB107:
 364               		.file 4 "../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h"
   1:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** /**
   2:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
   3:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \file
   4:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
   5:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \brief Common Standard I/O Serial Management.
   6:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
   7:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * This file defines a useful set of functions for the Stdio Serial interface on AVR
   8:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * and SAM devices.
   9:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  10:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * Copyright (c) 2009-2013 Atmel Corporation. All rights reserved.
  11:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  12:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \asf_license_start
  13:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  14:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \page License
  15:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  16:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * Redistribution and use in source and binary forms, with or without
  17:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * modification, are permitted provided that the following conditions are met:
  18:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  19:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  20:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    this list of conditions and the following disclaimer.
  21:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  22:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  23:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    this list of conditions and the following disclaimer in the documentation
  24:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    and/or other materials provided with the distribution.
  25:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  26:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  27:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    from this software without specific prior written permission.
  28:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  29:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 4. This software may only be redistributed and used in connection with an
  30:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    Atmel microcontroller product.
  31:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  32:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  33:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  34:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  35:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  36:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  37:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  38:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  39:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  40:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  41:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  42:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * POSSIBILITY OF SUCH DAMAGE.
  43:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  44:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \asf_license_stop
  45:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  46:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  ******************************************************************************/
  47:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  48:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  49:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #ifndef _STDIO_SERIAL_H_
  50:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #define _STDIO_SERIAL_H_
  51:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  52:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** /**
  53:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \defgroup group_common_utils_stdio_stdio_serial Standard serial I/O (stdio)
  54:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \ingroup group_common_utils_stdio
  55:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  56:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * Common standard serial I/O management driver that
  57:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * implements a stdio serial interface on AVR and SAM devices.
  58:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  59:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \{
  60:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  */
  61:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  62:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #include <stdio.h>
  63:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #include "compiler.h"
  64:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #ifndef SAMD20
  65:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # include "sysclk.h"
  66:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #endif
  67:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #include "serial.h"
  68:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  69:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #if (XMEGA || MEGA_RF) && defined(__GNUC__)
  70:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	extern int _write (char c, int *f);
  71:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	extern int _read (int *f);
  72:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #endif
  73:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  74:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  75:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** //! Pointer to the base of the USART module instance to use for stdio.
  76:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** extern volatile void *volatile stdio_base;
  77:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** //! Pointer to the external low level write function.
  78:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** extern int (*ptr_put)(void volatile*, char);
  79:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  80:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** //! Pointer to the external low level read function.
  81:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** extern void (*ptr_get)(void volatile*, char*);
  82:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  83:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** /*! \brief Initializes the stdio in Serial Mode.
  84:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  85:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \param usart       Base address of the USART instance.
  86:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \param opt         Options needed to set up RS232 communication (see \ref usart_options_t).
  87:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  88:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  */
  89:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** static inline void stdio_serial_init(volatile void *usart, const usart_serial_options_t *opt)
  90:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** {
 365               		.loc 4 90 0
 366               		.cfi_startproc
 367 013c CF93      		push r28
 368               	.LCFI22:
 369               		.cfi_def_cfa_offset 3
 370               		.cfi_offset 28, -2
 371 013e DF93      		push r29
 372               	.LCFI23:
 373               		.cfi_def_cfa_offset 4
 374               		.cfi_offset 29, -3
 375 0140 00D0      		rcall .
 376 0142 00D0      		rcall .
 377               	.LCFI24:
 378               		.cfi_def_cfa_offset 8
 379 0144 CDB7      		in r28,__SP_L__
 380 0146 DEB7      		in r29,__SP_H__
 381               	.LCFI25:
 382               		.cfi_def_cfa_register 28
 383               	/* prologue: function */
 384               	/* frame size = 4 */
 385               	/* stack size = 6 */
 386               	.L__stack_usage = 6
 387 0148 9A83      		std Y+2,r25
 388 014a 8983      		std Y+1,r24
 389 014c 7C83      		std Y+4,r23
 390 014e 6B83      		std Y+3,r22
  91:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	stdio_base = (void *)usart;
 391               		.loc 4 91 0
 392 0150 8981      		ldd r24,Y+1
 393 0152 9A81      		ldd r25,Y+2
 394 0154 9093 0000 		sts stdio_base+1,r25
 395 0158 8093 0000 		sts stdio_base,r24
  92:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	ptr_put = (int (*)(void volatile*,char))&usart_serial_putchar;
 396               		.loc 4 92 0
 397 015c 80E0      		ldi r24,lo8(gs(usart_serial_putchar))
 398 015e 90E0      		ldi r25,hi8(gs(usart_serial_putchar))
 399 0160 9093 0000 		sts ptr_put+1,r25
 400 0164 8093 0000 		sts ptr_put,r24
  93:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	ptr_get = (void (*)(void volatile*,char*))&usart_serial_getchar;
 401               		.loc 4 93 0
 402 0168 80E0      		ldi r24,lo8(gs(usart_serial_getchar))
 403 016a 90E0      		ldi r25,hi8(gs(usart_serial_getchar))
 404 016c 9093 0000 		sts ptr_get+1,r25
 405 0170 8093 0000 		sts ptr_get,r24
  94:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # if (XMEGA || MEGA_RF)
  95:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	usart_serial_init((USART_t *)usart,opt);
 406               		.loc 4 95 0
 407 0174 2B81      		ldd r18,Y+3
 408 0176 3C81      		ldd r19,Y+4
 409 0178 8981      		ldd r24,Y+1
 410 017a 9A81      		ldd r25,Y+2
 411 017c B901      		movw r22,r18
 412 017e 0E94 0000 		call usart_serial_init
  96:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # elif UC3
  97:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	usart_serial_init(usart,(usart_serial_options_t *)opt);
  98:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # elif SAM
  99:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	usart_serial_init((Usart *)usart,(usart_serial_options_t *)opt);
 100:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # else
 101:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  error Unsupported chip type
 102:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # endif
 103:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
 104:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # if defined(__GNUC__)
 105:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  if (XMEGA || MEGA_RF)
 106:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// For AVR GCC libc print redirection uses fdevopen.
 107:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	fdevopen((int (*)(char, FILE*))(_write),(int (*)(FILE*))(_read));
 413               		.loc 4 107 0
 414 0182 60E0      		ldi r22,lo8(gs(_read))
 415 0184 70E0      		ldi r23,hi8(gs(_read))
 416 0186 80E0      		ldi r24,lo8(gs(_write))
 417 0188 90E0      		ldi r25,hi8(gs(_write))
 418 018a 0E94 0000 		call fdevopen
 108:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  endif
 109:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  if UC3 || SAM
 110:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// For AVR32 and SAM GCC
 111:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// Specify that stdout and stdin should not be buffered.
 112:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	setbuf(stdout, NULL);
 113:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	setbuf(stdin, NULL);
 114:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// Note: Already the case in IAR's Normal DLIB default configuration
 115:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// and AVR GCC library:
 116:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// - printf() emits one character at a time.
 117:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// - getchar() requests only 1 byte to exit.
 118:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  endif
 119:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # endif
 120:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** }
 419               		.loc 4 120 0
 420 018e 0000      		nop
 421               	/* epilogue start */
 422 0190 0F90      		pop __tmp_reg__
 423 0192 0F90      		pop __tmp_reg__
 424 0194 0F90      		pop __tmp_reg__
 425 0196 0F90      		pop __tmp_reg__
 426 0198 DF91      		pop r29
 427 019a CF91      		pop r28
 428 019c 0895      		ret
 429               		.cfi_endproc
 430               	.LFE107:
 433               	macsc_enable_manual_bts:
 434               	.LFB121:
 435               		.file 5 "../../../platform/mega_rf/drivers/macsc/macsc_megarf.h"
   1:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
   2:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \file
   3:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
   4:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief AVR MEGARF MAC Symbol Counter Driver Definitions
   5:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
   6:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Copyright (c) 2013 Atmel Corporation. All rights reserved.
   7:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
   8:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \asf_license_start
   9:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  10:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \page License
  11:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  12:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Redistribution and use in source and binary forms, with or without
  13:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * modification, are permitted provided that the following conditions are met:
  14:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  15:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  16:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    this list of conditions and the following disclaimer.
  17:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  18:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  19:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    this list of conditions and the following disclaimer in the documentation
  20:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    and/or other materials provided with the distribution.
  21:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  22:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  23:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    from this software without specific prior written permission.
  24:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  25:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 4. This software may only be redistributed and used in connection with an
  26:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    Atmel microcontroller product.
  27:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  28:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  29:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  30:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  31:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  32:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  33:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  34:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  35:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  36:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  37:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  38:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * POSSIBILITY OF SUCH DAMAGE.
  39:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  40:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \asf_license_stop
  41:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  42:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  43:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #ifndef MACSC_MEGARF_H
  44:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_MEGARF_H
  45:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  46:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #include <compiler.h>
  47:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #include <parts.h>
  48:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #include "status_codes.h"
  49:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  50:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #ifdef __cplusplus
  51:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** extern "C" {
  52:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #endif
  53:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  54:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
  55:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \defgroup macsc_group MAC Symbol Counter Driver(MACSC)
  56:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  57:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * See \ref megarf_macsc_quickstart
  58:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  59:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This is a driver for the AVR MEGARF MAC Symbol Counter Driver(MACSC).
  60:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * It provides functions for enabling, disabling and configuring the module.
  61:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  62:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \section dependencies Dependencies
  63:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This driver depends on the following modules:
  64:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * - \ref interrupt_group for ISR definition and disabling interrupts during
  65:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * critical code sections.
  66:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @{
  67:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  68:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  69:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
  70:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Interrupt event callback function type
  71:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  72:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * The interrupt handler can be configured to do a function callback,
  73:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * the callback function must match the macsc_callback_t type.
  74:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  75:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  76:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** typedef void (*macsc_callback_t)(void);
  77:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  78:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /* ! MAC symbol counter compare Channel index */
  79:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** enum macsc_cc_channel {
  80:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! Channel 1 */
  81:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_CC1 = 1,
  82:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! Channel 2 */
  83:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_CC2 = 2,
  84:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! Channel 3 */
  85:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_CC3 = 3,
  86:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** };
  87:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
  88:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief MAC SC clock source select
  89:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  90:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * uses the SCCKSEL bit in SSCR register to select macsc clk src
  91:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  92:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * If the bit is one,the RTC clock from TOSC1 is selected, otherwise the symbol
  93:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * counter operates with the clock from XTAL1.
  94:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * During transceiver sleep modes the clock falls back to the RTC clock source,
  95:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * regardless of the selected clock. After wakeup, it switches back to the
  96:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * previosly
  97:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * selected clock source.
  98:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  99:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 100:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** enum macsc_xtal {
 101:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! 16MHz as macsc clock */
 102:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_16MHz = 0,
 103:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_32KHz = 1,
 104:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** };
 105:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 106:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 107:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @brief Reads the 32-bit timer register in the required order of bytes
 108:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 109:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param hh hh octet of 32-bit register
 110:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param hl hl octet of 32-bit register
 111:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param lh lh octet of 32-bit register
 112:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param ll ll octet of 32-bit register
 113:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 114:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @returns uint32_t Value of timer register
 115:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 116:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read32(volatile uint8_t *hh,
 117:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		volatile uint8_t *hl,
 118:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		volatile uint8_t *lh,
 119:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		volatile uint8_t *ll)
 120:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 121:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	union {
 122:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		uint8_t a[4];
 123:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		uint32_t rv;
 124:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	}
 125:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x;
 126:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 127:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[0] = *ll;
 128:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[1] = *lh;
 129:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[2] = *hl;
 130:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[3] = *hh;
 131:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 132:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return x.rv;
 133:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 134:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 135:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /* ! compare modes */
 136:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_ABSOLUTE_CMP 0
 137:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_RELATIVE_CMP 1
 138:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 139:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /** String concatenation by preprocessor used to create proper register names.
 140:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  **/
 141:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define CONCAT(a, b) a ## b
 142:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 143:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /** Creates proper subregister names and reads the corresponding values. */
 144:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_READ32(reg)                  macsc_read32(&CONCAT(reg, HH), \
 145:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		&CONCAT(reg, HL), \
 146:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		&CONCAT(reg, LH), \
 147:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		&CONCAT(reg, LL))
 148:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 149:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_WRITE32(reg, val)	\
 150:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	do { \
 151:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		union { uint8_t a[4]; uint32_t v; } \
 152:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		x; \
 153:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		x.v = val; \
 154:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, HH) = x.a[3]; \
 155:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, HL) = x.a[2]; \
 156:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, LH) = x.a[1]; \
 157:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, LL) = x.a[0]; \
 158:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	} \
 159:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	while (0)
 160:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 161:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 162:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Enable MAC SC
 163:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 164:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Enables the SC
 165:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 166:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param clk_src selection of clk source,avalable options in macsc_xtal,fixed
 167:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *  prescalar
 168:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param sleep_enable enable RTC as clock source during sleep
 169:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param auto_ts enable automatic timestamping
 170:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 171:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 172:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_enable(void);
 173:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 174:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 175:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Check if MACSC is enabled
 176:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 177:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * check if the MACSC is enabled.
 178:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 179:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 180:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 181:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 182:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** bool is_macsc_enable(void);
 183:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 184:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 185:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disable MAC SC
 186:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 187:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Disables the MAC SC
 188:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 189:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 190:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 191:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 192:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_disable(void);
 193:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 194:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 195:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Check if back-off slot counter is enabled
 196:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 197:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * check if the back-off slot counter is enabled.
 198:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 199:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 200:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 201:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 202:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** bool is_macsc_backoff_enable(void);
 203:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 204:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 205:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Enables compare interrupts of the MACSC
 206:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 207:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param channel Compare channel
 208:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 209:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_enable_cmp_int(enum macsc_cc_channel channel);
 210:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 211:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 212:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disables compare interrupts of the MACSC
 213:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 214:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param channel Compare channel
 215:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */void macsc_disable_cmp_int(enum macsc_cc_channel channel);
 216:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 217:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 218:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Usage of Absolute compare mode of the MACSC
 219:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 220:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param abs_rel  0 for absoulte cmp;1 for relative cmp
 221:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param cmp compare value for SCOCRx register
 222:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param channel Compare channel
 223:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 224:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_use_cmp(bool abs_rel, uint32_t cmp,enum macsc_cc_channel channel);
 225:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 226:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 227:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \ingroup macsc_group
 228:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \defgroup macsc_interrupt_group MAC Symbol Counter (MACSC) interrupt
 229:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * management
 230:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This group provides functions to configure MACSC module interrupts
 231:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 232:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @{
 233:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 234:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 235:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 236:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC overflow interrupt callback function
 237:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 238:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 239:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 240:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 241:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 242:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 243:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 244:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_ovf_int_cb(macsc_callback_t callback);
 245:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 246:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 247:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC Compare Channel 1 interrupt callback function
 248:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 249:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 250:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 251:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 252:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 253:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 254:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 255:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_cmp1_int_cb(macsc_callback_t callback);
 256:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 257:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 258:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC Compare Channel 2 interrupt callback function
 259:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 260:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 261:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 262:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 263:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 264:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 265:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 266:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_cmp2_int_cb(macsc_callback_t callback);
 267:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 268:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 269:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC Compare Channel 3 interrupt callback function
 270:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 271:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 272:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 273:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 274:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 275:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 276:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 277:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_cmp3_int_cb(macsc_callback_t callback);
 278:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 279:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 280:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC backoff slot counter interrupt callback function
 281:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 282:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 283:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 284:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 285:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 286:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 287:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 288:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_backoff_slot_cntr_int_cb(macsc_callback_t callback);
 289:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** //@}
 290:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 291:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 292:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Enable 32.768KHz clk using timer 2 async register
 293:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 294:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 295:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 296:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 297:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_sleep_clk_enable(void)
 298:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 299:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	ASSR |= (1 << AS2);
 300:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 301:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 302:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 303:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disable 32.768KHz clk using timer 2 async register
 304:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 305:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 306:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 307:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_sleep_clk_disable(void)
 308:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 309:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	ASSR &= ~(1 << AS2);
 310:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 311:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 312:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /* @} */
 313:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 314:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 315:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Configure MAC Symbol Counter Clock Source
 316:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 317:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param macsc macsc clk src
 318:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 319:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_write_clock_source(enum macsc_xtal source)
 320:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 321:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	if (source == MACSC_16MHz) {
 322:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCCR0 |= (source << SCCKSEL);
 323:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	} else if (source == MACSC_32KHz) {
 324:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCCR0 &= ~(1 << SCCKSEL);
 325:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	}
 326:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 327:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 328:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 329:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Read MAC SC Clock Source
 330:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 331:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 332:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return macsc_xtal enum Clock source selection
 333:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 334:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline enum macsc_xtal macsc_read_clock_source(void)
 335:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 336:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (enum macsc_xtal)(SCCR0 & (1 << SCCKSEL));
 337:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 338:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 339:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 340:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Write the Counter value of the MAC Symbol counter
 341:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 342:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param cnt_value Counter value
 343:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 344:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_write_count(uint32_t cnt_value)
 345:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 346:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_WRITE32(SCCNT, cnt_value);
 347:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 348:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 349:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 350:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Reads the Counter value of the MAC Symbol counter
 351:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 352:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note Output the Counter value
 353:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 354:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read_count(void)
 355:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 356:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (MACSC_READ32(SCCNT));
 357:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 358:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 359:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 360:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief enable back-off slot counter
 361:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 362:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 363:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note  Enables interrupt as well	.
 364:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note This counter works only if transceiver clock is running.So check Trx
 365:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * state in app before using this function in IEEE802.15.4 applications.
 366:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 367:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline bool macsc_backoff_slot_cnt_enable(void)
 368:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 369:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	if (!(PRR1 & (1 << PRTRX24))) {
 370:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCCR1 = (1 << SCENBO);
 371:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCIRQS |= (1 << IRQSBO);
 372:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCIRQM |= (1 << IRQMBO);
 373:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		return true;
 374:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	}
 375:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	else return false;
 376:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 377:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 378:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 379:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disable back-off slot counter
 380:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 381:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 382:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note    Disables interrupt as well	.
 383:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note This counter works only if transceiver clock is running.So check Trx
 384:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * state in app before using this function in IEEE802.15.4 applications.
 385:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 386:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_backoff_slot_cnt_disable(void)
 387:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 388:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCCR1 &= ~(1 << SCENBO);
 389:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCIRQM &= ~(1 << IRQMBO);
 390:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 391:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 392:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 393:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Tests if the Backoff slot cntr interrupt flag is set
 394:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 395:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return  backoff slot cntr interrupt has occurred or not : IRQSBO
 396:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 397:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline bool macsc_is_slot_cntr_interrupt_flag_set(void)
 398:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 399:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (SCIRQS & (1 << IRQSBO));
 400:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 401:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 402:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 403:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Clears the Backoff Slot cntr interrupt flag
 404:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 405:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note  IRQSBO is cleared
 406:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 407:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_clear_slot_cntr_interrupt_flag(void)
 408:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 409:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCIRQS |= (1 << IRQSBO);
 410:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 411:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 412:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 413:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Reads the SFD Timestamp register
 414:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 415:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return Timestamp of last received frame :SCTSR(read-only register)
 416:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 417:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read_ts(void)
 418:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 419:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (MACSC_READ32(SCTSR));
 420:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 421:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 422:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 423:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Reads the Beacon Timestamp register
 424:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 425:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return Timestamp of last received beacon frame :SCBTSR
 426:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 427:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read_bts(void)
 428:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 429:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (MACSC_READ32(SCBTSR));
 430:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 431:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 432:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 433:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Write the Beacon Timestamp register of the MAC Symbol counter
 434:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * The manual beacon timestamping can be used in conjunction with the
 435:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * relative compare mode of the three compare units to generate compare match
 436:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * interrupts without having a beacon frame received
 437:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 438:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * If set to 1, the current symbol counter value is stored into the beacon
 439:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * timestamp register.
 440:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * The bit is cleared afterwards.
 441:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 442:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 443:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_enable_manual_bts(void)
 444:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 436               		.loc 5 444 0
 437               		.cfi_startproc
 438 019e CF93      		push r28
 439               	.LCFI26:
 440               		.cfi_def_cfa_offset 3
 441               		.cfi_offset 28, -2
 442 01a0 DF93      		push r29
 443               	.LCFI27:
 444               		.cfi_def_cfa_offset 4
 445               		.cfi_offset 29, -3
 446 01a2 CDB7      		in r28,__SP_L__
 447 01a4 DEB7      		in r29,__SP_H__
 448               	.LCFI28:
 449               		.cfi_def_cfa_register 28
 450               	/* prologue: function */
 451               	/* frame size = 0 */
 452               	/* stack size = 2 */
 453               	.L__stack_usage = 2
 445:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCCR0 |= (1 << SCMBTS);
 454               		.loc 5 445 0
 455 01a6 8CED      		ldi r24,lo8(-36)
 456 01a8 90E0      		ldi r25,0
 457 01aa 2CED      		ldi r18,lo8(-36)
 458 01ac 30E0      		ldi r19,0
 459 01ae F901      		movw r30,r18
 460 01b0 2081      		ld r18,Z
 461 01b2 2064      		ori r18,lo8(64)
 462 01b4 FC01      		movw r30,r24
 463 01b6 2083      		st Z,r18
 446:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCCR0 &= ~(1 << SCTSE);
 464               		.loc 5 446 0
 465 01b8 8CED      		ldi r24,lo8(-36)
 466 01ba 90E0      		ldi r25,0
 467 01bc 2CED      		ldi r18,lo8(-36)
 468 01be 30E0      		ldi r19,0
 469 01c0 F901      		movw r30,r18
 470 01c2 2081      		ld r18,Z
 471 01c4 277F      		andi r18,lo8(-9)
 472 01c6 FC01      		movw r30,r24
 473 01c8 2083      		st Z,r18
 447:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 474               		.loc 5 447 0
 475 01ca 0000      		nop
 476               	/* epilogue start */
 477 01cc DF91      		pop r29
 478 01ce CF91      		pop r28
 479 01d0 0895      		ret
 480               		.cfi_endproc
 481               	.LFE121:
 483               	.global	appState
 484               		.section	.bss.appState,"aw",@nobits
 487               	appState:
 488 0000 00        		.zero	1
 489               		.section	.bss.msgReq,"aw",@nobits
 492               	msgReq:
 493 0000 0000 0000 		.zero	20
 493      0000 0000 
 493      0000 0000 
 493      0000 0000 
 493      0000 0000 
 494               		.section	.bss.PanId,"aw",@nobits
 497               	PanId:
 498 0000 00        		.zero	1
 499               		.section	.rodata
 500               	.LC1:
 501 0000 0A4D 5347 		.string	"\nMSG REQ SENT %d"
 501      2052 4551 
 501      2053 454E 
 501      5420 2564 
 501      00
 502               		.text
 503               	.global	appSendData
 505               	appSendData:
 506               	.LFB130:
 507               		.file 6 "ServerLLDN.c"
   1:ServerLLDN.c  **** /*
   2:ServerLLDN.c  **** 	* ServerLLDN.c
   3:ServerLLDN.c  **** 	*
   4:ServerLLDN.c  **** 	* Created: 10/18/2019 5:15:37 PM
   5:ServerLLDN.c  **** 	*  Author: guilherme
   6:ServerLLDN.c  **** 	*/ 
   7:ServerLLDN.c  **** 
   8:ServerLLDN.c  **** #include <stdlib.h>
   9:ServerLLDN.c  **** #include <stdio.h>
  10:ServerLLDN.c  **** #include <string.h>
  11:ServerLLDN.c  **** #include <inttypes.h>
  12:ServerLLDN.c  **** #include "config.h"
  13:ServerLLDN.c  **** #include "sys.h"
  14:ServerLLDN.c  **** #include "phy.h"
  15:ServerLLDN.c  **** #include "sys.h"
  16:ServerLLDN.c  **** #include "nwk.h"
  17:ServerLLDN.c  **** #include "sysclk.h"
  18:ServerLLDN.c  **** #include "sysTimer.h"
  19:ServerLLDN.c  **** #include "sleep_mgr.h"
  20:ServerLLDN.c  **** #include "sleepmgr.h"
  21:ServerLLDN.c  **** #include "led.h"
  22:ServerLLDN.c  **** #include "ioport.h"
  23:ServerLLDN.c  **** #include "conf_sleepmgr.h"
  24:ServerLLDN.c  **** #include "board.h"
  25:ServerLLDN.c  **** #include "platform.h"
  26:ServerLLDN.c  **** 
  27:ServerLLDN.c  **** #include "lldn.h"
  28:ServerLLDN.c  **** 
  29:ServerLLDN.c  **** #if 1
  30:ServerLLDN.c  **** #if (SIO2HOST_CHANNEL == SIO_USB)
  31:ServerLLDN.c  **** /* Only ARM */
  32:ServerLLDN.c  **** #include "hw_timer_lldn.h"
  33:ServerLLDN.c  **** #include "stdio_usb.h"
  34:ServerLLDN.c  **** #define MASTER_MACSC	0
  35:ServerLLDN.c  **** #else
  36:ServerLLDN.c  **** /* Only megarf series */
  37:ServerLLDN.c  **** #include "conf_sio2host.h"
  38:ServerLLDN.c  **** #define MASTER_MACSC	1
  39:ServerLLDN.c  **** #endif
  40:ServerLLDN.c  **** #else
  41:ServerLLDN.c  **** /* Only megarf series */
  42:ServerLLDN.c  **** #define MASTER_MACSC		1
  43:ServerLLDN.c  **** #endif
  44:ServerLLDN.c  **** 
  45:ServerLLDN.c  **** #define HUMAM_READABLE			1
  46:ServerLLDN.c  **** 
  47:ServerLLDN.c  **** #if (MASTER_MACSC == 1)
  48:ServerLLDN.c  **** #include "macsc_megarf.h"
  49:ServerLLDN.c  **** #define TIMESLOT_TIMER 1
  50:ServerLLDN.c  **** #else
  51:ServerLLDN.c  **** static SYS_Timer_t				tmrBeaconInterval;			// Beacon
  52:ServerLLDN.c  **** static SYS_Timer_t				tmrComputeData;				// Compute data
  53:ServerLLDN.c  **** #endif
  54:ServerLLDN.c  **** 
  55:ServerLLDN.c  **** #define PRINT 1
  56:ServerLLDN.c  **** 
  57:ServerLLDN.c  **** 	
  58:ServerLLDN.c  **** // equation for tTS gives time in seconds, the division by SYMBOL_TIME changes to symbols for count
  59:ServerLLDN.c  **** AppState_t	appState = APP_STATE_INITIAL;
  60:ServerLLDN.c  **** static NWK_DataReq_t msgReq;
  61:ServerLLDN.c  **** static uint8_t PanId;
  62:ServerLLDN.c  **** 
  63:ServerLLDN.c  ****  void appSendData(void)
  64:ServerLLDN.c  **** {
 508               		.loc 6 64 0
 509               		.cfi_startproc
 510 01d2 CF93      		push r28
 511               	.LCFI29:
 512               		.cfi_def_cfa_offset 3
 513               		.cfi_offset 28, -2
 514 01d4 DF93      		push r29
 515               	.LCFI30:
 516               		.cfi_def_cfa_offset 4
 517               		.cfi_offset 29, -3
 518 01d6 CDB7      		in r28,__SP_L__
 519 01d8 DEB7      		in r29,__SP_H__
 520               	.LCFI31:
 521               		.cfi_def_cfa_register 28
 522               	/* prologue: function */
 523               	/* frame size = 0 */
 524               	/* stack size = 2 */
 525               	.L__stack_usage = 2
  65:ServerLLDN.c  **** 	if(msgReq.options != 0)
 526               		.loc 6 65 0
 527 01da 8091 0000 		lds r24,msgReq+9
 528 01de 9091 0000 		lds r25,msgReq+9+1
 529 01e2 892B      		or r24,r25
 530 01e4 01F0      		breq .L17
  66:ServerLLDN.c  **** 	{
  67:ServerLLDN.c  **** 		printf("\nMSG REQ SENT %d",msgReq.options);
 531               		.loc 6 67 0
 532 01e6 8091 0000 		lds r24,msgReq+9
 533 01ea 9091 0000 		lds r25,msgReq+9+1
 534 01ee 292F      		mov r18,r25
 535 01f0 2F93      		push r18
 536 01f2 8F93      		push r24
 537 01f4 80E0      		ldi r24,lo8(.LC1)
 538 01f6 90E0      		ldi r25,hi8(.LC1)
 539 01f8 892F      		mov r24,r25
 540 01fa 8F93      		push r24
 541 01fc 80E0      		ldi r24,lo8(.LC1)
 542 01fe 90E0      		ldi r25,hi8(.LC1)
 543 0200 8F93      		push r24
 544 0202 0E94 0000 		call printf
 545 0206 0F90      		pop __tmp_reg__
 546 0208 0F90      		pop __tmp_reg__
 547 020a 0F90      		pop __tmp_reg__
 548 020c 0F90      		pop __tmp_reg__
  68:ServerLLDN.c  **** 		NWK_DataReq(&msgReq);
 549               		.loc 6 68 0
 550 020e 80E0      		ldi r24,lo8(msgReq)
 551 0210 90E0      		ldi r25,hi8(msgReq)
 552 0212 0E94 0000 		call NWK_DataReq
 553               	.L17:
  69:ServerLLDN.c  **** 	#if !APP_COORDINATOR
  70:ServerLLDN.c  **** 	#endif
  71:ServerLLDN.c  **** 	}
  72:ServerLLDN.c  **** }
 554               		.loc 6 72 0
 555 0216 0000      		nop
 556               	/* epilogue start */
 557 0218 DF91      		pop r29
 558 021a CF91      		pop r28
 559 021c 0895      		ret
 560               		.cfi_endproc
 561               	.LFE130:
 563               	.global	appPanState
 564               		.section	.data.appPanState,"aw",@progbits
 567               	appPanState:
 568 0000 01        		.byte	1
 569               		.comm	nodes_info_arr,1016,1
 570               	.global	config_request_frame
 571               		.section	.data.config_request_frame,"aw",@progbits
 574               	config_request_frame:
 575 0000 0F        		.byte	15
 576 0001 00        		.byte	0
 577 0002 0F        		.byte	15
 578 0003 0000      		.zero	2
 579 0005 80        		.byte	128
 580               		.comm	arr_slots,256,1
 581               		.comm	conf_req_arr,508,1
 582               	.global	conf_req_index
 583               		.section	.bss.conf_req_index,"aw",@nobits
 586               	conf_req_index:
 587 0000 0000      		.zero	2
 588               		.comm	ACKFrame,33,1
 589               	.global	ACKFrame_size
 590               		.section	.bss.ACKFrame_size,"aw",@nobits
 593               	ACKFrame_size:
 594 0000 0000      		.zero	2
 595               	.global	counter_online
 596               		.section	.data.counter_online,"aw",@progbits
 599               	counter_online:
 600 0000 6400      		.word	100
 601               	.global	beaconInterval
 602               		.section	.bss.beaconInterval,"aw",@nobits
 605               	beaconInterval:
 606 0000 0000      		.zero	2
 607               	.global	macLLDNnumUplinkTS
 608               		.section	.bss.macLLDNnumUplinkTS,"aw",@nobits
 611               	macLLDNnumUplinkTS:
 612 0000 0000      		.zero	2
 613               		.section	.bss.tmrDelay,"aw",@nobits
 616               	tmrDelay:
 617 0000 0000 0000 		.zero	13
 617      0000 0000 
 617      0000 0000 
 617      00
 618               	.global	assTimeSlot
 619               		.section	.bss.assTimeSlot,"aw",@nobits
 622               	assTimeSlot:
 623 0000 0000      		.zero	2
 624               	.global	counter_associados
 625               		.section	.bss.counter_associados,"aw",@nobits
 628               	counter_associados:
 629 0000 0000      		.zero	2
 630               	.global	cycles_counter
 631               		.section	.data.cycles_counter,"aw",@progbits
 634               	cycles_counter:
 635 0000 01        		.byte	1
 636               	.global	timeslot_counter
 637               		.section	.bss.timeslot_counter,"aw",@nobits
 640               	timeslot_counter:
 641 0000 00        		.zero	1
 642               		.text
 644               	tmrDelayHandler:
 645               	.LFB131:
  73:ServerLLDN.c  **** 
  74:ServerLLDN.c  **** #if APP_COORDINATOR
  75:ServerLLDN.c  **** 
  76:ServerLLDN.c  **** 	#define NODOS_ASSOCIADOS_ESPERADOS 12
  77:ServerLLDN.c  **** 	
  78:ServerLLDN.c  **** 	AppPanState_t appPanState = APP_PAN_STATE_RESET; // Initial state of PAN node
  79:ServerLLDN.c  **** 	
  80:ServerLLDN.c  **** 	/* Configuration Request Frames */
  81:ServerLLDN.c  **** 	/* Da pra mudar o envio do confrequest pra ja usar essa array com as informas dos nodos */	
  82:ServerLLDN.c  **** 	nodes_info_t nodes_info_arr[254]; // Array for Configure Request messages, one position per node, 
  83:ServerLLDN.c  **** 	NWK_ConfigRequest_t config_request_frame = { .id = LL_CONFIGURATION_REQUEST,
  84:ServerLLDN.c  **** 												 .s_macAddr = APP_ADDR,
  85:ServerLLDN.c  **** 												 .tx_channel = APP_CHANNEL,
  86:ServerLLDN.c  **** 												 .conf.macLLDNmgmtTS = MacLLDNMgmtTS };
  87:ServerLLDN.c  **** 	uint8_t arr_slots[256];
  88:ServerLLDN.c  **** 	int conf_req_arr[254];
  89:ServerLLDN.c  **** 	int conf_req_index = 0;
  90:ServerLLDN.c  **** 	/* Acknowledge Frame and Array */
  91:ServerLLDN.c  **** 	NWK_ACKFormat_t ACKFrame;	// ACK Frame Payload used in Discovery State
  92:ServerLLDN.c  **** 	int ACKFrame_size = 0;
  93:ServerLLDN.c  **** 	int counter_online = 100;
  94:ServerLLDN.c  **** 	unsigned int beaconInterval = 0; // no precisa ser global
  95:ServerLLDN.c  **** 	
  96:ServerLLDN.c  **** 	int macLLDNnumUplinkTS = 0;		// Number of uplink timeslots, is also the control of associated node
  97:ServerLLDN.c  **** 	
  98:ServerLLDN.c  **** 	/* This timer implements a delay between messages, 
  99:ServerLLDN.c  **** 	 * if not used the nodes are not able to receive the message
 100:ServerLLDN.c  **** 	 */
 101:ServerLLDN.c  **** 	static SYS_Timer_t tmrDelay;	
 102:ServerLLDN.c  **** 	
 103:ServerLLDN.c  **** 	/*  Control variables for testing */	
 104:ServerLLDN.c  **** 	int assTimeSlot = 0;
 105:ServerLLDN.c  **** 	int counter_associados = 0;		// Associated nodes counter
 106:ServerLLDN.c  **** 	uint8_t cycles_counter = macLLDNdiscoveryModeTimeout;
 107:ServerLLDN.c  **** 	uint8_t timeslot_counter = 0;
 108:ServerLLDN.c  **** 	
 109:ServerLLDN.c  **** 	static void tmrDelayHandler(SYS_Timer_t *timer)
 110:ServerLLDN.c  **** 	{
 646               		.loc 6 110 0
 647               		.cfi_startproc
 648 021e CF93      		push r28
 649               	.LCFI32:
 650               		.cfi_def_cfa_offset 3
 651               		.cfi_offset 28, -2
 652 0220 DF93      		push r29
 653               	.LCFI33:
 654               		.cfi_def_cfa_offset 4
 655               		.cfi_offset 29, -3
 656 0222 00D0      		rcall .
 657               	.LCFI34:
 658               		.cfi_def_cfa_offset 6
 659 0224 CDB7      		in r28,__SP_L__
 660 0226 DEB7      		in r29,__SP_H__
 661               	.LCFI35:
 662               		.cfi_def_cfa_register 28
 663               	/* prologue: function */
 664               	/* frame size = 2 */
 665               	/* stack size = 4 */
 666               	.L__stack_usage = 4
 667 0228 9A83      		std Y+2,r25
 668 022a 8983      		std Y+1,r24
 111:ServerLLDN.c  **** 		appState = APP_STATE_SEND;
 669               		.loc 6 111 0
 670 022c 82E0      		ldi r24,lo8(2)
 671 022e 8093 0000 		sts appState,r24
 112:ServerLLDN.c  **** 	}
 672               		.loc 6 112 0
 673 0232 0000      		nop
 674               	/* epilogue start */
 675 0234 0F90      		pop __tmp_reg__
 676 0236 0F90      		pop __tmp_reg__
 677 0238 DF91      		pop r29
 678 023a CF91      		pop r28
 679 023c 0895      		ret
 680               		.cfi_endproc
 681               	.LFE131:
 684               	lldn_server_beacon:
 685               	.LFB132:
 113:ServerLLDN.c  **** 	
 114:ServerLLDN.c  **** 	static void lldn_server_beacon(void)
 115:ServerLLDN.c  **** 	{
 686               		.loc 6 115 0
 687               		.cfi_startproc
 688 023e CF93      		push r28
 689               	.LCFI36:
 690               		.cfi_def_cfa_offset 3
 691               		.cfi_offset 28, -2
 692 0240 DF93      		push r29
 693               	.LCFI37:
 694               		.cfi_def_cfa_offset 4
 695               		.cfi_offset 29, -3
 696 0242 CDB7      		in r28,__SP_L__
 697 0244 DEB7      		in r29,__SP_H__
 698               	.LCFI38:
 699               		.cfi_def_cfa_register 28
 700               	/* prologue: function */
 701               	/* frame size = 0 */
 702               	/* stack size = 2 */
 703               	.L__stack_usage = 2
 116:ServerLLDN.c  **** 		macsc_enable_manual_bts();
 704               		.loc 6 116 0
 705 0246 0E94 0000 		call macsc_enable_manual_bts
 117:ServerLLDN.c  **** 		appState = APP_STATE_SEND;
 706               		.loc 6 117 0
 707 024a 82E0      		ldi r24,lo8(2)
 708 024c 8093 0000 		sts appState,r24
 118:ServerLLDN.c  **** 	}
 709               		.loc 6 118 0
 710 0250 0000      		nop
 711               	/* epilogue start */
 712 0252 DF91      		pop r29
 713 0254 CF91      		pop r28
 714 0256 0895      		ret
 715               		.cfi_endproc
 716               	.LFE132:
 719               	time_slot_handler:
 720               	.LFB133:
 119:ServerLLDN.c  **** 	
 120:ServerLLDN.c  **** 	static void time_slot_handler(void)
 121:ServerLLDN.c  **** 	{
 721               		.loc 6 121 0
 722               		.cfi_startproc
 723 0258 CF93      		push r28
 724               	.LCFI39:
 725               		.cfi_def_cfa_offset 3
 726               		.cfi_offset 28, -2
 727 025a DF93      		push r29
 728               	.LCFI40:
 729               		.cfi_def_cfa_offset 4
 730               		.cfi_offset 29, -3
 731 025c CDB7      		in r28,__SP_L__
 732 025e DEB7      		in r29,__SP_H__
 733               	.LCFI41:
 734               		.cfi_def_cfa_register 28
 735               	/* prologue: function */
 736               	/* frame size = 0 */
 737               	/* stack size = 2 */
 738               	.L__stack_usage = 2
 122:ServerLLDN.c  **** 		macsc_enable_manual_bts();
 739               		.loc 6 122 0
 740 0260 0E94 0000 		call macsc_enable_manual_bts
 123:ServerLLDN.c  **** 		appState = APP_STATE_ATT_PAN_STATE;
 741               		.loc 6 123 0
 742 0264 83E0      		ldi r24,lo8(3)
 743 0266 8093 0000 		sts appState,r24
 124:ServerLLDN.c  **** 	}
 744               		.loc 6 124 0
 745 026a 0000      		nop
 746               	/* epilogue start */
 747 026c DF91      		pop r29
 748 026e CF91      		pop r28
 749 0270 0895      		ret
 750               		.cfi_endproc
 751               	.LFE133:
 754               	downlink_delay_handler:
 755               	.LFB134:
 125:ServerLLDN.c  **** 	
 126:ServerLLDN.c  **** 	static void downlink_delay_handler(void)
 127:ServerLLDN.c  **** 	{
 756               		.loc 6 127 0
 757               		.cfi_startproc
 758 0272 CF93      		push r28
 759               	.LCFI42:
 760               		.cfi_def_cfa_offset 3
 761               		.cfi_offset 28, -2
 762 0274 DF93      		push r29
 763               	.LCFI43:
 764               		.cfi_def_cfa_offset 4
 765               		.cfi_offset 29, -3
 766 0276 CDB7      		in r28,__SP_L__
 767 0278 DEB7      		in r29,__SP_H__
 768               	.LCFI44:
 769               		.cfi_def_cfa_register 28
 770               	/* prologue: function */
 771               	/* frame size = 0 */
 772               	/* stack size = 2 */
 773               	.L__stack_usage = 2
 128:ServerLLDN.c  **** 		if(msgReq.options == NWK_OPT_LLDN_ACK)
 774               		.loc 6 128 0
 775 027a 8091 0000 		lds r24,msgReq+9
 776 027e 9091 0000 		lds r25,msgReq+9+1
 777 0282 8115      		cp r24,__zero_reg__
 778 0284 9044      		sbci r25,64
 779 0286 01F4      		brne .L23
 129:ServerLLDN.c  **** 		{
 130:ServerLLDN.c  **** 		appState = APP_STATE_SEND;
 780               		.loc 6 130 0
 781 0288 82E0      		ldi r24,lo8(2)
 782 028a 8093 0000 		sts appState,r24
 783               	.L23:
 131:ServerLLDN.c  **** 		}
 132:ServerLLDN.c  **** 	}
 784               		.loc 6 132 0
 785 028e 0000      		nop
 786               	/* epilogue start */
 787 0290 DF91      		pop r29
 788 0292 CF91      		pop r28
 789 0294 0895      		ret
 790               		.cfi_endproc
 791               	.LFE134:
 793               		.section	.rodata
 794               	.LC2:
 795 0011 0A20 454E 		.string	"\n END ONLINE HANDLER"
 795      4420 4F4E 
 795      4C49 4E45 
 795      2048 414E 
 795      444C 4552 
 796               		.text
 798               	end_of_online_handler:
 799               	.LFB135:
 133:ServerLLDN.c  **** 
 134:ServerLLDN.c  **** 	static void end_of_online_handler(void)
 135:ServerLLDN.c  **** 	{
 800               		.loc 6 135 0
 801               		.cfi_startproc
 802 0296 CF93      		push r28
 803               	.LCFI45:
 804               		.cfi_def_cfa_offset 3
 805               		.cfi_offset 28, -2
 806 0298 DF93      		push r29
 807               	.LCFI46:
 808               		.cfi_def_cfa_offset 4
 809               		.cfi_offset 29, -3
 810 029a CDB7      		in r28,__SP_L__
 811 029c DEB7      		in r29,__SP_H__
 812               	.LCFI47:
 813               		.cfi_def_cfa_register 28
 814               	/* prologue: function */
 815               	/* frame size = 0 */
 816               	/* stack size = 2 */
 817               	.L__stack_usage = 2
 136:ServerLLDN.c  **** 		printf("\n END ONLINE HANDLER");
 818               		.loc 6 136 0
 819 029e 80E0      		ldi r24,lo8(.LC2)
 820 02a0 90E0      		ldi r25,hi8(.LC2)
 821 02a2 892F      		mov r24,r25
 822 02a4 8F93      		push r24
 823 02a6 80E0      		ldi r24,lo8(.LC2)
 824 02a8 90E0      		ldi r25,hi8(.LC2)
 825 02aa 8F93      		push r24
 826 02ac 0E94 0000 		call printf
 827 02b0 0F90      		pop __tmp_reg__
 828 02b2 0F90      		pop __tmp_reg__
 137:ServerLLDN.c  **** 		appState = APP_STATE_ATT_PAN_STATE;
 829               		.loc 6 137 0
 830 02b4 83E0      		ldi r24,lo8(3)
 831 02b6 8093 0000 		sts appState,r24
 138:ServerLLDN.c  **** 	}
 832               		.loc 6 138 0
 833 02ba 0000      		nop
 834               	/* epilogue start */
 835 02bc DF91      		pop r29
 836 02be CF91      		pop r28
 837 02c0 0895      		ret
 838               		.cfi_endproc
 839               	.LFE135:
 841               		.section	.rodata
 842               	.LC3:
 843 0026 0A2A 2A2A 		.string	"\n***TIMESLOT****"
 843      5449 4D45 
 843      534C 4F54 
 843      2A2A 2A2A 
 843      00
 844               		.text
 846               	teste_handler:
 847               	.LFB136:
 139:ServerLLDN.c  **** 	
 140:ServerLLDN.c  **** 	#if TIMESLOT_TIMER
 141:ServerLLDN.c  **** 	static void teste_handler(void)
 142:ServerLLDN.c  **** 	{
 848               		.loc 6 142 0
 849               		.cfi_startproc
 850 02c2 CF93      		push r28
 851               	.LCFI48:
 852               		.cfi_def_cfa_offset 3
 853               		.cfi_offset 28, -2
 854 02c4 DF93      		push r29
 855               	.LCFI49:
 856               		.cfi_def_cfa_offset 4
 857               		.cfi_offset 29, -3
 858 02c6 CDB7      		in r28,__SP_L__
 859 02c8 DEB7      		in r29,__SP_H__
 860               	.LCFI50:
 861               		.cfi_def_cfa_register 28
 862               	/* prologue: function */
 863               	/* frame size = 0 */
 864               	/* stack size = 2 */
 865               	.L__stack_usage = 2
 143:ServerLLDN.c  **** 		if(msgReq.options)
 866               		.loc 6 143 0
 867 02ca 8091 0000 		lds r24,msgReq+9
 868 02ce 9091 0000 		lds r25,msgReq+9+1
 869 02d2 892B      		or r24,r25
 870 02d4 01F0      		breq .L26
 144:ServerLLDN.c  **** 			printf("\n***TIMESLOT****");
 871               		.loc 6 144 0
 872 02d6 80E0      		ldi r24,lo8(.LC3)
 873 02d8 90E0      		ldi r25,hi8(.LC3)
 874 02da 892F      		mov r24,r25
 875 02dc 8F93      		push r24
 876 02de 80E0      		ldi r24,lo8(.LC3)
 877 02e0 90E0      		ldi r25,hi8(.LC3)
 878 02e2 8F93      		push r24
 879 02e4 0E94 0000 		call printf
 880 02e8 0F90      		pop __tmp_reg__
 881 02ea 0F90      		pop __tmp_reg__
 882               	.L26:
 145:ServerLLDN.c  **** 		macsc_disable_cmp_int(MACSC_CC3);
 883               		.loc 6 145 0
 884 02ec 83E0      		ldi r24,lo8(3)
 885 02ee 0E94 0000 		call macsc_disable_cmp_int
 146:ServerLLDN.c  **** 	}
 886               		.loc 6 146 0
 887 02f2 0000      		nop
 888               	/* epilogue start */
 889 02f4 DF91      		pop r29
 890 02f6 CF91      		pop r28
 891 02f8 0895      		ret
 892               		.cfi_endproc
 893               	.LFE136:
 895               		.section	.rodata
 896               	.LC4:
 897 0037 0A41 6464 		.string	"\nAddr rep %d"
 897      7220 7265 
 897      7020 2564 
 897      00
 898               		.text
 900               	addToAckArray:
 901               	.LFB137:
 147:ServerLLDN.c  **** 	#endif
 148:ServerLLDN.c  **** 	
 149:ServerLLDN.c  **** 	static bool addToAckArray(uint8_t addres)
 150:ServerLLDN.c  **** 	{	
 902               		.loc 6 150 0
 903               		.cfi_startproc
 904 02fa CF93      		push r28
 905               	.LCFI51:
 906               		.cfi_def_cfa_offset 3
 907               		.cfi_offset 28, -2
 908 02fc DF93      		push r29
 909               	.LCFI52:
 910               		.cfi_def_cfa_offset 4
 911               		.cfi_offset 29, -3
 912 02fe 00D0      		rcall .
 913 0300 00D0      		rcall .
 914 0302 1F92      		push __zero_reg__
 915               	.LCFI53:
 916               		.cfi_def_cfa_offset 9
 917 0304 CDB7      		in r28,__SP_L__
 918 0306 DEB7      		in r29,__SP_H__
 919               	.LCFI54:
 920               		.cfi_def_cfa_register 28
 921               	/* prologue: function */
 922               	/* frame size = 5 */
 923               	/* stack size = 7 */
 924               	.L__stack_usage = 7
 925 0308 8D83      		std Y+5,r24
 151:ServerLLDN.c  **** 		int pos =(int) addres / 8;
 926               		.loc 6 151 0
 927 030a 8D81      		ldd r24,Y+5
 928 030c 8695      		lsr r24
 929 030e 8695      		lsr r24
 930 0310 8695      		lsr r24
 931 0312 882F      		mov r24,r24
 932 0314 90E0      		ldi r25,0
 933 0316 9A83      		std Y+2,r25
 934 0318 8983      		std Y+1,r24
 152:ServerLLDN.c  **** 		int bit_shift = 8 - (addres % 8);
 935               		.loc 6 152 0
 936 031a 8D81      		ldd r24,Y+5
 937 031c 882F      		mov r24,r24
 938 031e 90E0      		ldi r25,0
 939 0320 8770      		andi r24,7
 940 0322 9927      		clr r25
 941 0324 28E0      		ldi r18,lo8(8)
 942 0326 30E0      		ldi r19,0
 943 0328 A901      		movw r20,r18
 944 032a 481B      		sub r20,r24
 945 032c 590B      		sbc r21,r25
 946 032e CA01      		movw r24,r20
 947 0330 9C83      		std Y+4,r25
 948 0332 8B83      		std Y+3,r24
 153:ServerLLDN.c  **** 		
 154:ServerLLDN.c  **** 		if(ACKFrame.ackFlags[pos] & 1 << bit_shift)
 949               		.loc 6 154 0
 950 0334 8981      		ldd r24,Y+1
 951 0336 9A81      		ldd r25,Y+2
 952 0338 8050      		subi r24,lo8(-(ACKFrame+1))
 953 033a 9040      		sbci r25,hi8(-(ACKFrame+1))
 954 033c FC01      		movw r30,r24
 955 033e 8081      		ld r24,Z
 956 0340 882F      		mov r24,r24
 957 0342 90E0      		ldi r25,0
 958 0344 0B80      		ldd r0,Y+3
 959 0346 00C0      		rjmp 2f
 960               		1:
 961 0348 9595      		asr r25
 962 034a 8795      		ror r24
 963               		2:
 964 034c 0A94      		dec r0
 965 034e 02F4      		brpl 1b
 966 0350 8170      		andi r24,1
 967 0352 9927      		clr r25
 968 0354 892B      		or r24,r25
 969 0356 01F0      		breq .L28
 155:ServerLLDN.c  **** 		{
 156:ServerLLDN.c  **** 			printf("\nAddr rep %d", addres);
 970               		.loc 6 156 0
 971 0358 8D81      		ldd r24,Y+5
 972 035a 882F      		mov r24,r24
 973 035c 90E0      		ldi r25,0
 974 035e 292F      		mov r18,r25
 975 0360 2F93      		push r18
 976 0362 8F93      		push r24
 977 0364 80E0      		ldi r24,lo8(.LC4)
 978 0366 90E0      		ldi r25,hi8(.LC4)
 979 0368 892F      		mov r24,r25
 980 036a 8F93      		push r24
 981 036c 80E0      		ldi r24,lo8(.LC4)
 982 036e 90E0      		ldi r25,hi8(.LC4)
 983 0370 8F93      		push r24
 984 0372 0E94 0000 		call printf
 985 0376 0F90      		pop __tmp_reg__
 986 0378 0F90      		pop __tmp_reg__
 987 037a 0F90      		pop __tmp_reg__
 988 037c 0F90      		pop __tmp_reg__
 157:ServerLLDN.c  **** 			return false;
 989               		.loc 6 157 0
 990 037e 80E0      		ldi r24,0
 991 0380 00C0      		rjmp .L29
 992               	.L28:
 158:ServerLLDN.c  **** 		}
 159:ServerLLDN.c  **** 		ACKFrame.ackFlags[pos] = 1 << bit_shift;
 993               		.loc 6 159 0
 994 0382 81E0      		ldi r24,lo8(1)
 995 0384 90E0      		ldi r25,0
 996 0386 0B80      		ldd r0,Y+3
 997 0388 00C0      		rjmp 2f
 998               		1:
 999 038a 880F      		lsl r24
 1000 038c 991F      		rol r25
 1001               		2:
 1002 038e 0A94      		dec r0
 1003 0390 02F4      		brpl 1b
 1004 0392 282F      		mov r18,r24
 1005 0394 8981      		ldd r24,Y+1
 1006 0396 9A81      		ldd r25,Y+2
 1007 0398 8050      		subi r24,lo8(-(ACKFrame+1))
 1008 039a 9040      		sbci r25,hi8(-(ACKFrame+1))
 1009 039c FC01      		movw r30,r24
 1010 039e 2083      		st Z,r18
 160:ServerLLDN.c  **** 		if (pos + 1 > ACKFrame_size)
 1011               		.loc 6 160 0
 1012 03a0 8981      		ldd r24,Y+1
 1013 03a2 9A81      		ldd r25,Y+2
 1014 03a4 9C01      		movw r18,r24
 1015 03a6 2F5F      		subi r18,-1
 1016 03a8 3F4F      		sbci r19,-1
 1017 03aa 8091 0000 		lds r24,ACKFrame_size
 1018 03ae 9091 0000 		lds r25,ACKFrame_size+1
 1019 03b2 8217      		cp r24,r18
 1020 03b4 9307      		cpc r25,r19
 1021 03b6 04F4      		brge .L30
 161:ServerLLDN.c  **** 			ACKFrame_size = pos + 1;
 1022               		.loc 6 161 0
 1023 03b8 8981      		ldd r24,Y+1
 1024 03ba 9A81      		ldd r25,Y+2
 1025 03bc 0196      		adiw r24,1
 1026 03be 9093 0000 		sts ACKFrame_size+1,r25
 1027 03c2 8093 0000 		sts ACKFrame_size,r24
 1028               	.L30:
 162:ServerLLDN.c  **** 		
 163:ServerLLDN.c  **** 		return true;
 1029               		.loc 6 163 0
 1030 03c6 81E0      		ldi r24,lo8(1)
 1031               	.L29:
 1032               	/* epilogue start */
 164:ServerLLDN.c  **** 	}
 1033               		.loc 6 164 0
 1034 03c8 0F90      		pop __tmp_reg__
 1035 03ca 0F90      		pop __tmp_reg__
 1036 03cc 0F90      		pop __tmp_reg__
 1037 03ce 0F90      		pop __tmp_reg__
 1038 03d0 0F90      		pop __tmp_reg__
 1039 03d2 DF91      		pop r29
 1040 03d4 CF91      		pop r28
 1041 03d6 0895      		ret
 1042               		.cfi_endproc
 1043               	.LFE137:
 1045               		.section	.rodata
 1046               	.LC5:
 1047 0044 0A61 7373 		.string	"\nassTimeSlot %d"
 1047      5469 6D65 
 1047      536C 6F74 
 1047      2025 6400 
 1048               		.text
 1050               	addConfRequestArray:
 1051               	.LFB138:
 165:ServerLLDN.c  **** 
 166:ServerLLDN.c  **** 	static void addConfRequestArray(NWK_ConfigStatus_t *node)
 167:ServerLLDN.c  **** 	{
 1052               		.loc 6 167 0
 1053               		.cfi_startproc
 1054 03d8 CF93      		push r28
 1055               	.LCFI55:
 1056               		.cfi_def_cfa_offset 3
 1057               		.cfi_offset 28, -2
 1058 03da DF93      		push r29
 1059               	.LCFI56:
 1060               		.cfi_def_cfa_offset 4
 1061               		.cfi_offset 29, -3
 1062 03dc 00D0      		rcall .
 1063 03de 1F92      		push __zero_reg__
 1064               	.LCFI57:
 1065               		.cfi_def_cfa_offset 7
 1066 03e0 CDB7      		in r28,__SP_L__
 1067 03e2 DEB7      		in r29,__SP_H__
 1068               	.LCFI58:
 1069               		.cfi_def_cfa_register 28
 1070               	/* prologue: function */
 1071               	/* frame size = 3 */
 1072               	/* stack size = 5 */
 1073               	.L__stack_usage = 5
 1074 03e4 9B83      		std Y+3,r25
 1075 03e6 8A83      		std Y+2,r24
 168:ServerLLDN.c  **** 		//printf("conf_req_index : %d", conf_req_index);
 169:ServerLLDN.c  **** 		conf_req_index++;
 1076               		.loc 6 169 0
 1077 03e8 8091 0000 		lds r24,conf_req_index
 1078 03ec 9091 0000 		lds r25,conf_req_index+1
 1079 03f0 0196      		adiw r24,1
 1080 03f2 9093 0000 		sts conf_req_index+1,r25
 1081 03f6 8093 0000 		sts conf_req_index,r24
 170:ServerLLDN.c  **** 		uint8_t i;
 171:ServerLLDN.c  **** 		for (i= 0;i < 256 && arr_slots[i] == 1; i++);
 1082               		.loc 6 171 0
 1083 03fa 1982      		std Y+1,__zero_reg__
 1084 03fc 00C0      		rjmp .L32
 1085               	.L33:
 1086               		.loc 6 171 0 is_stmt 0 discriminator 3
 1087 03fe 8981      		ldd r24,Y+1
 1088 0400 8F5F      		subi r24,lo8(-(1))
 1089 0402 8983      		std Y+1,r24
 1090               	.L32:
 1091               		.loc 6 171 0 discriminator 1
 1092 0404 8981      		ldd r24,Y+1
 1093 0406 882F      		mov r24,r24
 1094 0408 90E0      		ldi r25,0
 1095 040a 8050      		subi r24,lo8(-(arr_slots))
 1096 040c 9040      		sbci r25,hi8(-(arr_slots))
 1097 040e FC01      		movw r30,r24
 1098 0410 8081      		ld r24,Z
 1099 0412 8130      		cpi r24,lo8(1)
 1100 0414 01F0      		breq .L33
 172:ServerLLDN.c  **** 		arr_slots[i] = 1;
 1101               		.loc 6 172 0 is_stmt 1
 1102 0416 8981      		ldd r24,Y+1
 1103 0418 882F      		mov r24,r24
 1104 041a 90E0      		ldi r25,0
 1105 041c 8050      		subi r24,lo8(-(arr_slots))
 1106 041e 9040      		sbci r25,hi8(-(arr_slots))
 1107 0420 21E0      		ldi r18,lo8(1)
 1108 0422 FC01      		movw r30,r24
 1109 0424 2083      		st Z,r18
 173:ServerLLDN.c  **** 		assTimeSlot++;
 1110               		.loc 6 173 0
 1111 0426 8091 0000 		lds r24,assTimeSlot
 1112 042a 9091 0000 		lds r25,assTimeSlot+1
 1113 042e 0196      		adiw r24,1
 1114 0430 9093 0000 		sts assTimeSlot+1,r25
 1115 0434 8093 0000 		sts assTimeSlot,r24
 174:ServerLLDN.c  **** 		printf("\nassTimeSlot %d", assTimeSlot);
 1116               		.loc 6 174 0
 1117 0438 8091 0000 		lds r24,assTimeSlot
 1118 043c 9091 0000 		lds r25,assTimeSlot+1
 1119 0440 292F      		mov r18,r25
 1120 0442 2F93      		push r18
 1121 0444 8F93      		push r24
 1122 0446 80E0      		ldi r24,lo8(.LC5)
 1123 0448 90E0      		ldi r25,hi8(.LC5)
 1124 044a 892F      		mov r24,r25
 1125 044c 8F93      		push r24
 1126 044e 80E0      		ldi r24,lo8(.LC5)
 1127 0450 90E0      		ldi r25,hi8(.LC5)
 1128 0452 8F93      		push r24
 1129 0454 0E94 0000 		call printf
 1130 0458 0F90      		pop __tmp_reg__
 1131 045a 0F90      		pop __tmp_reg__
 1132 045c 0F90      		pop __tmp_reg__
 1133 045e 0F90      		pop __tmp_reg__
 175:ServerLLDN.c  **** 		if(node->ts_dir.tsDuration > config_request_frame.conf.tsDuration)
 1134               		.loc 6 175 0
 1135 0460 8A81      		ldd r24,Y+2
 1136 0462 9B81      		ldd r25,Y+3
 1137 0464 FC01      		movw r30,r24
 1138 0466 8481      		ldd r24,Z+4
 1139 0468 8F77      		andi r24,lo8(127)
 1140 046a 282F      		mov r18,r24
 1141 046c 30E0      		ldi r19,0
 1142 046e 8091 0000 		lds r24,config_request_frame+5
 1143 0472 8F77      		andi r24,lo8(127)
 1144 0474 882F      		mov r24,r24
 1145 0476 90E0      		ldi r25,0
 1146 0478 8217      		cp r24,r18
 1147 047a 9307      		cpc r25,r19
 1148 047c 04F4      		brge .L34
 176:ServerLLDN.c  **** 		config_request_frame.conf.tsDuration = node->ts_dir.tsDuration;
 1149               		.loc 6 176 0
 1150 047e 8A81      		ldd r24,Y+2
 1151 0480 9B81      		ldd r25,Y+3
 1152 0482 FC01      		movw r30,r24
 1153 0484 8481      		ldd r24,Z+4
 1154 0486 8F77      		andi r24,lo8(127)
 1155 0488 8F77      		andi r24,lo8(127)
 1156 048a 9091 0000 		lds r25,config_request_frame+5
 1157 048e 9078      		andi r25,lo8(-128)
 1158 0490 892B      		or r24,r25
 1159 0492 8093 0000 		sts config_request_frame+5,r24
 1160               	.L34:
 177:ServerLLDN.c  **** 		
 178:ServerLLDN.c  **** 		// tem que atualizar o tamanho final
 179:ServerLLDN.c  **** 		nodes_info_arr[conf_req_index].req_timeslot_duration = node->ts_dir.tsDuration;
 1161               		.loc 6 179 0
 1162 0496 8091 0000 		lds r24,conf_req_index
 1163 049a 9091 0000 		lds r25,conf_req_index+1
 1164 049e 2A81      		ldd r18,Y+2
 1165 04a0 3B81      		ldd r19,Y+3
 1166 04a2 F901      		movw r30,r18
 1167 04a4 2481      		ldd r18,Z+4
 1168 04a6 2F77      		andi r18,lo8(127)
 1169 04a8 880F      		lsl r24
 1170 04aa 991F      		rol r25
 1171 04ac 880F      		lsl r24
 1172 04ae 991F      		rol r25
 1173 04b0 8050      		subi r24,lo8(-(nodes_info_arr+3))
 1174 04b2 9040      		sbci r25,hi8(-(nodes_info_arr+3))
 1175 04b4 FC01      		movw r30,r24
 1176 04b6 2083      		st Z,r18
 180:ServerLLDN.c  **** 		nodes_info_arr[conf_req_index].mac_addr = node->macAddr;
 1177               		.loc 6 180 0
 1178 04b8 8091 0000 		lds r24,conf_req_index
 1179 04bc 9091 0000 		lds r25,conf_req_index+1
 1180 04c0 2A81      		ldd r18,Y+2
 1181 04c2 3B81      		ldd r19,Y+3
 1182 04c4 F901      		movw r30,r18
 1183 04c6 2381      		ldd r18,Z+3
 1184 04c8 222F      		mov r18,r18
 1185 04ca 30E0      		ldi r19,0
 1186 04cc 880F      		lsl r24
 1187 04ce 991F      		rol r25
 1188 04d0 880F      		lsl r24
 1189 04d2 991F      		rol r25
 1190 04d4 8050      		subi r24,lo8(-(nodes_info_arr+1))
 1191 04d6 9040      		sbci r25,hi8(-(nodes_info_arr+1))
 1192 04d8 FC01      		movw r30,r24
 1193 04da 3183      		std Z+1,r19
 1194 04dc 2083      		st Z,r18
 181:ServerLLDN.c  **** 		nodes_info_arr[conf_req_index].assigned_time_slot = (uint8_t)i;
 1195               		.loc 6 181 0
 1196 04de 8091 0000 		lds r24,conf_req_index
 1197 04e2 9091 0000 		lds r25,conf_req_index+1
 1198 04e6 880F      		lsl r24
 1199 04e8 991F      		rol r25
 1200 04ea 880F      		lsl r24
 1201 04ec 991F      		rol r25
 1202 04ee 8050      		subi r24,lo8(-(nodes_info_arr))
 1203 04f0 9040      		sbci r25,hi8(-(nodes_info_arr))
 1204 04f2 2981      		ldd r18,Y+1
 1205 04f4 FC01      		movw r30,r24
 1206 04f6 2083      		st Z,r18
 182:ServerLLDN.c  **** 
 183:ServerLLDN.c  **** 	}
 1207               		.loc 6 183 0
 1208 04f8 0000      		nop
 1209               	/* epilogue start */
 1210 04fa 0F90      		pop __tmp_reg__
 1211 04fc 0F90      		pop __tmp_reg__
 1212 04fe 0F90      		pop __tmp_reg__
 1213 0500 DF91      		pop r29
 1214 0502 CF91      		pop r28
 1215 0504 0895      		ret
 1216               		.cfi_endproc
 1217               	.LFE138:
 1220               	CopyToConfigRequest:
 1221               	.LFB139:
 184:ServerLLDN.c  **** 
 185:ServerLLDN.c  **** 	static void CopyToConfigRequest(int i)
 186:ServerLLDN.c  **** 	{
 1222               		.loc 6 186 0
 1223               		.cfi_startproc
 1224 0506 CF93      		push r28
 1225               	.LCFI59:
 1226               		.cfi_def_cfa_offset 3
 1227               		.cfi_offset 28, -2
 1228 0508 DF93      		push r29
 1229               	.LCFI60:
 1230               		.cfi_def_cfa_offset 4
 1231               		.cfi_offset 29, -3
 1232 050a 00D0      		rcall .
 1233               	.LCFI61:
 1234               		.cfi_def_cfa_offset 6
 1235 050c CDB7      		in r28,__SP_L__
 1236 050e DEB7      		in r29,__SP_H__
 1237               	.LCFI62:
 1238               		.cfi_def_cfa_register 28
 1239               	/* prologue: function */
 1240               	/* frame size = 2 */
 1241               	/* stack size = 4 */
 1242               	.L__stack_usage = 4
 1243 0510 9A83      		std Y+2,r25
 1244 0512 8983      		std Y+1,r24
 187:ServerLLDN.c  **** 		config_request_frame.assTimeSlot = nodes_info_arr[i].assigned_time_slot;
 1245               		.loc 6 187 0
 1246 0514 8981      		ldd r24,Y+1
 1247 0516 9A81      		ldd r25,Y+2
 1248 0518 880F      		lsl r24
 1249 051a 991F      		rol r25
 1250 051c 880F      		lsl r24
 1251 051e 991F      		rol r25
 1252 0520 8050      		subi r24,lo8(-(nodes_info_arr))
 1253 0522 9040      		sbci r25,hi8(-(nodes_info_arr))
 1254 0524 FC01      		movw r30,r24
 1255 0526 8081      		ld r24,Z
 1256 0528 8093 0000 		sts config_request_frame+3,r24
 188:ServerLLDN.c  **** 		config_request_frame.macAddr = nodes_info_arr[i].mac_addr;
 1257               		.loc 6 188 0
 1258 052c 8981      		ldd r24,Y+1
 1259 052e 9A81      		ldd r25,Y+2
 1260 0530 880F      		lsl r24
 1261 0532 991F      		rol r25
 1262 0534 880F      		lsl r24
 1263 0536 991F      		rol r25
 1264 0538 8050      		subi r24,lo8(-(nodes_info_arr+1))
 1265 053a 9040      		sbci r25,hi8(-(nodes_info_arr+1))
 1266 053c FC01      		movw r30,r24
 1267 053e 8081      		ld r24,Z
 1268 0540 9181      		ldd r25,Z+1
 1269 0542 8093 0000 		sts config_request_frame+4,r24
 189:ServerLLDN.c  **** 	}
 1270               		.loc 6 189 0
 1271 0546 0000      		nop
 1272               	/* epilogue start */
 1273 0548 0F90      		pop __tmp_reg__
 1274 054a 0F90      		pop __tmp_reg__
 1275 054c DF91      		pop r29
 1276 054e CF91      		pop r28
 1277 0550 0895      		ret
 1278               		.cfi_endproc
 1279               	.LFE139:
 1281               		.section	.rodata
 1282               	.LC6:
 1283 0054 0A44 4953 		.string	"\nDISC %hhx"
 1283      4320 2568 
 1283      6878 00
 1284               	.LC7:
 1285 005f 0A43 4F4E 		.string	"\nCONF %d"
 1285      4620 2564 
 1285      00
 1286               		.text
 1288               	appCommandInd:
 1289               	.LFB140:
 190:ServerLLDN.c  **** 
 191:ServerLLDN.c  **** 
 192:ServerLLDN.c  **** 	static bool appCommandInd(NWK_DataInd_t *ind)
 193:ServerLLDN.c  **** 	{
 1290               		.loc 6 193 0
 1291               		.cfi_startproc
 1292 0552 CF93      		push r28
 1293               	.LCFI63:
 1294               		.cfi_def_cfa_offset 3
 1295               		.cfi_offset 28, -2
 1296 0554 DF93      		push r29
 1297               	.LCFI64:
 1298               		.cfi_def_cfa_offset 4
 1299               		.cfi_offset 29, -3
 1300 0556 00D0      		rcall .
 1301 0558 00D0      		rcall .
 1302 055a 00D0      		rcall .
 1303               	.LCFI65:
 1304               		.cfi_def_cfa_offset 10
 1305 055c CDB7      		in r28,__SP_L__
 1306 055e DEB7      		in r29,__SP_H__
 1307               	.LCFI66:
 1308               		.cfi_def_cfa_register 28
 1309               	/* prologue: function */
 1310               	/* frame size = 6 */
 1311               	/* stack size = 8 */
 1312               	.L__stack_usage = 8
 1313 0560 9E83      		std Y+6,r25
 1314 0562 8D83      		std Y+5,r24
 194:ServerLLDN.c  **** 		if(ind->data[0] == LL_DISCOVER_RESPONSE)
 1315               		.loc 6 194 0
 1316 0564 8D81      		ldd r24,Y+5
 1317 0566 9E81      		ldd r25,Y+6
 1318 0568 FC01      		movw r30,r24
 1319 056a 8085      		ldd r24,Z+8
 1320 056c 9185      		ldd r25,Z+9
 1321 056e FC01      		movw r30,r24
 1322 0570 8081      		ld r24,Z
 1323 0572 8D30      		cpi r24,lo8(13)
 1324 0574 01F4      		brne .L37
 1325               	.LBB2:
 195:ServerLLDN.c  **** 		{
 196:ServerLLDN.c  **** 			NWK_DiscoverResponse_t *msg = (NWK_DiscoverResponse_t*)ind->data;
 1326               		.loc 6 196 0
 1327 0576 8D81      		ldd r24,Y+5
 1328 0578 9E81      		ldd r25,Y+6
 1329 057a FC01      		movw r30,r24
 1330 057c 8085      		ldd r24,Z+8
 1331 057e 9185      		ldd r25,Z+9
 1332 0580 9C83      		std Y+4,r25
 1333 0582 8B83      		std Y+3,r24
 197:ServerLLDN.c  **** 			addToAckArray(msg->macAddr);	
 1334               		.loc 6 197 0
 1335 0584 8B81      		ldd r24,Y+3
 1336 0586 9C81      		ldd r25,Y+4
 1337 0588 FC01      		movw r30,r24
 1338 058a 8181      		ldd r24,Z+1
 1339 058c 0E94 0000 		call addToAckArray
 198:ServerLLDN.c  **** 					
 199:ServerLLDN.c  **** 			#if PRINT
 200:ServerLLDN.c  **** 			printf("\nDISC %hhx", msg->macAddr);	
 1340               		.loc 6 200 0
 1341 0590 8B81      		ldd r24,Y+3
 1342 0592 9C81      		ldd r25,Y+4
 1343 0594 FC01      		movw r30,r24
 1344 0596 8181      		ldd r24,Z+1
 1345 0598 882F      		mov r24,r24
 1346 059a 90E0      		ldi r25,0
 1347 059c 292F      		mov r18,r25
 1348 059e 2F93      		push r18
 1349 05a0 8F93      		push r24
 1350 05a2 80E0      		ldi r24,lo8(.LC6)
 1351 05a4 90E0      		ldi r25,hi8(.LC6)
 1352 05a6 892F      		mov r24,r25
 1353 05a8 8F93      		push r24
 1354 05aa 80E0      		ldi r24,lo8(.LC6)
 1355 05ac 90E0      		ldi r25,hi8(.LC6)
 1356 05ae 8F93      		push r24
 1357 05b0 0E94 0000 		call printf
 1358 05b4 0F90      		pop __tmp_reg__
 1359 05b6 0F90      		pop __tmp_reg__
 1360 05b8 0F90      		pop __tmp_reg__
 1361 05ba 0F90      		pop __tmp_reg__
 1362               	.LBE2:
 1363 05bc 00C0      		rjmp .L38
 1364               	.L37:
 201:ServerLLDN.c  **** 			#endif
 202:ServerLLDN.c  **** 		}
 203:ServerLLDN.c  **** 		else if(ind->data[0] == LL_CONFIGURATION_STATUS)
 1365               		.loc 6 203 0
 1366 05be 8D81      		ldd r24,Y+5
 1367 05c0 9E81      		ldd r25,Y+6
 1368 05c2 FC01      		movw r30,r24
 1369 05c4 8085      		ldd r24,Z+8
 1370 05c6 9185      		ldd r25,Z+9
 1371 05c8 FC01      		movw r30,r24
 1372 05ca 8081      		ld r24,Z
 1373 05cc 8E30      		cpi r24,lo8(14)
 1374 05ce 01F4      		brne .L39
 1375               	.LBB3:
 204:ServerLLDN.c  **** 		{
 205:ServerLLDN.c  **** 			NWK_ConfigStatus_t *msg = (NWK_ConfigStatus_t*)ind->data;
 1376               		.loc 6 205 0
 1377 05d0 8D81      		ldd r24,Y+5
 1378 05d2 9E81      		ldd r25,Y+6
 1379 05d4 FC01      		movw r30,r24
 1380 05d6 8085      		ldd r24,Z+8
 1381 05d8 9185      		ldd r25,Z+9
 1382 05da 9A83      		std Y+2,r25
 1383 05dc 8983      		std Y+1,r24
 206:ServerLLDN.c  **** 			addConfRequestArray(msg);
 1384               		.loc 6 206 0
 1385 05de 8981      		ldd r24,Y+1
 1386 05e0 9A81      		ldd r25,Y+2
 1387 05e2 0E94 0000 		call addConfRequestArray
 207:ServerLLDN.c  **** 			#if PRINT
 208:ServerLLDN.c  **** 			printf("\nCONF %d", msg->macAddr);	
 1388               		.loc 6 208 0
 1389 05e6 8981      		ldd r24,Y+1
 1390 05e8 9A81      		ldd r25,Y+2
 1391 05ea FC01      		movw r30,r24
 1392 05ec 8381      		ldd r24,Z+3
 1393 05ee 882F      		mov r24,r24
 1394 05f0 90E0      		ldi r25,0
 1395 05f2 292F      		mov r18,r25
 1396 05f4 2F93      		push r18
 1397 05f6 8F93      		push r24
 1398 05f8 80E0      		ldi r24,lo8(.LC7)
 1399 05fa 90E0      		ldi r25,hi8(.LC7)
 1400 05fc 892F      		mov r24,r25
 1401 05fe 8F93      		push r24
 1402 0600 80E0      		ldi r24,lo8(.LC7)
 1403 0602 90E0      		ldi r25,hi8(.LC7)
 1404 0604 8F93      		push r24
 1405 0606 0E94 0000 		call printf
 1406 060a 0F90      		pop __tmp_reg__
 1407 060c 0F90      		pop __tmp_reg__
 1408 060e 0F90      		pop __tmp_reg__
 1409 0610 0F90      		pop __tmp_reg__
 1410               	.LBE3:
 1411 0612 00C0      		rjmp .L38
 1412               	.L39:
 209:ServerLLDN.c  **** 			#endif
 210:ServerLLDN.c  **** 		}
 211:ServerLLDN.c  **** 		else return false;			
 1413               		.loc 6 211 0
 1414 0614 80E0      		ldi r24,0
 1415 0616 00C0      		rjmp .L40
 1416               	.L38:
 212:ServerLLDN.c  **** 		return true;
 1417               		.loc 6 212 0
 1418 0618 81E0      		ldi r24,lo8(1)
 1419               	.L40:
 1420               	/* epilogue start */
 213:ServerLLDN.c  **** 	}
 1421               		.loc 6 213 0
 1422 061a 2696      		adiw r28,6
 1423 061c 0FB6      		in __tmp_reg__,__SREG__
 1424 061e F894      		cli
 1425 0620 DEBF      		out __SP_H__,r29
 1426 0622 0FBE      		out __SREG__,__tmp_reg__
 1427 0624 CDBF      		out __SP_L__,r28
 1428 0626 DF91      		pop r29
 1429 0628 CF91      		pop r28
 1430 062a 0895      		ret
 1431               		.cfi_endproc
 1432               	.LFE140:
 1435               	appPanPrepareACK:
 1436               	.LFB141:
 214:ServerLLDN.c  **** 	
 215:ServerLLDN.c  **** 	static void appPanPrepareACK(void)
 216:ServerLLDN.c  **** 	{
 1437               		.loc 6 216 0
 1438               		.cfi_startproc
 1439 062c CF93      		push r28
 1440               	.LCFI67:
 1441               		.cfi_def_cfa_offset 3
 1442               		.cfi_offset 28, -2
 1443 062e DF93      		push r29
 1444               	.LCFI68:
 1445               		.cfi_def_cfa_offset 4
 1446               		.cfi_offset 29, -3
 1447 0630 CDB7      		in r28,__SP_L__
 1448 0632 DEB7      		in r29,__SP_H__
 1449               	.LCFI69:
 1450               		.cfi_def_cfa_register 28
 1451               	/* prologue: function */
 1452               	/* frame size = 0 */
 1453               	/* stack size = 2 */
 1454               	.L__stack_usage = 2
 217:ServerLLDN.c  **** 		msgReq.dstAddr		= 0;
 1455               		.loc 6 217 0
 1456 0634 1092 0000 		sts msgReq+5+1,__zero_reg__
 1457 0638 1092 0000 		sts msgReq+5,__zero_reg__
 218:ServerLLDN.c  **** 		msgReq.dstEndpoint	= APP_BEACON_ENDPOINT;
 1458               		.loc 6 218 0
 1459 063c 1092 0000 		sts msgReq+7,__zero_reg__
 219:ServerLLDN.c  **** 		msgReq.srcEndpoint	= APP_BEACON_ENDPOINT;
 1460               		.loc 6 219 0
 1461 0640 1092 0000 		sts msgReq+8,__zero_reg__
 220:ServerLLDN.c  **** 		msgReq.options		= NWK_OPT_LLDN_ACK;
 1462               		.loc 6 220 0
 1463 0644 80E0      		ldi r24,0
 1464 0646 90E4      		ldi r25,lo8(64)
 1465 0648 9093 0000 		sts msgReq+9+1,r25
 1466 064c 8093 0000 		sts msgReq+9,r24
 221:ServerLLDN.c  **** 		msgReq.data	= (uint8_t *)&ACKFrame;
 1467               		.loc 6 221 0
 1468 0650 80E0      		ldi r24,lo8(ACKFrame)
 1469 0652 90E0      		ldi r25,hi8(ACKFrame)
 1470 0654 9093 0000 		sts msgReq+13+1,r25
 1471 0658 8093 0000 		sts msgReq+13,r24
 222:ServerLLDN.c  **** 		msgReq.size	= sizeof(uint8_t)*(ACKFrame_size + 1);
 1472               		.loc 6 222 0
 1473 065c 8091 0000 		lds r24,ACKFrame_size
 1474 0660 9091 0000 		lds r25,ACKFrame_size+1
 1475 0664 8F5F      		subi r24,lo8(-(1))
 1476 0666 8093 0000 		sts msgReq+15,r24
 223:ServerLLDN.c  **** 
 224:ServerLLDN.c  **** 	}
 1477               		.loc 6 224 0
 1478 066a 0000      		nop
 1479               	/* epilogue start */
 1480 066c DF91      		pop r29
 1481 066e CF91      		pop r28
 1482 0670 0895      		ret
 1483               		.cfi_endproc
 1484               	.LFE141:
 1487               	appPanReset:
 1488               	.LFB142:
 225:ServerLLDN.c  **** 
 226:ServerLLDN.c  **** 	static void appPanReset(void)
 227:ServerLLDN.c  **** 	{
 1489               		.loc 6 227 0
 1490               		.cfi_startproc
 1491 0672 CF93      		push r28
 1492               	.LCFI70:
 1493               		.cfi_def_cfa_offset 3
 1494               		.cfi_offset 28, -2
 1495 0674 DF93      		push r29
 1496               	.LCFI71:
 1497               		.cfi_def_cfa_offset 4
 1498               		.cfi_offset 29, -3
 1499 0676 00D0      		rcall .
 1500 0678 00D0      		rcall .
 1501               	.LCFI72:
 1502               		.cfi_def_cfa_offset 8
 1503 067a CDB7      		in r28,__SP_L__
 1504 067c DEB7      		in r29,__SP_H__
 1505               	.LCFI73:
 1506               		.cfi_def_cfa_register 28
 1507               	/* prologue: function */
 1508               	/* frame size = 4 */
 1509               	/* stack size = 6 */
 1510               	.L__stack_usage = 6
 228:ServerLLDN.c  **** 		// prepare beacon reset message
 229:ServerLLDN.c  **** 		msgReq.dstAddr		= 0;
 1511               		.loc 6 229 0
 1512 067e 1092 0000 		sts msgReq+5+1,__zero_reg__
 1513 0682 1092 0000 		sts msgReq+5,__zero_reg__
 230:ServerLLDN.c  **** 		msgReq.dstEndpoint	= APP_BEACON_ENDPOINT;
 1514               		.loc 6 230 0
 1515 0686 1092 0000 		sts msgReq+7,__zero_reg__
 231:ServerLLDN.c  **** 		msgReq.srcEndpoint	= APP_BEACON_ENDPOINT;
 1516               		.loc 6 231 0
 1517 068a 1092 0000 		sts msgReq+8,__zero_reg__
 232:ServerLLDN.c  **** 		msgReq.options		= NWK_OPT_LLDN_BEACON | NWK_OPT_RESET_STATE;
 1518               		.loc 6 232 0
 1519 068e 80E4      		ldi r24,lo8(64)
 1520 0690 94E0      		ldi r25,lo8(4)
 1521 0692 9093 0000 		sts msgReq+9+1,r25
 1522 0696 8093 0000 		sts msgReq+9,r24
 233:ServerLLDN.c  **** 		msgReq.data			= NULL;
 1523               		.loc 6 233 0
 1524 069a 1092 0000 		sts msgReq+13+1,__zero_reg__
 1525 069e 1092 0000 		sts msgReq+13,__zero_reg__
 234:ServerLLDN.c  **** 		msgReq.size			= 0;
 1526               		.loc 6 234 0
 1527 06a2 1092 0000 		sts msgReq+15,__zero_reg__
 1528               	.LBB4:
 235:ServerLLDN.c  **** 
 236:ServerLLDN.c  **** 		for(int i = 0; i < 32; i++)
 1529               		.loc 6 236 0
 1530 06a6 1A82      		std Y+2,__zero_reg__
 1531 06a8 1982      		std Y+1,__zero_reg__
 1532 06aa 00C0      		rjmp .L43
 1533               	.L44:
 237:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1534               		.loc 6 237 0 discriminator 3
 1535 06ac 8981      		ldd r24,Y+1
 1536 06ae 9A81      		ldd r25,Y+2
 1537 06b0 8050      		subi r24,lo8(-(ACKFrame+1))
 1538 06b2 9040      		sbci r25,hi8(-(ACKFrame+1))
 1539 06b4 FC01      		movw r30,r24
 1540 06b6 1082      		st Z,__zero_reg__
 236:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1541               		.loc 6 236 0 discriminator 3
 1542 06b8 8981      		ldd r24,Y+1
 1543 06ba 9A81      		ldd r25,Y+2
 1544 06bc 0196      		adiw r24,1
 1545 06be 9A83      		std Y+2,r25
 1546 06c0 8983      		std Y+1,r24
 1547               	.L43:
 236:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1548               		.loc 6 236 0 is_stmt 0 discriminator 1
 1549 06c2 8981      		ldd r24,Y+1
 1550 06c4 9A81      		ldd r25,Y+2
 1551 06c6 8097      		sbiw r24,32
 1552 06c8 04F0      		brlt .L44
 1553               	.LBE4:
 1554               	.LBB5:
 238:ServerLLDN.c  **** 		for (int i = 0; i < 255; i++)
 1555               		.loc 6 238 0 is_stmt 1
 1556 06ca 1C82      		std Y+4,__zero_reg__
 1557 06cc 1B82      		std Y+3,__zero_reg__
 1558 06ce 00C0      		rjmp .L45
 1559               	.L46:
 239:ServerLLDN.c  **** 		{
 240:ServerLLDN.c  **** 			arr_slots[i] = 0;
 1560               		.loc 6 240 0 discriminator 3
 1561 06d0 8B81      		ldd r24,Y+3
 1562 06d2 9C81      		ldd r25,Y+4
 1563 06d4 8050      		subi r24,lo8(-(arr_slots))
 1564 06d6 9040      		sbci r25,hi8(-(arr_slots))
 1565 06d8 FC01      		movw r30,r24
 1566 06da 1082      		st Z,__zero_reg__
 241:ServerLLDN.c  **** 			nodes_info_arr[i].mac_addr = 0;
 1567               		.loc 6 241 0 discriminator 3
 1568 06dc 8B81      		ldd r24,Y+3
 1569 06de 9C81      		ldd r25,Y+4
 1570 06e0 880F      		lsl r24
 1571 06e2 991F      		rol r25
 1572 06e4 880F      		lsl r24
 1573 06e6 991F      		rol r25
 1574 06e8 8050      		subi r24,lo8(-(nodes_info_arr+1))
 1575 06ea 9040      		sbci r25,hi8(-(nodes_info_arr+1))
 1576 06ec FC01      		movw r30,r24
 1577 06ee 1182      		std Z+1,__zero_reg__
 1578 06f0 1082      		st Z,__zero_reg__
 238:ServerLLDN.c  **** 		for (int i = 0; i < 255; i++)
 1579               		.loc 6 238 0 discriminator 3
 1580 06f2 8B81      		ldd r24,Y+3
 1581 06f4 9C81      		ldd r25,Y+4
 1582 06f6 0196      		adiw r24,1
 1583 06f8 9C83      		std Y+4,r25
 1584 06fa 8B83      		std Y+3,r24
 1585               	.L45:
 238:ServerLLDN.c  **** 		for (int i = 0; i < 255; i++)
 1586               		.loc 6 238 0 is_stmt 0 discriminator 1
 1587 06fc 8B81      		ldd r24,Y+3
 1588 06fe 9C81      		ldd r25,Y+4
 1589 0700 8F3F      		cpi r24,-1
 1590 0702 9105      		cpc r25,__zero_reg__
 1591 0704 04F0      		brlt .L46
 1592               	.LBE5:
 242:ServerLLDN.c  **** 		}
 243:ServerLLDN.c  **** 		assTimeSlot = MacLLDNMgmtTS * 2;
 1593               		.loc 6 243 0 is_stmt 1
 1594 0706 82E0      		ldi r24,lo8(2)
 1595 0708 90E0      		ldi r25,0
 1596 070a 9093 0000 		sts assTimeSlot+1,r25
 1597 070e 8093 0000 		sts assTimeSlot,r24
 244:ServerLLDN.c  **** 		ACKFrame_size = 0;
 1598               		.loc 6 244 0
 1599 0712 1092 0000 		sts ACKFrame_size+1,__zero_reg__
 1600 0716 1092 0000 		sts ACKFrame_size,__zero_reg__
 245:ServerLLDN.c  **** 		conf_req_index = 0;
 1601               		.loc 6 245 0
 1602 071a 1092 0000 		sts conf_req_index+1,__zero_reg__
 1603 071e 1092 0000 		sts conf_req_index,__zero_reg__
 246:ServerLLDN.c  **** 		counter_associados = 0;
 1604               		.loc 6 246 0
 1605 0722 1092 0000 		sts counter_associados+1,__zero_reg__
 1606 0726 1092 0000 		sts counter_associados,__zero_reg__
 247:ServerLLDN.c  **** 		n = 0;
 1607               		.loc 6 247 0
 1608 072a 1092 0000 		sts n,__zero_reg__
 248:ServerLLDN.c  **** 	}
 1609               		.loc 6 248 0
 1610 072e 0000      		nop
 1611               	/* epilogue start */
 1612 0730 0F90      		pop __tmp_reg__
 1613 0732 0F90      		pop __tmp_reg__
 1614 0734 0F90      		pop __tmp_reg__
 1615 0736 0F90      		pop __tmp_reg__
 1616 0738 DF91      		pop r29
 1617 073a CF91      		pop r28
 1618 073c 0895      		ret
 1619               		.cfi_endproc
 1620               	.LFE142:
 1622               	.global	__floatsisf
 1623               	.global	__addsf3
 1624               	.global	__divsf3
 1625               	.global	__mulsf3
 1626               	.global	__fixunssfsi
 1628               	appPanDiscInit:
 1629               	.LFB143:
 249:ServerLLDN.c  **** 
 250:ServerLLDN.c  **** 	static void appPanDiscInit(void)
 251:ServerLLDN.c  **** 	{	
 1630               		.loc 6 251 0
 1631               		.cfi_startproc
 1632 073e CF93      		push r28
 1633               	.LCFI74:
 1634               		.cfi_def_cfa_offset 3
 1635               		.cfi_offset 28, -2
 1636 0740 DF93      		push r29
 1637               	.LCFI75:
 1638               		.cfi_def_cfa_offset 4
 1639               		.cfi_offset 29, -3
 1640 0742 00D0      		rcall .
 1641               	.LCFI76:
 1642               		.cfi_def_cfa_offset 6
 1643 0744 CDB7      		in r28,__SP_L__
 1644 0746 DEB7      		in r29,__SP_H__
 1645               	.LCFI77:
 1646               		.cfi_def_cfa_register 28
 1647               	/* prologue: function */
 1648               	/* frame size = 2 */
 1649               	/* stack size = 4 */
 1650               	.L__stack_usage = 4
 1651               	.LBB6:
 252:ServerLLDN.c  **** 		/* clear Ack array of previous discovery state */
 253:ServerLLDN.c  **** 		for(int i = 0; i < 32; i++)
 1652               		.loc 6 253 0
 1653 0748 1A82      		std Y+2,__zero_reg__
 1654 074a 1982      		std Y+1,__zero_reg__
 1655 074c 00C0      		rjmp .L48
 1656               	.L49:
 254:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1657               		.loc 6 254 0 discriminator 3
 1658 074e 8981      		ldd r24,Y+1
 1659 0750 9A81      		ldd r25,Y+2
 1660 0752 8050      		subi r24,lo8(-(ACKFrame+1))
 1661 0754 9040      		sbci r25,hi8(-(ACKFrame+1))
 1662 0756 FC01      		movw r30,r24
 1663 0758 1082      		st Z,__zero_reg__
 253:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1664               		.loc 6 253 0 discriminator 3
 1665 075a 8981      		ldd r24,Y+1
 1666 075c 9A81      		ldd r25,Y+2
 1667 075e 0196      		adiw r24,1
 1668 0760 9A83      		std Y+2,r25
 1669 0762 8983      		std Y+1,r24
 1670               	.L48:
 253:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1671               		.loc 6 253 0 is_stmt 0 discriminator 1
 1672 0764 8981      		ldd r24,Y+1
 1673 0766 9A81      		ldd r25,Y+2
 1674 0768 8097      		sbiw r24,32
 1675 076a 04F0      		brlt .L49
 1676               	.LBE6:
 255:ServerLLDN.c  **** 		ACKFrame_size = 0;
 1677               		.loc 6 255 0 is_stmt 1
 1678 076c 1092 0000 		sts ACKFrame_size+1,__zero_reg__
 1679 0770 1092 0000 		sts ACKFrame_size,__zero_reg__
 256:ServerLLDN.c  **** 		/* Prepare Beacon Message as first beacon in discovery state */		
 257:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 1680               		.loc 6 257 0
 1681 0774 1092 0000 		sts msgReq+5+1,__zero_reg__
 1682 0778 1092 0000 		sts msgReq+5,__zero_reg__
 258:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_BEACON_ENDPOINT;
 1683               		.loc 6 258 0
 1684 077c 1092 0000 		sts msgReq+7,__zero_reg__
 259:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_BEACON_ENDPOINT;
 1685               		.loc 6 259 0
 1686 0780 1092 0000 		sts msgReq+8,__zero_reg__
 260:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_LLDN_BEACON | NWK_OPT_DISCOVERY_STATE;
 1687               		.loc 6 260 0
 1688 0784 80E4      		ldi r24,lo8(64)
 1689 0786 91E0      		ldi r25,lo8(1)
 1690 0788 9093 0000 		sts msgReq+9+1,r25
 1691 078c 8093 0000 		sts msgReq+9,r24
 261:ServerLLDN.c  **** 		msgReq.data					= NULL;
 1692               		.loc 6 261 0
 1693 0790 1092 0000 		sts msgReq+13+1,__zero_reg__
 1694 0794 1092 0000 		sts msgReq+13,__zero_reg__
 262:ServerLLDN.c  **** 		msgReq.size					= 0;
 1695               		.loc 6 262 0
 1696 0798 1092 0000 		sts msgReq+15,__zero_reg__
 263:ServerLLDN.c  **** 		
 264:ServerLLDN.c  **** 		
 265:ServerLLDN.c  **** 		/* Only start timers if it is the first association process */
 266:ServerLLDN.c  **** 		if(cycles_counter == 0) 
 1697               		.loc 6 266 0
 1698 079c 8091 0000 		lds r24,cycles_counter
 1699 07a0 8823      		tst r24
 1700 07a2 01F0      		breq .+2
 1701 07a4 00C0      		rjmp .L51
 267:ServerLLDN.c  **** 		{
 268:ServerLLDN.c  **** 			
 269:ServerLLDN.c  **** 		/* Calculates Beacon Intervals according to 802.15.4e - 2012 p. 70 */
 270:ServerLLDN.c  **** 		n = 127; 
 1702               		.loc 6 270 0
 1703 07a6 8FE7      		ldi r24,lo8(127)
 1704 07a8 8093 0000 		sts n,r24
 271:ServerLLDN.c  **** 		tTS =  ((p_var*sp + (m+n)*sm + macMinLIFSPeriod)/v_var);
 1705               		.loc 6 271 0
 1706 07ac 8091 0000 		lds r24,n
 1707 07b0 882F      		mov r24,r24
 1708 07b2 90E0      		ldi r25,0
 1709 07b4 0396      		adiw r24,3
 1710 07b6 880F      		lsl r24
 1711 07b8 991F      		rol r25
 1712 07ba 092E      		mov __tmp_reg__,r25
 1713 07bc 000C      		lsl r0
 1714 07be AA0B      		sbc r26,r26
 1715 07c0 BB0B      		sbc r27,r27
 1716 07c2 BC01      		movw r22,r24
 1717 07c4 CD01      		movw r24,r26
 1718 07c6 0E94 0000 		call __floatsisf
 1719 07ca DC01      		movw r26,r24
 1720 07cc CB01      		movw r24,r22
 1721 07ce 20E0      		ldi r18,0
 1722 07d0 30E0      		ldi r19,0
 1723 07d2 40E4      		ldi r20,lo8(64)
 1724 07d4 51E4      		ldi r21,lo8(65)
 1725 07d6 BC01      		movw r22,r24
 1726 07d8 CD01      		movw r24,r26
 1727 07da 0E94 0000 		call __addsf3
 1728 07de DC01      		movw r26,r24
 1729 07e0 CB01      		movw r24,r22
 1730 07e2 20E0      		ldi r18,0
 1731 07e4 30E0      		ldi r19,0
 1732 07e6 40E2      		ldi r20,lo8(32)
 1733 07e8 52E4      		ldi r21,lo8(66)
 1734 07ea BC01      		movw r22,r24
 1735 07ec CD01      		movw r24,r26
 1736 07ee 0E94 0000 		call __addsf3
 1737 07f2 DC01      		movw r26,r24
 1738 07f4 CB01      		movw r24,r22
 1739 07f6 20E0      		ldi r18,0
 1740 07f8 34E2      		ldi r19,lo8(36)
 1741 07fa 44E7      		ldi r20,lo8(116)
 1742 07fc 57E4      		ldi r21,lo8(71)
 1743 07fe BC01      		movw r22,r24
 1744 0800 CD01      		movw r24,r26
 1745 0802 0E94 0000 		call __divsf3
 1746 0806 DC01      		movw r26,r24
 1747 0808 CB01      		movw r24,r22
 1748 080a 8093 0000 		sts tTS,r24
 1749 080e 9093 0000 		sts tTS+1,r25
 1750 0812 A093 0000 		sts tTS+2,r26
 1751 0816 B093 0000 		sts tTS+3,r27
 272:ServerLLDN.c  **** 		#if (MASTER_MACSC == 1)
 273:ServerLLDN.c  **** 		
 274:ServerLLDN.c  **** 			beaconInterval = 2 * numBaseTimeSlotperMgmt * (tTS) / (SYMBOL_TIME);
 1752               		.loc 6 274 0
 1753 081a 8091 0000 		lds r24,tTS
 1754 081e 9091 0000 		lds r25,tTS+1
 1755 0822 A091 0000 		lds r26,tTS+2
 1756 0826 B091 0000 		lds r27,tTS+3
 1757 082a 20E0      		ldi r18,0
 1758 082c 30E0      		ldi r19,0
 1759 082e 40E8      		ldi r20,lo8(-128)
 1760 0830 50E4      		ldi r21,lo8(64)
 1761 0832 BC01      		movw r22,r24
 1762 0834 CD01      		movw r24,r26
 1763 0836 0E94 0000 		call __mulsf3
 1764 083a DC01      		movw r26,r24
 1765 083c CB01      		movw r24,r22
 1766 083e 2DEB      		ldi r18,lo8(-67)
 1767 0840 37E3      		ldi r19,lo8(55)
 1768 0842 46E8      		ldi r20,lo8(-122)
 1769 0844 57E3      		ldi r21,lo8(55)
 1770 0846 BC01      		movw r22,r24
 1771 0848 CD01      		movw r24,r26
 1772 084a 0E94 0000 		call __divsf3
 1773 084e DC01      		movw r26,r24
 1774 0850 CB01      		movw r24,r22
 1775 0852 BC01      		movw r22,r24
 1776 0854 CD01      		movw r24,r26
 1777 0856 0E94 0000 		call __fixunssfsi
 1778 085a DC01      		movw r26,r24
 1779 085c CB01      		movw r24,r22
 1780 085e 9093 0000 		sts beaconInterval+1,r25
 1781 0862 8093 0000 		sts beaconInterval,r24
 275:ServerLLDN.c  **** 			/*
 276:ServerLLDN.c  **** 			* Configure interrupts callback functions
 277:ServerLLDN.c  **** 			* overflow interrupt, compare 1,2,3 interrupts
 278:ServerLLDN.c  **** 			*/
 279:ServerLLDN.c  **** 			macsc_set_cmp1_int_cb(lldn_server_beacon);
 1782               		.loc 6 279 0
 1783 0866 80E0      		ldi r24,lo8(gs(lldn_server_beacon))
 1784 0868 90E0      		ldi r25,hi8(gs(lldn_server_beacon))
 1785 086a 0E94 0000 		call macsc_set_cmp1_int_cb
 280:ServerLLDN.c  **** 			/*
 281:ServerLLDN.c  **** 			* Configure MACSC to generate compare interrupts from channels 1,2,3
 282:ServerLLDN.c  **** 			* Set compare mode to absolute, set compare value.
 283:ServerLLDN.c  **** 			*/
 284:ServerLLDN.c  **** 			macsc_enable_manual_bts();
 1786               		.loc 6 284 0
 1787 086e 0E94 0000 		call macsc_enable_manual_bts
 285:ServerLLDN.c  **** 			macsc_enable_cmp_int(MACSC_CC1);
 1788               		.loc 6 285 0
 1789 0872 81E0      		ldi r24,lo8(1)
 1790 0874 0E94 0000 		call macsc_enable_cmp_int
 286:ServerLLDN.c  **** 
 287:ServerLLDN.c  **** 			macsc_use_cmp(MACSC_RELATIVE_CMP, beaconInterval , MACSC_CC1);
 1791               		.loc 6 287 0
 1792 0878 8091 0000 		lds r24,beaconInterval
 1793 087c 9091 0000 		lds r25,beaconInterval+1
 1794 0880 CC01      		movw r24,r24
 1795 0882 A0E0      		ldi r26,0
 1796 0884 B0E0      		ldi r27,0
 1797 0886 21E0      		ldi r18,lo8(1)
 1798 0888 AC01      		movw r20,r24
 1799 088a BD01      		movw r22,r26
 1800 088c 81E0      		ldi r24,lo8(1)
 1801 088e 0E94 0000 		call macsc_use_cmp
 288:ServerLLDN.c  **** 			
 289:ServerLLDN.c  **** 			/* Timer used in testing */
 290:ServerLLDN.c  **** 			#if TIMESLOT_TIMER
 291:ServerLLDN.c  **** 			macsc_set_cmp2_int_cb(teste_handler);	
 1802               		.loc 6 291 0
 1803 0892 80E0      		ldi r24,lo8(gs(teste_handler))
 1804 0894 90E0      		ldi r25,hi8(gs(teste_handler))
 1805 0896 0E94 0000 		call macsc_set_cmp2_int_cb
 292:ServerLLDN.c  **** 			macsc_enable_cmp_int(MACSC_CC2);
 1806               		.loc 6 292 0
 1807 089a 82E0      		ldi r24,lo8(2)
 1808 089c 0E94 0000 		call macsc_enable_cmp_int
 293:ServerLLDN.c  **** 			macsc_use_cmp(MACSC_RELATIVE_CMP, beaconInterval / 2, MACSC_CC2);
 1809               		.loc 6 293 0
 1810 08a0 8091 0000 		lds r24,beaconInterval
 1811 08a4 9091 0000 		lds r25,beaconInterval+1
 1812 08a8 9695      		lsr r25
 1813 08aa 8795      		ror r24
 1814 08ac CC01      		movw r24,r24
 1815 08ae A0E0      		ldi r26,0
 1816 08b0 B0E0      		ldi r27,0
 1817 08b2 22E0      		ldi r18,lo8(2)
 1818 08b4 AC01      		movw r20,r24
 1819 08b6 BD01      		movw r22,r26
 1820 08b8 81E0      		ldi r24,lo8(1)
 1821 08ba 0E94 0000 		call macsc_use_cmp
 1822               	.L51:
 294:ServerLLDN.c  **** 			#endif
 295:ServerLLDN.c  **** 			
 296:ServerLLDN.c  **** 		#endif
 297:ServerLLDN.c  **** 		}
 298:ServerLLDN.c  **** 	}
 1823               		.loc 6 298 0
 1824 08be 0000      		nop
 1825               	/* epilogue start */
 1826 08c0 0F90      		pop __tmp_reg__
 1827 08c2 0F90      		pop __tmp_reg__
 1828 08c4 DF91      		pop r29
 1829 08c6 CF91      		pop r28
 1830 08c8 0895      		ret
 1831               		.cfi_endproc
 1832               	.LFE143:
 1835               	appPanOnlineInit:
 1836               	.LFB144:
 299:ServerLLDN.c  **** 
 300:ServerLLDN.c  **** 	static void appPanOnlineInit()
 301:ServerLLDN.c  **** 	{
 1837               		.loc 6 301 0
 1838               		.cfi_startproc
 1839 08ca EF92      		push r14
 1840               	.LCFI78:
 1841               		.cfi_def_cfa_offset 3
 1842               		.cfi_offset 14, -2
 1843 08cc FF92      		push r15
 1844               	.LCFI79:
 1845               		.cfi_def_cfa_offset 4
 1846               		.cfi_offset 15, -3
 1847 08ce 0F93      		push r16
 1848               	.LCFI80:
 1849               		.cfi_def_cfa_offset 5
 1850               		.cfi_offset 16, -4
 1851 08d0 1F93      		push r17
 1852               	.LCFI81:
 1853               		.cfi_def_cfa_offset 6
 1854               		.cfi_offset 17, -5
 1855 08d2 CF93      		push r28
 1856               	.LCFI82:
 1857               		.cfi_def_cfa_offset 7
 1858               		.cfi_offset 28, -6
 1859 08d4 DF93      		push r29
 1860               	.LCFI83:
 1861               		.cfi_def_cfa_offset 8
 1862               		.cfi_offset 29, -7
 1863 08d6 CDB7      		in r28,__SP_L__
 1864 08d8 DEB7      		in r29,__SP_H__
 1865               	.LCFI84:
 1866               		.cfi_def_cfa_register 28
 1867               	/* prologue: function */
 1868               	/* frame size = 0 */
 1869               	/* stack size = 6 */
 1870               	.L__stack_usage = 6
 302:ServerLLDN.c  **** 		timeslot_counter = 0;
 1871               		.loc 6 302 0
 1872 08da 1092 0000 		sts timeslot_counter,__zero_reg__
 303:ServerLLDN.c  **** 		
 304:ServerLLDN.c  ****  		tTS =  ((p_var*sp + (m+ /*config_request_frame.conf.tsDuration */ 127.0 )*sm + macMinLIFSPeriod)
 1873               		.loc 6 304 0
 1874 08de 8EEE      		ldi r24,lo8(-18)
 1875 08e0 93E9      		ldi r25,lo8(-109)
 1876 08e2 A3EA      		ldi r26,lo8(-93)
 1877 08e4 BBE3      		ldi r27,lo8(59)
 1878 08e6 8093 0000 		sts tTS,r24
 1879 08ea 9093 0000 		sts tTS+1,r25
 1880 08ee A093 0000 		sts tTS+2,r26
 1881 08f2 B093 0000 		sts tTS+3,r27
 305:ServerLLDN.c  **** 		
 306:ServerLLDN.c  **** 		// (number of time slots x mgmt time solts) x base timelosts
 307:ServerLLDN.c  ****  		beaconInterval = (assTimeSlot + MacLLDNMgmtTS*numBaseTimeSlotperMgmt) * tTS / (SYMBOL_TIME); 
 1882               		.loc 6 307 0
 1883 08f6 8091 0000 		lds r24,assTimeSlot
 1884 08fa 9091 0000 		lds r25,assTimeSlot+1
 1885 08fe 0296      		adiw r24,2
 1886 0900 092E      		mov __tmp_reg__,r25
 1887 0902 000C      		lsl r0
 1888 0904 AA0B      		sbc r26,r26
 1889 0906 BB0B      		sbc r27,r27
 1890 0908 BC01      		movw r22,r24
 1891 090a CD01      		movw r24,r26
 1892 090c 0E94 0000 		call __floatsisf
 1893 0910 7B01      		movw r14,r22
 1894 0912 8C01      		movw r16,r24
 1895 0914 8091 0000 		lds r24,tTS
 1896 0918 9091 0000 		lds r25,tTS+1
 1897 091c A091 0000 		lds r26,tTS+2
 1898 0920 B091 0000 		lds r27,tTS+3
 1899 0924 9C01      		movw r18,r24
 1900 0926 AD01      		movw r20,r26
 1901 0928 C801      		movw r24,r16
 1902 092a B701      		movw r22,r14
 1903 092c 0E94 0000 		call __mulsf3
 1904 0930 DC01      		movw r26,r24
 1905 0932 CB01      		movw r24,r22
 1906 0934 2DEB      		ldi r18,lo8(-67)
 1907 0936 37E3      		ldi r19,lo8(55)
 1908 0938 46E8      		ldi r20,lo8(-122)
 1909 093a 57E3      		ldi r21,lo8(55)
 1910 093c BC01      		movw r22,r24
 1911 093e CD01      		movw r24,r26
 1912 0940 0E94 0000 		call __divsf3
 1913 0944 DC01      		movw r26,r24
 1914 0946 CB01      		movw r24,r22
 1915 0948 BC01      		movw r22,r24
 1916 094a CD01      		movw r24,r26
 1917 094c 0E94 0000 		call __fixunssfsi
 1918 0950 DC01      		movw r26,r24
 1919 0952 CB01      		movw r24,r22
 1920 0954 9093 0000 		sts beaconInterval+1,r25
 1921 0958 8093 0000 		sts beaconInterval,r24
 308:ServerLLDN.c  **** 		
 309:ServerLLDN.c  **** 		// Configure Timers
 310:ServerLLDN.c  **** 		macsc_set_cmp1_int_cb(time_slot_handler);
 1922               		.loc 6 310 0
 1923 095c 80E0      		ldi r24,lo8(gs(time_slot_handler))
 1924 095e 90E0      		ldi r25,hi8(gs(time_slot_handler))
 1925 0960 0E94 0000 		call macsc_set_cmp1_int_cb
 311:ServerLLDN.c  **** 		
 312:ServerLLDN.c  **** 		macsc_enable_manual_bts();
 1926               		.loc 6 312 0
 1927 0964 0E94 0000 		call macsc_enable_manual_bts
 313:ServerLLDN.c  **** 		
 314:ServerLLDN.c  **** 		macsc_enable_cmp_int(MACSC_CC1);
 1928               		.loc 6 314 0
 1929 0968 81E0      		ldi r24,lo8(1)
 1930 096a 0E94 0000 		call macsc_enable_cmp_int
 315:ServerLLDN.c  **** 		macsc_use_cmp(MACSC_RELATIVE_CMP, tTS / (SYMBOL_TIME), MACSC_CC1);
 1931               		.loc 6 315 0
 1932 096e 8091 0000 		lds r24,tTS
 1933 0972 9091 0000 		lds r25,tTS+1
 1934 0976 A091 0000 		lds r26,tTS+2
 1935 097a B091 0000 		lds r27,tTS+3
 1936 097e 2DEB      		ldi r18,lo8(-67)
 1937 0980 37E3      		ldi r19,lo8(55)
 1938 0982 46E8      		ldi r20,lo8(-122)
 1939 0984 57E3      		ldi r21,lo8(55)
 1940 0986 BC01      		movw r22,r24
 1941 0988 CD01      		movw r24,r26
 1942 098a 0E94 0000 		call __divsf3
 1943 098e DC01      		movw r26,r24
 1944 0990 CB01      		movw r24,r22
 1945 0992 BC01      		movw r22,r24
 1946 0994 CD01      		movw r24,r26
 1947 0996 0E94 0000 		call __fixunssfsi
 1948 099a DC01      		movw r26,r24
 1949 099c CB01      		movw r24,r22
 1950 099e 21E0      		ldi r18,lo8(1)
 1951 09a0 AC01      		movw r20,r24
 1952 09a2 BD01      		movw r22,r26
 1953 09a4 81E0      		ldi r24,lo8(1)
 1954 09a6 0E94 0000 		call macsc_use_cmp
 316:ServerLLDN.c  **** 		
 317:ServerLLDN.c  **** 		appPanState = APP_PAN_STATE_CHECK_TS;
 1955               		.loc 6 317 0
 1956 09aa 8BE0      		ldi r24,lo8(11)
 1957 09ac 8093 0000 		sts appPanState,r24
 318:ServerLLDN.c  **** 		
 319:ServerLLDN.c  **** // 		printf("\n assTimeSlot %d", assTimeSlot);
 320:ServerLLDN.c  **** // 		tTS =  ((p_var*sp + (m+ /*config_request_frame.conf.tsDuration */ 127.0 )*sm + macMinLIFSPerio
 321:ServerLLDN.c  **** // 		unsigned int bi = (assTimeSlot + MacLLDNMgmtTS*numBaseTimeSlotperMgmt) * tTS / (SYMBOL_TIME);;
 322:ServerLLDN.c  **** // 		printf("\n bi %d", bi);
 323:ServerLLDN.c  **** // 		beaconInterval = (assTimeSlot + MacLLDNMgmtTS*numBaseTimeSlotperMgmt) * tTS / (SYMBOL_TIME); /
 324:ServerLLDN.c  **** // 		printf("\nOnline Initial %d", beaconInterval, assTimeSlot);
 325:ServerLLDN.c  **** // 		
 326:ServerLLDN.c  **** // 		// Configure Timers
 327:ServerLLDN.c  **** // 		macsc_set_cmp1_int_cb(end_of_online_handler);
 328:ServerLLDN.c  **** // 		macsc_enable_manual_bts();
 329:ServerLLDN.c  **** // 		macsc_enable_cmp_int(MACSC_CC1);
 330:ServerLLDN.c  **** // 		macsc_use_cmp(MACSC_RELATIVE_CMP, tTS / (SYMBOL_TIME), MACSC_CC2);
 331:ServerLLDN.c  **** // 		macsc_use_cmp(MACSC_RELATIVE_CMP, beaconInterval, MACSC_CC1);
 332:ServerLLDN.c  **** // 		
 333:ServerLLDN.c  **** // 		 //prepares online beacon , PRECISA SER REVISADO COM A NORMA, ESTOU EM DVIDA NO TIMESLOTE SIZ
 334:ServerLLDN.c  **** // 		msgReq.dstAddr				= 0;
 335:ServerLLDN.c  **** // 		msgReq.dstEndpoint			= APP_BEACON_ENDPOINT;
 336:ServerLLDN.c  **** // 		msgReq.srcEndpoint			= APP_BEACON_ENDPOINT;
 337:ServerLLDN.c  **** // 		msgReq.options				= NWK_OPT_LLDN_BEACON | NWK_OPT_ONLINE_STATE;
 338:ServerLLDN.c  **** // 		msgReq.data					= NULL;
 339:ServerLLDN.c  **** // 		msgReq.size					= 0;
 340:ServerLLDN.c  **** // 		appState = APP_STATE_SEND;
 341:ServerLLDN.c  **** // 	
 342:ServerLLDN.c  **** // 		counter_online--;
 343:ServerLLDN.c  **** // 		if(counter_online <= 0 )
 344:ServerLLDN.c  **** // 		{
 345:ServerLLDN.c  **** // 			printf("\nAqui");
 346:ServerLLDN.c  **** // 			macsc_disable_cmp_int(MACSC_CC1);
 347:ServerLLDN.c  **** // 			macsc_disable_cmp_int(MACSC_CC2);
 348:ServerLLDN.c  **** // 			appState = APP_STATE_IDLE;
 349:ServerLLDN.c  **** // 			appPanState = APP_PAN_STATE_IDLE;				
 350:ServerLLDN.c  **** // 		}
 351:ServerLLDN.c  **** 		
 352:ServerLLDN.c  **** 	}
 1958               		.loc 6 352 0
 1959 09b0 0000      		nop
 1960               	/* epilogue start */
 1961 09b2 DF91      		pop r29
 1962 09b4 CF91      		pop r28
 1963 09b6 1F91      		pop r17
 1964 09b8 0F91      		pop r16
 1965 09ba FF90      		pop r15
 1966 09bc EF90      		pop r14
 1967 09be 0895      		ret
 1968               		.cfi_endproc
 1969               	.LFE144:
 1972               	appInit:
 1973               	.LFB145:
 353:ServerLLDN.c  **** 
 354:ServerLLDN.c  **** 
 355:ServerLLDN.c  **** #else 
 356:ServerLLDN.c  **** 	uint8_t payloadSize = 0x01;
 357:ServerLLDN.c  **** 	uint8_t assTimeSlot = 0xFF;
 358:ServerLLDN.c  **** 	uint8_t n = 0;
 359:ServerLLDN.c  **** 	
 360:ServerLLDN.c  **** 	static NwkFrameBeaconHeaderLLDN_t *rec_beacon;
 361:ServerLLDN.c  **** 	static NWK_DiscoverResponse_t msgDiscResponse = { .id = LL_DISCOVER_RESPONSE,
 362:ServerLLDN.c  **** 													 .macAddr = APP_ADDR,
 363:ServerLLDN.c  **** 													 .ts_dir.tsDuration = 4,
 364:ServerLLDN.c  **** 													 .ts_dir.dirIndicator = 0b1 };
 365:ServerLLDN.c  **** 	static NWK_ConfigStatus_t msgConfigStatus = { .id = LL_CONFIGURATION_STATUS,
 366:ServerLLDN.c  **** 												 .macAddr = APP_ADDR,
 367:ServerLLDN.c  **** 												 .s_macAddr = APP_ADDR,
 368:ServerLLDN.c  **** 												 .ts_dir.tsDuration = 4,
 369:ServerLLDN.c  **** 												 .ts_dir.dirIndicator = 1,
 370:ServerLLDN.c  **** 												 .assTimeSlot = 0xff };
 371:ServerLLDN.c  **** 	static bool ack_received;
 372:ServerLLDN.c  **** 	bool MacLLDNMgmtTS = 0; 
 373:ServerLLDN.c  **** 	bool associated = 0;
 374:ServerLLDN.c  **** 	
 375:ServerLLDN.c  **** 	static void send_message_timeHandler(void)
 376:ServerLLDN.c  **** 	{
 377:ServerLLDN.c  **** 		printf("\nTIMER");
 378:ServerLLDN.c  **** 		appState = APP_STATE_SEND;	
 379:ServerLLDN.c  **** 		#if MASTER_MACSC == 0
 380:ServerLLDN.c  **** 			timer_stop();
 381:ServerLLDN.c  **** 		#endif
 382:ServerLLDN.c  **** 	}
 383:ServerLLDN.c  **** 
 384:ServerLLDN.c  **** 	
 385:ServerLLDN.c  **** 	static bool appBeaconInd(NWK_DataInd_t *ind)
 386:ServerLLDN.c  **** 	{
 387:ServerLLDN.c  **** 		rec_beacon = (NwkFrameBeaconHeaderLLDN_t*)ind->data;
 388:ServerLLDN.c  **** 		//  bom implementar rotinas pra se o nodo estiver associado a um coordeandor e se no estiver
 389:ServerLLDN.c  **** 		PanId = rec_beacon->PanId; // s pode mudar se ele associar
 390:ServerLLDN.c  **** 		if( ((rec_beacon->Flags.txState == DISC_MODE && !ack_received && rec_beacon->confSeqNumber == 0x0
 391:ServerLLDN.c  **** 			(rec_beacon->Flags.txState == CONFIG_MODE && ack_received)) && associated == 0)
 392:ServerLLDN.c  **** 		{
 393:ServerLLDN.c  **** 	
 394:ServerLLDN.c  **** 			int ts_time =  ((p_var*sp + (m+ rec_beacon->TimeSlotSize  )*sm + macMinLIFSPeriod)/v_var)  / (SY
 395:ServerLLDN.c  **** 			int msg_wait_time = rec_beacon->Flags.numBaseMgmtTimeslots * rec_beacon->TimeSlotSize * 2; // sy
 396:ServerLLDN.c  **** 			printf("\n TimeSlotSize %d", rec_beacon->TimeSlotSize);
 397:ServerLLDN.c  **** 			#if MASTER_MACSC
 398:ServerLLDN.c  **** 				macsc_enable_manual_bts();
 399:ServerLLDN.c  **** 				macsc_set_cmp1_int_cb(send_message_timeHandler);
 400:ServerLLDN.c  **** 				macsc_enable_cmp_int(MACSC_CC1); 
 401:ServerLLDN.c  **** 				macsc_use_cmp(MACSC_RELATIVE_CMP, msg_wait_time - 250, MACSC_CC1);
 402:ServerLLDN.c  **** 			#else
 403:ServerLLDN.c  **** 				timer_init();
 404:ServerLLDN.c  **** 				timer_delay(msg_wait_time/2);
 405:ServerLLDN.c  **** 				hw_timer_setup_handler(send_message_timeHandler);
 406:ServerLLDN.c  **** 				timer_start();
 407:ServerLLDN.c  **** 			#endif
 408:ServerLLDN.c  **** 			appState = (rec_beacon->Flags.txState == DISC_MODE) ? APP_STATE_PREP_DISC_REPONSE : APP_STATE_PR
 409:ServerLLDN.c  **** 		}
 410:ServerLLDN.c  **** 		else if (rec_beacon->Flags.txState == RESET_MODE)
 411:ServerLLDN.c  **** 		{
 412:ServerLLDN.c  **** 			ack_received = 0;
 413:ServerLLDN.c  **** 			associated = 0;
 414:ServerLLDN.c  **** 		}
 415:ServerLLDN.c  **** 
 416:ServerLLDN.c  **** 		return true;
 417:ServerLLDN.c  **** 	}
 418:ServerLLDN.c  **** 	
 419:ServerLLDN.c  **** 	static bool appAckInd(NWK_DataInd_t *ind)
 420:ServerLLDN.c  **** 	{
 421:ServerLLDN.c  **** 		#if !MASTER_MACSC
 422:ServerLLDN.c  **** 		ind->data = ind->data - (uint8_t) 1;
 423:ServerLLDN.c  **** 		#endif
 424:ServerLLDN.c  **** 		NWK_ACKFormat_t *ackframe = (NWK_ACKFormat_t*)ind->data;
 425:ServerLLDN.c  **** 		if(PanId == ackframe->sourceId)
 426:ServerLLDN.c  **** 		{
 427:ServerLLDN.c  **** 			int pos = (int) APP_ADDR / 8;
 428:ServerLLDN.c  **** 			int bit_shift = 8 - APP_ADDR % 8;
 429:ServerLLDN.c  **** 			if( ackframe->ackFlags[pos] & 1 << bit_shift)	
 430:ServerLLDN.c  **** 			{
 431:ServerLLDN.c  **** 				printf("\n ack true");
 432:ServerLLDN.c  **** 				ack_received = true;
 433:ServerLLDN.c  **** 			}
 434:ServerLLDN.c  **** 		}
 435:ServerLLDN.c  **** 		return true;
 436:ServerLLDN.c  **** 	}
 437:ServerLLDN.c  **** 	
 438:ServerLLDN.c  **** 	static bool appCommandInd(NWK_DataInd_t *ind)
 439:ServerLLDN.c  **** 	{
 440:ServerLLDN.c  **** 		#if !MASTER_MACSC
 441:ServerLLDN.c  **** 		ind->data = ind->data - (uint8_t) 1;
 442:ServerLLDN.c  **** 		#endif
 443:ServerLLDN.c  **** 		
 444:ServerLLDN.c  **** 		if(ind->data[0] == LL_CONFIGURATION_REQUEST)
 445:ServerLLDN.c  **** 		{
 446:ServerLLDN.c  **** 			NWK_ConfigRequest_t *msg = (NWK_ConfigRequest_t*)ind->data;
 447:ServerLLDN.c  **** 			if(msg->macAddr == APP_ADDR)
 448:ServerLLDN.c  **** 			{
 449:ServerLLDN.c  **** 				PHY_SetChannel(msg->tx_channel);
 450:ServerLLDN.c  **** 				NWK_SetPanId(msg->s_macAddr);
 451:ServerLLDN.c  **** 				assTimeSlot = msg->assTimeSlot;
 452:ServerLLDN.c  **** 				n = msg->conf.tsDuration;
 453:ServerLLDN.c  **** 				associated = 1;
 454:ServerLLDN.c  **** 				printf("\nRecebeu conf request");
 455:ServerLLDN.c  **** 			}
 456:ServerLLDN.c  **** 		}
 457:ServerLLDN.c  **** 		return true;
 458:ServerLLDN.c  **** 	}
 459:ServerLLDN.c  **** 
 460:ServerLLDN.c  **** 	void appPrepareDiscoverResponse()
 461:ServerLLDN.c  **** 	{
 462:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 463:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_COMMAND_ENDPOINT;
 464:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_COMMAND_ENDPOINT;
 465:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_MAC_COMMAND;
 466:ServerLLDN.c  **** 		msgReq.data					= (uint8_t*)&msgDiscResponse;
 467:ServerLLDN.c  **** 		msgReq.size					= sizeof(msgDiscResponse);
 468:ServerLLDN.c  **** 	}
 469:ServerLLDN.c  **** 	
 470:ServerLLDN.c  **** 	void appPrepareConfigurationStatus()
 471:ServerLLDN.c  **** 	{		
 472:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 473:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_COMMAND_ENDPOINT;
 474:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_COMMAND_ENDPOINT;
 475:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_MAC_COMMAND;
 476:ServerLLDN.c  **** 		msgReq.data					= (uint8_t*)&msgConfigStatus;
 477:ServerLLDN.c  **** 		msgReq.size					= sizeof(msgConfigStatus);
 478:ServerLLDN.c  **** 	}
 479:ServerLLDN.c  **** 	
 480:ServerLLDN.c  **** #endif // APP_COORDINATOR
 481:ServerLLDN.c  **** 
 482:ServerLLDN.c  **** static void appInit(void)
 483:ServerLLDN.c  **** {
 1974               		.loc 6 483 0
 1975               		.cfi_startproc
 1976 09c0 CF93      		push r28
 1977               	.LCFI85:
 1978               		.cfi_def_cfa_offset 3
 1979               		.cfi_offset 28, -2
 1980 09c2 DF93      		push r29
 1981               	.LCFI86:
 1982               		.cfi_def_cfa_offset 4
 1983               		.cfi_offset 29, -3
 1984 09c4 CDB7      		in r28,__SP_L__
 1985 09c6 DEB7      		in r29,__SP_H__
 1986               	.LCFI87:
 1987               		.cfi_def_cfa_register 28
 1988               	/* prologue: function */
 1989               	/* frame size = 0 */
 1990               	/* stack size = 2 */
 1991               	.L__stack_usage = 2
 484:ServerLLDN.c  **** 	NWK_SetAddr(APP_ADDR);
 1992               		.loc 6 484 0
 1993 09c8 80E0      		ldi r24,0
 1994 09ca 90E0      		ldi r25,0
 1995 09cc 0E94 0000 		call NWK_SetAddr
 485:ServerLLDN.c  **** 	PHY_SetChannel(APP_CHANNEL);
 1996               		.loc 6 485 0
 1997 09d0 8FE0      		ldi r24,lo8(15)
 1998 09d2 0E94 0000 		call PHY_SetChannel
 486:ServerLLDN.c  **** 	PHY_SetRxState(true);
 1999               		.loc 6 486 0
 2000 09d6 81E0      		ldi r24,lo8(1)
 2001 09d8 0E94 0000 		call PHY_SetRxState
 487:ServerLLDN.c  **** 		
 488:ServerLLDN.c  **** 	#if APP_COORDINATOR	 
 489:ServerLLDN.c  **** 		/* Timer used for delay between messages */
 490:ServerLLDN.c  **** 		tmrDelay.interval = 2;
 2002               		.loc 6 490 0
 2003 09dc 82E0      		ldi r24,lo8(2)
 2004 09de 90E0      		ldi r25,0
 2005 09e0 A0E0      		ldi r26,0
 2006 09e2 B0E0      		ldi r27,0
 2007 09e4 8093 0000 		sts tmrDelay+6,r24
 2008 09e8 9093 0000 		sts tmrDelay+6+1,r25
 2009 09ec A093 0000 		sts tmrDelay+6+2,r26
 2010 09f0 B093 0000 		sts tmrDelay+6+3,r27
 491:ServerLLDN.c  **** 		tmrDelay.mode = SYS_TIMER_INTERVAL_MODE;
 2011               		.loc 6 491 0
 2012 09f4 1092 0000 		sts tmrDelay+10,__zero_reg__
 492:ServerLLDN.c  **** 		tmrDelay.handler = tmrDelayHandler;
 2013               		.loc 6 492 0
 2014 09f8 80E0      		ldi r24,lo8(gs(tmrDelayHandler))
 2015 09fa 90E0      		ldi r25,hi8(gs(tmrDelayHandler))
 2016 09fc 9093 0000 		sts tmrDelay+11+1,r25
 2017 0a00 8093 0000 		sts tmrDelay+11,r24
 493:ServerLLDN.c  **** 	  
 494:ServerLLDN.c  **** 		/* 
 495:ServerLLDN.c  **** 		* Disable CSMA/CA
 496:ServerLLDN.c  **** 		* Disable auto ACK
 497:ServerLLDN.c  **** 		*/
 498:ServerLLDN.c  **** 		NWK_SetPanId(APP_PANID);
 2018               		.loc 6 498 0
 2019 0a04 8EEF      		ldi r24,lo8(-2)
 2020 0a06 9AEC      		ldi r25,lo8(-54)
 2021 0a08 0E94 0000 		call NWK_SetPanId
 499:ServerLLDN.c  **** 		PanId = APP_PANID;
 2022               		.loc 6 499 0
 2023 0a0c 8EEF      		ldi r24,lo8(-2)
 2024 0a0e 8093 0000 		sts PanId,r24
 500:ServerLLDN.c  **** 		ACKFrame.sourceId = APP_PANID;
 2025               		.loc 6 500 0
 2026 0a12 8EEF      		ldi r24,lo8(-2)
 2027 0a14 8093 0000 		sts ACKFrame,r24
 501:ServerLLDN.c  **** 		PHY_SetTdmaMode(true);
 2028               		.loc 6 501 0
 2029 0a18 81E0      		ldi r24,lo8(1)
 2030 0a1a 0E94 0000 		call PHY_SetTdmaMode
 502:ServerLLDN.c  **** 	NWK_OpenEndpoint(APP_COMMAND_ENDPOINT, appCommandInd);
 2031               		.loc 6 502 0
 2032 0a1e 60E0      		ldi r22,lo8(gs(appCommandInd))
 2033 0a20 70E0      		ldi r23,hi8(gs(appCommandInd))
 2034 0a22 83E0      		ldi r24,lo8(3)
 2035 0a24 0E94 0000 		call NWK_OpenEndpoint
 503:ServerLLDN.c  **** 	#else
 504:ServerLLDN.c  **** 		/*
 505:ServerLLDN.c  **** 		 * Enable CSMA/CA
 506:ServerLLDN.c  **** 		 * Enable Random CSMA seed generator
 507:ServerLLDN.c  **** 		 */
 508:ServerLLDN.c  **** 		PHY_SetTdmaMode(false);
 509:ServerLLDN.c  **** 		// PHY_SetOptimizedCSMAValues();
 510:ServerLLDN.c  **** 		
 511:ServerLLDN.c  **** 		payloadSize = 0x01;
 512:ServerLLDN.c  **** 		NWK_OpenEndpoint(APP_BEACON_ENDPOINT, appBeaconInd);
 513:ServerLLDN.c  **** 		NWK_OpenEndpoint(APP_ACK_ENDPOINT, appAckInd);
 514:ServerLLDN.c  **** 		NWK_OpenEndpoint(APP_COMMAND_ENDPOINT, appCommandInd);
 515:ServerLLDN.c  **** 		/*
 516:ServerLLDN.c  **** 		* Configure interrupts callback functions
 517:ServerLLDN.c  **** 		*/
 518:ServerLLDN.c  **** 		
 519:ServerLLDN.c  **** 	#endif // APP_COORDENATOR
 520:ServerLLDN.c  **** 	PHY_SetPromiscuousMode(true);
 2036               		.loc 6 520 0
 2037 0a28 81E0      		ldi r24,lo8(1)
 2038 0a2a 0E94 0000 		call PHY_SetPromiscuousMode
 521:ServerLLDN.c  **** 
 522:ServerLLDN.c  **** }
 2039               		.loc 6 522 0
 2040 0a2e 0000      		nop
 2041               	/* epilogue start */
 2042 0a30 DF91      		pop r29
 2043 0a32 CF91      		pop r28
 2044 0a34 0895      		ret
 2045               		.cfi_endproc
 2046               	.LFE145:
 2048               		.section	.rodata
 2049               	.LC8:
 2050 0068 0A25 642C 		.string	"\n%d, %d"
 2050      2025 6400 
 2051               	.LC9:
 2052 0070 0A61 7373 		.string	"\nassTimeSlots %d"
 2052      5469 6D65 
 2052      536C 6F74 
 2052      7320 2564 
 2052      00
 2053               	.LC10:
 2054 0081 0A20 636F 		.string	"\n counter %d ts %d"
 2054      756E 7465 
 2054      7220 2564 
 2054      2074 7320 
 2054      2564 00
 2055               	.LC11:
 2056 0094 0A46 696D 		.string	"\nFim de um Per\355odo"
 2056      2064 6520 
 2056      756D 2050 
 2056      6572 ED6F 
 2056      646F 00
 2057               	.LC12:
 2058 00a7 0A2D 2D2D 		.string	"\n------- slot %d --------"
 2058      2D2D 2D2D 
 2058      2073 6C6F 
 2058      7420 2564 
 2058      202D 2D2D 
 2059               	.global	__fixsfsi
 2060               		.text
 2062               	APP_TaskHandler:
 2063               	.LFB146:
 523:ServerLLDN.c  **** 
 524:ServerLLDN.c  **** static void APP_TaskHandler(void)
 525:ServerLLDN.c  **** {
 2064               		.loc 6 525 0
 2065               		.cfi_startproc
 2066 0a36 CF93      		push r28
 2067               	.LCFI88:
 2068               		.cfi_def_cfa_offset 3
 2069               		.cfi_offset 28, -2
 2070 0a38 DF93      		push r29
 2071               	.LCFI89:
 2072               		.cfi_def_cfa_offset 4
 2073               		.cfi_offset 29, -3
 2074 0a3a 00D0      		rcall .
 2075               	.LCFI90:
 2076               		.cfi_def_cfa_offset 6
 2077 0a3c CDB7      		in r28,__SP_L__
 2078 0a3e DEB7      		in r29,__SP_H__
 2079               	.LCFI91:
 2080               		.cfi_def_cfa_register 28
 2081               	/* prologue: function */
 2082               	/* frame size = 2 */
 2083               	/* stack size = 4 */
 2084               	.L__stack_usage = 4
 526:ServerLLDN.c  **** 	switch (appState){
 2085               		.loc 6 526 0
 2086 0a40 8091 0000 		lds r24,appState
 2087 0a44 882F      		mov r24,r24
 2088 0a46 90E0      		ldi r25,0
 2089 0a48 8230      		cpi r24,2
 2090 0a4a 9105      		cpc r25,__zero_reg__
 2091 0a4c 01F0      		breq .L56
 2092 0a4e 8330      		cpi r24,3
 2093 0a50 9105      		cpc r25,__zero_reg__
 2094 0a52 01F0      		breq .L57
 2095 0a54 892B      		or r24,r25
 2096 0a56 01F0      		breq .L58
 527:ServerLLDN.c  **** 		case APP_STATE_INITIAL:
 528:ServerLLDN.c  **** 		{
 529:ServerLLDN.c  **** 			appInit();
 530:ServerLLDN.c  **** 			#if APP_COORDINATOR
 531:ServerLLDN.c  **** 				appState = APP_STATE_ATT_PAN_STATE;
 532:ServerLLDN.c  **** 			#else
 533:ServerLLDN.c  **** 				appState = APP_STATE_IDLE;
 534:ServerLLDN.c  **** 			#endif
 535:ServerLLDN.c  **** 			break;
 536:ServerLLDN.c  **** 		}
 537:ServerLLDN.c  **** 		case APP_STATE_SEND:
 538:ServerLLDN.c  **** 		{
 539:ServerLLDN.c  **** 			appSendData();
 540:ServerLLDN.c  **** 			#if APP_COORDINATOR
 541:ServerLLDN.c  **** 				/* Every time a message is send updates coordinator to prepare next message */
 542:ServerLLDN.c  **** 				appState = APP_STATE_ATT_PAN_STATE;
 543:ServerLLDN.c  **** 			#else
 544:ServerLLDN.c  **** 				appState = APP_STATE_IDLE;
 545:ServerLLDN.c  **** 			#endif
 546:ServerLLDN.c  **** 			break;
 547:ServerLLDN.c  **** 		}
 548:ServerLLDN.c  **** 		#if APP_COORDINATOR // COORDINATOR SPECIFIC STATE MACHINE
 549:ServerLLDN.c  **** 		case APP_STATE_ATT_PAN_STATE:
 550:ServerLLDN.c  **** 		{
 551:ServerLLDN.c  **** 			switch(appPanState)
 552:ServerLLDN.c  **** 			{
 553:ServerLLDN.c  **** 				/* Prepare beacon to desassociate all nodes */
 554:ServerLLDN.c  **** 				case APP_PAN_STATE_RESET:
 555:ServerLLDN.c  **** 				{
 556:ServerLLDN.c  **** 					appPanReset();
 557:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 558:ServerLLDN.c  **** 					appState	= APP_STATE_SEND;
 559:ServerLLDN.c  **** 					cycles_counter = 0;
 560:ServerLLDN.c  **** 					break;
 561:ServerLLDN.c  **** 				}
 562:ServerLLDN.c  **** 				/* Prepare first Beacon of Discovery */
 563:ServerLLDN.c  **** 				case APP_PAN_STATE_DISC_INITIAL:
 564:ServerLLDN.c  **** 				{
 565:ServerLLDN.c  **** 					/* if nodes associated is equal to expected number of associated nodes stop association proces
 566:ServerLLDN.c  **** 					 * this implementation was done as is to be used in tests, for real network functionality 
 567:ServerLLDN.c  **** 					 * the number of max association processes must be done through macLLDNdiscoveryModeTimeout
 568:ServerLLDN.c  **** 					 */
 569:ServerLLDN.c  **** 					if(counter_associados == NODOS_ASSOCIADOS_ESPERADOS || cycles_counter >= 2)
 570:ServerLLDN.c  **** 					{	
 571:ServerLLDN.c  **** 						printf("\n%d, %d", cycles_counter, counter_associados);
 572:ServerLLDN.c  **** 						counter_associados = 0;
 573:ServerLLDN.c  **** 						/* if all nodes expected where associated stop beacon generation interruptions */
 574:ServerLLDN.c  **** 						// macsc_disable_cmp_int(MACSC_CC1);
 575:ServerLLDN.c  **** 						// macsc_disable_cmp_int(MACSC_CC2);
 576:ServerLLDN.c  **** 						msgReq.options = 0;
 577:ServerLLDN.c  **** 						/* set coordinator node to idle further implementation of online state must be done */
 578:ServerLLDN.c  **** 						appState = APP_STATE_ATT_PAN_STATE;
 579:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_ONLINE_INITIAL; // APP_PAN_STATE_ONLINE_INIT
 580:ServerLLDN.c  **** 						printf("\nassTimeSlots %d", assTimeSlot);
 581:ServerLLDN.c  **** 						
 582:ServerLLDN.c  **** 					}
 583:ServerLLDN.c  **** 					/* if not all nodes expected where associated run through association process again */
 584:ServerLLDN.c  **** 					else 
 585:ServerLLDN.c  **** 					{
 586:ServerLLDN.c  **** 						/* prepare beacon message and start timers for beacon */
 587:ServerLLDN.c  **** 						appPanDiscInit();
 588:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 589:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_DISC_SECOND_BE;
 590:ServerLLDN.c  **** 					}
 591:ServerLLDN.c  **** 					break;
 592:ServerLLDN.c  **** 				}
 593:ServerLLDN.c  **** 				case APP_PAN_STATE_DISC_SECOND_BE:
 594:ServerLLDN.c  **** 				{
 595:ServerLLDN.c  **** 					/* Prepares message as: Discovery Beacon and Second Beacon */
 596:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_DISCOVERY_STATE | NWK_OPT_SECOND_BEACON ;
 597:ServerLLDN.c  **** 					msgReq.data = NULL;
 598:ServerLLDN.c  **** 					msgReq.size = 0;
 599:ServerLLDN.c  **** 					
 600:ServerLLDN.c  **** 					appState	= APP_PAN_STATE_DISC_PREPARE_ACK;
 601:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_PREPARE_ACK;
 602:ServerLLDN.c  **** 					break;
 603:ServerLLDN.c  **** 				}
 604:ServerLLDN.c  **** 				case APP_PAN_STATE_DISC_PREPARE_ACK:
 605:ServerLLDN.c  **** 				{
 606:ServerLLDN.c  **** 					/* This timer implements a delay between messages, 
 607:ServerLLDN.c  **** 					 * if not used the nodes are not able to receive the message
 608:ServerLLDN.c  **** 					 */
 609:ServerLLDN.c  **** 					appPanPrepareACK();
 610:ServerLLDN.c  **** 					SYS_TimerStart(&tmrDelay);
 611:ServerLLDN.c  **** 					
 612:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_CONFIG_INITIAL; 
 613:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 614:ServerLLDN.c  **** 					break;
 615:ServerLLDN.c  **** 				}
 616:ServerLLDN.c  **** 				case APP_PAN_STATE_CONFIG_INITIAL:
 617:ServerLLDN.c  **** 				{
 618:ServerLLDN.c  **** 					/* Prepares the message as: Configuration Beacon and First State Beacon */
 619:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_CONFIG_STATE;
 620:ServerLLDN.c  **** 					msgReq.data = NULL;
 621:ServerLLDN.c  **** 					msgReq.size = 0;
 622:ServerLLDN.c  **** 					
 623:ServerLLDN.c  **** 					appState	= APP_STATE_IDLE;
 624:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_CONFIG_SECOND_BEACON;
 625:ServerLLDN.c  **** 					break;
 626:ServerLLDN.c  **** 
 627:ServerLLDN.c  **** 				}
 628:ServerLLDN.c  **** 				case APP_PAN_STATE_CONFIG_SECOND_BEACON:
 629:ServerLLDN.c  **** 				{
 630:ServerLLDN.c  **** 					/* Prepares the message as: Configuration Beacon and Second State Beacon */
 631:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_CONFIG_STATE | NWK_OPT_SECOND_BEACON;
 632:ServerLLDN.c  **** 					msgReq.data = NULL;
 633:ServerLLDN.c  **** 					msgReq.size = 0;
 634:ServerLLDN.c  **** 					
 635:ServerLLDN.c  **** 					appState	= APP_STATE_IDLE;
 636:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 637:ServerLLDN.c  **** 					break;
 638:ServerLLDN.c  **** 				}
 639:ServerLLDN.c  **** 				case APP_PAN_STATE_SEND_CONF_REQUEST:
 640:ServerLLDN.c  **** 				{
 641:ServerLLDN.c  **** 
 642:ServerLLDN.c  **** 					if(conf_req_index > 0)
 643:ServerLLDN.c  **** 					{
 644:ServerLLDN.c  **** 						CopyToConfigRequest(conf_req_index);
 645:ServerLLDN.c  **** 						msgReq.options		= NWK_OPT_MAC_COMMAND;
 646:ServerLLDN.c  **** 						msgReq.data			= (uint8_t*)&config_request_frame;
 647:ServerLLDN.c  **** 						msgReq.size			= sizeof(NWK_ConfigRequest_t);
 648:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 649:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 650:ServerLLDN.c  **** 						conf_req_index--;
 651:ServerLLDN.c  **** 						counter_associados++;
 652:ServerLLDN.c  **** 						SYS_TimerStart(&tmrDelay);
 653:ServerLLDN.c  **** 					}
 654:ServerLLDN.c  **** 					else
 655:ServerLLDN.c  **** 					{
 656:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_CONFIG_THIRD_BEACON;
 657:ServerLLDN.c  **** 					}
 658:ServerLLDN.c  **** 					break;
 659:ServerLLDN.c  **** 				}
 660:ServerLLDN.c  **** 				case APP_PAN_STATE_CONFIG_THIRD_BEACON:
 661:ServerLLDN.c  **** 				{
 662:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_CONFIG_STATE | NWK_OPT_THIRD_BEACON;
 663:ServerLLDN.c  **** 					msgReq.data = NULL;
 664:ServerLLDN.c  **** 					msgReq.size = 0;
 665:ServerLLDN.c  **** 					
 666:ServerLLDN.c  **** 					appState	= APP_STATE_IDLE;
 667:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 668:ServerLLDN.c  **** 					cycles_counter++;	
 669:ServerLLDN.c  **** 					
 670:ServerLLDN.c  **** 					break;
 671:ServerLLDN.c  **** 				}
 672:ServerLLDN.c  **** 				case APP_PAN_STATE_ONLINE_INITIAL:
 673:ServerLLDN.c  **** 				{
 674:ServerLLDN.c  **** 					appPanOnlineInit();
 675:ServerLLDN.c  **** 					break;
 676:ServerLLDN.c  **** 				}
 677:ServerLLDN.c  **** 				case APP_PAN_STATE_CHECK_TS:
 678:ServerLLDN.c  **** 				{
 679:ServerLLDN.c  **** 					printf("\n counter %d ts %d", timeslot_counter, assTimeSlot);
 680:ServerLLDN.c  **** 					if(timeslot_counter >= assTimeSlot)
 681:ServerLLDN.c  **** 					{
 682:ServerLLDN.c  **** 						printf("\nFim de um Perodo");
 683:ServerLLDN.c  **** 						macsc_disable_cmp_int(MACSC_CC1);
 684:ServerLLDN.c  **** 						macsc_disable_cmp_int(MACSC_CC2);
 685:ServerLLDN.c  **** 						appState = APP_STATE_IDLE;
 686:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_IDLE;	
 687:ServerLLDN.c  **** 					}
 688:ServerLLDN.c  **** 					else
 689:ServerLLDN.c  **** 					{
 690:ServerLLDN.c  **** 						printf("\n------- slot %d --------", timeslot_counter);
 691:ServerLLDN.c  **** 						appState = APP_STATE_IDLE;
 692:ServerLLDN.c  **** 						timeslot_counter++;
 693:ServerLLDN.c  **** 					}
 694:ServerLLDN.c  **** 				}
 695:ServerLLDN.c  **** 				case APP_PAN_STATE_ONLINE_END_BE:
 696:ServerLLDN.c  **** 				{
 697:ServerLLDN.c  **** 					if(0)
 698:ServerLLDN.c  **** 					{
 699:ServerLLDN.c  **** 						// implementar as condies para entrar no processo de associao
 700:ServerLLDN.c  **** 					}
 701:ServerLLDN.c  **** 					else
 702:ServerLLDN.c  **** 					{
 703:ServerLLDN.c  **** 						// posso calcular esse valor no onlineinit, o tTS precisa ser recalculado, o seu valor muda n
 704:ServerLLDN.c  **** 						// pode voltar pro state_online_initial porque precisa reconfigurar os timers
 705:ServerLLDN.c  **** 						// precisa revisar o macsc_enable_manual_bts()
 706:ServerLLDN.c  **** 						
 707:ServerLLDN.c  **** 						tTS =  ((p_var*sp + (m+127)*sm + macMinLIFSPeriod)/v_var);
 708:ServerLLDN.c  **** 
 709:ServerLLDN.c  **** 						int idle_time =  2 * numBaseTimeSlotperMgmt * (tTS) * 5 / (SYMBOL_TIME); // 5 is the total of
 710:ServerLLDN.c  **** 						macsc_set_cmp1_int_cb(lldn_server_beacon); // esta funo pode s mandar o beacon do online, 
 711:ServerLLDN.c  **** 						macsc_enable_manual_bts();
 712:ServerLLDN.c  **** 						macsc_enable_cmp_int(MACSC_CC1);
 713:ServerLLDN.c  **** 						macsc_use_cmp(MACSC_RELATIVE_CMP, idle_time, MACSC_CC1);
 714:ServerLLDN.c  **** 						
 715:ServerLLDN.c  **** 					}
 716:ServerLLDN.c  **** 					break;
 717:ServerLLDN.c  **** 				}
 718:ServerLLDN.c  **** 				case APP_PAN_STATE_IDLE:
 719:ServerLLDN.c  **** 				{
 720:ServerLLDN.c  **** 					msgReq.options = 0;
 721:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 722:ServerLLDN.c  **** 					break;
 723:ServerLLDN.c  **** 				}
 724:ServerLLDN.c  **** 			}
 725:ServerLLDN.c  **** 			break;	
 726:ServerLLDN.c  **** 		}
 727:ServerLLDN.c  **** 		#else // NODES SPECIFIC STATE MACHINE
 728:ServerLLDN.c  **** 		case APP_STATE_PREP_DISC_REPONSE:
 729:ServerLLDN.c  **** 		{
 730:ServerLLDN.c  **** 			appPrepareDiscoverResponse();
 731:ServerLLDN.c  **** 			appState = APP_STATE_IDLE;	
 732:ServerLLDN.c  **** 			break;
 733:ServerLLDN.c  **** 		}
 734:ServerLLDN.c  **** 		
 735:ServerLLDN.c  **** 		case APP_STATE_PREP_CONFIG_STATUS:
 736:ServerLLDN.c  **** 		{
 737:ServerLLDN.c  **** 			// se o nodo recebeu ack na fase do discovery prepara a mensagem de configuration status
 738:ServerLLDN.c  **** 			if(ack_received && rec_beacon->confSeqNumber == 0 && associated == 0) {
 739:ServerLLDN.c  **** 				appPrepareConfigurationStatus();
 740:ServerLLDN.c  **** 			}
 741:ServerLLDN.c  **** 			// se o nodo no recebeu desativa o timer e fica em idle
 742:ServerLLDN.c  **** 			else {
 743:ServerLLDN.c  **** 				#if MASTER_MACSC
 744:ServerLLDN.c  **** 				macsc_disable_cmp_int(MACSC_CC1);
 745:ServerLLDN.c  **** 				#else
 746:ServerLLDN.c  **** 				timer_stop();
 747:ServerLLDN.c  **** 				#endif
 748:ServerLLDN.c  **** 			}
 749:ServerLLDN.c  **** 			ack_received = 0;
 750:ServerLLDN.c  **** 			appState = APP_STATE_IDLE;
 751:ServerLLDN.c  **** 			break;
 752:ServerLLDN.c  **** 		}
 753:ServerLLDN.c  **** 		#endif
 754:ServerLLDN.c  **** 		default:
 755:ServerLLDN.c  **** 		{
 756:ServerLLDN.c  **** 			break;
 2097               		.loc 6 756 0
 2098 0a58 00C0      		rjmp .L59
 2099               	.L58:
 529:ServerLLDN.c  **** 			#if APP_COORDINATOR
 2100               		.loc 6 529 0
 2101 0a5a 0E94 0000 		call appInit
 531:ServerLLDN.c  **** 			#else
 2102               		.loc 6 531 0
 2103 0a5e 83E0      		ldi r24,lo8(3)
 2104 0a60 8093 0000 		sts appState,r24
 535:ServerLLDN.c  **** 		}
 2105               		.loc 6 535 0
 2106 0a64 00C0      		rjmp .L59
 2107               	.L56:
 539:ServerLLDN.c  **** 			#if APP_COORDINATOR
 2108               		.loc 6 539 0
 2109 0a66 0E94 0000 		call appSendData
 542:ServerLLDN.c  **** 			#else
 2110               		.loc 6 542 0
 2111 0a6a 83E0      		ldi r24,lo8(3)
 2112 0a6c 8093 0000 		sts appState,r24
 546:ServerLLDN.c  **** 		}
 2113               		.loc 6 546 0
 2114 0a70 00C0      		rjmp .L59
 2115               	.L57:
 551:ServerLLDN.c  **** 			{
 2116               		.loc 6 551 0
 2117 0a72 8091 0000 		lds r24,appPanState
 2118 0a76 882F      		mov r24,r24
 2119 0a78 90E0      		ldi r25,0
 2120 0a7a 092E      		mov __tmp_reg__,r25
 2121 0a7c 000C      		lsl r0
 2122 0a7e AA0B      		sbc r26,r26
 2123 0a80 BB0B      		sbc r27,r27
 2124 0a82 40E0      		ldi r20,0
 2125 0a84 50E0      		ldi r21,0
 2126 0a86 2BE0      		ldi r18,lo8(11)
 2127 0a88 30E0      		ldi r19,0
 2128 0a8a 841B      		sub r24,r20
 2129 0a8c 950B      		sbc r25,r21
 2130 0a8e 2817      		cp r18,r24
 2131 0a90 3907      		cpc r19,r25
 2132 0a92 00F4      		brsh .+2
 2133 0a94 00C0      		rjmp .L80
 2134 0a96 8050      		subi r24,lo8(-(gs(.L62)))
 2135 0a98 9040      		sbci r25,hi8(-(gs(.L62)))
 2136 0a9a FC01      		movw r30,r24
 2137 0a9c 0C94 0000 		jmp __tablejump2__
 2138               		.section	.progmem.gcc_sw_table,"a",@progbits
 2139               		.p2align	1
 2140               	.L62:
 2141 0000 0000      		.word gs(.L61)
 2142 0002 0000      		.word gs(.L63)
 2143 0004 0000      		.word gs(.L64)
 2144 0006 0000      		.word gs(.L65)
 2145 0008 0000      		.word gs(.L66)
 2146 000a 0000      		.word gs(.L67)
 2147 000c 0000      		.word gs(.L68)
 2148 000e 0000      		.word gs(.L69)
 2149 0010 0000      		.word gs(.L70)
 2150 0012 0000      		.word gs(.L71)
 2151 0014 0000      		.word gs(.L72)
 2152 0016 0000      		.word gs(.L73)
 2153               		.text
 2154               	.L63:
 556:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 2155               		.loc 6 556 0
 2156 0aa0 0E94 0000 		call appPanReset
 557:ServerLLDN.c  **** 					appState	= APP_STATE_SEND;
 2157               		.loc 6 557 0
 2158 0aa4 82E0      		ldi r24,lo8(2)
 2159 0aa6 8093 0000 		sts appPanState,r24
 558:ServerLLDN.c  **** 					cycles_counter = 0;
 2160               		.loc 6 558 0
 2161 0aaa 82E0      		ldi r24,lo8(2)
 2162 0aac 8093 0000 		sts appState,r24
 559:ServerLLDN.c  **** 					break;
 2163               		.loc 6 559 0
 2164 0ab0 1092 0000 		sts cycles_counter,__zero_reg__
 560:ServerLLDN.c  **** 				}
 2165               		.loc 6 560 0
 2166 0ab4 00C0      		rjmp .L60
 2167               	.L64:
 569:ServerLLDN.c  **** 					{	
 2168               		.loc 6 569 0
 2169 0ab6 8091 0000 		lds r24,counter_associados
 2170 0aba 9091 0000 		lds r25,counter_associados+1
 2171 0abe 0C97      		sbiw r24,12
 2172 0ac0 01F0      		breq .L74
 569:ServerLLDN.c  **** 					{	
 2173               		.loc 6 569 0 is_stmt 0 discriminator 1
 2174 0ac2 8091 0000 		lds r24,cycles_counter
 2175 0ac6 8230      		cpi r24,lo8(2)
 2176 0ac8 00F4      		brsh .+2
 2177 0aca 00C0      		rjmp .L75
 2178               	.L74:
 571:ServerLLDN.c  **** 						counter_associados = 0;
 2179               		.loc 6 571 0 is_stmt 1
 2180 0acc 2091 0000 		lds r18,counter_associados
 2181 0ad0 3091 0000 		lds r19,counter_associados+1
 2182 0ad4 8091 0000 		lds r24,cycles_counter
 2183 0ad8 882F      		mov r24,r24
 2184 0ada 90E0      		ldi r25,0
 2185 0adc 432F      		mov r20,r19
 2186 0ade 4F93      		push r20
 2187 0ae0 2F93      		push r18
 2188 0ae2 292F      		mov r18,r25
 2189 0ae4 2F93      		push r18
 2190 0ae6 8F93      		push r24
 2191 0ae8 80E0      		ldi r24,lo8(.LC8)
 2192 0aea 90E0      		ldi r25,hi8(.LC8)
 2193 0aec 892F      		mov r24,r25
 2194 0aee 8F93      		push r24
 2195 0af0 80E0      		ldi r24,lo8(.LC8)
 2196 0af2 90E0      		ldi r25,hi8(.LC8)
 2197 0af4 8F93      		push r24
 2198 0af6 0E94 0000 		call printf
 2199 0afa 0F90      		pop __tmp_reg__
 2200 0afc 0F90      		pop __tmp_reg__
 2201 0afe 0F90      		pop __tmp_reg__
 2202 0b00 0F90      		pop __tmp_reg__
 2203 0b02 0F90      		pop __tmp_reg__
 2204 0b04 0F90      		pop __tmp_reg__
 572:ServerLLDN.c  **** 						/* if all nodes expected where associated stop beacon generation interruptions */
 2205               		.loc 6 572 0
 2206 0b06 1092 0000 		sts counter_associados+1,__zero_reg__
 2207 0b0a 1092 0000 		sts counter_associados,__zero_reg__
 576:ServerLLDN.c  **** 						/* set coordinator node to idle further implementation of online state must be done */
 2208               		.loc 6 576 0
 2209 0b0e 1092 0000 		sts msgReq+9+1,__zero_reg__
 2210 0b12 1092 0000 		sts msgReq+9,__zero_reg__
 578:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_ONLINE_INITIAL; // APP_PAN_STATE_ONLINE_INIT
 2211               		.loc 6 578 0
 2212 0b16 83E0      		ldi r24,lo8(3)
 2213 0b18 8093 0000 		sts appState,r24
 579:ServerLLDN.c  **** 						printf("\nassTimeSlots %d", assTimeSlot);
 2214               		.loc 6 579 0
 2215 0b1c 89E0      		ldi r24,lo8(9)
 2216 0b1e 8093 0000 		sts appPanState,r24
 580:ServerLLDN.c  **** 						
 2217               		.loc 6 580 0
 2218 0b22 8091 0000 		lds r24,assTimeSlot
 2219 0b26 9091 0000 		lds r25,assTimeSlot+1
 2220 0b2a 292F      		mov r18,r25
 2221 0b2c 2F93      		push r18
 2222 0b2e 8F93      		push r24
 2223 0b30 80E0      		ldi r24,lo8(.LC9)
 2224 0b32 90E0      		ldi r25,hi8(.LC9)
 2225 0b34 892F      		mov r24,r25
 2226 0b36 8F93      		push r24
 2227 0b38 80E0      		ldi r24,lo8(.LC9)
 2228 0b3a 90E0      		ldi r25,hi8(.LC9)
 2229 0b3c 8F93      		push r24
 2230 0b3e 0E94 0000 		call printf
 2231 0b42 0F90      		pop __tmp_reg__
 2232 0b44 0F90      		pop __tmp_reg__
 2233 0b46 0F90      		pop __tmp_reg__
 2234 0b48 0F90      		pop __tmp_reg__
 591:ServerLLDN.c  **** 				}
 2235               		.loc 6 591 0
 2236 0b4a 00C0      		rjmp .L60
 2237               	.L75:
 587:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 2238               		.loc 6 587 0
 2239 0b4c 0E94 0000 		call appPanDiscInit
 588:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_DISC_SECOND_BE;
 2240               		.loc 6 588 0
 2241 0b50 81E0      		ldi r24,lo8(1)
 2242 0b52 8093 0000 		sts appState,r24
 589:ServerLLDN.c  **** 					}
 2243               		.loc 6 589 0
 2244 0b56 83E0      		ldi r24,lo8(3)
 2245 0b58 8093 0000 		sts appPanState,r24
 591:ServerLLDN.c  **** 				}
 2246               		.loc 6 591 0
 2247 0b5c 00C0      		rjmp .L60
 2248               	.L65:
 596:ServerLLDN.c  **** 					msgReq.data = NULL;
 2249               		.loc 6 596 0
 2250 0b5e 80E4      		ldi r24,lo8(64)
 2251 0b60 99E0      		ldi r25,lo8(9)
 2252 0b62 9093 0000 		sts msgReq+9+1,r25
 2253 0b66 8093 0000 		sts msgReq+9,r24
 597:ServerLLDN.c  **** 					msgReq.size = 0;
 2254               		.loc 6 597 0
 2255 0b6a 1092 0000 		sts msgReq+13+1,__zero_reg__
 2256 0b6e 1092 0000 		sts msgReq+13,__zero_reg__
 598:ServerLLDN.c  **** 					
 2257               		.loc 6 598 0
 2258 0b72 1092 0000 		sts msgReq+15,__zero_reg__
 600:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_PREPARE_ACK;
 2259               		.loc 6 600 0
 2260 0b76 84E0      		ldi r24,lo8(4)
 2261 0b78 8093 0000 		sts appState,r24
 601:ServerLLDN.c  **** 					break;
 2262               		.loc 6 601 0
 2263 0b7c 84E0      		ldi r24,lo8(4)
 2264 0b7e 8093 0000 		sts appPanState,r24
 602:ServerLLDN.c  **** 				}
 2265               		.loc 6 602 0
 2266 0b82 00C0      		rjmp .L60
 2267               	.L66:
 609:ServerLLDN.c  **** 					SYS_TimerStart(&tmrDelay);
 2268               		.loc 6 609 0
 2269 0b84 0E94 0000 		call appPanPrepareACK
 610:ServerLLDN.c  **** 					
 2270               		.loc 6 610 0
 2271 0b88 80E0      		ldi r24,lo8(tmrDelay)
 2272 0b8a 90E0      		ldi r25,hi8(tmrDelay)
 2273 0b8c 0E94 0000 		call SYS_TimerStart
 612:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 2274               		.loc 6 612 0
 2275 0b90 85E0      		ldi r24,lo8(5)
 2276 0b92 8093 0000 		sts appPanState,r24
 613:ServerLLDN.c  **** 					break;
 2277               		.loc 6 613 0
 2278 0b96 81E0      		ldi r24,lo8(1)
 2279 0b98 8093 0000 		sts appState,r24
 614:ServerLLDN.c  **** 				}
 2280               		.loc 6 614 0
 2281 0b9c 00C0      		rjmp .L60
 2282               	.L67:
 619:ServerLLDN.c  **** 					msgReq.data = NULL;
 2283               		.loc 6 619 0
 2284 0b9e 80E4      		ldi r24,lo8(64)
 2285 0ba0 92E0      		ldi r25,lo8(2)
 2286 0ba2 9093 0000 		sts msgReq+9+1,r25
 2287 0ba6 8093 0000 		sts msgReq+9,r24
 620:ServerLLDN.c  **** 					msgReq.size = 0;
 2288               		.loc 6 620 0
 2289 0baa 1092 0000 		sts msgReq+13+1,__zero_reg__
 2290 0bae 1092 0000 		sts msgReq+13,__zero_reg__
 621:ServerLLDN.c  **** 					
 2291               		.loc 6 621 0
 2292 0bb2 1092 0000 		sts msgReq+15,__zero_reg__
 623:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_CONFIG_SECOND_BEACON;
 2293               		.loc 6 623 0
 2294 0bb6 81E0      		ldi r24,lo8(1)
 2295 0bb8 8093 0000 		sts appState,r24
 624:ServerLLDN.c  **** 					break;
 2296               		.loc 6 624 0
 2297 0bbc 87E0      		ldi r24,lo8(7)
 2298 0bbe 8093 0000 		sts appPanState,r24
 625:ServerLLDN.c  **** 
 2299               		.loc 6 625 0
 2300 0bc2 00C0      		rjmp .L60
 2301               	.L69:
 631:ServerLLDN.c  **** 					msgReq.data = NULL;
 2302               		.loc 6 631 0
 2303 0bc4 80E4      		ldi r24,lo8(64)
 2304 0bc6 9AE0      		ldi r25,lo8(10)
 2305 0bc8 9093 0000 		sts msgReq+9+1,r25
 2306 0bcc 8093 0000 		sts msgReq+9,r24
 632:ServerLLDN.c  **** 					msgReq.size = 0;
 2307               		.loc 6 632 0
 2308 0bd0 1092 0000 		sts msgReq+13+1,__zero_reg__
 2309 0bd4 1092 0000 		sts msgReq+13,__zero_reg__
 633:ServerLLDN.c  **** 					
 2310               		.loc 6 633 0
 2311 0bd8 1092 0000 		sts msgReq+15,__zero_reg__
 635:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 2312               		.loc 6 635 0
 2313 0bdc 81E0      		ldi r24,lo8(1)
 2314 0bde 8093 0000 		sts appState,r24
 636:ServerLLDN.c  **** 					break;
 2315               		.loc 6 636 0
 2316 0be2 86E0      		ldi r24,lo8(6)
 2317 0be4 8093 0000 		sts appPanState,r24
 637:ServerLLDN.c  **** 				}
 2318               		.loc 6 637 0
 2319 0be8 00C0      		rjmp .L60
 2320               	.L68:
 642:ServerLLDN.c  **** 					{
 2321               		.loc 6 642 0
 2322 0bea 8091 0000 		lds r24,conf_req_index
 2323 0bee 9091 0000 		lds r25,conf_req_index+1
 2324 0bf2 1816      		cp __zero_reg__,r24
 2325 0bf4 1906      		cpc __zero_reg__,r25
 2326 0bf6 04F4      		brge .L77
 644:ServerLLDN.c  **** 						msgReq.options		= NWK_OPT_MAC_COMMAND;
 2327               		.loc 6 644 0
 2328 0bf8 8091 0000 		lds r24,conf_req_index
 2329 0bfc 9091 0000 		lds r25,conf_req_index+1
 2330 0c00 0E94 0000 		call CopyToConfigRequest
 645:ServerLLDN.c  **** 						msgReq.data			= (uint8_t*)&config_request_frame;
 2331               		.loc 6 645 0
 2332 0c04 80E0      		ldi r24,0
 2333 0c06 90E8      		ldi r25,lo8(-128)
 2334 0c08 9093 0000 		sts msgReq+9+1,r25
 2335 0c0c 8093 0000 		sts msgReq+9,r24
 646:ServerLLDN.c  **** 						msgReq.size			= sizeof(NWK_ConfigRequest_t);
 2336               		.loc 6 646 0
 2337 0c10 80E0      		ldi r24,lo8(config_request_frame)
 2338 0c12 90E0      		ldi r25,hi8(config_request_frame)
 2339 0c14 9093 0000 		sts msgReq+13+1,r25
 2340 0c18 8093 0000 		sts msgReq+13,r24
 647:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 2341               		.loc 6 647 0
 2342 0c1c 86E0      		ldi r24,lo8(6)
 2343 0c1e 8093 0000 		sts msgReq+15,r24
 648:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 2344               		.loc 6 648 0
 2345 0c22 81E0      		ldi r24,lo8(1)
 2346 0c24 8093 0000 		sts appState,r24
 649:ServerLLDN.c  **** 						conf_req_index--;
 2347               		.loc 6 649 0
 2348 0c28 86E0      		ldi r24,lo8(6)
 2349 0c2a 8093 0000 		sts appPanState,r24
 650:ServerLLDN.c  **** 						counter_associados++;
 2350               		.loc 6 650 0
 2351 0c2e 8091 0000 		lds r24,conf_req_index
 2352 0c32 9091 0000 		lds r25,conf_req_index+1
 2353 0c36 0197      		sbiw r24,1
 2354 0c38 9093 0000 		sts conf_req_index+1,r25
 2355 0c3c 8093 0000 		sts conf_req_index,r24
 651:ServerLLDN.c  **** 						SYS_TimerStart(&tmrDelay);
 2356               		.loc 6 651 0
 2357 0c40 8091 0000 		lds r24,counter_associados
 2358 0c44 9091 0000 		lds r25,counter_associados+1
 2359 0c48 0196      		adiw r24,1
 2360 0c4a 9093 0000 		sts counter_associados+1,r25
 2361 0c4e 8093 0000 		sts counter_associados,r24
 652:ServerLLDN.c  **** 					}
 2362               		.loc 6 652 0
 2363 0c52 80E0      		ldi r24,lo8(tmrDelay)
 2364 0c54 90E0      		ldi r25,hi8(tmrDelay)
 2365 0c56 0E94 0000 		call SYS_TimerStart
 658:ServerLLDN.c  **** 				}
 2366               		.loc 6 658 0
 2367 0c5a 00C0      		rjmp .L60
 2368               	.L77:
 656:ServerLLDN.c  **** 					}
 2369               		.loc 6 656 0
 2370 0c5c 88E0      		ldi r24,lo8(8)
 2371 0c5e 8093 0000 		sts appPanState,r24
 658:ServerLLDN.c  **** 				}
 2372               		.loc 6 658 0
 2373 0c62 00C0      		rjmp .L60
 2374               	.L70:
 662:ServerLLDN.c  **** 					msgReq.data = NULL;
 2375               		.loc 6 662 0
 2376 0c64 80E4      		ldi r24,lo8(64)
 2377 0c66 92E1      		ldi r25,lo8(18)
 2378 0c68 9093 0000 		sts msgReq+9+1,r25
 2379 0c6c 8093 0000 		sts msgReq+9,r24
 663:ServerLLDN.c  **** 					msgReq.size = 0;
 2380               		.loc 6 663 0
 2381 0c70 1092 0000 		sts msgReq+13+1,__zero_reg__
 2382 0c74 1092 0000 		sts msgReq+13,__zero_reg__
 664:ServerLLDN.c  **** 					
 2383               		.loc 6 664 0
 2384 0c78 1092 0000 		sts msgReq+15,__zero_reg__
 666:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 2385               		.loc 6 666 0
 2386 0c7c 81E0      		ldi r24,lo8(1)
 2387 0c7e 8093 0000 		sts appState,r24
 667:ServerLLDN.c  **** 					cycles_counter++;	
 2388               		.loc 6 667 0
 2389 0c82 82E0      		ldi r24,lo8(2)
 2390 0c84 8093 0000 		sts appPanState,r24
 668:ServerLLDN.c  **** 					
 2391               		.loc 6 668 0
 2392 0c88 8091 0000 		lds r24,cycles_counter
 2393 0c8c 8F5F      		subi r24,lo8(-(1))
 2394 0c8e 8093 0000 		sts cycles_counter,r24
 670:ServerLLDN.c  **** 				}
 2395               		.loc 6 670 0
 2396 0c92 00C0      		rjmp .L60
 2397               	.L71:
 674:ServerLLDN.c  **** 					break;
 2398               		.loc 6 674 0
 2399 0c94 0E94 0000 		call appPanOnlineInit
 675:ServerLLDN.c  **** 				}
 2400               		.loc 6 675 0
 2401 0c98 00C0      		rjmp .L60
 2402               	.L73:
 679:ServerLLDN.c  **** 					if(timeslot_counter >= assTimeSlot)
 2403               		.loc 6 679 0
 2404 0c9a 2091 0000 		lds r18,assTimeSlot
 2405 0c9e 3091 0000 		lds r19,assTimeSlot+1
 2406 0ca2 8091 0000 		lds r24,timeslot_counter
 2407 0ca6 882F      		mov r24,r24
 2408 0ca8 90E0      		ldi r25,0
 2409 0caa 432F      		mov r20,r19
 2410 0cac 4F93      		push r20
 2411 0cae 2F93      		push r18
 2412 0cb0 292F      		mov r18,r25
 2413 0cb2 2F93      		push r18
 2414 0cb4 8F93      		push r24
 2415 0cb6 80E0      		ldi r24,lo8(.LC10)
 2416 0cb8 90E0      		ldi r25,hi8(.LC10)
 2417 0cba 892F      		mov r24,r25
 2418 0cbc 8F93      		push r24
 2419 0cbe 80E0      		ldi r24,lo8(.LC10)
 2420 0cc0 90E0      		ldi r25,hi8(.LC10)
 2421 0cc2 8F93      		push r24
 2422 0cc4 0E94 0000 		call printf
 2423 0cc8 0F90      		pop __tmp_reg__
 2424 0cca 0F90      		pop __tmp_reg__
 2425 0ccc 0F90      		pop __tmp_reg__
 2426 0cce 0F90      		pop __tmp_reg__
 2427 0cd0 0F90      		pop __tmp_reg__
 2428 0cd2 0F90      		pop __tmp_reg__
 680:ServerLLDN.c  **** 					{
 2429               		.loc 6 680 0
 2430 0cd4 8091 0000 		lds r24,timeslot_counter
 2431 0cd8 282F      		mov r18,r24
 2432 0cda 30E0      		ldi r19,0
 2433 0cdc 8091 0000 		lds r24,assTimeSlot
 2434 0ce0 9091 0000 		lds r25,assTimeSlot+1
 2435 0ce4 2817      		cp r18,r24
 2436 0ce6 3907      		cpc r19,r25
 2437 0ce8 04F0      		brlt .L79
 682:ServerLLDN.c  **** 						macsc_disable_cmp_int(MACSC_CC1);
 2438               		.loc 6 682 0
 2439 0cea 80E0      		ldi r24,lo8(.LC11)
 2440 0cec 90E0      		ldi r25,hi8(.LC11)
 2441 0cee 892F      		mov r24,r25
 2442 0cf0 8F93      		push r24
 2443 0cf2 80E0      		ldi r24,lo8(.LC11)
 2444 0cf4 90E0      		ldi r25,hi8(.LC11)
 2445 0cf6 8F93      		push r24
 2446 0cf8 0E94 0000 		call printf
 2447 0cfc 0F90      		pop __tmp_reg__
 2448 0cfe 0F90      		pop __tmp_reg__
 683:ServerLLDN.c  **** 						macsc_disable_cmp_int(MACSC_CC2);
 2449               		.loc 6 683 0
 2450 0d00 81E0      		ldi r24,lo8(1)
 2451 0d02 0E94 0000 		call macsc_disable_cmp_int
 684:ServerLLDN.c  **** 						appState = APP_STATE_IDLE;
 2452               		.loc 6 684 0
 2453 0d06 82E0      		ldi r24,lo8(2)
 2454 0d08 0E94 0000 		call macsc_disable_cmp_int
 685:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_IDLE;	
 2455               		.loc 6 685 0
 2456 0d0c 81E0      		ldi r24,lo8(1)
 2457 0d0e 8093 0000 		sts appState,r24
 686:ServerLLDN.c  **** 					}
 2458               		.loc 6 686 0
 2459 0d12 1092 0000 		sts appPanState,__zero_reg__
 2460 0d16 00C0      		rjmp .L72
 2461               	.L79:
 690:ServerLLDN.c  **** 						appState = APP_STATE_IDLE;
 2462               		.loc 6 690 0
 2463 0d18 8091 0000 		lds r24,timeslot_counter
 2464 0d1c 882F      		mov r24,r24
 2465 0d1e 90E0      		ldi r25,0
 2466 0d20 292F      		mov r18,r25
 2467 0d22 2F93      		push r18
 2468 0d24 8F93      		push r24
 2469 0d26 80E0      		ldi r24,lo8(.LC12)
 2470 0d28 90E0      		ldi r25,hi8(.LC12)
 2471 0d2a 892F      		mov r24,r25
 2472 0d2c 8F93      		push r24
 2473 0d2e 80E0      		ldi r24,lo8(.LC12)
 2474 0d30 90E0      		ldi r25,hi8(.LC12)
 2475 0d32 8F93      		push r24
 2476 0d34 0E94 0000 		call printf
 2477 0d38 0F90      		pop __tmp_reg__
 2478 0d3a 0F90      		pop __tmp_reg__
 2479 0d3c 0F90      		pop __tmp_reg__
 2480 0d3e 0F90      		pop __tmp_reg__
 691:ServerLLDN.c  **** 						timeslot_counter++;
 2481               		.loc 6 691 0
 2482 0d40 81E0      		ldi r24,lo8(1)
 2483 0d42 8093 0000 		sts appState,r24
 692:ServerLLDN.c  **** 					}
 2484               		.loc 6 692 0
 2485 0d46 8091 0000 		lds r24,timeslot_counter
 2486 0d4a 8F5F      		subi r24,lo8(-(1))
 2487 0d4c 8093 0000 		sts timeslot_counter,r24
 2488               	.L72:
 2489               	.LBB7:
 707:ServerLLDN.c  **** 
 2490               		.loc 6 707 0
 2491 0d50 8EEE      		ldi r24,lo8(-18)
 2492 0d52 93E9      		ldi r25,lo8(-109)
 2493 0d54 A3EA      		ldi r26,lo8(-93)
 2494 0d56 BBE3      		ldi r27,lo8(59)
 2495 0d58 8093 0000 		sts tTS,r24
 2496 0d5c 9093 0000 		sts tTS+1,r25
 2497 0d60 A093 0000 		sts tTS+2,r26
 2498 0d64 B093 0000 		sts tTS+3,r27
 709:ServerLLDN.c  **** 						macsc_set_cmp1_int_cb(lldn_server_beacon); // esta funo pode s mandar o beacon do online, 
 2499               		.loc 6 709 0
 2500 0d68 8091 0000 		lds r24,tTS
 2501 0d6c 9091 0000 		lds r25,tTS+1
 2502 0d70 A091 0000 		lds r26,tTS+2
 2503 0d74 B091 0000 		lds r27,tTS+3
 2504 0d78 20E0      		ldi r18,0
 2505 0d7a 30E0      		ldi r19,0
 2506 0d7c 40E8      		ldi r20,lo8(-128)
 2507 0d7e 50E4      		ldi r21,lo8(64)
 2508 0d80 BC01      		movw r22,r24
 2509 0d82 CD01      		movw r24,r26
 2510 0d84 0E94 0000 		call __mulsf3
 2511 0d88 DC01      		movw r26,r24
 2512 0d8a CB01      		movw r24,r22
 2513 0d8c 20E0      		ldi r18,0
 2514 0d8e 30E0      		ldi r19,0
 2515 0d90 40EA      		ldi r20,lo8(-96)
 2516 0d92 50E4      		ldi r21,lo8(64)
 2517 0d94 BC01      		movw r22,r24
 2518 0d96 CD01      		movw r24,r26
 2519 0d98 0E94 0000 		call __mulsf3
 2520 0d9c DC01      		movw r26,r24
 2521 0d9e CB01      		movw r24,r22
 2522 0da0 2DEB      		ldi r18,lo8(-67)
 2523 0da2 37E3      		ldi r19,lo8(55)
 2524 0da4 46E8      		ldi r20,lo8(-122)
 2525 0da6 57E3      		ldi r21,lo8(55)
 2526 0da8 BC01      		movw r22,r24
 2527 0daa CD01      		movw r24,r26
 2528 0dac 0E94 0000 		call __divsf3
 2529 0db0 DC01      		movw r26,r24
 2530 0db2 CB01      		movw r24,r22
 2531 0db4 BC01      		movw r22,r24
 2532 0db6 CD01      		movw r24,r26
 2533 0db8 0E94 0000 		call __fixsfsi
 2534 0dbc DC01      		movw r26,r24
 2535 0dbe CB01      		movw r24,r22
 2536 0dc0 9A83      		std Y+2,r25
 2537 0dc2 8983      		std Y+1,r24
 710:ServerLLDN.c  **** 						macsc_enable_manual_bts();
 2538               		.loc 6 710 0
 2539 0dc4 80E0      		ldi r24,lo8(gs(lldn_server_beacon))
 2540 0dc6 90E0      		ldi r25,hi8(gs(lldn_server_beacon))
 2541 0dc8 0E94 0000 		call macsc_set_cmp1_int_cb
 711:ServerLLDN.c  **** 						macsc_enable_cmp_int(MACSC_CC1);
 2542               		.loc 6 711 0
 2543 0dcc 0E94 0000 		call macsc_enable_manual_bts
 712:ServerLLDN.c  **** 						macsc_use_cmp(MACSC_RELATIVE_CMP, idle_time, MACSC_CC1);
 2544               		.loc 6 712 0
 2545 0dd0 81E0      		ldi r24,lo8(1)
 2546 0dd2 0E94 0000 		call macsc_enable_cmp_int
 713:ServerLLDN.c  **** 						
 2547               		.loc 6 713 0
 2548 0dd6 8981      		ldd r24,Y+1
 2549 0dd8 9A81      		ldd r25,Y+2
 2550 0dda 092E      		mov __tmp_reg__,r25
 2551 0ddc 000C      		lsl r0
 2552 0dde AA0B      		sbc r26,r26
 2553 0de0 BB0B      		sbc r27,r27
 2554 0de2 21E0      		ldi r18,lo8(1)
 2555 0de4 AC01      		movw r20,r24
 2556 0de6 BD01      		movw r22,r26
 2557 0de8 81E0      		ldi r24,lo8(1)
 2558 0dea 0E94 0000 		call macsc_use_cmp
 2559               	.LBE7:
 716:ServerLLDN.c  **** 				}
 2560               		.loc 6 716 0
 2561 0dee 00C0      		rjmp .L60
 2562               	.L61:
 720:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 2563               		.loc 6 720 0
 2564 0df0 1092 0000 		sts msgReq+9+1,__zero_reg__
 2565 0df4 1092 0000 		sts msgReq+9,__zero_reg__
 721:ServerLLDN.c  **** 					break;
 2566               		.loc 6 721 0
 2567 0df8 81E0      		ldi r24,lo8(1)
 2568 0dfa 8093 0000 		sts appState,r24
 722:ServerLLDN.c  **** 				}
 2569               		.loc 6 722 0
 2570 0dfe 0000      		nop
 2571               	.L60:
 2572               	.L80:
 725:ServerLLDN.c  **** 		}
 2573               		.loc 6 725 0
 2574 0e00 0000      		nop
 2575               	.L59:
 757:ServerLLDN.c  **** 		}
 758:ServerLLDN.c  **** 	}
 759:ServerLLDN.c  **** }
 2576               		.loc 6 759 0
 2577 0e02 0000      		nop
 2578               	/* epilogue start */
 2579 0e04 0F90      		pop __tmp_reg__
 2580 0e06 0F90      		pop __tmp_reg__
 2581 0e08 DF91      		pop r29
 2582 0e0a CF91      		pop r28
 2583 0e0c 0895      		ret
 2584               		.cfi_endproc
 2585               	.LFE146:
 2587               		.section	.rodata
 2588               	.LC0:
 2589 00c1 00        		.byte	0
 2590 00c2 C2        		.byte	-62
 2591 00c3 01        		.byte	1
 2592 00c4 00        		.byte	0
 2593 00c5 03        		.byte	3
 2594 00c6 00        		.byte	0
 2595 00c7 00        		.byte	0
 2596               		.text
 2597               	.global	main
 2599               	main:
 2600               	.LFB147:
 760:ServerLLDN.c  **** 
 761:ServerLLDN.c  **** 	/*****************************************************************************
 762:ServerLLDN.c  **** 	*****************************************************************************/
 763:ServerLLDN.c  **** 	int main(void)
 764:ServerLLDN.c  **** 	{
 2601               		.loc 6 764 0
 2602               		.cfi_startproc
 2603 0e0e 0F93      		push r16
 2604               	.LCFI92:
 2605               		.cfi_def_cfa_offset 3
 2606               		.cfi_offset 16, -2
 2607 0e10 1F93      		push r17
 2608               	.LCFI93:
 2609               		.cfi_def_cfa_offset 4
 2610               		.cfi_offset 17, -3
 2611 0e12 CF93      		push r28
 2612               	.LCFI94:
 2613               		.cfi_def_cfa_offset 5
 2614               		.cfi_offset 28, -4
 2615 0e14 DF93      		push r29
 2616               	.LCFI95:
 2617               		.cfi_def_cfa_offset 6
 2618               		.cfi_offset 29, -5
 2619 0e16 CDB7      		in r28,__SP_L__
 2620 0e18 DEB7      		in r29,__SP_H__
 2621               	.LCFI96:
 2622               		.cfi_def_cfa_register 28
 2623 0e1a 2797      		sbiw r28,7
 2624               	.LCFI97:
 2625               		.cfi_def_cfa_offset 13
 2626 0e1c 0FB6      		in __tmp_reg__,__SREG__
 2627 0e1e F894      		cli
 2628 0e20 DEBF      		out __SP_H__,r29
 2629 0e22 0FBE      		out __SREG__,__tmp_reg__
 2630 0e24 CDBF      		out __SP_L__,r28
 2631               	/* prologue: function */
 2632               	/* frame size = 7 */
 2633               	/* stack size = 11 */
 2634               	.L__stack_usage = 11
 765:ServerLLDN.c  **** 		sysclk_init();
 2635               		.loc 6 765 0
 2636 0e26 0E94 0000 		call sysclk_init
 766:ServerLLDN.c  **** 		board_init();
 2637               		.loc 6 766 0
 2638 0e2a 0E94 0000 		call board_init
 767:ServerLLDN.c  **** 
 768:ServerLLDN.c  **** 		SYS_Init();
 2639               		.loc 6 768 0
 2640 0e2e 0E94 0000 		call SYS_Init
 769:ServerLLDN.c  **** 		/* Disable CSMA/CA
 770:ServerLLDN.c  **** 		 * Disable auto ACK
 771:ServerLLDN.c  **** 		 * Enable Rx of LLDN Frame Type as described in 802.15.4e - 2012 
 772:ServerLLDN.c  **** 		 */
 773:ServerLLDN.c  **** 
 774:ServerLLDN.c  **** 		sm_init();
 2641               		.loc 6 774 0
 2642 0e32 0E94 0000 		call sm_init
 775:ServerLLDN.c  **** 
 776:ServerLLDN.c  **** 		// Initialize interrupt vector table support.
 777:ServerLLDN.c  **** 	#if (SIO2HOST_CHANNEL == SIO_USB)
 778:ServerLLDN.c  **** 		irq_initialize_vectors();
 779:ServerLLDN.c  **** 	#endif
 780:ServerLLDN.c  **** 		cpu_irq_enable();
 2643               		.loc 6 780 0
 2644               	/* #APP */
 2645               	 ;  780 "ServerLLDN.c" 1
 2646 0e36 7894      		sei
 2647               	 ;  0 "" 2
 781:ServerLLDN.c  **** 
 782:ServerLLDN.c  **** 	#if 1
 783:ServerLLDN.c  **** 	#if (SIO2HOST_CHANNEL == SIO_USB)
 784:ServerLLDN.c  **** 		stdio_usb_init();
 785:ServerLLDN.c  **** 	#else
 786:ServerLLDN.c  **** 		const usart_serial_options_t usart_serial_options =
 2648               		.loc 6 786 0
 2649               	/* #NOAPP */
 2650 0e38 27E0      		ldi r18,lo8(7)
 2651 0e3a E0E0      		ldi r30,lo8(.LC0)
 2652 0e3c F0E0      		ldi r31,hi8(.LC0)
 2653 0e3e CE01      		movw r24,r28
 2654 0e40 0196      		adiw r24,1
 2655 0e42 DC01      		movw r26,r24
 2656               		0:
 2657 0e44 0190      		ld r0,Z+
 2658 0e46 0D92      		st X+,r0
 2659 0e48 2A95      		dec r18
 2660 0e4a 01F4      		brne 0b
 787:ServerLLDN.c  **** 		{
 788:ServerLLDN.c  **** 			.baudrate     = USART_HOST_BAUDRATE,
 789:ServerLLDN.c  **** 			.charlength   = USART_HOST_CHAR_LENGTH,
 790:ServerLLDN.c  **** 			.paritytype   = USART_HOST_PARITY,
 791:ServerLLDN.c  **** 			.stopbits     = USART_HOST_STOP_BITS
 792:ServerLLDN.c  **** 		};
 793:ServerLLDN.c  **** 
 794:ServerLLDN.c  **** 		stdio_serial_init(USART_HOST, &usart_serial_options);
 2661               		.loc 6 794 0
 2662 0e4c CE01      		movw r24,r28
 2663 0e4e 0196      		adiw r24,1
 2664 0e50 BC01      		movw r22,r24
 2665 0e52 80EC      		ldi r24,lo8(-64)
 2666 0e54 90E0      		ldi r25,0
 2667 0e56 0E94 0000 		call stdio_serial_init
 795:ServerLLDN.c  **** 		usart_double_baud_enable(USART_HOST);
 2668               		.loc 6 795 0
 2669 0e5a 80EC      		ldi r24,lo8(-64)
 2670 0e5c 90E0      		ldi r25,0
 2671 0e5e 0E94 0000 		call usart_double_baud_enable
 796:ServerLLDN.c  **** 		usart_set_baudrate_precalculated(USART_HOST, USART_HOST_BAUDRATE, sysclk_get_source_clock_hz());
 2672               		.loc 6 796 0
 2673 0e62 0E94 0000 		call sysclk_get_source_clock_hz
 2674 0e66 DC01      		movw r26,r24
 2675 0e68 CB01      		movw r24,r22
 2676 0e6a 8C01      		movw r16,r24
 2677 0e6c 9D01      		movw r18,r26
 2678 0e6e 40E0      		ldi r20,0
 2679 0e70 52EC      		ldi r21,lo8(-62)
 2680 0e72 61E0      		ldi r22,lo8(1)
 2681 0e74 70E0      		ldi r23,0
 2682 0e76 80EC      		ldi r24,lo8(-64)
 2683 0e78 90E0      		ldi r25,0
 2684 0e7a 0E94 0000 		call usart_set_baudrate_precalculated
 2685               	.L82:
 797:ServerLLDN.c  **** 
 798:ServerLLDN.c  **** 	#endif
 799:ServerLLDN.c  **** 	#endif
 800:ServerLLDN.c  **** 		for(;;)
 801:ServerLLDN.c  **** 		{
 802:ServerLLDN.c  **** 			SYS_TaskHandler();
 2686               		.loc 6 802 0 discriminator 1
 2687 0e7e 0E94 0000 		call SYS_TaskHandler
 803:ServerLLDN.c  **** 			APP_TaskHandler();
 2688               		.loc 6 803 0 discriminator 1
 2689 0e82 0E94 0000 		call APP_TaskHandler
 804:ServerLLDN.c  **** 		}
 2690               		.loc 6 804 0 discriminator 1
 2691 0e86 00C0      		rjmp .L82
 2692               		.cfi_endproc
 2693               	.LFE147:
 2695               	.Letext0:
 2696               		.file 7 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\avr8\\avr8-gnu-toolchain\\avr\\in
 2697               		.file 8 "../../../stack/LwMesh/TDMA/nwk/inc/nwkRx.h"
 2698               		.file 9 "../../../stack/LwMesh/TDMA/nwk/inc/nwkDataReq.h"
 2699               		.file 10 "../../../stack/LwMesh/TDMA/sys/inc/sysTimer.h"
 2700               		.file 11 "../../../platform/mega_rf/drivers/sleep/sleep.h"
 2701               		.file 12 "lldn.h"
 2702               		.file 13 "../../../platform/mega_rf/utils/status_codes.h"
 2703               		.file 14 "config/config.h"
 2704               		.file 15 "../../../platform/common/services/sleepmgr/mega_rf/sleepmgr.h"
DEFINED SYMBOLS
                            *ABS*:00000000 ServerLLDN.c
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:2      *ABS*:0000003e __SP_H__
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:3      *ABS*:0000003d __SP_L__
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:4      *ABS*:0000003f __SREG__
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:5      *ABS*:0000003b __RAMPZ__
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:6      *ABS*:00000000 __tmp_reg__
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:7      *ABS*:00000001 __zero_reg__
                            *COM*:00000001 n
                            *COM*:00000004 tTS
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:14     .text:00000000 sysclk_get_main_hz
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:51     .text:0000001a sysclk_get_source_clock_hz
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:88     .progmem.data.baudctrl_1mhz:00000000 baudctrl_1mhz
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:100    .progmem.data.baudctrl_8mhz:00000000 baudctrl_8mhz
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:112    .progmem.data.baudctrl_16mhz:00000000 baudctrl_16mhz
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:123    .text:00000034 usart_double_baud_enable
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:172    .text:00000062 usart_serial_init
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:267    .text:000000de usart_serial_putchar
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:311    .text:00000106 usart_serial_getchar
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:362    .text:0000013c stdio_serial_init
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:433    .text:0000019e macsc_enable_manual_bts
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:487    .bss.appState:00000000 appState
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:492    .bss.msgReq:00000000 msgReq
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:497    .bss.PanId:00000000 PanId
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:505    .text:000001d2 appSendData
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:567    .data.appPanState:00000000 appPanState
                            *COM*:000003f8 nodes_info_arr
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:574    .data.config_request_frame:00000000 config_request_frame
                            *COM*:00000100 arr_slots
                            *COM*:000001fc conf_req_arr
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:586    .bss.conf_req_index:00000000 conf_req_index
                            *COM*:00000021 ACKFrame
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:593    .bss.ACKFrame_size:00000000 ACKFrame_size
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:599    .data.counter_online:00000000 counter_online
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:605    .bss.beaconInterval:00000000 beaconInterval
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:611    .bss.macLLDNnumUplinkTS:00000000 macLLDNnumUplinkTS
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:616    .bss.tmrDelay:00000000 tmrDelay
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:622    .bss.assTimeSlot:00000000 assTimeSlot
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:628    .bss.counter_associados:00000000 counter_associados
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:634    .data.cycles_counter:00000000 cycles_counter
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:640    .bss.timeslot_counter:00000000 timeslot_counter
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:644    .text:0000021e tmrDelayHandler
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:684    .text:0000023e lldn_server_beacon
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:719    .text:00000258 time_slot_handler
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:754    .text:00000272 downlink_delay_handler
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:798    .text:00000296 end_of_online_handler
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:846    .text:000002c2 teste_handler
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:900    .text:000002fa addToAckArray
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:1050   .text:000003d8 addConfRequestArray
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:1220   .text:00000506 CopyToConfigRequest
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:1288   .text:00000552 appCommandInd
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:1435   .text:0000062c appPanPrepareACK
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:1487   .text:00000672 appPanReset
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:1628   .text:0000073e appPanDiscInit
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:1835   .text:000008ca appPanOnlineInit
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:1972   .text:000009c0 appInit
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:2062   .text:00000a36 APP_TaskHandler
C:\Users\GUILHE~1\AppData\Local\Temp\cccfnMjF.s:2599   .text:00000e0e main

UNDEFINED SYMBOLS
usart_init_rs232
usart_putchar
usart_getchar
stdio_base
ptr_put
ptr_get
_read
_write
fdevopen
printf
NWK_DataReq
macsc_disable_cmp_int
__floatsisf
__addsf3
__divsf3
__mulsf3
__fixunssfsi
macsc_set_cmp1_int_cb
macsc_enable_cmp_int
macsc_use_cmp
macsc_set_cmp2_int_cb
NWK_SetAddr
PHY_SetChannel
PHY_SetRxState
NWK_SetPanId
PHY_SetTdmaMode
NWK_OpenEndpoint
PHY_SetPromiscuousMode
__fixsfsi
__tablejump2__
SYS_TimerStart
sysclk_init
board_init
SYS_Init
sm_init
usart_set_baudrate_precalculated
SYS_TaskHandler
__do_copy_data
__do_clear_bss
