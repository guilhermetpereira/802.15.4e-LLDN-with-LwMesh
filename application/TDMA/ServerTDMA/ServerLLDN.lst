   1               		.file	"ServerLLDN.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.text
   9               	.Ltext0:
  10               		.cfi_sections	.debug_frame
  11               		.comm	n,1,1
  12               		.comm	tTS,4,1
  14               	sysclk_get_main_hz:
  15               	.LFB67:
  16               		.file 1 "../../../platform/common/services/clock/mega/sysclk.h"
   1:../../../platform/common/services/clock/mega/sysclk.h **** /**
   2:../../../platform/common/services/clock/mega/sysclk.h ****  * \file
   3:../../../platform/common/services/clock/mega/sysclk.h ****  *
   4:../../../platform/common/services/clock/mega/sysclk.h ****  * \brief Chip-specific system clock management functions
   5:../../../platform/common/services/clock/mega/sysclk.h ****  *
   6:../../../platform/common/services/clock/mega/sysclk.h ****  * Copyright (c) 2012 Atmel Corporation. All rights reserved.
   7:../../../platform/common/services/clock/mega/sysclk.h ****  *
   8:../../../platform/common/services/clock/mega/sysclk.h ****  * \asf_license_start
   9:../../../platform/common/services/clock/mega/sysclk.h ****  *
  10:../../../platform/common/services/clock/mega/sysclk.h ****  * \page License
  11:../../../platform/common/services/clock/mega/sysclk.h ****  *
  12:../../../platform/common/services/clock/mega/sysclk.h ****  * Redistribution and use in source and binary forms, with or without
  13:../../../platform/common/services/clock/mega/sysclk.h ****  * modification, are permitted provided that the following conditions are met:
  14:../../../platform/common/services/clock/mega/sysclk.h ****  *
  15:../../../platform/common/services/clock/mega/sysclk.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  16:../../../platform/common/services/clock/mega/sysclk.h ****  *    this list of conditions and the following disclaimer.
  17:../../../platform/common/services/clock/mega/sysclk.h ****  *
  18:../../../platform/common/services/clock/mega/sysclk.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  19:../../../platform/common/services/clock/mega/sysclk.h ****  *    this list of conditions and the following disclaimer in the documentation
  20:../../../platform/common/services/clock/mega/sysclk.h ****  *    and/or other materials provided with the distribution.
  21:../../../platform/common/services/clock/mega/sysclk.h ****  *
  22:../../../platform/common/services/clock/mega/sysclk.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  23:../../../platform/common/services/clock/mega/sysclk.h ****  *    from this software without specific prior written permission.
  24:../../../platform/common/services/clock/mega/sysclk.h ****  *
  25:../../../platform/common/services/clock/mega/sysclk.h ****  * 4. This software may only be redistributed and used in connection with an
  26:../../../platform/common/services/clock/mega/sysclk.h ****  *    Atmel microcontroller product.
  27:../../../platform/common/services/clock/mega/sysclk.h ****  *
  28:../../../platform/common/services/clock/mega/sysclk.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  29:../../../platform/common/services/clock/mega/sysclk.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  30:../../../platform/common/services/clock/mega/sysclk.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  31:../../../platform/common/services/clock/mega/sysclk.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  32:../../../platform/common/services/clock/mega/sysclk.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  33:../../../platform/common/services/clock/mega/sysclk.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  34:../../../platform/common/services/clock/mega/sysclk.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  35:../../../platform/common/services/clock/mega/sysclk.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  36:../../../platform/common/services/clock/mega/sysclk.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  37:../../../platform/common/services/clock/mega/sysclk.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  38:../../../platform/common/services/clock/mega/sysclk.h ****  * POSSIBILITY OF SUCH DAMAGE.
  39:../../../platform/common/services/clock/mega/sysclk.h ****  *
  40:../../../platform/common/services/clock/mega/sysclk.h ****  * \asf_license_stop
  41:../../../platform/common/services/clock/mega/sysclk.h ****  *
  42:../../../platform/common/services/clock/mega/sysclk.h ****  */
  43:../../../platform/common/services/clock/mega/sysclk.h **** #ifndef MEGA_SYSCLK_H_INCLUDED
  44:../../../platform/common/services/clock/mega/sysclk.h **** #define MEGA_SYSCLK_H_INCLUDED
  45:../../../platform/common/services/clock/mega/sysclk.h **** 
  46:../../../platform/common/services/clock/mega/sysclk.h **** #include <board.h>
  47:../../../platform/common/services/clock/mega/sysclk.h **** #include <compiler.h>
  48:../../../platform/common/services/clock/mega/sysclk.h **** #include <parts.h>
  49:../../../platform/common/services/clock/mega/sysclk.h **** 
  50:../../../platform/common/services/clock/mega/sysclk.h **** /* Include clock configuration for the project. */
  51:../../../platform/common/services/clock/mega/sysclk.h **** #include <conf_clock.h>
  52:../../../platform/common/services/clock/mega/sysclk.h **** 
  53:../../../platform/common/services/clock/mega/sysclk.h **** #ifdef __cplusplus
  54:../../../platform/common/services/clock/mega/sysclk.h **** extern "C" {
  55:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  56:../../../platform/common/services/clock/mega/sysclk.h **** #define ASM __asm__
  57:../../../platform/common/services/clock/mega/sysclk.h **** 
  58:../../../platform/common/services/clock/mega/sysclk.h **** /* CONFIG_SYSCLK_PSDIV  to use default if not defined*/
  59:../../../platform/common/services/clock/mega/sysclk.h **** #ifndef CONFIG_SYSCLK_PSDIV
  60:../../../platform/common/services/clock/mega/sysclk.h **** # define CONFIG_SYSCLK_PSDIV    SYSCLK_PSDIV_8
  61:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  62:../../../platform/common/services/clock/mega/sysclk.h **** 
  63:../../../platform/common/services/clock/mega/sysclk.h **** /* ! \name Prescaler Setting (relative to CLKsys) */
  64:../../../platform/common/services/clock/mega/sysclk.h **** /* @{ */
  65:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_1      0   /* !< Do not prescale */
  66:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_2      1   /* !< Prescale CLKper4 by 2 */
  67:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_4      2   /* !< Prescale CLKper4 by 4 */
  68:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_8      3   /* !< Prescale CLKper4 by 8 */
  69:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_16     4   /* !< Prescale CLKper4 by 16 */
  70:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_32     5   /* !< Prescale CLKper4 by 32 */
  71:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_64     6   /* !< Prescale CLKper4 by 64 */
  72:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_128    7   /* !< Prescale CLKper4 by 128 */
  73:../../../platform/common/services/clock/mega/sysclk.h **** #define SYSCLK_PSDIV_256    8   /* !< Prescale CLKper4 by 256 */
  74:../../../platform/common/services/clock/mega/sysclk.h **** 
  75:../../../platform/common/services/clock/mega/sysclk.h **** /* @} */
  76:../../../platform/common/services/clock/mega/sysclk.h **** 
  77:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF || MEGA_XX0_1 || MEGA_XX4 || MEGA_XX4_A
  78:../../../platform/common/services/clock/mega/sysclk.h **** 
  79:../../../platform/common/services/clock/mega/sysclk.h **** #define NUMBER_OF_POWER_REG       2
  80:../../../platform/common/services/clock/mega/sysclk.h **** /*Starting Address for power reduction*/
  81:../../../platform/common/services/clock/mega/sysclk.h **** #define POWER_REG_ADD             PRR0
  82:../../../platform/common/services/clock/mega/sysclk.h **** 
  83:../../../platform/common/services/clock/mega/sysclk.h **** /* ! \name Power Reduction  Clock Port Numbers */
  84:../../../platform/common/services/clock/mega/sysclk.h **** enum power_red_id {
  85:../../../platform/common/services/clock/mega/sysclk.h **** 	POWER_RED_REG0,     /* !< Devices on PRR0 */
  86:../../../platform/common/services/clock/mega/sysclk.h **** #if !MEGA_XX4 || !MEGA_XX4_A || MEGA_XX0_1
  87:../../../platform/common/services/clock/mega/sysclk.h **** 	POWER_RED_REG1,     /* !< Devices on PRR1 */
  88:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  89:../../../platform/common/services/clock/mega/sysclk.h **** };
  90:../../../platform/common/services/clock/mega/sysclk.h **** #endif
  91:../../../platform/common/services/clock/mega/sysclk.h **** 
  92:../../../platform/common/services/clock/mega/sysclk.h **** /****************************************************
  93:../../../platform/common/services/clock/mega/sysclk.h ****  * Given a dummy type but not used for these groups
  94:../../../platform/common/services/clock/mega/sysclk.h ****  * to support for otherthen megaRF device.
  95:../../../platform/common/services/clock/mega/sysclk.h ****  **************************************************/
  96:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_XX8 || MEGA_XX8_A || MEGA_UNSPECIFIED
  97:../../../platform/common/services/clock/mega/sysclk.h **** #define NUMBER_OF_POWER_REG       1
  98:../../../platform/common/services/clock/mega/sysclk.h **** /*Starting Address for power reduction*/
  99:../../../platform/common/services/clock/mega/sysclk.h **** #define POWER_REG_ADD             PRR
 100:../../../platform/common/services/clock/mega/sysclk.h **** 
 101:../../../platform/common/services/clock/mega/sysclk.h **** /* ! \name Power Reduction  Clock Port Numbers */
 102:../../../platform/common/services/clock/mega/sysclk.h **** enum power_red_id {
 103:../../../platform/common/services/clock/mega/sysclk.h **** 	POWER_RED_REG0,     /* !< Devices on PRR */
 104:../../../platform/common/services/clock/mega/sysclk.h **** };
 105:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 106:../../../platform/common/services/clock/mega/sysclk.h **** 
 107:../../../platform/common/services/clock/mega/sysclk.h **** /* Bit mask for the power reduction register based on */
 108:../../../platform/common/services/clock/mega/sysclk.h **** /*   MCU ARCH.                                        */
 109:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 110:../../../platform/common/services/clock/mega/sysclk.h **** /*Bit mask for PRR2 */
 111:../../../platform/common/services/clock/mega/sysclk.h **** 
 112:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM0_bm                       1 << PRRAM0
 113:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM1_bm                       1 << PRRAM1
 114:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM2_bm                       1 << PRRAM2
 115:../../../platform/common/services/clock/mega/sysclk.h **** #define PRRAM3_bm                       1 << PRRAM3
 116:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 117:../../../platform/common/services/clock/mega/sysclk.h **** 
 118:../../../platform/common/services/clock/mega/sysclk.h **** /*Bit mask for the power reduction 0 or PRR*/
 119:../../../platform/common/services/clock/mega/sysclk.h **** #if !MEGA_XX_UN0 && !MEGA_XX_UN0
 120:../../../platform/common/services/clock/mega/sysclk.h **** #define PRADC_bm                        1 << PRADC
 121:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART0_bm                     1 << PRUSART0
 122:../../../platform/common/services/clock/mega/sysclk.h **** #define PRSPI_bm                        1 << PRSPI
 123:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM1_bm                       1 << PRTIM1
 124:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 125:../../../platform/common/services/clock/mega/sysclk.h **** 
 126:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 127:../../../platform/common/services/clock/mega/sysclk.h **** #define PRPGA_bm                        1 << PRPGA
 128:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 129:../../../platform/common/services/clock/mega/sysclk.h **** 
 130:../../../platform/common/services/clock/mega/sysclk.h **** #if !MEGA_UNSPECIFIED
 131:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM0_bm                       1 << PRTIM0
 132:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM2_bm                       1 << PRTIM2
 133:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTWI_bm                        1 << PRTWI
 134:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 135:../../../platform/common/services/clock/mega/sysclk.h **** 
 136:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_XX_UN2
 137:../../../platform/common/services/clock/mega/sysclk.h **** #define PRLCD_bm                        1 << PRLCD
 138:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 139:../../../platform/common/services/clock/mega/sysclk.h **** 
 140:../../../platform/common/services/clock/mega/sysclk.h **** /*Bit mask for  PRR1  */
 141:../../../platform/common/services/clock/mega/sysclk.h **** #ifdef PRR1
 142:../../../platform/common/services/clock/mega/sysclk.h **** #if (MEGA_XX4 || MEGA_XX4_A)
 143:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM3_bm                       1 << PRTIM3
 144:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 145:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 146:../../../platform/common/services/clock/mega/sysclk.h **** 
 147:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF || MEGA_XX4 || MEGA_XX4_A
 148:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART1_bm                     1 << PRUSART1
 149:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART2_bm                     1 << PRUSART2
 150:../../../platform/common/services/clock/mega/sysclk.h **** #define PRUSART3_bm                     1 << PRUSART3
 151:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM3_bm                       1 << PRTIM3
 152:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM4_bm                       1 << PRTIM4
 153:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTIM5_bm                       1 << PRTIM5
 154:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 155:../../../platform/common/services/clock/mega/sysclk.h **** 
 156:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 157:../../../platform/common/services/clock/mega/sysclk.h **** #define PRTRX24_bm                      1 << PRTRX24
 158:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 159:../../../platform/common/services/clock/mega/sysclk.h **** 
 160:../../../platform/common/services/clock/mega/sysclk.h **** /**
 161:../../../platform/common/services/clock/mega/sysclk.h ****  * \name Querying the system clock and its derived clocks
 162:../../../platform/common/services/clock/mega/sysclk.h ****  */
 163:../../../platform/common/services/clock/mega/sysclk.h **** /* @{ */
 164:../../../platform/common/services/clock/mega/sysclk.h **** 
 165:../../../platform/common/services/clock/mega/sysclk.h **** /**
 166:../../../platform/common/services/clock/mega/sysclk.h ****  * \brief Return the current rate in Hz of the main system clock
 167:../../../platform/common/services/clock/mega/sysclk.h ****  * To know the clock value at what frequency the main clock is running
 168:../../../platform/common/services/clock/mega/sysclk.h ****  * \return Frequency of the main system clock, in Hz.
 169:../../../platform/common/services/clock/mega/sysclk.h ****  * \todo : please initialize the SYSCLK_SOURCE in conf_clock.h file for
 170:../../../platform/common/services/clock/mega/sysclk.h ****  * configured source clock using fuses.
 171:../../../platform/common/services/clock/mega/sysclk.h ****  * \eg. #define SYSCLK_SOURCE SYSCLK_SRC_RC16MHZ to use internal RC
 172:../../../platform/common/services/clock/mega/sysclk.h ****  * oscillator for clock source.
 173:../../../platform/common/services/clock/mega/sysclk.h ****  */
 174:../../../platform/common/services/clock/mega/sysclk.h **** static inline uint32_t sysclk_get_main_hz(void)
 175:../../../platform/common/services/clock/mega/sysclk.h **** {
  17               		.loc 1 175 0
  18               		.cfi_startproc
  19 0000 CF93      		push r28
  20               	.LCFI0:
  21               		.cfi_def_cfa_offset 3
  22               		.cfi_offset 28, -2
  23 0002 DF93      		push r29
  24               	.LCFI1:
  25               		.cfi_def_cfa_offset 4
  26               		.cfi_offset 29, -3
  27 0004 CDB7      		in r28,__SP_L__
  28 0006 DEB7      		in r29,__SP_H__
  29               	.LCFI2:
  30               		.cfi_def_cfa_register 28
  31               	/* prologue: function */
  32               	/* frame size = 0 */
  33               	/* stack size = 2 */
  34               	.L__stack_usage = 2
 176:../../../platform/common/services/clock/mega/sysclk.h **** 	switch (SYSCLK_SOURCE) {
 177:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_RC16MHZ:
 178:../../../platform/common/services/clock/mega/sysclk.h **** 		return 16000000UL;
 179:../../../platform/common/services/clock/mega/sysclk.h **** 
 180:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_RC128KHZ:
 181:../../../platform/common/services/clock/mega/sysclk.h **** 		return 128000UL;
 182:../../../platform/common/services/clock/mega/sysclk.h **** 
 183:../../../platform/common/services/clock/mega/sysclk.h **** #if MEGA_RF
 184:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_TRS16MHZ:
 185:../../../platform/common/services/clock/mega/sysclk.h **** 		return 16000000UL;
  35               		.loc 1 185 0
  36 0008 80E0      		ldi r24,0
  37 000a 94E2      		ldi r25,lo8(36)
  38 000c A4EF      		ldi r26,lo8(-12)
  39 000e B0E0      		ldi r27,0
 186:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 187:../../../platform/common/services/clock/mega/sysclk.h **** #ifdef BOARD_EXTERNAL_CLK
 188:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_SRC_EXTERNAL:
 189:../../../platform/common/services/clock/mega/sysclk.h **** 		return BOARD_EXTERNAL_CLK;
 190:../../../platform/common/services/clock/mega/sysclk.h **** #endif
 191:../../../platform/common/services/clock/mega/sysclk.h **** 	default:
 192:../../../platform/common/services/clock/mega/sysclk.h **** 
 193:../../../platform/common/services/clock/mega/sysclk.h **** 		return 1000000UL;
 194:../../../platform/common/services/clock/mega/sysclk.h **** 	}
 195:../../../platform/common/services/clock/mega/sysclk.h **** }
  40               		.loc 1 195 0
  41 0010 BC01      		movw r22,r24
  42 0012 CD01      		movw r24,r26
  43               	/* epilogue start */
  44 0014 DF91      		pop r29
  45 0016 CF91      		pop r28
  46 0018 0895      		ret
  47               		.cfi_endproc
  48               	.LFE67:
  51               	sysclk_get_source_clock_hz:
  52               	.LFB68:
 196:../../../platform/common/services/clock/mega/sysclk.h **** 
 197:../../../platform/common/services/clock/mega/sysclk.h **** /**
 198:../../../platform/common/services/clock/mega/sysclk.h ****  * \brief Return the current rate in Hz of source clock in Hz.
 199:../../../platform/common/services/clock/mega/sysclk.h ****  *
 200:../../../platform/common/services/clock/mega/sysclk.h ****  * This clock always runs at the same rate as the CPU clock unless the divider
 201:../../../platform/common/services/clock/mega/sysclk.h ****  * is set.
 202:../../../platform/common/services/clock/mega/sysclk.h ****  *
 203:../../../platform/common/services/clock/mega/sysclk.h ****  * \return Frequency of the system clock, in Hz.
 204:../../../platform/common/services/clock/mega/sysclk.h ****  */
 205:../../../platform/common/services/clock/mega/sysclk.h **** static inline uint32_t sysclk_get_source_clock_hz(void)
 206:../../../platform/common/services/clock/mega/sysclk.h **** {
  53               		.loc 1 206 0
  54               		.cfi_startproc
  55 001a CF93      		push r28
  56               	.LCFI3:
  57               		.cfi_def_cfa_offset 3
  58               		.cfi_offset 28, -2
  59 001c DF93      		push r29
  60               	.LCFI4:
  61               		.cfi_def_cfa_offset 4
  62               		.cfi_offset 29, -3
  63 001e CDB7      		in r28,__SP_L__
  64 0020 DEB7      		in r29,__SP_H__
  65               	.LCFI5:
  66               		.cfi_def_cfa_register 28
  67               	/* prologue: function */
  68               	/* frame size = 0 */
  69               	/* stack size = 2 */
  70               	.L__stack_usage = 2
 207:../../../platform/common/services/clock/mega/sysclk.h **** 	switch (CONFIG_SYSCLK_PSDIV) {
 208:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_1: /* Fall through */
 209:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 210:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 211:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 2;
 212:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 213:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz();
  71               		.loc 1 213 0
  72 0022 0E94 0000 		call sysclk_get_main_hz
  73 0026 DC01      		movw r26,r24
  74 0028 CB01      		movw r24,r22
 214:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 215:../../../platform/common/services/clock/mega/sysclk.h **** 
 216:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_2:
 217:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 218:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 219:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 4;
 220:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 221:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 2;
 222:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 223:../../../platform/common/services/clock/mega/sysclk.h **** 
 224:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_4:
 225:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 226:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 227:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 8;
 228:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 229:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 4;
 230:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 231:../../../platform/common/services/clock/mega/sysclk.h **** 
 232:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_8:
 233:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 234:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 235:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 16;
 236:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 237:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 8;
 238:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 239:../../../platform/common/services/clock/mega/sysclk.h **** 
 240:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_16:
 241:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 242:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 243:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 32;
 244:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 245:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 16;
 246:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 247:../../../platform/common/services/clock/mega/sysclk.h **** 
 248:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_32:
 249:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 250:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 251:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 64;
 252:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 253:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 32;
 254:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 255:../../../platform/common/services/clock/mega/sysclk.h **** 
 256:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_64:
 257:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 258:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 259:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 128;
 260:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 261:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 64;
 262:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 263:../../../platform/common/services/clock/mega/sysclk.h **** 
 264:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_128:
 265:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 266:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 267:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 256;
 268:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 269:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 128;
 270:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 271:../../../platform/common/services/clock/mega/sysclk.h **** 
 272:../../../platform/common/services/clock/mega/sysclk.h **** 	case SYSCLK_PSDIV_256:
 273:../../../platform/common/services/clock/mega/sysclk.h **** 		if (SYSCLK_SOURCE == SYSCLK_SRC_RC16MHZ ||
 274:../../../platform/common/services/clock/mega/sysclk.h **** 				SYSCLK_SOURCE == SYSCLK_SRC_RC128KHZ) {
 275:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 512;
 276:../../../platform/common/services/clock/mega/sysclk.h **** 		} else {
 277:../../../platform/common/services/clock/mega/sysclk.h **** 			return sysclk_get_main_hz() / 256;
 278:../../../platform/common/services/clock/mega/sysclk.h **** 		}
 279:../../../platform/common/services/clock/mega/sysclk.h **** 
 280:../../../platform/common/services/clock/mega/sysclk.h **** 	default:
 281:../../../platform/common/services/clock/mega/sysclk.h **** 		/*Invalide case*/
 282:../../../platform/common/services/clock/mega/sysclk.h **** 		return 0;
 283:../../../platform/common/services/clock/mega/sysclk.h **** 	}
 284:../../../platform/common/services/clock/mega/sysclk.h **** }
  75               		.loc 1 284 0
  76 002a BC01      		movw r22,r24
  77 002c CD01      		movw r24,r26
  78               	/* epilogue start */
  79 002e DF91      		pop r29
  80 0030 CF91      		pop r28
  81 0032 0895      		ret
  82               		.cfi_endproc
  83               	.LFE68:
  85               		.section	.progmem.data.baudctrl_1mhz,"a",@progbits
  88               	baudctrl_1mhz:
  89 0000 3300      		.word	51
  90 0002 1900      		.word	25
  91 0004 0C00      		.word	12
  92 0006 0600      		.word	6
  93 0008 0300      		.word	3
  94 000a 0200      		.word	2
  95 000c 0100      		.word	1
  96 000e FF00      		.word	255
  97               		.section	.progmem.data.baudctrl_8mhz,"a",@progbits
 100               	baudctrl_8mhz:
 101 0000 A001      		.word	416
 102 0002 CF00      		.word	207
 103 0004 6700      		.word	103
 104 0006 3300      		.word	51
 105 0008 1900      		.word	25
 106 000a 0C00      		.word	12
 107 000c 0700      		.word	7
 108 000e 0800      		.word	8
 109               		.section	.progmem.data.baudctrl_16mhz,"a",@progbits
 112               	baudctrl_16mhz:
 113 0000 4003      		.word	832
 114 0002 A001      		.word	416
 115 0004 CF00      		.word	207
 116 0006 6700      		.word	103
 117 0008 3300      		.word	51
 118 000a 1900      		.word	25
 119 000c 1000      		.word	16
 120 000e 1000      		.word	16
 121               		.text
 123               	usart_double_baud_enable:
 124               	.LFB101:
 125               		.file 2 "../../../platform/mega_rf/drivers/usart/usart_megarf.h"
   1:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
   2:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \file
   3:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
   4:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief USART driver for AVR MEGARF.
   5:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
   6:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * This file contains basic functions for the AVR MEGA USART, with support for
   7:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * all modes, settings and clock speeds.
   8:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
   9:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Copyright (c) 2013-2015 Atmel Corporation. All rights reserved.
  10:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  11:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \asf_license_start
  12:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  13:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \page License
  14:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  15:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Redistribution and use in source and binary forms, with or without
  16:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * modification, are permitted provided that the following conditions are met:
  17:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  18:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  19:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    this list of conditions and the following disclaimer.
  20:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  21:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  22:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    this list of conditions and the following disclaimer in the documentation
  23:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    and/or other materials provided with the distribution.
  24:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  25:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  26:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    from this software without specific prior written permission.
  27:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  28:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * 4. This software may only be redistributed and used in connection with an
  29:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *    Atmel microcontroller product.
  30:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  31:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  32:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  33:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  34:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  35:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  36:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  37:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  38:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  39:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  40:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  41:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * POSSIBILITY OF SUCH DAMAGE.
  42:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  43:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \asf_license_stop
  44:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  45:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
  46:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #ifndef _USART_MEGARF_H_
  47:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define _USART_MEGARF_H_
  48:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  49:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #ifdef __cplusplus
  50:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** extern "C" {
  51:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #endif
  52:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  53:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #include "compiler.h"
  54:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #include "status_codes.h"
  55:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  56:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
  57:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \defgroup megarf_usart_group USART module (USART)
  58:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  59:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * See \ref megarf_usart_quickstart.
  60:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  61:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * This is a driver for configuring, enabling, disabling and use of the on-chip
  62:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * USART.
  63:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  64:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \section dependencies Dependencies
  65:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  66:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * The USART module depends on the following modules:
  67:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  - \ref sysclk_group for peripheral clock control.
  68:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  - \ref port_driver_group for peripheral io port control.
  69:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
  70:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * @{
  71:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
  72:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  73:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 1200 */
  74:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_1200      0x00
  75:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 2400 */
  76:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_2400      0x01
  77:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 4800 */
  78:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_4800      0x02
  79:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 9600 */
  80:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_9600      0x03
  81:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 19200 */
  82:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_19200     0x04
  83:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 38400 */
  84:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_38400     0x05
  85:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 57600 */
  86:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_57600     0x06
  87:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Offset in lookup table for baudrate 115200 */
  88:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_115200    0x07
  89:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Baudrate not in lookup table */
  90:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_BAUD_UNDEFINED 0xFF
  91:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
  92:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef volatile uint8_t register8_t;
  93:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef volatile uint16_t register16_t;
  94:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Universal Synchronous/Asynchronous Receiver/Transmitter */
  95:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef struct USART_struct {
  96:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UCSRnA;  /* Control Register A */
  97:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UCSRnB;  /* Control Register B */
  98:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UCSRnC;  /* Control Register C */
  99:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t reserved;
 100:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register16_t UBRR;  /* Baud Rate Register Value */
 101:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	register8_t UDR;  /* I/O Data Register */
 102:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_t;
 103:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 104:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USARTA0    (*(USART_t *)0xC0)   /* Universal Asynchronous
 105:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                 * Receiver-Transmitter A0 */
 106:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USARTA1    (*(USART_t *)0XC8)   /* Universal Asynchronous
 107:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                 * Receiver-Transmitter A1 */
 108:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 109:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* USART.UCSRxA  bit masks and bit positions */
 110:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXC_bm  0x80 /* RX complete bit mask.*/
 111:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXC_bp  7 /* RX complete bit position.*/
 112:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 113:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXC_bm  0x40 /* TX complete bit mask.*/
 114:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXC_bp  6 /* TX complete bit position.*/
 115:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 116:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRE_bm  0x20 /* DATA Register Empty Bit mask.*/
 117:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRE_bp  5 /*  DATA Register Empty bit position.*/
 118:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 119:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_FE_bm   0x10 /* Frame Error bit mask.*/
 120:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_FE_bp   4 /*Frame error bit position.*/
 121:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 122:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DOR_bm  0x08 /* Data Over Run bit mask.*/
 123:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DOR_bp  3 /* Data Over Run bit position.*/
 124:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 125:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UPE_bm  0x04 /* Parity error bit mask.*/
 126:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UPE_bp  2 /* Parity error bit position.*/
 127:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 128:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_U2X_bm  0x02 /* Double TX speed bit mask.*/
 129:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_U2X_bp  1 /* Double TX speed bit position.*/
 130:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 131:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_MPCM_bm  0x01 /* Multi Processor bit mask.*/
 132:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_MPMC_bp  0 /* Multi processor bit position.*/
 133:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 134:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* USART.UCSRxB  bit masks and bit positions */
 135:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXCIE_bm  0x80 /* RX complete interrupt Enable bit mask.*/
 136:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXCIE_bp  7 /* RX complete interrupt Enable bit position.*/
 137:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 138:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXCIE_bm  0x40 /* TX complete interrupt Enable bit mask.*/
 139:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXCIE_bp  6 /* TX complete interrupt Enable bit position.*/
 140:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 141:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRIE_bm  0x20 /* Data register empty interrupt Enable bit mask.*/
 142:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DRIE_bp  5 /* Data register empty interrupt Enable bit position.*/
 143:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 144:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXEN_bm  0x10  /* Receiver Enable bit mask. */
 145:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXEN_bp  4  /* Receiver Enable bit position. */
 146:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 147:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXEN_bm  0x08  /* Transmitter Enable bit mask. */
 148:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXEN_bp  3  /* Transmitter Enable bit position. */
 149:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 150:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE2_bm  0x04  /* Character Size bit mask. */
 151:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE2_bp  2 /* Character Size bit position. */
 152:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 153:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXB8_bm  0x02  /* Transmit bit 8 bit mask. */
 154:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_RXB8_bp  1  /* Transmit bit 8 bit position. */
 155:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 156:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXB8_bm  0x01  /* Transmit bit 8 bit mask. */
 157:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_TXB8_bp  0  /* Transmit bit 8 bit position. */
 158:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 159:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* USART.UCSRxC  bit masks and bit positions */
 160:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_gm  0xC0 /* USART Mode Select 01 grp mask.*/
 161:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_gp  6 /* USART Mode Select 01 grp position.*/
 162:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 163:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_bm  0x80 /* USART Mode Select 01 bit mask.*/
 164:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL01_bp  7 /* USART Mode Select 01 bit position.*/
 165:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 166:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL00_bm  0x40 /* USART Mode Select 00 bit mask.*/
 167:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UMSEL00_bp  6 /* USART Mode Select 00 bit position.*/
 168:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 169:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE_gm  0x30 /* USART Parity Mode Select grp mask.*/
 170:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE_gp  4 /* USART Parity Mode Select grp position.*/
 171:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 172:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE01_bm  0x20 /* USART Parity Mode Select 01 bit mask.*/
 173:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE01_bp  5 /* USART Parity Mode Select 01 bit position.*/
 174:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 175:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE00_bm  0x10 /* USART Parity Mode Select 00 bit mask.*/
 176:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_PMODE00_bp  4 /* USART Parity Mode Select 00 bit position.*/
 177:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 178:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_STOPB_bm  0x08 /* USART stop bit mask.*/
 179:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_STOPB_bp  3 /* USART stop bit Position.*/
 180:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 181:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01C_gm  0x06  /* Character Size 10 bit 1 mask. */
 182:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01C_gp  1 /* Character Size 10 bit position. */
 183:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 184:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01_bm  0x04  /* Character Size 10 bit 1 mask. */
 185:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE01_bp  2 /* Character Size 10 bit position. */
 186:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 187:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE00_bm  0x02  /* Character Size 00 bit 1 mask. */
 188:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_CHSIZE00_bp  1 /* Character Size bit 00 position. */
 189:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 190:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPOL_bm  0x01  /* Sync mode Pol bit 1 mask. */
 191:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPOL_bp  0 /*Sync mode Pol bit 0 position */
 192:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 193:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPHA_bm 0x02 /* Clock Phase bit mask. */
 194:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_UCPHA_bp 1 /* Clock Phase bit position. */
 195:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 196:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DORD_bm 0x04 /* Data order bit mask. */
 197:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** #define USART_DORD_bp 2 /* Data order bit position. */
 198:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 199:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Character Size */
 200:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef enum USART_CHSIZE_enum {
 201:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_5BIT_gc = (0x00),  /* Character size: 5 bit */
 202:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_6BIT_gc = (0x01),  /* Character size: 6 bit */
 203:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_7BIT_gc = (0x02),  /* Character size: 7 bit */
 204:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_8BIT_gc = (0x03),  /* Character size: 8 bit */
 205:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_9BIT_gc = (0x07),  /* Character size: 9 bit */
 206:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_CHSIZE_t;
 207:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 208:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Communication Mode */
 209:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef enum USART_CMODE_enum {
 210:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_ASYNCHRONOUS_gc = (0x00 << USART_UMSEL01_gp),  /*
 211:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            *
 212:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            *
 213:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            *Asynchronous
 214:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                            * Mode */
 215:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_SYNCHRONOUS_gc = (0x01 << USART_UMSEL01_gp),  /* Synchronous
 216:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	                                                           * Mode */
 217:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_IRDA_gc = (0x02 << USART_UMSEL01_gp),  /* IrDA Mode */
 218:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CMODE_MSPI_gc = (0x03 << USART_UMSEL01_gp),  /* Master SPI Mode */
 219:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_CMODE_t;
 220:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 221:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* Parity Mode */
 222:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef enum USART_PMODE_enum {
 223:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_DISABLED_gc = (0x00 << USART_PMODE_gp),  /* No Parity */
 224:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_EVEN_gc = (0x02 << USART_PMODE_gp),  /* Even Parity */
 225:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_ODD_gc = (0x03 << USART_PMODE_gp),  /* Odd Parity */
 226:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } USART_PMODE_t;
 227:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 228:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Lookup table containing baudctrl values for CPU frequency 1 Mhz */
 229:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static PROGMEM_DECLARE(uint16_t, baudctrl_1mhz[]) = {
 230:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0033, /* Baud: 1200 */
 231:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0019, /* Baud: 2400 */
 232:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x000C, /* Baud: 4800 */
 233:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0006, /* Baud: 9600 */
 234:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0003, /* Baud: 19200 */
 235:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0002, /* Baud: 38400 */
 236:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0001, /* Baud: 57600 */
 237:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_BAUD_UNDEFINED, /* Baud: 115200 */
 238:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** };
 239:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 240:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Lookup table containing baudctrl values for CPU frequency 8 Mhz */
 241:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static PROGMEM_DECLARE(uint16_t, baudctrl_8mhz[]) = {
 242:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x01A0, /* Baud: 1200 */
 243:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x00CF, /* Baud: 2400 */
 244:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0067, /* Baud: 4800 */
 245:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0033, /* Baud: 9600 */
 246:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0019, /* Baud: 19200 */
 247:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x000C, /* Baud: 38400 */
 248:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0007, /* Baud: 57600 */
 249:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0008, /* Baud: 115200 */
 250:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** };
 251:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 252:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Lookup table containing baudctrl values for CPU frequency 16 Mhz */
 253:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static PROGMEM_DECLARE(uint16_t, baudctrl_16mhz[]) = {
 254:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0340, /* Baud: 1200 */
 255:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x01A0, /* Baud: 2400 */
 256:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x00CF, /* Baud: 4800 */
 257:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0067, /* Baud: 9600 */
 258:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0033, /* Baud: 19200 */
 259:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0019, /* Baud: 38400 */
 260:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0010, /* Baud: 57600 */
 261:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	0x0010, /* Baud: 115200 */
 262:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** };
 263:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 264:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 265:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Input parameters when initializing RS232 and similar modes. */
 266:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef struct usart_rs232_options {
 267:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Set baud rate of the USART (unused in slave modes). */
 268:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint32_t baudrate;
 269:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 270:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Number of bits to transmit as a character (5 to 9). */
 271:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_CHSIZE_t charlength;
 272:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 273:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Parity type: USART_PMODE_DISABLED_gc, USART_PMODE_EVEN_gc, */
 274:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! USART_PMODE_ODD_gc. */
 275:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	USART_PMODE_t paritytype;
 276:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 277:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Number of stop bits between two characters: */
 278:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! true: 2 stop bits */
 279:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! false: 1 stop bit */
 280:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	bool stopbits;
 281:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } usart_rs232_options_t;
 282:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 283:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /* ! Input parameters when initializing SPI master mode. */
 284:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** typedef struct usart_spi_options {
 285:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! Set baud rate of the USART in SPI mode. */
 286:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint32_t baudrate;
 287:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 288:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	/* ! SPI transmission mode. */
 289:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint8_t spimode;
 290:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 291:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	uint8_t data_order;
 292:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** } usart_spi_options_t;
 293:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 294:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 295:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 296:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART receiver.
 297:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 298:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module
 299:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 300:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_enable(USART_t *usart)
 301:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 302:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_RXEN_bm;
 303:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 304:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 305:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 306:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART receiver.
 307:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 308:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 309:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 310:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_disable(USART_t *usart)
 311:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 312:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_RXEN_bm;
 313:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 314:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 315:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 316:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief  Configure the USART frame format.
 317:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 318:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  Sets the frame format, Frame Size, parity mode and number of stop bits.
 319:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 320:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param usart Pointer to the USART module
 321:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param charSize The character size. Use USART_CHSIZE_t type.
 322:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param parityMode The parity Mode. Use USART_PMODE_t type.
 323:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *  \param twoStopBits Enable two stop bit mode. Use bool type.
 324:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 325:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_format_set(USART_t *usart, USART_CHSIZE_t charSize,
 326:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 		USART_PMODE_t parityMode, bool twoStopBits)
 327:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 328:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC
 329:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 		= ((usart)->UCSRnC &
 330:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			(~USART_CHSIZE01C_gm)) | ((charSize & 0x03)
 331:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			<< USART_CHSIZE01C_gp);
 332:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB
 333:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 		= ((usart)->UCSRnB &
 334:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			(~USART_CHSIZE2_bm)) | ((charSize & 0x04)
 335:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			<< USART_CHSIZE2_bp);
 336:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 337:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC = ((usart)->UCSRnC & (~USART_PMODE_gm)) | parityMode;
 338:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 339:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC = ((usart)->UCSRnC & (~USART_STOPB_bm)) | (twoStopBits
 340:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 			<< USART_STOPB_bp);
 341:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 342:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 343:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 344:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART transmitter.
 345:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 346:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 347:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 348:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_enable(USART_t *usart)
 349:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 350:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_TXEN_bm;
 351:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 352:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 353:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 354:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART transmitter.
 355:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 356:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 357:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 358:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_disable(USART_t *usart)
 359:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 360:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_TXEN_bm;
 361:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 362:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 363:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 364:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART transmit complete interrupt.
 365:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 366:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 367:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 368:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_complete_interrupt_enable(USART_t *usart)
 369:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 370:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_TXC_bm;
 371:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 372:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 373:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 374:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART receive complete interrupt.
 375:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 376:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 377:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 378:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_complete_interrupt_enable(USART_t *usart)
 379:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 380:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_RXC_bm;
 381:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 382:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 383:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 384:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Enable USART data register empty interrupt.
 385:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 386:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 387:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 388:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_data_empty_interrupt_enable(USART_t *usart)
 389:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 390:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB |= USART_DRIE_bm;
 391:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 392:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 393:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 394:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART transmit complete interrupt.
 395:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 396:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 397:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 398:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_tx_complete_interrupt_disable(USART_t *usart)
 399:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 400:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_TXC_bm;
 401:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 402:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 403:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 404:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART receive complete interrupt.
 405:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 406:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 407:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 408:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_rx_complete_interrupt_disable(USART_t *usart)
 409:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 410:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_RXC_bm;
 411:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 412:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 413:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 414:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Disable USART data register empty interrupt.
 415:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 416:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module.
 417:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 418:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_data_empty_interrupt_disable(USART_t *usart)
 419:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 420:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnB &= ~USART_DRIE_bm;
 421:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 422:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 423:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 424:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Set the mode the USART run in.
 425:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 426:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Set the mode the USART run in. The default mode is asynchronous mode.
 427:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 428:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart Pointer to the USART module register section.
 429:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usartmode Selects the USART mode. Use USART_CMODE_t type.
 430:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 431:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * USART modes:
 432:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x0        : Asynchronous mode.
 433:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x1        : Synchronous mode.
 434:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x2        : IrDA mode.
 435:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * - 0x3        : Master SPI mode.
 436:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 437:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_set_mode(USART_t *usart, USART_CMODE_t usartmode)
 438:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 439:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UCSRnC = ((usart)->UCSRnC & (~USART_UMSEL01_gm)) | usartmode;
 440:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 441:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 442:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 443:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Check if data register empty flag is set.
 444:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 445:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 446:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 447:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline bool usart_data_register_is_empty(USART_t *usart)
 448:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 449:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UCSRnA & USART_DRE_bm;
 450:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 451:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 452:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 453:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Checks if the RX complete interrupt flag is set.
 454:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 455:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Checks if the RX complete interrupt flag is set.
 456:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 457:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 458:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 459:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline bool usart_rx_is_complete(USART_t *usart)
 460:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 461:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UCSRnA & USART_RXC_bm;
 462:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 463:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 464:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 465:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Checks if the TX complete interrupt flag is set.
 466:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 467:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * Checks if the TX complete interrupt flag is set.
 468:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 469:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 470:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 471:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline bool usart_tx_is_complete(USART_t *usart)
 472:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 473:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UCSRnA & USART_TXC_bm;
 474:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 475:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 476:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 477:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Clear TX complete interrupt flag.
 478:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * TX flag is clear after complete transmission, automatically.
 479:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 480:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 481:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_clear_tx_complete(USART_t *usart)
 482:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 483:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****          usart->UCSRnA |=  USART_TXC_bm;
 484:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 485:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 486:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 487:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Write a data to the USART data register.
 488:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 489:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 490:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param txdata The data to be transmitted.
 491:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 492:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_put(USART_t *usart, uint8_t txdata)
 493:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 494:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	(usart)->UDR = txdata;
 495:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 496:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 497:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 498:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief  Read a data to the USART data register.
 499:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 500:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 501:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 502:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \return The received data
 503:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 504:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline uint8_t usart_get(USART_t *usart)
 505:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 506:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	return (usart)->UDR;
 507:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 508:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 
 509:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** /**
 510:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \brief Double the USART transmission speed.
 511:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  *
 512:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  * \param usart The USART module.
 513:../../../platform/mega_rf/drivers/usart/usart_megarf.h ****  */
 514:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** static inline void usart_double_baud_enable(USART_t *usart)
 515:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** {
 126               		.loc 2 515 0
 127               		.cfi_startproc
 128 0034 CF93      		push r28
 129               	.LCFI6:
 130               		.cfi_def_cfa_offset 3
 131               		.cfi_offset 28, -2
 132 0036 DF93      		push r29
 133               	.LCFI7:
 134               		.cfi_def_cfa_offset 4
 135               		.cfi_offset 29, -3
 136 0038 00D0      		rcall .
 137               	.LCFI8:
 138               		.cfi_def_cfa_offset 6
 139 003a CDB7      		in r28,__SP_L__
 140 003c DEB7      		in r29,__SP_H__
 141               	.LCFI9:
 142               		.cfi_def_cfa_register 28
 143               	/* prologue: function */
 144               	/* frame size = 2 */
 145               	/* stack size = 4 */
 146               	.L__stack_usage = 4
 147 003e 9A83      		std Y+2,r25
 148 0040 8983      		std Y+1,r24
 516:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** 	usart->UCSRnA |=  USART_U2X_bm;
 149               		.loc 2 516 0
 150 0042 8981      		ldd r24,Y+1
 151 0044 9A81      		ldd r25,Y+2
 152 0046 FC01      		movw r30,r24
 153 0048 8081      		ld r24,Z
 154 004a 282F      		mov r18,r24
 155 004c 2260      		ori r18,lo8(2)
 156 004e 8981      		ldd r24,Y+1
 157 0050 9A81      		ldd r25,Y+2
 158 0052 FC01      		movw r30,r24
 159 0054 2083      		st Z,r18
 517:../../../platform/mega_rf/drivers/usart/usart_megarf.h **** }
 160               		.loc 2 517 0
 161 0056 0000      		nop
 162               	/* epilogue start */
 163 0058 0F90      		pop __tmp_reg__
 164 005a 0F90      		pop __tmp_reg__
 165 005c DF91      		pop r29
 166 005e CF91      		pop r28
 167 0060 0895      		ret
 168               		.cfi_endproc
 169               	.LFE101:
 172               	usart_serial_init:
 173               	.LFB104:
 174               		.file 3 "../../../platform/common/services/serial/megarf_usart/usart_serial.h"
   1:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /**
   2:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \file
   3:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
   4:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \brief This file defines a useful set of functions for the Serial interface on 
   5:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * AVR MEGARF devices.
   6:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
   7:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * Copyright (c) 2013 Atmel Corporation. All rights reserved.
   8:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
   9:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \asf_license_start
  10:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  11:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \page License
  12:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  13:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * Redistribution and use in source and binary forms, with or without
  14:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * modification, are permitted provided that the following conditions are met:
  15:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  16:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  17:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    this list of conditions and the following disclaimer.
  18:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  19:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  20:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    this list of conditions and the following disclaimer in the documentation
  21:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    and/or other materials provided with the distribution.
  22:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  23:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  24:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    from this software without specific prior written permission.
  25:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  26:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * 4. This software may only be redistributed and used in connection with an
  27:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *    Atmel microcontroller product.
  28:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  29:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  30:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  31:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  32:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  33:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  34:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  35:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  36:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  37:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  38:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  39:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * POSSIBILITY OF SUCH DAMAGE.
  40:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  41:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \asf_license_stop
  42:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  43:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  44:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #ifndef _USART_SERIAL_H_
  45:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #define _USART_SERIAL_H_
  46:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  47:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #ifdef __cplusplus
  48:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** extern "C" {
  49:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #endif
  50:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  51:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "compiler.h"
  52:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "sysclk.h"
  53:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "status_codes.h"
  54:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "usart_megarf.h"
  55:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  56:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \name Serial Management Configuration
  57:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  58:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /* ! @{ */
  59:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** #include "conf_usart_serial.h"
  60:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /* ! @} */
  61:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  62:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** typedef usart_rs232_options_t usart_serial_options_t;
  63:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  64:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** typedef USART_t *usart_if;
  65:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  66:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \brief Initializes the Usart in master mode.
  67:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  68:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param usart       Base address of the USART instance.
  69:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param options     Options needed to set up RS232 communication (see \ref
  70:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * usart_serial_options_t).
  71:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  72:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \retval true if the initialization was successful
  73:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \retval false if initialization failed (error in baud rate calculation)
  74:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  75:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** static inline bool usart_serial_init(usart_if usart, const
  76:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 		usart_serial_options_t *options)
  77:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** {
 175               		.loc 3 77 0
 176               		.cfi_startproc
 177 0062 CF93      		push r28
 178               	.LCFI10:
 179               		.cfi_def_cfa_offset 3
 180               		.cfi_offset 28, -2
 181 0064 DF93      		push r29
 182               	.LCFI11:
 183               		.cfi_def_cfa_offset 4
 184               		.cfi_offset 29, -3
 185 0066 CDB7      		in r28,__SP_L__
 186 0068 DEB7      		in r29,__SP_H__
 187               	.LCFI12:
 188               		.cfi_def_cfa_register 28
 189 006a 2B97      		sbiw r28,11
 190               	.LCFI13:
 191               		.cfi_def_cfa_offset 15
 192 006c 0FB6      		in __tmp_reg__,__SREG__
 193 006e F894      		cli
 194 0070 DEBF      		out __SP_H__,r29
 195 0072 0FBE      		out __SREG__,__tmp_reg__
 196 0074 CDBF      		out __SP_L__,r28
 197               	/* prologue: function */
 198               	/* frame size = 11 */
 199               	/* stack size = 13 */
 200               	.L__stack_usage = 13
 201 0076 9987      		std Y+9,r25
 202 0078 8887      		std Y+8,r24
 203 007a 7B87      		std Y+11,r23
 204 007c 6A87      		std Y+10,r22
  78:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	/* USART options. */
  79:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options_t usart_rs232_options;
  80:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.charlength   = options->charlength;
 205               		.loc 3 80 0
 206 007e 8A85      		ldd r24,Y+10
 207 0080 9B85      		ldd r25,Y+11
 208 0082 FC01      		movw r30,r24
 209 0084 8481      		ldd r24,Z+4
 210 0086 8D83      		std Y+5,r24
  81:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.paritytype   = options->paritytype;
 211               		.loc 3 81 0
 212 0088 8A85      		ldd r24,Y+10
 213 008a 9B85      		ldd r25,Y+11
 214 008c FC01      		movw r30,r24
 215 008e 8581      		ldd r24,Z+5
 216 0090 8E83      		std Y+6,r24
  82:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.stopbits     = options->stopbits;
 217               		.loc 3 82 0
 218 0092 8A85      		ldd r24,Y+10
 219 0094 9B85      		ldd r25,Y+11
 220 0096 FC01      		movw r30,r24
 221 0098 8681      		ldd r24,Z+6
 222 009a 8F83      		std Y+7,r24
  83:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	usart_rs232_options.baudrate     = options->baudrate;
 223               		.loc 3 83 0
 224 009c 8A85      		ldd r24,Y+10
 225 009e 9B85      		ldd r25,Y+11
 226 00a0 FC01      		movw r30,r24
 227 00a2 8081      		ld r24,Z
 228 00a4 9181      		ldd r25,Z+1
 229 00a6 A281      		ldd r26,Z+2
 230 00a8 B381      		ldd r27,Z+3
 231 00aa 8983      		std Y+1,r24
 232 00ac 9A83      		std Y+2,r25
 233 00ae AB83      		std Y+3,r26
 234 00b0 BC83      		std Y+4,r27
  84:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  85:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	if (usart_init_rs232(usart, &usart_rs232_options)) {
 235               		.loc 3 85 0
 236 00b2 8885      		ldd r24,Y+8
 237 00b4 9985      		ldd r25,Y+9
 238 00b6 9E01      		movw r18,r28
 239 00b8 2F5F      		subi r18,-1
 240 00ba 3F4F      		sbci r19,-1
 241 00bc B901      		movw r22,r18
 242 00be 0E94 0000 		call usart_init_rs232
 243 00c2 8823      		tst r24
 244 00c4 01F0      		breq .L7
  86:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 		return true;
 245               		.loc 3 86 0
 246 00c6 81E0      		ldi r24,lo8(1)
 247 00c8 00C0      		rjmp .L9
 248               	.L7:
  87:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	} else {
  88:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 		return false;
 249               		.loc 3 88 0
 250 00ca 80E0      		ldi r24,0
 251               	.L9:
 252               	/* epilogue start */
  89:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	}
  90:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** }
 253               		.loc 3 90 0 discriminator 1
 254 00cc 2B96      		adiw r28,11
 255 00ce 0FB6      		in __tmp_reg__,__SREG__
 256 00d0 F894      		cli
 257 00d2 DEBF      		out __SP_H__,r29
 258 00d4 0FBE      		out __SREG__,__tmp_reg__
 259 00d6 CDBF      		out __SP_L__,r28
 260 00d8 DF91      		pop r29
 261 00da CF91      		pop r28
 262 00dc 0895      		ret
 263               		.cfi_endproc
 264               	.LFE104:
 267               	usart_serial_putchar:
 268               	.LFB105:
  91:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
  92:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \brief Sends a character with the USART.
  93:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  94:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param usart   Base address of the USART instance.
  95:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param c       Character to write.
  96:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
  97:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \return Status code
  98:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
  99:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** static inline status_code_t usart_serial_putchar(usart_if usart, uint8_t c)
 100:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** {
 269               		.loc 3 100 0
 270               		.cfi_startproc
 271 00de CF93      		push r28
 272               	.LCFI14:
 273               		.cfi_def_cfa_offset 3
 274               		.cfi_offset 28, -2
 275 00e0 DF93      		push r29
 276               	.LCFI15:
 277               		.cfi_def_cfa_offset 4
 278               		.cfi_offset 29, -3
 279 00e2 00D0      		rcall .
 280 00e4 1F92      		push __zero_reg__
 281               	.LCFI16:
 282               		.cfi_def_cfa_offset 7
 283 00e6 CDB7      		in r28,__SP_L__
 284 00e8 DEB7      		in r29,__SP_H__
 285               	.LCFI17:
 286               		.cfi_def_cfa_register 28
 287               	/* prologue: function */
 288               	/* frame size = 3 */
 289               	/* stack size = 5 */
 290               	.L__stack_usage = 5
 291 00ea 9A83      		std Y+2,r25
 292 00ec 8983      		std Y+1,r24
 293 00ee 6B83      		std Y+3,r22
 101:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	return usart_putchar(usart, c);
 294               		.loc 3 101 0
 295 00f0 8981      		ldd r24,Y+1
 296 00f2 9A81      		ldd r25,Y+2
 297 00f4 6B81      		ldd r22,Y+3
 298 00f6 0E94 0000 		call usart_putchar
 299               	/* epilogue start */
 102:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** }
 300               		.loc 3 102 0
 301 00fa 0F90      		pop __tmp_reg__
 302 00fc 0F90      		pop __tmp_reg__
 303 00fe 0F90      		pop __tmp_reg__
 304 0100 DF91      		pop r29
 305 0102 CF91      		pop r28
 306 0104 0895      		ret
 307               		.cfi_endproc
 308               	.LFE105:
 311               	usart_serial_getchar:
 312               	.LFB106:
 103:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 
 104:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** /*! \brief Waits until a character is received, and returns it.
 105:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
 106:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param usart   Base address of the USART instance.
 107:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  * \param data   Data to read
 108:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  *
 109:../../../platform/common/services/serial/megarf_usart/usart_serial.h ****  */
 110:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** static inline void usart_serial_getchar(usart_if usart, uint8_t *data)
 111:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** {
 313               		.loc 3 111 0
 314               		.cfi_startproc
 315 0106 CF93      		push r28
 316               	.LCFI18:
 317               		.cfi_def_cfa_offset 3
 318               		.cfi_offset 28, -2
 319 0108 DF93      		push r29
 320               	.LCFI19:
 321               		.cfi_def_cfa_offset 4
 322               		.cfi_offset 29, -3
 323 010a 00D0      		rcall .
 324 010c 00D0      		rcall .
 325               	.LCFI20:
 326               		.cfi_def_cfa_offset 8
 327 010e CDB7      		in r28,__SP_L__
 328 0110 DEB7      		in r29,__SP_H__
 329               	.LCFI21:
 330               		.cfi_def_cfa_register 28
 331               	/* prologue: function */
 332               	/* frame size = 4 */
 333               	/* stack size = 6 */
 334               	.L__stack_usage = 6
 335 0112 9A83      		std Y+2,r25
 336 0114 8983      		std Y+1,r24
 337 0116 7C83      		std Y+4,r23
 338 0118 6B83      		std Y+3,r22
 112:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** 	*data = usart_getchar(usart);
 339               		.loc 3 112 0
 340 011a 8981      		ldd r24,Y+1
 341 011c 9A81      		ldd r25,Y+2
 342 011e 0E94 0000 		call usart_getchar
 343 0122 282F      		mov r18,r24
 344 0124 8B81      		ldd r24,Y+3
 345 0126 9C81      		ldd r25,Y+4
 346 0128 FC01      		movw r30,r24
 347 012a 2083      		st Z,r18
 113:../../../platform/common/services/serial/megarf_usart/usart_serial.h **** }
 348               		.loc 3 113 0
 349 012c 0000      		nop
 350               	/* epilogue start */
 351 012e 0F90      		pop __tmp_reg__
 352 0130 0F90      		pop __tmp_reg__
 353 0132 0F90      		pop __tmp_reg__
 354 0134 0F90      		pop __tmp_reg__
 355 0136 DF91      		pop r29
 356 0138 CF91      		pop r28
 357 013a 0895      		ret
 358               		.cfi_endproc
 359               	.LFE106:
 362               	stdio_serial_init:
 363               	.LFB107:
 364               		.file 4 "../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h"
   1:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** /**
   2:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
   3:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \file
   4:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
   5:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \brief Common Standard I/O Serial Management.
   6:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
   7:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * This file defines a useful set of functions for the Stdio Serial interface on AVR
   8:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * and SAM devices.
   9:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  10:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * Copyright (c) 2009-2013 Atmel Corporation. All rights reserved.
  11:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  12:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \asf_license_start
  13:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  14:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \page License
  15:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  16:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * Redistribution and use in source and binary forms, with or without
  17:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * modification, are permitted provided that the following conditions are met:
  18:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  19:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  20:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    this list of conditions and the following disclaimer.
  21:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  22:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  23:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    this list of conditions and the following disclaimer in the documentation
  24:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    and/or other materials provided with the distribution.
  25:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  26:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  27:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    from this software without specific prior written permission.
  28:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  29:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * 4. This software may only be redistributed and used in connection with an
  30:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *    Atmel microcontroller product.
  31:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  32:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  33:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  34:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  35:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  36:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  37:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  38:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  39:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  40:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  41:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  42:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * POSSIBILITY OF SUCH DAMAGE.
  43:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  44:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \asf_license_stop
  45:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  46:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  ******************************************************************************/
  47:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  48:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  49:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #ifndef _STDIO_SERIAL_H_
  50:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #define _STDIO_SERIAL_H_
  51:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  52:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** /**
  53:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \defgroup group_common_utils_stdio_stdio_serial Standard serial I/O (stdio)
  54:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \ingroup group_common_utils_stdio
  55:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  56:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * Common standard serial I/O management driver that
  57:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * implements a stdio serial interface on AVR and SAM devices.
  58:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  59:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \{
  60:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  */
  61:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  62:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #include <stdio.h>
  63:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #include "compiler.h"
  64:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #ifndef SAMD20
  65:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # include "sysclk.h"
  66:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #endif
  67:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #include "serial.h"
  68:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  69:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #if (XMEGA || MEGA_RF) && defined(__GNUC__)
  70:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	extern int _write (char c, int *f);
  71:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	extern int _read (int *f);
  72:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #endif
  73:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  74:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  75:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** //! Pointer to the base of the USART module instance to use for stdio.
  76:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** extern volatile void *volatile stdio_base;
  77:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** //! Pointer to the external low level write function.
  78:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** extern int (*ptr_put)(void volatile*, char);
  79:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  80:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** //! Pointer to the external low level read function.
  81:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** extern void (*ptr_get)(void volatile*, char*);
  82:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
  83:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** /*! \brief Initializes the stdio in Serial Mode.
  84:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  85:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \param usart       Base address of the USART instance.
  86:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  * \param opt         Options needed to set up RS232 communication (see \ref usart_options_t).
  87:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  *
  88:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h ****  */
  89:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** static inline void stdio_serial_init(volatile void *usart, const usart_serial_options_t *opt)
  90:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** {
 365               		.loc 4 90 0
 366               		.cfi_startproc
 367 013c CF93      		push r28
 368               	.LCFI22:
 369               		.cfi_def_cfa_offset 3
 370               		.cfi_offset 28, -2
 371 013e DF93      		push r29
 372               	.LCFI23:
 373               		.cfi_def_cfa_offset 4
 374               		.cfi_offset 29, -3
 375 0140 00D0      		rcall .
 376 0142 00D0      		rcall .
 377               	.LCFI24:
 378               		.cfi_def_cfa_offset 8
 379 0144 CDB7      		in r28,__SP_L__
 380 0146 DEB7      		in r29,__SP_H__
 381               	.LCFI25:
 382               		.cfi_def_cfa_register 28
 383               	/* prologue: function */
 384               	/* frame size = 4 */
 385               	/* stack size = 6 */
 386               	.L__stack_usage = 6
 387 0148 9A83      		std Y+2,r25
 388 014a 8983      		std Y+1,r24
 389 014c 7C83      		std Y+4,r23
 390 014e 6B83      		std Y+3,r22
  91:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	stdio_base = (void *)usart;
 391               		.loc 4 91 0
 392 0150 8981      		ldd r24,Y+1
 393 0152 9A81      		ldd r25,Y+2
 394 0154 9093 0000 		sts stdio_base+1,r25
 395 0158 8093 0000 		sts stdio_base,r24
  92:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	ptr_put = (int (*)(void volatile*,char))&usart_serial_putchar;
 396               		.loc 4 92 0
 397 015c 80E0      		ldi r24,lo8(gs(usart_serial_putchar))
 398 015e 90E0      		ldi r25,hi8(gs(usart_serial_putchar))
 399 0160 9093 0000 		sts ptr_put+1,r25
 400 0164 8093 0000 		sts ptr_put,r24
  93:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	ptr_get = (void (*)(void volatile*,char*))&usart_serial_getchar;
 401               		.loc 4 93 0
 402 0168 80E0      		ldi r24,lo8(gs(usart_serial_getchar))
 403 016a 90E0      		ldi r25,hi8(gs(usart_serial_getchar))
 404 016c 9093 0000 		sts ptr_get+1,r25
 405 0170 8093 0000 		sts ptr_get,r24
  94:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # if (XMEGA || MEGA_RF)
  95:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	usart_serial_init((USART_t *)usart,opt);
 406               		.loc 4 95 0
 407 0174 2B81      		ldd r18,Y+3
 408 0176 3C81      		ldd r19,Y+4
 409 0178 8981      		ldd r24,Y+1
 410 017a 9A81      		ldd r25,Y+2
 411 017c B901      		movw r22,r18
 412 017e 0E94 0000 		call usart_serial_init
  96:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # elif UC3
  97:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	usart_serial_init(usart,(usart_serial_options_t *)opt);
  98:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # elif SAM
  99:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	usart_serial_init((Usart *)usart,(usart_serial_options_t *)opt);
 100:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # else
 101:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  error Unsupported chip type
 102:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # endif
 103:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 
 104:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # if defined(__GNUC__)
 105:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  if (XMEGA || MEGA_RF)
 106:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// For AVR GCC libc print redirection uses fdevopen.
 107:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	fdevopen((int (*)(char, FILE*))(_write),(int (*)(FILE*))(_read));
 413               		.loc 4 107 0
 414 0182 60E0      		ldi r22,lo8(gs(_read))
 415 0184 70E0      		ldi r23,hi8(gs(_read))
 416 0186 80E0      		ldi r24,lo8(gs(_write))
 417 0188 90E0      		ldi r25,hi8(gs(_write))
 418 018a 0E94 0000 		call fdevopen
 108:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  endif
 109:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  if UC3 || SAM
 110:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// For AVR32 and SAM GCC
 111:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// Specify that stdout and stdin should not be buffered.
 112:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	setbuf(stdout, NULL);
 113:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	setbuf(stdin, NULL);
 114:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// Note: Already the case in IAR's Normal DLIB default configuration
 115:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// and AVR GCC library:
 116:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// - printf() emits one character at a time.
 117:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** 	// - getchar() requests only 1 byte to exit.
 118:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** #  endif
 119:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** # endif
 120:../../../platform/common/utils/stdio/stdio_serial/stdio_serial.h **** }
 419               		.loc 4 120 0
 420 018e 0000      		nop
 421               	/* epilogue start */
 422 0190 0F90      		pop __tmp_reg__
 423 0192 0F90      		pop __tmp_reg__
 424 0194 0F90      		pop __tmp_reg__
 425 0196 0F90      		pop __tmp_reg__
 426 0198 DF91      		pop r29
 427 019a CF91      		pop r28
 428 019c 0895      		ret
 429               		.cfi_endproc
 430               	.LFE107:
 433               	macsc_enable_manual_bts:
 434               	.LFB121:
 435               		.file 5 "../../../platform/mega_rf/drivers/macsc/macsc_megarf.h"
   1:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
   2:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \file
   3:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
   4:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief AVR MEGARF MAC Symbol Counter Driver Definitions
   5:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
   6:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Copyright (c) 2013 Atmel Corporation. All rights reserved.
   7:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
   8:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \asf_license_start
   9:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  10:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \page License
  11:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  12:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Redistribution and use in source and binary forms, with or without
  13:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * modification, are permitted provided that the following conditions are met:
  14:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  15:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  16:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    this list of conditions and the following disclaimer.
  17:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  18:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  19:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    this list of conditions and the following disclaimer in the documentation
  20:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    and/or other materials provided with the distribution.
  21:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  22:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  23:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    from this software without specific prior written permission.
  24:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  25:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * 4. This software may only be redistributed and used in connection with an
  26:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *    Atmel microcontroller product.
  27:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  28:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  29:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  30:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  31:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  32:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  33:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  34:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  35:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  36:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  37:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  38:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * POSSIBILITY OF SUCH DAMAGE.
  39:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  40:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \asf_license_stop
  41:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  42:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  43:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #ifndef MACSC_MEGARF_H
  44:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_MEGARF_H
  45:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  46:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #include <compiler.h>
  47:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #include <parts.h>
  48:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #include "status_codes.h"
  49:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  50:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #ifdef __cplusplus
  51:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** extern "C" {
  52:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #endif
  53:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  54:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
  55:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \defgroup macsc_group MAC Symbol Counter Driver(MACSC)
  56:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  57:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * See \ref megarf_macsc_quickstart
  58:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  59:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This is a driver for the AVR MEGARF MAC Symbol Counter Driver(MACSC).
  60:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * It provides functions for enabling, disabling and configuring the module.
  61:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  62:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \section dependencies Dependencies
  63:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This driver depends on the following modules:
  64:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * - \ref interrupt_group for ISR definition and disabling interrupts during
  65:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * critical code sections.
  66:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @{
  67:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  68:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  69:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
  70:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Interrupt event callback function type
  71:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  72:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * The interrupt handler can be configured to do a function callback,
  73:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * the callback function must match the macsc_callback_t type.
  74:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  75:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  76:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** typedef void (*macsc_callback_t)(void);
  77:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
  78:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /* ! MAC symbol counter compare Channel index */
  79:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** enum macsc_cc_channel {
  80:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! Channel 1 */
  81:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_CC1 = 1,
  82:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! Channel 2 */
  83:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_CC2 = 2,
  84:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! Channel 3 */
  85:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_CC3 = 3,
  86:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** };
  87:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
  88:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief MAC SC clock source select
  89:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  90:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * uses the SCCKSEL bit in SSCR register to select macsc clk src
  91:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
  92:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * If the bit is one,the RTC clock from TOSC1 is selected, otherwise the symbol
  93:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * counter operates with the clock from XTAL1.
  94:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * During transceiver sleep modes the clock falls back to the RTC clock source,
  95:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * regardless of the selected clock. After wakeup, it switches back to the
  96:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * previosly
  97:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * selected clock source.
  98:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
  99:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 100:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** enum macsc_xtal {
 101:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	/* ! 16MHz as macsc clock */
 102:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_16MHz = 0,
 103:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_32KHz = 1,
 104:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** };
 105:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 106:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 107:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @brief Reads the 32-bit timer register in the required order of bytes
 108:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 109:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param hh hh octet of 32-bit register
 110:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param hl hl octet of 32-bit register
 111:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param lh lh octet of 32-bit register
 112:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @param ll ll octet of 32-bit register
 113:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 114:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @returns uint32_t Value of timer register
 115:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 116:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read32(volatile uint8_t *hh,
 117:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		volatile uint8_t *hl,
 118:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		volatile uint8_t *lh,
 119:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		volatile uint8_t *ll)
 120:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 121:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	union {
 122:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		uint8_t a[4];
 123:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		uint32_t rv;
 124:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	}
 125:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x;
 126:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 127:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[0] = *ll;
 128:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[1] = *lh;
 129:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[2] = *hl;
 130:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	x.a[3] = *hh;
 131:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 132:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return x.rv;
 133:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 134:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 135:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /* ! compare modes */
 136:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_ABSOLUTE_CMP 0
 137:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_RELATIVE_CMP 1
 138:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 139:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /** String concatenation by preprocessor used to create proper register names.
 140:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  **/
 141:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define CONCAT(a, b) a ## b
 142:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 143:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /** Creates proper subregister names and reads the corresponding values. */
 144:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_READ32(reg)                  macsc_read32(&CONCAT(reg, HH), \
 145:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		&CONCAT(reg, HL), \
 146:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		&CONCAT(reg, LH), \
 147:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		&CONCAT(reg, LL))
 148:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 149:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** #define MACSC_WRITE32(reg, val)	\
 150:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	do { \
 151:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		union { uint8_t a[4]; uint32_t v; } \
 152:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		x; \
 153:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		x.v = val; \
 154:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, HH) = x.a[3]; \
 155:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, HL) = x.a[2]; \
 156:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, LH) = x.a[1]; \
 157:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		CONCAT(reg, LL) = x.a[0]; \
 158:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	} \
 159:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	while (0)
 160:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 161:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 162:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Enable MAC SC
 163:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 164:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Enables the SC
 165:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 166:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param clk_src selection of clk source,avalable options in macsc_xtal,fixed
 167:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *  prescalar
 168:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param sleep_enable enable RTC as clock source during sleep
 169:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param auto_ts enable automatic timestamping
 170:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 171:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 172:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_enable(void);
 173:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 174:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 175:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Check if MACSC is enabled
 176:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 177:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * check if the MACSC is enabled.
 178:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 179:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 180:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 181:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 182:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** bool is_macsc_enable(void);
 183:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 184:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 185:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disable MAC SC
 186:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 187:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * Disables the MAC SC
 188:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 189:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 190:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 191:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 192:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_disable(void);
 193:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 194:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 195:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Check if back-off slot counter is enabled
 196:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 197:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * check if the back-off slot counter is enabled.
 198:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 199:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 200:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 201:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 202:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** bool is_macsc_backoff_enable(void);
 203:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 204:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 205:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Enables compare interrupts of the MACSC
 206:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 207:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param channel Compare channel
 208:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 209:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_enable_cmp_int(enum macsc_cc_channel channel);
 210:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 211:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 212:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disables compare interrupts of the MACSC
 213:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 214:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param channel Compare channel
 215:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */void macsc_disable_cmp_int(enum macsc_cc_channel channel);
 216:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 217:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 218:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Usage of Absolute compare mode of the MACSC
 219:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 220:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param abs_rel  0 for absoulte cmp;1 for relative cmp
 221:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param cmp compare value for SCOCRx register
 222:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param channel Compare channel
 223:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 224:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_use_cmp(bool abs_rel, uint32_t cmp,enum macsc_cc_channel channel);
 225:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 226:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 227:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \ingroup macsc_group
 228:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \defgroup macsc_interrupt_group MAC Symbol Counter (MACSC) interrupt
 229:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * management
 230:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This group provides functions to configure MACSC module interrupts
 231:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 232:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * @{
 233:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 234:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 235:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 236:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC overflow interrupt callback function
 237:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 238:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 239:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 240:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 241:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 242:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 243:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 244:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_ovf_int_cb(macsc_callback_t callback);
 245:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 246:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 247:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC Compare Channel 1 interrupt callback function
 248:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 249:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 250:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 251:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 252:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 253:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 254:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 255:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_cmp1_int_cb(macsc_callback_t callback);
 256:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 257:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 258:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC Compare Channel 2 interrupt callback function
 259:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 260:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 261:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 262:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 263:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 264:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 265:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 266:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_cmp2_int_cb(macsc_callback_t callback);
 267:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 268:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 269:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC Compare Channel 3 interrupt callback function
 270:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 271:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 272:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 273:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 274:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 275:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 276:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 277:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_cmp3_int_cb(macsc_callback_t callback);
 278:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 279:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 280:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Set MACSC backoff slot counter interrupt callback function
 281:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 282:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * This function allows the caller to set and change the interrupt callback
 283:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * function. Without setting a callback function the interrupt handler in the
 284:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * driver will only clear the interrupt flags.
 285:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 286:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param callback Reference to a callback function
 287:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 288:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** void macsc_set_backoff_slot_cntr_int_cb(macsc_callback_t callback);
 289:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** //@}
 290:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 291:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 292:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Enable 32.768KHz clk using timer 2 async register
 293:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 294:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 295:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 296:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 297:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_sleep_clk_enable(void)
 298:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 299:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	ASSR |= (1 << AS2);
 300:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 301:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 302:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 303:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disable 32.768KHz clk using timer 2 async register
 304:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 305:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 306:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 307:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_sleep_clk_disable(void)
 308:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 309:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	ASSR &= ~(1 << AS2);
 310:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 311:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 312:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /* @} */
 313:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 314:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 315:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Configure MAC Symbol Counter Clock Source
 316:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 317:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param macsc macsc clk src
 318:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 319:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_write_clock_source(enum macsc_xtal source)
 320:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 321:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	if (source == MACSC_16MHz) {
 322:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCCR0 |= (source << SCCKSEL);
 323:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	} else if (source == MACSC_32KHz) {
 324:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCCR0 &= ~(1 << SCCKSEL);
 325:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	}
 326:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 327:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 328:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 329:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Read MAC SC Clock Source
 330:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 331:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 332:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return macsc_xtal enum Clock source selection
 333:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 334:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline enum macsc_xtal macsc_read_clock_source(void)
 335:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 336:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (enum macsc_xtal)(SCCR0 & (1 << SCCKSEL));
 337:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 338:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 339:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 340:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Write the Counter value of the MAC Symbol counter
 341:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 342:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param cnt_value Counter value
 343:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 344:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_write_count(uint32_t cnt_value)
 345:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 346:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	MACSC_WRITE32(SCCNT, cnt_value);
 347:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 348:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 349:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 350:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Reads the Counter value of the MAC Symbol counter
 351:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 352:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note Output the Counter value
 353:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 354:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read_count(void)
 355:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 356:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (MACSC_READ32(SCCNT));
 357:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 358:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 359:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 360:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief enable back-off slot counter
 361:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 362:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 363:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note  Enables interrupt as well	.
 364:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note This counter works only if transceiver clock is running.So check Trx
 365:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * state in app before using this function in IEEE802.15.4 applications.
 366:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 367:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline bool macsc_backoff_slot_cnt_enable(void)
 368:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 369:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	if (!(PRR1 & (1 << PRTRX24))) {
 370:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCCR1 = (1 << SCENBO);
 371:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCIRQS |= (1 << IRQSBO);
 372:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		SCIRQM |= (1 << IRQMBO);
 373:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 		return true;
 374:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	}
 375:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	else return false;
 376:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 377:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 378:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 379:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Disable back-off slot counter
 380:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 381:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \param none
 382:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note    Disables interrupt as well	.
 383:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note This counter works only if transceiver clock is running.So check Trx
 384:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * state in app before using this function in IEEE802.15.4 applications.
 385:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 386:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_backoff_slot_cnt_disable(void)
 387:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 388:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCCR1 &= ~(1 << SCENBO);
 389:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCIRQM &= ~(1 << IRQMBO);
 390:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 391:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 392:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 393:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Tests if the Backoff slot cntr interrupt flag is set
 394:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 395:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return  backoff slot cntr interrupt has occurred or not : IRQSBO
 396:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 397:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline bool macsc_is_slot_cntr_interrupt_flag_set(void)
 398:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 399:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (SCIRQS & (1 << IRQSBO));
 400:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 401:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 402:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 403:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Clears the Backoff Slot cntr interrupt flag
 404:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 405:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \note  IRQSBO is cleared
 406:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 407:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_clear_slot_cntr_interrupt_flag(void)
 408:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 409:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCIRQS |= (1 << IRQSBO);
 410:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 411:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 412:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 413:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Reads the SFD Timestamp register
 414:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 415:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return Timestamp of last received frame :SCTSR(read-only register)
 416:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 417:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read_ts(void)
 418:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 419:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (MACSC_READ32(SCTSR));
 420:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 421:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 422:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 423:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Reads the Beacon Timestamp register
 424:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 425:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \return Timestamp of last received beacon frame :SCBTSR
 426:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 427:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline uint32_t macsc_read_bts(void)
 428:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 429:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	return (MACSC_READ32(SCBTSR));
 430:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 431:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 
 432:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** /**
 433:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * \brief Write the Beacon Timestamp register of the MAC Symbol counter
 434:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * The manual beacon timestamping can be used in conjunction with the
 435:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * relative compare mode of the three compare units to generate compare match
 436:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * interrupts without having a beacon frame received
 437:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 438:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * If set to 1, the current symbol counter value is stored into the beacon
 439:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * timestamp register.
 440:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  * The bit is cleared afterwards.
 441:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  *
 442:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h ****  */
 443:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** static inline void macsc_enable_manual_bts(void)
 444:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** {
 436               		.loc 5 444 0
 437               		.cfi_startproc
 438 019e CF93      		push r28
 439               	.LCFI26:
 440               		.cfi_def_cfa_offset 3
 441               		.cfi_offset 28, -2
 442 01a0 DF93      		push r29
 443               	.LCFI27:
 444               		.cfi_def_cfa_offset 4
 445               		.cfi_offset 29, -3
 446 01a2 CDB7      		in r28,__SP_L__
 447 01a4 DEB7      		in r29,__SP_H__
 448               	.LCFI28:
 449               		.cfi_def_cfa_register 28
 450               	/* prologue: function */
 451               	/* frame size = 0 */
 452               	/* stack size = 2 */
 453               	.L__stack_usage = 2
 445:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCCR0 |= (1 << SCMBTS);
 454               		.loc 5 445 0
 455 01a6 8CED      		ldi r24,lo8(-36)
 456 01a8 90E0      		ldi r25,0
 457 01aa 2CED      		ldi r18,lo8(-36)
 458 01ac 30E0      		ldi r19,0
 459 01ae F901      		movw r30,r18
 460 01b0 2081      		ld r18,Z
 461 01b2 2064      		ori r18,lo8(64)
 462 01b4 FC01      		movw r30,r24
 463 01b6 2083      		st Z,r18
 446:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** 	SCCR0 &= ~(1 << SCTSE);
 464               		.loc 5 446 0
 465 01b8 8CED      		ldi r24,lo8(-36)
 466 01ba 90E0      		ldi r25,0
 467 01bc 2CED      		ldi r18,lo8(-36)
 468 01be 30E0      		ldi r19,0
 469 01c0 F901      		movw r30,r18
 470 01c2 2081      		ld r18,Z
 471 01c4 277F      		andi r18,lo8(-9)
 472 01c6 FC01      		movw r30,r24
 473 01c8 2083      		st Z,r18
 447:../../../platform/mega_rf/drivers/macsc/macsc_megarf.h **** }
 474               		.loc 5 447 0
 475 01ca 0000      		nop
 476               	/* epilogue start */
 477 01cc DF91      		pop r29
 478 01ce CF91      		pop r28
 479 01d0 0895      		ret
 480               		.cfi_endproc
 481               	.LFE121:
 483               	.global	appState
 484               		.section	.bss.appState,"aw",@nobits
 487               	appState:
 488 0000 00        		.zero	1
 489               		.section	.bss.msgReq,"aw",@nobits
 492               	msgReq:
 493 0000 0000 0000 		.zero	20
 493      0000 0000 
 493      0000 0000 
 493      0000 0000 
 493      0000 0000 
 494               		.section	.bss.PanId,"aw",@nobits
 497               	PanId:
 498 0000 00        		.zero	1
 499               		.section	.rodata
 500               	.LC1:
 501 0000 0A4D 5347 		.string	"\nMSG REQ SENT %d"
 501      2052 4551 
 501      2053 454E 
 501      5420 2564 
 501      00
 502               		.text
 503               	.global	appSendData
 505               	appSendData:
 506               	.LFB130:
 507               		.file 6 "ServerLLDN.c"
   1:ServerLLDN.c  **** /*
   2:ServerLLDN.c  **** 	* ServerLLDN.c
   3:ServerLLDN.c  **** 	*
   4:ServerLLDN.c  **** 	* Created: 10/18/2019 5:15:37 PM
   5:ServerLLDN.c  **** 	*  Author: guilherme
   6:ServerLLDN.c  **** 	*/ 
   7:ServerLLDN.c  **** 
   8:ServerLLDN.c  **** #include <stdlib.h>
   9:ServerLLDN.c  **** #include <stdio.h>
  10:ServerLLDN.c  **** #include <string.h>
  11:ServerLLDN.c  **** #include <inttypes.h>
  12:ServerLLDN.c  **** #include "config.h"
  13:ServerLLDN.c  **** #include "sys.h"
  14:ServerLLDN.c  **** #include "phy.h"
  15:ServerLLDN.c  **** #include "sys.h"
  16:ServerLLDN.c  **** #include "nwk.h"
  17:ServerLLDN.c  **** #include "sysclk.h"
  18:ServerLLDN.c  **** #include "sysTimer.h"
  19:ServerLLDN.c  **** #include "sleep_mgr.h"
  20:ServerLLDN.c  **** #include "sleepmgr.h"
  21:ServerLLDN.c  **** #include "led.h"
  22:ServerLLDN.c  **** #include "ioport.h"
  23:ServerLLDN.c  **** #include "conf_sleepmgr.h"
  24:ServerLLDN.c  **** #include "board.h"
  25:ServerLLDN.c  **** #include "platform.h"
  26:ServerLLDN.c  **** 
  27:ServerLLDN.c  **** #include "lldn.h"
  28:ServerLLDN.c  **** 
  29:ServerLLDN.c  **** #if 1
  30:ServerLLDN.c  **** #if (SIO2HOST_CHANNEL == SIO_USB)
  31:ServerLLDN.c  **** /* Only ARM */
  32:ServerLLDN.c  **** #include "hw_timer_lldn.h"
  33:ServerLLDN.c  **** #include "stdio_usb.h"
  34:ServerLLDN.c  **** #define MASTER_MACSC	0
  35:ServerLLDN.c  **** #else
  36:ServerLLDN.c  **** /* Only megarf series */
  37:ServerLLDN.c  **** #include "conf_sio2host.h"
  38:ServerLLDN.c  **** #define MASTER_MACSC	1
  39:ServerLLDN.c  **** #endif
  40:ServerLLDN.c  **** #else
  41:ServerLLDN.c  **** /* Only megarf series */
  42:ServerLLDN.c  **** #define MASTER_MACSC		1
  43:ServerLLDN.c  **** #endif
  44:ServerLLDN.c  **** 
  45:ServerLLDN.c  **** #define HUMAM_READABLE			1
  46:ServerLLDN.c  **** 
  47:ServerLLDN.c  **** #if (MASTER_MACSC == 1)
  48:ServerLLDN.c  **** #include "macsc_megarf.h"
  49:ServerLLDN.c  **** #define TIMESLOT_TIMER 1
  50:ServerLLDN.c  **** #else
  51:ServerLLDN.c  **** static SYS_Timer_t				tmrBeaconInterval;			// Beacon
  52:ServerLLDN.c  **** static SYS_Timer_t				tmrComputeData;				// Compute data
  53:ServerLLDN.c  **** #endif
  54:ServerLLDN.c  **** 
  55:ServerLLDN.c  **** #define PRINT 1
  56:ServerLLDN.c  **** 
  57:ServerLLDN.c  **** 	
  58:ServerLLDN.c  **** // equation for tTS gives time in seconds, the division by SYMBOL_TIME changes to symbols for count
  59:ServerLLDN.c  **** AppState_t	appState = APP_STATE_INITIAL;
  60:ServerLLDN.c  **** static NWK_DataReq_t msgReq;
  61:ServerLLDN.c  **** static uint8_t PanId;
  62:ServerLLDN.c  **** 
  63:ServerLLDN.c  ****  void appSendData(void)
  64:ServerLLDN.c  **** {
 508               		.loc 6 64 0
 509               		.cfi_startproc
 510 01d2 CF93      		push r28
 511               	.LCFI29:
 512               		.cfi_def_cfa_offset 3
 513               		.cfi_offset 28, -2
 514 01d4 DF93      		push r29
 515               	.LCFI30:
 516               		.cfi_def_cfa_offset 4
 517               		.cfi_offset 29, -3
 518 01d6 CDB7      		in r28,__SP_L__
 519 01d8 DEB7      		in r29,__SP_H__
 520               	.LCFI31:
 521               		.cfi_def_cfa_register 28
 522               	/* prologue: function */
 523               	/* frame size = 0 */
 524               	/* stack size = 2 */
 525               	.L__stack_usage = 2
  65:ServerLLDN.c  **** 	if(msgReq.options != 0)
 526               		.loc 6 65 0
 527 01da 8091 0000 		lds r24,msgReq+9
 528 01de 9091 0000 		lds r25,msgReq+9+1
 529 01e2 892B      		or r24,r25
 530 01e4 01F0      		breq .L17
  66:ServerLLDN.c  **** 	{
  67:ServerLLDN.c  **** 		printf("\nMSG REQ SENT %d",msgReq.options);
 531               		.loc 6 67 0
 532 01e6 8091 0000 		lds r24,msgReq+9
 533 01ea 9091 0000 		lds r25,msgReq+9+1
 534 01ee 292F      		mov r18,r25
 535 01f0 2F93      		push r18
 536 01f2 8F93      		push r24
 537 01f4 80E0      		ldi r24,lo8(.LC1)
 538 01f6 90E0      		ldi r25,hi8(.LC1)
 539 01f8 892F      		mov r24,r25
 540 01fa 8F93      		push r24
 541 01fc 80E0      		ldi r24,lo8(.LC1)
 542 01fe 90E0      		ldi r25,hi8(.LC1)
 543 0200 8F93      		push r24
 544 0202 0E94 0000 		call printf
 545 0206 0F90      		pop __tmp_reg__
 546 0208 0F90      		pop __tmp_reg__
 547 020a 0F90      		pop __tmp_reg__
 548 020c 0F90      		pop __tmp_reg__
  68:ServerLLDN.c  **** 		NWK_DataReq(&msgReq);
 549               		.loc 6 68 0
 550 020e 80E0      		ldi r24,lo8(msgReq)
 551 0210 90E0      		ldi r25,hi8(msgReq)
 552 0212 0E94 0000 		call NWK_DataReq
 553               	.L17:
  69:ServerLLDN.c  **** 	#if !APP_COORDINATOR
  70:ServerLLDN.c  **** 	#endif
  71:ServerLLDN.c  **** 	}
  72:ServerLLDN.c  **** }
 554               		.loc 6 72 0
 555 0216 0000      		nop
 556               	/* epilogue start */
 557 0218 DF91      		pop r29
 558 021a CF91      		pop r28
 559 021c 0895      		ret
 560               		.cfi_endproc
 561               	.LFE130:
 563               	.global	appPanState
 564               		.section	.data.appPanState,"aw",@progbits
 567               	appPanState:
 568 0000 01        		.byte	1
 569               		.comm	nodes_info_arr,1016,1
 570               	.global	config_request_frame
 571               		.section	.data.config_request_frame,"aw",@progbits
 574               	config_request_frame:
 575 0000 0F        		.byte	15
 576 0001 00        		.byte	0
 577 0002 0F        		.byte	15
 578 0003 0000      		.zero	2
 579 0005 80        		.byte	128
 580               	.global	conf_req_list
 581               		.section	.bss.conf_req_list,"aw",@nobits
 584               	conf_req_list:
 585 0000 0000      		.zero	2
 586               		.comm	conf_req_arr,508,1
 587               	.global	conf_req_index
 588               		.section	.bss.conf_req_index,"aw",@nobits
 591               	conf_req_index:
 592 0000 0000      		.zero	2
 593               		.comm	ACKFrame,33,1
 594               	.global	ACKFrame_size
 595               		.section	.bss.ACKFrame_size,"aw",@nobits
 598               	ACKFrame_size:
 599 0000 0000      		.zero	2
 600               	.global	beaconInterval
 601               		.section	.bss.beaconInterval,"aw",@nobits
 604               	beaconInterval:
 605 0000 0000 0000 		.zero	4
 606               	.global	macLLDNnumUplinkTS
 607               		.section	.bss.macLLDNnumUplinkTS,"aw",@nobits
 610               	macLLDNnumUplinkTS:
 611 0000 0000      		.zero	2
 612               		.section	.bss.tmrDelay,"aw",@nobits
 615               	tmrDelay:
 616 0000 0000 0000 		.zero	13
 616      0000 0000 
 616      0000 0000 
 616      00
 617               	.global	counter_associados
 618               		.section	.bss.counter_associados,"aw",@nobits
 621               	counter_associados:
 622 0000 0000      		.zero	2
 623               	.global	cycles_counter
 624               		.section	.data.cycles_counter,"aw",@progbits
 627               	cycles_counter:
 628 0000 01        		.byte	1
 629               		.text
 631               	tmrDelayHandler:
 632               	.LFB131:
  73:ServerLLDN.c  **** 
  74:ServerLLDN.c  **** #if APP_COORDINATOR
  75:ServerLLDN.c  **** 
  76:ServerLLDN.c  **** 	#define NODOS_ASSOCIADOS_ESPERADOS 12
  77:ServerLLDN.c  **** 	
  78:ServerLLDN.c  **** 	AppPanState_t appPanState = APP_PAN_STATE_RESET; // Initial state of PAN node
  79:ServerLLDN.c  **** 	
  80:ServerLLDN.c  **** 	/* Configuration Request Frames */
  81:ServerLLDN.c  **** 	/* Da pra mudar o envio do confrequest pra ja usar essa array com as informas dos nodos */	
  82:ServerLLDN.c  **** 	nodes_info_t nodes_info_arr[254]; // Array for Configure Request messages, one position per node, 
  83:ServerLLDN.c  **** 	NWK_ConfigRequest_t config_request_frame = { .id = LL_CONFIGURATION_REQUEST,
  84:ServerLLDN.c  **** 												 .s_macAddr = APP_ADDR,
  85:ServerLLDN.c  **** 												 .tx_channel = APP_CHANNEL,
  86:ServerLLDN.c  **** 												 .conf.macLLDNmgmtTS = MacLLDNMgmtTS };
  87:ServerLLDN.c  **** 	nodes_info_list_t *conf_req_list = NULL;
  88:ServerLLDN.c  **** 	int conf_req_arr[254];
  89:ServerLLDN.c  **** 	int conf_req_index = 0;
  90:ServerLLDN.c  **** 	/* Acknowledge Frame and Array */
  91:ServerLLDN.c  **** 	NWK_ACKFormat_t ACKFrame;	// ACK Frame Payload used in Discovery State
  92:ServerLLDN.c  **** 	int ACKFrame_size = 0;
  93:ServerLLDN.c  **** 
  94:ServerLLDN.c  **** 	float beaconInterval = 0; // no precisa ser global
  95:ServerLLDN.c  **** 	
  96:ServerLLDN.c  **** 	int macLLDNnumUplinkTS = 0;		// Number of uplink timeslots, is also the control of associated node
  97:ServerLLDN.c  **** 	
  98:ServerLLDN.c  **** 	/* This timer implements a delay between messages, 
  99:ServerLLDN.c  **** 	 * if not used the nodes are not able to receive the message
 100:ServerLLDN.c  **** 	 */
 101:ServerLLDN.c  **** 	static SYS_Timer_t tmrDelay;	
 102:ServerLLDN.c  **** 	
 103:ServerLLDN.c  **** 	/*  Control variables for testing */	
 104:ServerLLDN.c  **** 	int counter_associados = 0;		// Associated nodes counter
 105:ServerLLDN.c  **** 	uint8_t cycles_counter = macLLDNdiscoveryModeTimeout;
 106:ServerLLDN.c  **** 
 107:ServerLLDN.c  **** 	
 108:ServerLLDN.c  **** 	static void tmrDelayHandler(SYS_Timer_t *timer)
 109:ServerLLDN.c  **** 	{
 633               		.loc 6 109 0
 634               		.cfi_startproc
 635 021e CF93      		push r28
 636               	.LCFI32:
 637               		.cfi_def_cfa_offset 3
 638               		.cfi_offset 28, -2
 639 0220 DF93      		push r29
 640               	.LCFI33:
 641               		.cfi_def_cfa_offset 4
 642               		.cfi_offset 29, -3
 643 0222 00D0      		rcall .
 644               	.LCFI34:
 645               		.cfi_def_cfa_offset 6
 646 0224 CDB7      		in r28,__SP_L__
 647 0226 DEB7      		in r29,__SP_H__
 648               	.LCFI35:
 649               		.cfi_def_cfa_register 28
 650               	/* prologue: function */
 651               	/* frame size = 2 */
 652               	/* stack size = 4 */
 653               	.L__stack_usage = 4
 654 0228 9A83      		std Y+2,r25
 655 022a 8983      		std Y+1,r24
 110:ServerLLDN.c  **** 		appState = APP_STATE_SEND;
 656               		.loc 6 110 0
 657 022c 82E0      		ldi r24,lo8(2)
 658 022e 8093 0000 		sts appState,r24
 111:ServerLLDN.c  **** 	}
 659               		.loc 6 111 0
 660 0232 0000      		nop
 661               	/* epilogue start */
 662 0234 0F90      		pop __tmp_reg__
 663 0236 0F90      		pop __tmp_reg__
 664 0238 DF91      		pop r29
 665 023a CF91      		pop r28
 666 023c 0895      		ret
 667               		.cfi_endproc
 668               	.LFE131:
 671               	lldn_server_beacon:
 672               	.LFB132:
 112:ServerLLDN.c  **** 	
 113:ServerLLDN.c  **** 	static void lldn_server_beacon(void)
 114:ServerLLDN.c  **** 	{
 673               		.loc 6 114 0
 674               		.cfi_startproc
 675 023e CF93      		push r28
 676               	.LCFI36:
 677               		.cfi_def_cfa_offset 3
 678               		.cfi_offset 28, -2
 679 0240 DF93      		push r29
 680               	.LCFI37:
 681               		.cfi_def_cfa_offset 4
 682               		.cfi_offset 29, -3
 683 0242 CDB7      		in r28,__SP_L__
 684 0244 DEB7      		in r29,__SP_H__
 685               	.LCFI38:
 686               		.cfi_def_cfa_register 28
 687               	/* prologue: function */
 688               	/* frame size = 0 */
 689               	/* stack size = 2 */
 690               	.L__stack_usage = 2
 115:ServerLLDN.c  **** 		macsc_enable_manual_bts();
 691               		.loc 6 115 0
 692 0246 0E94 0000 		call macsc_enable_manual_bts
 116:ServerLLDN.c  **** 		appState = APP_STATE_SEND;
 693               		.loc 6 116 0
 694 024a 82E0      		ldi r24,lo8(2)
 695 024c 8093 0000 		sts appState,r24
 117:ServerLLDN.c  **** 	}
 696               		.loc 6 117 0
 697 0250 0000      		nop
 698               	/* epilogue start */
 699 0252 DF91      		pop r29
 700 0254 CF91      		pop r28
 701 0256 0895      		ret
 702               		.cfi_endproc
 703               	.LFE132:
 706               	downlink_delay_handler:
 707               	.LFB133:
 118:ServerLLDN.c  **** 	
 119:ServerLLDN.c  **** 	static void downlink_delay_handler(void)
 120:ServerLLDN.c  **** 	{
 708               		.loc 6 120 0
 709               		.cfi_startproc
 710 0258 CF93      		push r28
 711               	.LCFI39:
 712               		.cfi_def_cfa_offset 3
 713               		.cfi_offset 28, -2
 714 025a DF93      		push r29
 715               	.LCFI40:
 716               		.cfi_def_cfa_offset 4
 717               		.cfi_offset 29, -3
 718 025c CDB7      		in r28,__SP_L__
 719 025e DEB7      		in r29,__SP_H__
 720               	.LCFI41:
 721               		.cfi_def_cfa_register 28
 722               	/* prologue: function */
 723               	/* frame size = 0 */
 724               	/* stack size = 2 */
 725               	.L__stack_usage = 2
 121:ServerLLDN.c  **** 		if(msgReq.options == NWK_OPT_LLDN_ACK)
 726               		.loc 6 121 0
 727 0260 8091 0000 		lds r24,msgReq+9
 728 0264 9091 0000 		lds r25,msgReq+9+1
 729 0268 8115      		cp r24,__zero_reg__
 730 026a 9044      		sbci r25,64
 731 026c 01F4      		brne .L22
 122:ServerLLDN.c  **** 		{
 123:ServerLLDN.c  **** 		appState = APP_STATE_SEND;
 732               		.loc 6 123 0
 733 026e 82E0      		ldi r24,lo8(2)
 734 0270 8093 0000 		sts appState,r24
 735               	.L22:
 124:ServerLLDN.c  **** 		}
 125:ServerLLDN.c  **** 	}
 736               		.loc 6 125 0
 737 0274 0000      		nop
 738               	/* epilogue start */
 739 0276 DF91      		pop r29
 740 0278 CF91      		pop r28
 741 027a 0895      		ret
 742               		.cfi_endproc
 743               	.LFE133:
 746               	end_of_online_handler:
 747               	.LFB134:
 126:ServerLLDN.c  **** 
 127:ServerLLDN.c  **** 	static void end_of_online_handler(void)
 128:ServerLLDN.c  **** 	{
 748               		.loc 6 128 0
 749               		.cfi_startproc
 750 027c CF93      		push r28
 751               	.LCFI42:
 752               		.cfi_def_cfa_offset 3
 753               		.cfi_offset 28, -2
 754 027e DF93      		push r29
 755               	.LCFI43:
 756               		.cfi_def_cfa_offset 4
 757               		.cfi_offset 29, -3
 758 0280 CDB7      		in r28,__SP_L__
 759 0282 DEB7      		in r29,__SP_H__
 760               	.LCFI44:
 761               		.cfi_def_cfa_register 28
 762               	/* prologue: function */
 763               	/* frame size = 0 */
 764               	/* stack size = 2 */
 765               	.L__stack_usage = 2
 129:ServerLLDN.c  **** 		appState = APP_STATE_ATT_PAN_STATE;
 766               		.loc 6 129 0
 767 0284 83E0      		ldi r24,lo8(3)
 768 0286 8093 0000 		sts appState,r24
 130:ServerLLDN.c  **** 		appPanState = APP_PAN_STATE_ONLINE_END_BE;
 769               		.loc 6 130 0
 770 028a 8AE0      		ldi r24,lo8(10)
 771 028c 8093 0000 		sts appPanState,r24
 131:ServerLLDN.c  **** 	}
 772               		.loc 6 131 0
 773 0290 0000      		nop
 774               	/* epilogue start */
 775 0292 DF91      		pop r29
 776 0294 CF91      		pop r28
 777 0296 0895      		ret
 778               		.cfi_endproc
 779               	.LFE134:
 781               		.section	.rodata
 782               	.LC2:
 783 0011 0A2A 2A2A 		.string	"\n***TIMESLOT****"
 783      5449 4D45 
 783      534C 4F54 
 783      2A2A 2A2A 
 783      00
 784               		.text
 786               	teste_handler:
 787               	.LFB135:
 132:ServerLLDN.c  **** 	
 133:ServerLLDN.c  **** 	#if TIMESLOT_TIMER
 134:ServerLLDN.c  **** 	static void teste_handler(void)
 135:ServerLLDN.c  **** 	{
 788               		.loc 6 135 0
 789               		.cfi_startproc
 790 0298 CF93      		push r28
 791               	.LCFI45:
 792               		.cfi_def_cfa_offset 3
 793               		.cfi_offset 28, -2
 794 029a DF93      		push r29
 795               	.LCFI46:
 796               		.cfi_def_cfa_offset 4
 797               		.cfi_offset 29, -3
 798 029c CDB7      		in r28,__SP_L__
 799 029e DEB7      		in r29,__SP_H__
 800               	.LCFI47:
 801               		.cfi_def_cfa_register 28
 802               	/* prologue: function */
 803               	/* frame size = 0 */
 804               	/* stack size = 2 */
 805               	.L__stack_usage = 2
 136:ServerLLDN.c  **** 		if(msgReq.options)
 806               		.loc 6 136 0
 807 02a0 8091 0000 		lds r24,msgReq+9
 808 02a4 9091 0000 		lds r25,msgReq+9+1
 809 02a8 892B      		or r24,r25
 810 02aa 01F0      		breq .L25
 137:ServerLLDN.c  **** 			printf("\n***TIMESLOT****");
 811               		.loc 6 137 0
 812 02ac 80E0      		ldi r24,lo8(.LC2)
 813 02ae 90E0      		ldi r25,hi8(.LC2)
 814 02b0 892F      		mov r24,r25
 815 02b2 8F93      		push r24
 816 02b4 80E0      		ldi r24,lo8(.LC2)
 817 02b6 90E0      		ldi r25,hi8(.LC2)
 818 02b8 8F93      		push r24
 819 02ba 0E94 0000 		call printf
 820 02be 0F90      		pop __tmp_reg__
 821 02c0 0F90      		pop __tmp_reg__
 822               	.L25:
 138:ServerLLDN.c  **** 		macsc_disable_cmp_int(MACSC_CC3);
 823               		.loc 6 138 0
 824 02c2 83E0      		ldi r24,lo8(3)
 825 02c4 0E94 0000 		call macsc_disable_cmp_int
 139:ServerLLDN.c  **** 	}
 826               		.loc 6 139 0
 827 02c8 0000      		nop
 828               	/* epilogue start */
 829 02ca DF91      		pop r29
 830 02cc CF91      		pop r28
 831 02ce 0895      		ret
 832               		.cfi_endproc
 833               	.LFE135:
 835               		.section	.rodata
 836               	.LC3:
 837 0022 0A41 6464 		.string	"\nAddr rep %d"
 837      7220 7265 
 837      7020 2564 
 837      00
 838               		.text
 840               	addToAckArray:
 841               	.LFB136:
 140:ServerLLDN.c  **** 	#endif
 141:ServerLLDN.c  **** 	
 142:ServerLLDN.c  **** 	static bool addToAckArray(uint8_t addres)
 143:ServerLLDN.c  **** 	{	
 842               		.loc 6 143 0
 843               		.cfi_startproc
 844 02d0 CF93      		push r28
 845               	.LCFI48:
 846               		.cfi_def_cfa_offset 3
 847               		.cfi_offset 28, -2
 848 02d2 DF93      		push r29
 849               	.LCFI49:
 850               		.cfi_def_cfa_offset 4
 851               		.cfi_offset 29, -3
 852 02d4 00D0      		rcall .
 853 02d6 00D0      		rcall .
 854 02d8 1F92      		push __zero_reg__
 855               	.LCFI50:
 856               		.cfi_def_cfa_offset 9
 857 02da CDB7      		in r28,__SP_L__
 858 02dc DEB7      		in r29,__SP_H__
 859               	.LCFI51:
 860               		.cfi_def_cfa_register 28
 861               	/* prologue: function */
 862               	/* frame size = 5 */
 863               	/* stack size = 7 */
 864               	.L__stack_usage = 7
 865 02de 8D83      		std Y+5,r24
 144:ServerLLDN.c  **** 		int pos =(int) addres / 8;
 866               		.loc 6 144 0
 867 02e0 8D81      		ldd r24,Y+5
 868 02e2 8695      		lsr r24
 869 02e4 8695      		lsr r24
 870 02e6 8695      		lsr r24
 871 02e8 882F      		mov r24,r24
 872 02ea 90E0      		ldi r25,0
 873 02ec 9A83      		std Y+2,r25
 874 02ee 8983      		std Y+1,r24
 145:ServerLLDN.c  **** 		int bit_shift = 8 - (addres % 8);
 875               		.loc 6 145 0
 876 02f0 8D81      		ldd r24,Y+5
 877 02f2 882F      		mov r24,r24
 878 02f4 90E0      		ldi r25,0
 879 02f6 8770      		andi r24,7
 880 02f8 9927      		clr r25
 881 02fa 28E0      		ldi r18,lo8(8)
 882 02fc 30E0      		ldi r19,0
 883 02fe A901      		movw r20,r18
 884 0300 481B      		sub r20,r24
 885 0302 590B      		sbc r21,r25
 886 0304 CA01      		movw r24,r20
 887 0306 9C83      		std Y+4,r25
 888 0308 8B83      		std Y+3,r24
 146:ServerLLDN.c  **** 		
 147:ServerLLDN.c  **** 		if(ACKFrame.ackFlags[pos] & 1 << bit_shift)
 889               		.loc 6 147 0
 890 030a 8981      		ldd r24,Y+1
 891 030c 9A81      		ldd r25,Y+2
 892 030e 8050      		subi r24,lo8(-(ACKFrame+1))
 893 0310 9040      		sbci r25,hi8(-(ACKFrame+1))
 894 0312 FC01      		movw r30,r24
 895 0314 8081      		ld r24,Z
 896 0316 882F      		mov r24,r24
 897 0318 90E0      		ldi r25,0
 898 031a 0B80      		ldd r0,Y+3
 899 031c 00C0      		rjmp 2f
 900               		1:
 901 031e 9595      		asr r25
 902 0320 8795      		ror r24
 903               		2:
 904 0322 0A94      		dec r0
 905 0324 02F4      		brpl 1b
 906 0326 8170      		andi r24,1
 907 0328 9927      		clr r25
 908 032a 892B      		or r24,r25
 909 032c 01F0      		breq .L27
 148:ServerLLDN.c  **** 		{
 149:ServerLLDN.c  **** 			printf("\nAddr rep %d", addres);
 910               		.loc 6 149 0
 911 032e 8D81      		ldd r24,Y+5
 912 0330 882F      		mov r24,r24
 913 0332 90E0      		ldi r25,0
 914 0334 292F      		mov r18,r25
 915 0336 2F93      		push r18
 916 0338 8F93      		push r24
 917 033a 80E0      		ldi r24,lo8(.LC3)
 918 033c 90E0      		ldi r25,hi8(.LC3)
 919 033e 892F      		mov r24,r25
 920 0340 8F93      		push r24
 921 0342 80E0      		ldi r24,lo8(.LC3)
 922 0344 90E0      		ldi r25,hi8(.LC3)
 923 0346 8F93      		push r24
 924 0348 0E94 0000 		call printf
 925 034c 0F90      		pop __tmp_reg__
 926 034e 0F90      		pop __tmp_reg__
 927 0350 0F90      		pop __tmp_reg__
 928 0352 0F90      		pop __tmp_reg__
 150:ServerLLDN.c  **** 			return false;
 929               		.loc 6 150 0
 930 0354 80E0      		ldi r24,0
 931 0356 00C0      		rjmp .L28
 932               	.L27:
 151:ServerLLDN.c  **** 		}
 152:ServerLLDN.c  **** 		ACKFrame.ackFlags[pos] = 1 << bit_shift;
 933               		.loc 6 152 0
 934 0358 81E0      		ldi r24,lo8(1)
 935 035a 90E0      		ldi r25,0
 936 035c 0B80      		ldd r0,Y+3
 937 035e 00C0      		rjmp 2f
 938               		1:
 939 0360 880F      		lsl r24
 940 0362 991F      		rol r25
 941               		2:
 942 0364 0A94      		dec r0
 943 0366 02F4      		brpl 1b
 944 0368 282F      		mov r18,r24
 945 036a 8981      		ldd r24,Y+1
 946 036c 9A81      		ldd r25,Y+2
 947 036e 8050      		subi r24,lo8(-(ACKFrame+1))
 948 0370 9040      		sbci r25,hi8(-(ACKFrame+1))
 949 0372 FC01      		movw r30,r24
 950 0374 2083      		st Z,r18
 153:ServerLLDN.c  **** 		if (pos + 1 > ACKFrame_size)
 951               		.loc 6 153 0
 952 0376 8981      		ldd r24,Y+1
 953 0378 9A81      		ldd r25,Y+2
 954 037a 9C01      		movw r18,r24
 955 037c 2F5F      		subi r18,-1
 956 037e 3F4F      		sbci r19,-1
 957 0380 8091 0000 		lds r24,ACKFrame_size
 958 0384 9091 0000 		lds r25,ACKFrame_size+1
 959 0388 8217      		cp r24,r18
 960 038a 9307      		cpc r25,r19
 961 038c 04F4      		brge .L29
 154:ServerLLDN.c  **** 			ACKFrame_size = pos + 1;
 962               		.loc 6 154 0
 963 038e 8981      		ldd r24,Y+1
 964 0390 9A81      		ldd r25,Y+2
 965 0392 0196      		adiw r24,1
 966 0394 9093 0000 		sts ACKFrame_size+1,r25
 967 0398 8093 0000 		sts ACKFrame_size,r24
 968               	.L29:
 155:ServerLLDN.c  **** 		
 156:ServerLLDN.c  **** 		return true;
 969               		.loc 6 156 0
 970 039c 81E0      		ldi r24,lo8(1)
 971               	.L28:
 972               	/* epilogue start */
 157:ServerLLDN.c  **** 	}
 973               		.loc 6 157 0
 974 039e 0F90      		pop __tmp_reg__
 975 03a0 0F90      		pop __tmp_reg__
 976 03a2 0F90      		pop __tmp_reg__
 977 03a4 0F90      		pop __tmp_reg__
 978 03a6 0F90      		pop __tmp_reg__
 979 03a8 DF91      		pop r29
 980 03aa CF91      		pop r28
 981 03ac 0895      		ret
 982               		.cfi_endproc
 983               	.LFE136:
 985               	.global	__floatsisf
 986               	.global	__addsf3
 987               	.global	__divsf3
 988               	.global	__fixunssfsi
 990               	addConfRequestArray:
 991               	.LFB137:
 158:ServerLLDN.c  **** 
 159:ServerLLDN.c  **** 	static void addConfRequestArray(NWK_ConfigStatus_t *node)
 160:ServerLLDN.c  **** 	{
 992               		.loc 6 160 0
 993               		.cfi_startproc
 994 03ae CF93      		push r28
 995               	.LCFI52:
 996               		.cfi_def_cfa_offset 3
 997               		.cfi_offset 28, -2
 998 03b0 DF93      		push r29
 999               	.LCFI53:
 1000               		.cfi_def_cfa_offset 4
 1001               		.cfi_offset 29, -3
 1002 03b2 00D0      		rcall .
 1003               	.LCFI54:
 1004               		.cfi_def_cfa_offset 6
 1005 03b4 CDB7      		in r28,__SP_L__
 1006 03b6 DEB7      		in r29,__SP_H__
 1007               	.LCFI55:
 1008               		.cfi_def_cfa_register 28
 1009               	/* prologue: function */
 1010               	/* frame size = 2 */
 1011               	/* stack size = 4 */
 1012               	.L__stack_usage = 4
 1013 03b8 9A83      		std Y+2,r25
 1014 03ba 8983      		std Y+1,r24
 161:ServerLLDN.c  **** 		//printf("conf_req_index : %d", conf_req_index);
 162:ServerLLDN.c  **** 		conf_req_index++;
 1015               		.loc 6 162 0
 1016 03bc 8091 0000 		lds r24,conf_req_index
 1017 03c0 9091 0000 		lds r25,conf_req_index+1
 1018 03c4 0196      		adiw r24,1
 1019 03c6 9093 0000 		sts conf_req_index+1,r25
 1020 03ca 8093 0000 		sts conf_req_index,r24
 163:ServerLLDN.c  **** 		
 164:ServerLLDN.c  **** 		if(node->ts_dir.tsDuration > config_request_frame.conf.tsDuration)
 1021               		.loc 6 164 0
 1022 03ce 8981      		ldd r24,Y+1
 1023 03d0 9A81      		ldd r25,Y+2
 1024 03d2 FC01      		movw r30,r24
 1025 03d4 8481      		ldd r24,Z+4
 1026 03d6 8F77      		andi r24,lo8(127)
 1027 03d8 282F      		mov r18,r24
 1028 03da 30E0      		ldi r19,0
 1029 03dc 8091 0000 		lds r24,config_request_frame+5
 1030 03e0 8F77      		andi r24,lo8(127)
 1031 03e2 882F      		mov r24,r24
 1032 03e4 90E0      		ldi r25,0
 1033 03e6 8217      		cp r24,r18
 1034 03e8 9307      		cpc r25,r19
 1035 03ea 04F0      		brlt .+2
 1036 03ec 00C0      		rjmp .L31
 165:ServerLLDN.c  **** 		config_request_frame.conf.tsDuration =  ((p_var*sp + (m+ node->ts_dir.tsDuration )*sm + macMinLIF
 1037               		.loc 6 165 0
 1038 03ee 8981      		ldd r24,Y+1
 1039 03f0 9A81      		ldd r25,Y+2
 1040 03f2 FC01      		movw r30,r24
 1041 03f4 8481      		ldd r24,Z+4
 1042 03f6 8F77      		andi r24,lo8(127)
 1043 03f8 882F      		mov r24,r24
 1044 03fa 90E0      		ldi r25,0
 1045 03fc 0396      		adiw r24,3
 1046 03fe 880F      		lsl r24
 1047 0400 991F      		rol r25
 1048 0402 092E      		mov __tmp_reg__,r25
 1049 0404 000C      		lsl r0
 1050 0406 AA0B      		sbc r26,r26
 1051 0408 BB0B      		sbc r27,r27
 1052 040a BC01      		movw r22,r24
 1053 040c CD01      		movw r24,r26
 1054 040e 0E94 0000 		call __floatsisf
 1055 0412 DC01      		movw r26,r24
 1056 0414 CB01      		movw r24,r22
 1057 0416 20E0      		ldi r18,0
 1058 0418 30E0      		ldi r19,0
 1059 041a 40E4      		ldi r20,lo8(64)
 1060 041c 51E4      		ldi r21,lo8(65)
 1061 041e BC01      		movw r22,r24
 1062 0420 CD01      		movw r24,r26
 1063 0422 0E94 0000 		call __addsf3
 1064 0426 DC01      		movw r26,r24
 1065 0428 CB01      		movw r24,r22
 1066 042a 20E0      		ldi r18,0
 1067 042c 30E0      		ldi r19,0
 1068 042e 40E2      		ldi r20,lo8(32)
 1069 0430 52E4      		ldi r21,lo8(66)
 1070 0432 BC01      		movw r22,r24
 1071 0434 CD01      		movw r24,r26
 1072 0436 0E94 0000 		call __addsf3
 1073 043a DC01      		movw r26,r24
 1074 043c CB01      		movw r24,r22
 1075 043e 20E0      		ldi r18,0
 1076 0440 34E2      		ldi r19,lo8(36)
 1077 0442 44E7      		ldi r20,lo8(116)
 1078 0444 57E4      		ldi r21,lo8(71)
 1079 0446 BC01      		movw r22,r24
 1080 0448 CD01      		movw r24,r26
 1081 044a 0E94 0000 		call __divsf3
 1082 044e DC01      		movw r26,r24
 1083 0450 CB01      		movw r24,r22
 1084 0452 BC01      		movw r22,r24
 1085 0454 CD01      		movw r24,r26
 1086 0456 0E94 0000 		call __fixunssfsi
 1087 045a DC01      		movw r26,r24
 1088 045c CB01      		movw r24,r22
 1089 045e 8F77      		andi r24,lo8(127)
 1090 0460 9091 0000 		lds r25,config_request_frame+5
 1091 0464 9078      		andi r25,lo8(-128)
 1092 0466 892B      		or r24,r25
 1093 0468 8093 0000 		sts config_request_frame+5,r24
 1094               	.L31:
 166:ServerLLDN.c  **** 		
 167:ServerLLDN.c  **** 		// tem que atualizar o tamanho final
 168:ServerLLDN.c  **** 		nodes_info_arr[conf_req_index].req_timeslot_duration = node->ts_dir.tsDuration;
 1095               		.loc 6 168 0
 1096 046c 8091 0000 		lds r24,conf_req_index
 1097 0470 9091 0000 		lds r25,conf_req_index+1
 1098 0474 2981      		ldd r18,Y+1
 1099 0476 3A81      		ldd r19,Y+2
 1100 0478 F901      		movw r30,r18
 1101 047a 2481      		ldd r18,Z+4
 1102 047c 2F77      		andi r18,lo8(127)
 1103 047e 880F      		lsl r24
 1104 0480 991F      		rol r25
 1105 0482 880F      		lsl r24
 1106 0484 991F      		rol r25
 1107 0486 8050      		subi r24,lo8(-(nodes_info_arr+3))
 1108 0488 9040      		sbci r25,hi8(-(nodes_info_arr+3))
 1109 048a FC01      		movw r30,r24
 1110 048c 2083      		st Z,r18
 169:ServerLLDN.c  **** 		nodes_info_arr[conf_req_index].mac_addr = node->macAddr;
 1111               		.loc 6 169 0
 1112 048e 8091 0000 		lds r24,conf_req_index
 1113 0492 9091 0000 		lds r25,conf_req_index+1
 1114 0496 2981      		ldd r18,Y+1
 1115 0498 3A81      		ldd r19,Y+2
 1116 049a F901      		movw r30,r18
 1117 049c 2381      		ldd r18,Z+3
 1118 049e 222F      		mov r18,r18
 1119 04a0 30E0      		ldi r19,0
 1120 04a2 880F      		lsl r24
 1121 04a4 991F      		rol r25
 1122 04a6 880F      		lsl r24
 1123 04a8 991F      		rol r25
 1124 04aa 8050      		subi r24,lo8(-(nodes_info_arr+1))
 1125 04ac 9040      		sbci r25,hi8(-(nodes_info_arr+1))
 1126 04ae FC01      		movw r30,r24
 1127 04b0 3183      		std Z+1,r19
 1128 04b2 2083      		st Z,r18
 170:ServerLLDN.c  **** 		nodes_info_arr[conf_req_index].assigned_time_slot = (uint8_t)conf_req_index;
 1129               		.loc 6 170 0
 1130 04b4 8091 0000 		lds r24,conf_req_index
 1131 04b8 9091 0000 		lds r25,conf_req_index+1
 1132 04bc 2091 0000 		lds r18,conf_req_index
 1133 04c0 3091 0000 		lds r19,conf_req_index+1
 1134 04c4 880F      		lsl r24
 1135 04c6 991F      		rol r25
 1136 04c8 880F      		lsl r24
 1137 04ca 991F      		rol r25
 1138 04cc 8050      		subi r24,lo8(-(nodes_info_arr))
 1139 04ce 9040      		sbci r25,hi8(-(nodes_info_arr))
 1140 04d0 FC01      		movw r30,r24
 1141 04d2 2083      		st Z,r18
 171:ServerLLDN.c  **** 
 172:ServerLLDN.c  **** 	}
 1142               		.loc 6 172 0
 1143 04d4 0000      		nop
 1144               	/* epilogue start */
 1145 04d6 0F90      		pop __tmp_reg__
 1146 04d8 0F90      		pop __tmp_reg__
 1147 04da DF91      		pop r29
 1148 04dc CF91      		pop r28
 1149 04de 0895      		ret
 1150               		.cfi_endproc
 1151               	.LFE137:
 1154               	CopyToConfigRequest:
 1155               	.LFB138:
 173:ServerLLDN.c  **** 
 174:ServerLLDN.c  **** 	static void CopyToConfigRequest(int i)
 175:ServerLLDN.c  **** 	{
 1156               		.loc 6 175 0
 1157               		.cfi_startproc
 1158 04e0 CF93      		push r28
 1159               	.LCFI56:
 1160               		.cfi_def_cfa_offset 3
 1161               		.cfi_offset 28, -2
 1162 04e2 DF93      		push r29
 1163               	.LCFI57:
 1164               		.cfi_def_cfa_offset 4
 1165               		.cfi_offset 29, -3
 1166 04e4 00D0      		rcall .
 1167               	.LCFI58:
 1168               		.cfi_def_cfa_offset 6
 1169 04e6 CDB7      		in r28,__SP_L__
 1170 04e8 DEB7      		in r29,__SP_H__
 1171               	.LCFI59:
 1172               		.cfi_def_cfa_register 28
 1173               	/* prologue: function */
 1174               	/* frame size = 2 */
 1175               	/* stack size = 4 */
 1176               	.L__stack_usage = 4
 1177 04ea 9A83      		std Y+2,r25
 1178 04ec 8983      		std Y+1,r24
 176:ServerLLDN.c  **** 		config_request_frame.assTimeSlot = nodes_info_arr[i].assigned_time_slot;
 1179               		.loc 6 176 0
 1180 04ee 8981      		ldd r24,Y+1
 1181 04f0 9A81      		ldd r25,Y+2
 1182 04f2 880F      		lsl r24
 1183 04f4 991F      		rol r25
 1184 04f6 880F      		lsl r24
 1185 04f8 991F      		rol r25
 1186 04fa 8050      		subi r24,lo8(-(nodes_info_arr))
 1187 04fc 9040      		sbci r25,hi8(-(nodes_info_arr))
 1188 04fe FC01      		movw r30,r24
 1189 0500 8081      		ld r24,Z
 1190 0502 8093 0000 		sts config_request_frame+3,r24
 177:ServerLLDN.c  **** 		config_request_frame.macAddr = nodes_info_arr[i].mac_addr;
 1191               		.loc 6 177 0
 1192 0506 8981      		ldd r24,Y+1
 1193 0508 9A81      		ldd r25,Y+2
 1194 050a 880F      		lsl r24
 1195 050c 991F      		rol r25
 1196 050e 880F      		lsl r24
 1197 0510 991F      		rol r25
 1198 0512 8050      		subi r24,lo8(-(nodes_info_arr+1))
 1199 0514 9040      		sbci r25,hi8(-(nodes_info_arr+1))
 1200 0516 FC01      		movw r30,r24
 1201 0518 8081      		ld r24,Z
 1202 051a 9181      		ldd r25,Z+1
 1203 051c 8093 0000 		sts config_request_frame+4,r24
 178:ServerLLDN.c  **** 	}
 1204               		.loc 6 178 0
 1205 0520 0000      		nop
 1206               	/* epilogue start */
 1207 0522 0F90      		pop __tmp_reg__
 1208 0524 0F90      		pop __tmp_reg__
 1209 0526 DF91      		pop r29
 1210 0528 CF91      		pop r28
 1211 052a 0895      		ret
 1212               		.cfi_endproc
 1213               	.LFE138:
 1215               		.section	.rodata
 1216               	.LC4:
 1217 002f 0A44 4953 		.string	"\nDISC %hhx"
 1217      4320 2568 
 1217      6878 00
 1218               	.LC5:
 1219 003a 0A43 4F4E 		.string	"\nCONF %d"
 1219      4620 2564 
 1219      00
 1220               		.text
 1222               	appCommandInd:
 1223               	.LFB139:
 179:ServerLLDN.c  **** 
 180:ServerLLDN.c  **** 
 181:ServerLLDN.c  **** 	static bool appCommandInd(NWK_DataInd_t *ind)
 182:ServerLLDN.c  **** 	{
 1224               		.loc 6 182 0
 1225               		.cfi_startproc
 1226 052c CF93      		push r28
 1227               	.LCFI60:
 1228               		.cfi_def_cfa_offset 3
 1229               		.cfi_offset 28, -2
 1230 052e DF93      		push r29
 1231               	.LCFI61:
 1232               		.cfi_def_cfa_offset 4
 1233               		.cfi_offset 29, -3
 1234 0530 00D0      		rcall .
 1235 0532 00D0      		rcall .
 1236 0534 00D0      		rcall .
 1237               	.LCFI62:
 1238               		.cfi_def_cfa_offset 10
 1239 0536 CDB7      		in r28,__SP_L__
 1240 0538 DEB7      		in r29,__SP_H__
 1241               	.LCFI63:
 1242               		.cfi_def_cfa_register 28
 1243               	/* prologue: function */
 1244               	/* frame size = 6 */
 1245               	/* stack size = 8 */
 1246               	.L__stack_usage = 8
 1247 053a 9E83      		std Y+6,r25
 1248 053c 8D83      		std Y+5,r24
 183:ServerLLDN.c  **** 		if(ind->data[0] == LL_DISCOVER_RESPONSE)
 1249               		.loc 6 183 0
 1250 053e 8D81      		ldd r24,Y+5
 1251 0540 9E81      		ldd r25,Y+6
 1252 0542 FC01      		movw r30,r24
 1253 0544 8085      		ldd r24,Z+8
 1254 0546 9185      		ldd r25,Z+9
 1255 0548 FC01      		movw r30,r24
 1256 054a 8081      		ld r24,Z
 1257 054c 8D30      		cpi r24,lo8(13)
 1258 054e 01F4      		brne .L34
 1259               	.LBB2:
 184:ServerLLDN.c  **** 		{
 185:ServerLLDN.c  **** 			NWK_DiscoverResponse_t *msg = (NWK_DiscoverResponse_t*)ind->data;
 1260               		.loc 6 185 0
 1261 0550 8D81      		ldd r24,Y+5
 1262 0552 9E81      		ldd r25,Y+6
 1263 0554 FC01      		movw r30,r24
 1264 0556 8085      		ldd r24,Z+8
 1265 0558 9185      		ldd r25,Z+9
 1266 055a 9C83      		std Y+4,r25
 1267 055c 8B83      		std Y+3,r24
 186:ServerLLDN.c  **** 			addToAckArray(msg->macAddr);	
 1268               		.loc 6 186 0
 1269 055e 8B81      		ldd r24,Y+3
 1270 0560 9C81      		ldd r25,Y+4
 1271 0562 FC01      		movw r30,r24
 1272 0564 8181      		ldd r24,Z+1
 1273 0566 0E94 0000 		call addToAckArray
 187:ServerLLDN.c  **** 					
 188:ServerLLDN.c  **** 			#if PRINT
 189:ServerLLDN.c  **** 			printf("\nDISC %hhx", msg->macAddr);	
 1274               		.loc 6 189 0
 1275 056a 8B81      		ldd r24,Y+3
 1276 056c 9C81      		ldd r25,Y+4
 1277 056e FC01      		movw r30,r24
 1278 0570 8181      		ldd r24,Z+1
 1279 0572 882F      		mov r24,r24
 1280 0574 90E0      		ldi r25,0
 1281 0576 292F      		mov r18,r25
 1282 0578 2F93      		push r18
 1283 057a 8F93      		push r24
 1284 057c 80E0      		ldi r24,lo8(.LC4)
 1285 057e 90E0      		ldi r25,hi8(.LC4)
 1286 0580 892F      		mov r24,r25
 1287 0582 8F93      		push r24
 1288 0584 80E0      		ldi r24,lo8(.LC4)
 1289 0586 90E0      		ldi r25,hi8(.LC4)
 1290 0588 8F93      		push r24
 1291 058a 0E94 0000 		call printf
 1292 058e 0F90      		pop __tmp_reg__
 1293 0590 0F90      		pop __tmp_reg__
 1294 0592 0F90      		pop __tmp_reg__
 1295 0594 0F90      		pop __tmp_reg__
 1296               	.LBE2:
 1297 0596 00C0      		rjmp .L35
 1298               	.L34:
 190:ServerLLDN.c  **** 			#endif
 191:ServerLLDN.c  **** 		}
 192:ServerLLDN.c  **** 		else if(ind->data[0] == LL_CONFIGURATION_STATUS)
 1299               		.loc 6 192 0
 1300 0598 8D81      		ldd r24,Y+5
 1301 059a 9E81      		ldd r25,Y+6
 1302 059c FC01      		movw r30,r24
 1303 059e 8085      		ldd r24,Z+8
 1304 05a0 9185      		ldd r25,Z+9
 1305 05a2 FC01      		movw r30,r24
 1306 05a4 8081      		ld r24,Z
 1307 05a6 8E30      		cpi r24,lo8(14)
 1308 05a8 01F4      		brne .L36
 1309               	.LBB3:
 193:ServerLLDN.c  **** 		{
 194:ServerLLDN.c  **** 			NWK_ConfigStatus_t *msg = (NWK_ConfigStatus_t*)ind->data;
 1310               		.loc 6 194 0
 1311 05aa 8D81      		ldd r24,Y+5
 1312 05ac 9E81      		ldd r25,Y+6
 1313 05ae FC01      		movw r30,r24
 1314 05b0 8085      		ldd r24,Z+8
 1315 05b2 9185      		ldd r25,Z+9
 1316 05b4 9A83      		std Y+2,r25
 1317 05b6 8983      		std Y+1,r24
 195:ServerLLDN.c  **** 			addConfRequestArray(msg);
 1318               		.loc 6 195 0
 1319 05b8 8981      		ldd r24,Y+1
 1320 05ba 9A81      		ldd r25,Y+2
 1321 05bc 0E94 0000 		call addConfRequestArray
 196:ServerLLDN.c  **** 			#if PRINT
 197:ServerLLDN.c  **** 			printf("\nCONF %d", msg->macAddr);	
 1322               		.loc 6 197 0
 1323 05c0 8981      		ldd r24,Y+1
 1324 05c2 9A81      		ldd r25,Y+2
 1325 05c4 FC01      		movw r30,r24
 1326 05c6 8381      		ldd r24,Z+3
 1327 05c8 882F      		mov r24,r24
 1328 05ca 90E0      		ldi r25,0
 1329 05cc 292F      		mov r18,r25
 1330 05ce 2F93      		push r18
 1331 05d0 8F93      		push r24
 1332 05d2 80E0      		ldi r24,lo8(.LC5)
 1333 05d4 90E0      		ldi r25,hi8(.LC5)
 1334 05d6 892F      		mov r24,r25
 1335 05d8 8F93      		push r24
 1336 05da 80E0      		ldi r24,lo8(.LC5)
 1337 05dc 90E0      		ldi r25,hi8(.LC5)
 1338 05de 8F93      		push r24
 1339 05e0 0E94 0000 		call printf
 1340 05e4 0F90      		pop __tmp_reg__
 1341 05e6 0F90      		pop __tmp_reg__
 1342 05e8 0F90      		pop __tmp_reg__
 1343 05ea 0F90      		pop __tmp_reg__
 1344               	.LBE3:
 1345 05ec 00C0      		rjmp .L35
 1346               	.L36:
 198:ServerLLDN.c  **** 			#endif
 199:ServerLLDN.c  **** 		}
 200:ServerLLDN.c  **** 		else return false;			
 1347               		.loc 6 200 0
 1348 05ee 80E0      		ldi r24,0
 1349 05f0 00C0      		rjmp .L37
 1350               	.L35:
 201:ServerLLDN.c  **** 		return true;
 1351               		.loc 6 201 0
 1352 05f2 81E0      		ldi r24,lo8(1)
 1353               	.L37:
 1354               	/* epilogue start */
 202:ServerLLDN.c  **** 	}
 1355               		.loc 6 202 0
 1356 05f4 2696      		adiw r28,6
 1357 05f6 0FB6      		in __tmp_reg__,__SREG__
 1358 05f8 F894      		cli
 1359 05fa DEBF      		out __SP_H__,r29
 1360 05fc 0FBE      		out __SREG__,__tmp_reg__
 1361 05fe CDBF      		out __SP_L__,r28
 1362 0600 DF91      		pop r29
 1363 0602 CF91      		pop r28
 1364 0604 0895      		ret
 1365               		.cfi_endproc
 1366               	.LFE139:
 1369               	appPanPrepareACK:
 1370               	.LFB140:
 203:ServerLLDN.c  **** 	
 204:ServerLLDN.c  **** 	static void appPanPrepareACK(void)
 205:ServerLLDN.c  **** 	{
 1371               		.loc 6 205 0
 1372               		.cfi_startproc
 1373 0606 CF93      		push r28
 1374               	.LCFI64:
 1375               		.cfi_def_cfa_offset 3
 1376               		.cfi_offset 28, -2
 1377 0608 DF93      		push r29
 1378               	.LCFI65:
 1379               		.cfi_def_cfa_offset 4
 1380               		.cfi_offset 29, -3
 1381 060a CDB7      		in r28,__SP_L__
 1382 060c DEB7      		in r29,__SP_H__
 1383               	.LCFI66:
 1384               		.cfi_def_cfa_register 28
 1385               	/* prologue: function */
 1386               	/* frame size = 0 */
 1387               	/* stack size = 2 */
 1388               	.L__stack_usage = 2
 206:ServerLLDN.c  **** 		msgReq.dstAddr		= 0;
 1389               		.loc 6 206 0
 1390 060e 1092 0000 		sts msgReq+5+1,__zero_reg__
 1391 0612 1092 0000 		sts msgReq+5,__zero_reg__
 207:ServerLLDN.c  **** 		msgReq.dstEndpoint	= APP_BEACON_ENDPOINT;
 1392               		.loc 6 207 0
 1393 0616 1092 0000 		sts msgReq+7,__zero_reg__
 208:ServerLLDN.c  **** 		msgReq.srcEndpoint	= APP_BEACON_ENDPOINT;
 1394               		.loc 6 208 0
 1395 061a 1092 0000 		sts msgReq+8,__zero_reg__
 209:ServerLLDN.c  **** 		msgReq.options		= NWK_OPT_LLDN_ACK;
 1396               		.loc 6 209 0
 1397 061e 80E0      		ldi r24,0
 1398 0620 90E4      		ldi r25,lo8(64)
 1399 0622 9093 0000 		sts msgReq+9+1,r25
 1400 0626 8093 0000 		sts msgReq+9,r24
 210:ServerLLDN.c  **** 		msgReq.data	= (uint8_t *)&ACKFrame;
 1401               		.loc 6 210 0
 1402 062a 80E0      		ldi r24,lo8(ACKFrame)
 1403 062c 90E0      		ldi r25,hi8(ACKFrame)
 1404 062e 9093 0000 		sts msgReq+13+1,r25
 1405 0632 8093 0000 		sts msgReq+13,r24
 211:ServerLLDN.c  **** 		msgReq.size	= sizeof(uint8_t)*(ACKFrame_size + 1);
 1406               		.loc 6 211 0
 1407 0636 8091 0000 		lds r24,ACKFrame_size
 1408 063a 9091 0000 		lds r25,ACKFrame_size+1
 1409 063e 8F5F      		subi r24,lo8(-(1))
 1410 0640 8093 0000 		sts msgReq+15,r24
 212:ServerLLDN.c  **** 
 213:ServerLLDN.c  **** 	}
 1411               		.loc 6 213 0
 1412 0644 0000      		nop
 1413               	/* epilogue start */
 1414 0646 DF91      		pop r29
 1415 0648 CF91      		pop r28
 1416 064a 0895      		ret
 1417               		.cfi_endproc
 1418               	.LFE140:
 1421               	appPanReset:
 1422               	.LFB141:
 214:ServerLLDN.c  **** 
 215:ServerLLDN.c  **** 	static void appPanReset(void)
 216:ServerLLDN.c  **** 	{
 1423               		.loc 6 216 0
 1424               		.cfi_startproc
 1425 064c CF93      		push r28
 1426               	.LCFI67:
 1427               		.cfi_def_cfa_offset 3
 1428               		.cfi_offset 28, -2
 1429 064e DF93      		push r29
 1430               	.LCFI68:
 1431               		.cfi_def_cfa_offset 4
 1432               		.cfi_offset 29, -3
 1433 0650 00D0      		rcall .
 1434 0652 00D0      		rcall .
 1435               	.LCFI69:
 1436               		.cfi_def_cfa_offset 8
 1437 0654 CDB7      		in r28,__SP_L__
 1438 0656 DEB7      		in r29,__SP_H__
 1439               	.LCFI70:
 1440               		.cfi_def_cfa_register 28
 1441               	/* prologue: function */
 1442               	/* frame size = 4 */
 1443               	/* stack size = 6 */
 1444               	.L__stack_usage = 6
 217:ServerLLDN.c  **** 		// prepare beacon reset message
 218:ServerLLDN.c  **** 		msgReq.dstAddr		= 0;
 1445               		.loc 6 218 0
 1446 0658 1092 0000 		sts msgReq+5+1,__zero_reg__
 1447 065c 1092 0000 		sts msgReq+5,__zero_reg__
 219:ServerLLDN.c  **** 		msgReq.dstEndpoint	= APP_BEACON_ENDPOINT;
 1448               		.loc 6 219 0
 1449 0660 1092 0000 		sts msgReq+7,__zero_reg__
 220:ServerLLDN.c  **** 		msgReq.srcEndpoint	= APP_BEACON_ENDPOINT;
 1450               		.loc 6 220 0
 1451 0664 1092 0000 		sts msgReq+8,__zero_reg__
 221:ServerLLDN.c  **** 		msgReq.options		= NWK_OPT_LLDN_BEACON | NWK_OPT_RESET_STATE;
 1452               		.loc 6 221 0
 1453 0668 80E4      		ldi r24,lo8(64)
 1454 066a 94E0      		ldi r25,lo8(4)
 1455 066c 9093 0000 		sts msgReq+9+1,r25
 1456 0670 8093 0000 		sts msgReq+9,r24
 222:ServerLLDN.c  **** 		msgReq.data			= NULL;
 1457               		.loc 6 222 0
 1458 0674 1092 0000 		sts msgReq+13+1,__zero_reg__
 1459 0678 1092 0000 		sts msgReq+13,__zero_reg__
 223:ServerLLDN.c  **** 		msgReq.size			= 0;
 1460               		.loc 6 223 0
 1461 067c 1092 0000 		sts msgReq+15,__zero_reg__
 1462               	.LBB4:
 224:ServerLLDN.c  **** 
 225:ServerLLDN.c  **** 		for(int i = 0; i < 32; i++)
 1463               		.loc 6 225 0
 1464 0680 1A82      		std Y+2,__zero_reg__
 1465 0682 1982      		std Y+1,__zero_reg__
 1466 0684 00C0      		rjmp .L40
 1467               	.L41:
 226:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1468               		.loc 6 226 0 discriminator 3
 1469 0686 8981      		ldd r24,Y+1
 1470 0688 9A81      		ldd r25,Y+2
 1471 068a 8050      		subi r24,lo8(-(ACKFrame+1))
 1472 068c 9040      		sbci r25,hi8(-(ACKFrame+1))
 1473 068e FC01      		movw r30,r24
 1474 0690 1082      		st Z,__zero_reg__
 225:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1475               		.loc 6 225 0 discriminator 3
 1476 0692 8981      		ldd r24,Y+1
 1477 0694 9A81      		ldd r25,Y+2
 1478 0696 0196      		adiw r24,1
 1479 0698 9A83      		std Y+2,r25
 1480 069a 8983      		std Y+1,r24
 1481               	.L40:
 225:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1482               		.loc 6 225 0 is_stmt 0 discriminator 1
 1483 069c 8981      		ldd r24,Y+1
 1484 069e 9A81      		ldd r25,Y+2
 1485 06a0 8097      		sbiw r24,32
 1486 06a2 04F0      		brlt .L41
 1487               	.LBE4:
 1488               	.LBB5:
 227:ServerLLDN.c  **** 		for (int i = 0; i < 255; i++)
 1489               		.loc 6 227 0 is_stmt 1
 1490 06a4 1C82      		std Y+4,__zero_reg__
 1491 06a6 1B82      		std Y+3,__zero_reg__
 1492 06a8 00C0      		rjmp .L42
 1493               	.L43:
 228:ServerLLDN.c  **** 			nodes_info_arr[i].mac_addr = 0;
 1494               		.loc 6 228 0 discriminator 3
 1495 06aa 8B81      		ldd r24,Y+3
 1496 06ac 9C81      		ldd r25,Y+4
 1497 06ae 880F      		lsl r24
 1498 06b0 991F      		rol r25
 1499 06b2 880F      		lsl r24
 1500 06b4 991F      		rol r25
 1501 06b6 8050      		subi r24,lo8(-(nodes_info_arr+1))
 1502 06b8 9040      		sbci r25,hi8(-(nodes_info_arr+1))
 1503 06ba FC01      		movw r30,r24
 1504 06bc 1182      		std Z+1,__zero_reg__
 1505 06be 1082      		st Z,__zero_reg__
 227:ServerLLDN.c  **** 		for (int i = 0; i < 255; i++)
 1506               		.loc 6 227 0 discriminator 3
 1507 06c0 8B81      		ldd r24,Y+3
 1508 06c2 9C81      		ldd r25,Y+4
 1509 06c4 0196      		adiw r24,1
 1510 06c6 9C83      		std Y+4,r25
 1511 06c8 8B83      		std Y+3,r24
 1512               	.L42:
 227:ServerLLDN.c  **** 		for (int i = 0; i < 255; i++)
 1513               		.loc 6 227 0 is_stmt 0 discriminator 1
 1514 06ca 8B81      		ldd r24,Y+3
 1515 06cc 9C81      		ldd r25,Y+4
 1516 06ce 8F3F      		cpi r24,-1
 1517 06d0 9105      		cpc r25,__zero_reg__
 1518 06d2 04F0      		brlt .L43
 1519               	.LBE5:
 229:ServerLLDN.c  **** 			
 230:ServerLLDN.c  **** 		ACKFrame_size = 0;
 1520               		.loc 6 230 0 is_stmt 1
 1521 06d4 1092 0000 		sts ACKFrame_size+1,__zero_reg__
 1522 06d8 1092 0000 		sts ACKFrame_size,__zero_reg__
 231:ServerLLDN.c  **** 		conf_req_index = 0;
 1523               		.loc 6 231 0
 1524 06dc 1092 0000 		sts conf_req_index+1,__zero_reg__
 1525 06e0 1092 0000 		sts conf_req_index,__zero_reg__
 232:ServerLLDN.c  **** 		counter_associados = 0;
 1526               		.loc 6 232 0
 1527 06e4 1092 0000 		sts counter_associados+1,__zero_reg__
 1528 06e8 1092 0000 		sts counter_associados,__zero_reg__
 233:ServerLLDN.c  **** 		n = 0;
 1529               		.loc 6 233 0
 1530 06ec 1092 0000 		sts n,__zero_reg__
 234:ServerLLDN.c  **** 	}
 1531               		.loc 6 234 0
 1532 06f0 0000      		nop
 1533               	/* epilogue start */
 1534 06f2 0F90      		pop __tmp_reg__
 1535 06f4 0F90      		pop __tmp_reg__
 1536 06f6 0F90      		pop __tmp_reg__
 1537 06f8 0F90      		pop __tmp_reg__
 1538 06fa DF91      		pop r29
 1539 06fc CF91      		pop r28
 1540 06fe 0895      		ret
 1541               		.cfi_endproc
 1542               	.LFE141:
 1544               	.global	__mulsf3
 1546               	appPanDiscInit:
 1547               	.LFB142:
 235:ServerLLDN.c  **** 
 236:ServerLLDN.c  **** 	static void appPanDiscInit(void)
 237:ServerLLDN.c  **** 	{	
 1548               		.loc 6 237 0
 1549               		.cfi_startproc
 1550 0700 CF93      		push r28
 1551               	.LCFI71:
 1552               		.cfi_def_cfa_offset 3
 1553               		.cfi_offset 28, -2
 1554 0702 DF93      		push r29
 1555               	.LCFI72:
 1556               		.cfi_def_cfa_offset 4
 1557               		.cfi_offset 29, -3
 1558 0704 00D0      		rcall .
 1559               	.LCFI73:
 1560               		.cfi_def_cfa_offset 6
 1561 0706 CDB7      		in r28,__SP_L__
 1562 0708 DEB7      		in r29,__SP_H__
 1563               	.LCFI74:
 1564               		.cfi_def_cfa_register 28
 1565               	/* prologue: function */
 1566               	/* frame size = 2 */
 1567               	/* stack size = 4 */
 1568               	.L__stack_usage = 4
 1569               	.LBB6:
 238:ServerLLDN.c  **** 		/* clear Ack array of previous discovery state */
 239:ServerLLDN.c  **** 		for(int i = 0; i < 32; i++)
 1570               		.loc 6 239 0
 1571 070a 1A82      		std Y+2,__zero_reg__
 1572 070c 1982      		std Y+1,__zero_reg__
 1573 070e 00C0      		rjmp .L45
 1574               	.L46:
 240:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1575               		.loc 6 240 0 discriminator 3
 1576 0710 8981      		ldd r24,Y+1
 1577 0712 9A81      		ldd r25,Y+2
 1578 0714 8050      		subi r24,lo8(-(ACKFrame+1))
 1579 0716 9040      		sbci r25,hi8(-(ACKFrame+1))
 1580 0718 FC01      		movw r30,r24
 1581 071a 1082      		st Z,__zero_reg__
 239:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1582               		.loc 6 239 0 discriminator 3
 1583 071c 8981      		ldd r24,Y+1
 1584 071e 9A81      		ldd r25,Y+2
 1585 0720 0196      		adiw r24,1
 1586 0722 9A83      		std Y+2,r25
 1587 0724 8983      		std Y+1,r24
 1588               	.L45:
 239:ServerLLDN.c  **** 			ACKFrame.ackFlags[i] = 0;
 1589               		.loc 6 239 0 is_stmt 0 discriminator 1
 1590 0726 8981      		ldd r24,Y+1
 1591 0728 9A81      		ldd r25,Y+2
 1592 072a 8097      		sbiw r24,32
 1593 072c 04F0      		brlt .L46
 1594               	.LBE6:
 241:ServerLLDN.c  **** 		ACKFrame_size = 0;
 1595               		.loc 6 241 0 is_stmt 1
 1596 072e 1092 0000 		sts ACKFrame_size+1,__zero_reg__
 1597 0732 1092 0000 		sts ACKFrame_size,__zero_reg__
 242:ServerLLDN.c  **** 		/* Prepare Beacon Message as first beacon in discovery state */		
 243:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 1598               		.loc 6 243 0
 1599 0736 1092 0000 		sts msgReq+5+1,__zero_reg__
 1600 073a 1092 0000 		sts msgReq+5,__zero_reg__
 244:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_BEACON_ENDPOINT;
 1601               		.loc 6 244 0
 1602 073e 1092 0000 		sts msgReq+7,__zero_reg__
 245:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_BEACON_ENDPOINT;
 1603               		.loc 6 245 0
 1604 0742 1092 0000 		sts msgReq+8,__zero_reg__
 246:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_LLDN_BEACON | NWK_OPT_DISCOVERY_STATE;
 1605               		.loc 6 246 0
 1606 0746 80E4      		ldi r24,lo8(64)
 1607 0748 91E0      		ldi r25,lo8(1)
 1608 074a 9093 0000 		sts msgReq+9+1,r25
 1609 074e 8093 0000 		sts msgReq+9,r24
 247:ServerLLDN.c  **** 		msgReq.data					= NULL;
 1610               		.loc 6 247 0
 1611 0752 1092 0000 		sts msgReq+13+1,__zero_reg__
 1612 0756 1092 0000 		sts msgReq+13,__zero_reg__
 248:ServerLLDN.c  **** 		msgReq.size					= 0;
 1613               		.loc 6 248 0
 1614 075a 1092 0000 		sts msgReq+15,__zero_reg__
 249:ServerLLDN.c  **** 		
 250:ServerLLDN.c  **** 		
 251:ServerLLDN.c  **** 		/* Only start timers if it is the first association process */
 252:ServerLLDN.c  **** 		if(cycles_counter == 0) 
 1615               		.loc 6 252 0
 1616 075e 8091 0000 		lds r24,cycles_counter
 1617 0762 8823      		tst r24
 1618 0764 01F0      		breq .+2
 1619 0766 00C0      		rjmp .L48
 253:ServerLLDN.c  **** 		{
 254:ServerLLDN.c  **** 			
 255:ServerLLDN.c  **** 		/* Calculates Beacon Intervals according to 802.15.4e - 2012 p. 70 */
 256:ServerLLDN.c  **** 		n = 127; 
 1620               		.loc 6 256 0
 1621 0768 8FE7      		ldi r24,lo8(127)
 1622 076a 8093 0000 		sts n,r24
 257:ServerLLDN.c  **** 		tTS =  ((p_var*sp + (m+n)*sm + macMinLIFSPeriod)/v_var);
 1623               		.loc 6 257 0
 1624 076e 8091 0000 		lds r24,n
 1625 0772 882F      		mov r24,r24
 1626 0774 90E0      		ldi r25,0
 1627 0776 0396      		adiw r24,3
 1628 0778 880F      		lsl r24
 1629 077a 991F      		rol r25
 1630 077c 092E      		mov __tmp_reg__,r25
 1631 077e 000C      		lsl r0
 1632 0780 AA0B      		sbc r26,r26
 1633 0782 BB0B      		sbc r27,r27
 1634 0784 BC01      		movw r22,r24
 1635 0786 CD01      		movw r24,r26
 1636 0788 0E94 0000 		call __floatsisf
 1637 078c DC01      		movw r26,r24
 1638 078e CB01      		movw r24,r22
 1639 0790 20E0      		ldi r18,0
 1640 0792 30E0      		ldi r19,0
 1641 0794 40E4      		ldi r20,lo8(64)
 1642 0796 51E4      		ldi r21,lo8(65)
 1643 0798 BC01      		movw r22,r24
 1644 079a CD01      		movw r24,r26
 1645 079c 0E94 0000 		call __addsf3
 1646 07a0 DC01      		movw r26,r24
 1647 07a2 CB01      		movw r24,r22
 1648 07a4 20E0      		ldi r18,0
 1649 07a6 30E0      		ldi r19,0
 1650 07a8 40E2      		ldi r20,lo8(32)
 1651 07aa 52E4      		ldi r21,lo8(66)
 1652 07ac BC01      		movw r22,r24
 1653 07ae CD01      		movw r24,r26
 1654 07b0 0E94 0000 		call __addsf3
 1655 07b4 DC01      		movw r26,r24
 1656 07b6 CB01      		movw r24,r22
 1657 07b8 20E0      		ldi r18,0
 1658 07ba 34E2      		ldi r19,lo8(36)
 1659 07bc 44E7      		ldi r20,lo8(116)
 1660 07be 57E4      		ldi r21,lo8(71)
 1661 07c0 BC01      		movw r22,r24
 1662 07c2 CD01      		movw r24,r26
 1663 07c4 0E94 0000 		call __divsf3
 1664 07c8 DC01      		movw r26,r24
 1665 07ca CB01      		movw r24,r22
 1666 07cc 8093 0000 		sts tTS,r24
 1667 07d0 9093 0000 		sts tTS+1,r25
 1668 07d4 A093 0000 		sts tTS+2,r26
 1669 07d8 B093 0000 		sts tTS+3,r27
 258:ServerLLDN.c  **** 		#if (MASTER_MACSC == 1)
 259:ServerLLDN.c  **** 		
 260:ServerLLDN.c  **** 			beaconInterval = 2 * numBaseTimeSlotperMgmt * (tTS) / (SYMBOL_TIME);
 1670               		.loc 6 260 0
 1671 07dc 8091 0000 		lds r24,tTS
 1672 07e0 9091 0000 		lds r25,tTS+1
 1673 07e4 A091 0000 		lds r26,tTS+2
 1674 07e8 B091 0000 		lds r27,tTS+3
 1675 07ec 20E0      		ldi r18,0
 1676 07ee 30E0      		ldi r19,0
 1677 07f0 40E8      		ldi r20,lo8(-128)
 1678 07f2 50E4      		ldi r21,lo8(64)
 1679 07f4 BC01      		movw r22,r24
 1680 07f6 CD01      		movw r24,r26
 1681 07f8 0E94 0000 		call __mulsf3
 1682 07fc DC01      		movw r26,r24
 1683 07fe CB01      		movw r24,r22
 1684 0800 2DEB      		ldi r18,lo8(-67)
 1685 0802 37E3      		ldi r19,lo8(55)
 1686 0804 46E8      		ldi r20,lo8(-122)
 1687 0806 57E3      		ldi r21,lo8(55)
 1688 0808 BC01      		movw r22,r24
 1689 080a CD01      		movw r24,r26
 1690 080c 0E94 0000 		call __divsf3
 1691 0810 DC01      		movw r26,r24
 1692 0812 CB01      		movw r24,r22
 1693 0814 8093 0000 		sts beaconInterval,r24
 1694 0818 9093 0000 		sts beaconInterval+1,r25
 1695 081c A093 0000 		sts beaconInterval+2,r26
 1696 0820 B093 0000 		sts beaconInterval+3,r27
 261:ServerLLDN.c  **** 			/*
 262:ServerLLDN.c  **** 			* Configure interrupts callback functions
 263:ServerLLDN.c  **** 			* overflow interrupt, compare 1,2,3 interrupts
 264:ServerLLDN.c  **** 			*/
 265:ServerLLDN.c  **** 			macsc_set_cmp1_int_cb(lldn_server_beacon);
 1697               		.loc 6 265 0
 1698 0824 80E0      		ldi r24,lo8(gs(lldn_server_beacon))
 1699 0826 90E0      		ldi r25,hi8(gs(lldn_server_beacon))
 1700 0828 0E94 0000 		call macsc_set_cmp1_int_cb
 266:ServerLLDN.c  **** 			/*
 267:ServerLLDN.c  **** 			* Configure MACSC to generate compare interrupts from channels 1,2,3
 268:ServerLLDN.c  **** 			* Set compare mode to absolute, set compare value.
 269:ServerLLDN.c  **** 			*/
 270:ServerLLDN.c  **** 			macsc_enable_manual_bts();
 1701               		.loc 6 270 0
 1702 082c 0E94 0000 		call macsc_enable_manual_bts
 271:ServerLLDN.c  **** 			macsc_enable_cmp_int(MACSC_CC1);
 1703               		.loc 6 271 0
 1704 0830 81E0      		ldi r24,lo8(1)
 1705 0832 0E94 0000 		call macsc_enable_cmp_int
 272:ServerLLDN.c  **** 
 273:ServerLLDN.c  **** 			macsc_use_cmp(MACSC_RELATIVE_CMP, beaconInterval , MACSC_CC1);
 1706               		.loc 6 273 0
 1707 0836 8091 0000 		lds r24,beaconInterval
 1708 083a 9091 0000 		lds r25,beaconInterval+1
 1709 083e A091 0000 		lds r26,beaconInterval+2
 1710 0842 B091 0000 		lds r27,beaconInterval+3
 1711 0846 BC01      		movw r22,r24
 1712 0848 CD01      		movw r24,r26
 1713 084a 0E94 0000 		call __fixunssfsi
 1714 084e DC01      		movw r26,r24
 1715 0850 CB01      		movw r24,r22
 1716 0852 21E0      		ldi r18,lo8(1)
 1717 0854 AC01      		movw r20,r24
 1718 0856 BD01      		movw r22,r26
 1719 0858 81E0      		ldi r24,lo8(1)
 1720 085a 0E94 0000 		call macsc_use_cmp
 274:ServerLLDN.c  **** 			
 275:ServerLLDN.c  **** 			/* Timer used in testing */
 276:ServerLLDN.c  **** 			#if TIMESLOT_TIMER
 277:ServerLLDN.c  **** 			macsc_set_cmp2_int_cb(teste_handler);	
 1721               		.loc 6 277 0
 1722 085e 80E0      		ldi r24,lo8(gs(teste_handler))
 1723 0860 90E0      		ldi r25,hi8(gs(teste_handler))
 1724 0862 0E94 0000 		call macsc_set_cmp2_int_cb
 278:ServerLLDN.c  **** 			macsc_enable_cmp_int(MACSC_CC2);
 1725               		.loc 6 278 0
 1726 0866 82E0      		ldi r24,lo8(2)
 1727 0868 0E94 0000 		call macsc_enable_cmp_int
 279:ServerLLDN.c  **** 			macsc_use_cmp(MACSC_RELATIVE_CMP, beaconInterval / 2, MACSC_CC2);
 1728               		.loc 6 279 0
 1729 086c 8091 0000 		lds r24,beaconInterval
 1730 0870 9091 0000 		lds r25,beaconInterval+1
 1731 0874 A091 0000 		lds r26,beaconInterval+2
 1732 0878 B091 0000 		lds r27,beaconInterval+3
 1733 087c 20E0      		ldi r18,0
 1734 087e 30E0      		ldi r19,0
 1735 0880 40E0      		ldi r20,0
 1736 0882 50E4      		ldi r21,lo8(64)
 1737 0884 BC01      		movw r22,r24
 1738 0886 CD01      		movw r24,r26
 1739 0888 0E94 0000 		call __divsf3
 1740 088c DC01      		movw r26,r24
 1741 088e CB01      		movw r24,r22
 1742 0890 BC01      		movw r22,r24
 1743 0892 CD01      		movw r24,r26
 1744 0894 0E94 0000 		call __fixunssfsi
 1745 0898 DC01      		movw r26,r24
 1746 089a CB01      		movw r24,r22
 1747 089c 22E0      		ldi r18,lo8(2)
 1748 089e AC01      		movw r20,r24
 1749 08a0 BD01      		movw r22,r26
 1750 08a2 81E0      		ldi r24,lo8(1)
 1751 08a4 0E94 0000 		call macsc_use_cmp
 1752               	.L48:
 280:ServerLLDN.c  **** 			#endif
 281:ServerLLDN.c  **** 			
 282:ServerLLDN.c  **** 		#endif
 283:ServerLLDN.c  **** 		}
 284:ServerLLDN.c  **** 	}
 1753               		.loc 6 284 0
 1754 08a8 0000      		nop
 1755               	/* epilogue start */
 1756 08aa 0F90      		pop __tmp_reg__
 1757 08ac 0F90      		pop __tmp_reg__
 1758 08ae DF91      		pop r29
 1759 08b0 CF91      		pop r28
 1760 08b2 0895      		ret
 1761               		.cfi_endproc
 1762               	.LFE142:
 1765               	appPanOnlineInit:
 1766               	.LFB143:
 285:ServerLLDN.c  **** 
 286:ServerLLDN.c  **** 	static void appPanOnlineInit()
 287:ServerLLDN.c  **** 	{
 1767               		.loc 6 287 0
 1768               		.cfi_startproc
 1769 08b4 CF93      		push r28
 1770               	.LCFI75:
 1771               		.cfi_def_cfa_offset 3
 1772               		.cfi_offset 28, -2
 1773 08b6 DF93      		push r29
 1774               	.LCFI76:
 1775               		.cfi_def_cfa_offset 4
 1776               		.cfi_offset 29, -3
 1777 08b8 CDB7      		in r28,__SP_L__
 1778 08ba DEB7      		in r29,__SP_H__
 1779               	.LCFI77:
 1780               		.cfi_def_cfa_register 28
 1781               	/* prologue: function */
 1782               	/* frame size = 0 */
 1783               	/* stack size = 2 */
 1784               	.L__stack_usage = 2
 288:ServerLLDN.c  **** 		/*
 289:ServerLLDN.c  **** 		tTS =  ((p_var*sp + (m+n)*sm + macMinLIFSPeriod)/v_var);
 290:ServerLLDN.c  **** 		// beaconInterval = (assTimeSlot + MacLLDNMgmtTS*numBaseTimeSlotperMgmt) * tTS / (SYMBOL_TIME); /
 291:ServerLLDN.c  **** 		// Configure Timers
 292:ServerLLDN.c  **** 		macsc_set_cmp1_int_cb(end_of_online_handler);
 293:ServerLLDN.c  **** 		macsc_enable_manual_bts();
 294:ServerLLDN.c  **** 		macsc_enable_cmp_int(MACSC_CC1);
 295:ServerLLDN.c  **** 		macsc_use_cmp(MACSC_RELATIVE_CMP, beaconInterval, MACSC_CC1);
 296:ServerLLDN.c  **** 		
 297:ServerLLDN.c  **** 		/* prepares online beacon , PRECISA SER REVISADO COM A NORMA, ESTOU EM DVIDA NO TIMESLOTE SIZE, 
 298:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 1785               		.loc 6 298 0
 1786 08bc 1092 0000 		sts msgReq+5+1,__zero_reg__
 1787 08c0 1092 0000 		sts msgReq+5,__zero_reg__
 299:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_BEACON_ENDPOINT;
 1788               		.loc 6 299 0
 1789 08c4 1092 0000 		sts msgReq+7,__zero_reg__
 300:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_BEACON_ENDPOINT;
 1790               		.loc 6 300 0
 1791 08c8 1092 0000 		sts msgReq+8,__zero_reg__
 301:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_LLDN_BEACON | NWK_OPT_ONLINE_STATE;
 1792               		.loc 6 301 0
 1793 08cc 80EC      		ldi r24,lo8(-64)
 1794 08ce 90E0      		ldi r25,0
 1795 08d0 9093 0000 		sts msgReq+9+1,r25
 1796 08d4 8093 0000 		sts msgReq+9,r24
 302:ServerLLDN.c  **** 		msgReq.data					= NULL;
 1797               		.loc 6 302 0
 1798 08d8 1092 0000 		sts msgReq+13+1,__zero_reg__
 1799 08dc 1092 0000 		sts msgReq+13,__zero_reg__
 303:ServerLLDN.c  **** 		msgReq.size					= 0;
 1800               		.loc 6 303 0
 1801 08e0 1092 0000 		sts msgReq+15,__zero_reg__
 304:ServerLLDN.c  **** 		
 305:ServerLLDN.c  **** 	}
 1802               		.loc 6 305 0
 1803 08e4 0000      		nop
 1804               	/* epilogue start */
 1805 08e6 DF91      		pop r29
 1806 08e8 CF91      		pop r28
 1807 08ea 0895      		ret
 1808               		.cfi_endproc
 1809               	.LFE143:
 1812               	appInit:
 1813               	.LFB144:
 306:ServerLLDN.c  **** 
 307:ServerLLDN.c  **** 
 308:ServerLLDN.c  **** #else 
 309:ServerLLDN.c  **** 	uint8_t payloadSize = 0x01;
 310:ServerLLDN.c  **** 	uint8_t assTimeSlot = 0xFF;
 311:ServerLLDN.c  **** 	uint8_t n = 0;
 312:ServerLLDN.c  **** 	
 313:ServerLLDN.c  **** 	static NwkFrameBeaconHeaderLLDN_t *rec_beacon;
 314:ServerLLDN.c  **** 	static NWK_DiscoverResponse_t msgDiscResponse = { .id = LL_DISCOVER_RESPONSE,
 315:ServerLLDN.c  **** 													 .macAddr = APP_ADDR,
 316:ServerLLDN.c  **** 													 .ts_dir.tsDuration = 4,
 317:ServerLLDN.c  **** 													 .ts_dir.dirIndicator = 0b1 };
 318:ServerLLDN.c  **** 	static NWK_ConfigStatus_t msgConfigStatus = { .id = LL_CONFIGURATION_STATUS,
 319:ServerLLDN.c  **** 												 .macAddr = APP_ADDR,
 320:ServerLLDN.c  **** 												 .s_macAddr = APP_ADDR,
 321:ServerLLDN.c  **** 												 .ts_dir.tsDuration = 4,
 322:ServerLLDN.c  **** 												 .ts_dir.dirIndicator = 1,
 323:ServerLLDN.c  **** 												 .assTimeSlot = 0xff };
 324:ServerLLDN.c  **** 	static bool ack_received;
 325:ServerLLDN.c  **** 	bool MacLLDNMgmtTS = 0; 
 326:ServerLLDN.c  **** 	bool associated = 0;
 327:ServerLLDN.c  **** 	
 328:ServerLLDN.c  **** 	static void send_message_timeHandler(void)
 329:ServerLLDN.c  **** 	{
 330:ServerLLDN.c  **** 		printf("\nTIMER");
 331:ServerLLDN.c  **** 		appState = APP_STATE_SEND;	
 332:ServerLLDN.c  **** 		#if MASTER_MACSC == 0
 333:ServerLLDN.c  **** 			timer_stop();
 334:ServerLLDN.c  **** 		#endif
 335:ServerLLDN.c  **** 	}
 336:ServerLLDN.c  **** 
 337:ServerLLDN.c  **** 	
 338:ServerLLDN.c  **** 	static bool appBeaconInd(NWK_DataInd_t *ind)
 339:ServerLLDN.c  **** 	{
 340:ServerLLDN.c  **** 		rec_beacon = (NwkFrameBeaconHeaderLLDN_t*)ind->data;
 341:ServerLLDN.c  **** 		//  bom implementar rotinas pra se o nodo estiver associado a um coordeandor e se no estiver
 342:ServerLLDN.c  **** 		PanId = rec_beacon->PanId; // s pode mudar se ele associar
 343:ServerLLDN.c  **** 		if( ((rec_beacon->Flags.txState == DISC_MODE && !ack_received && rec_beacon->confSeqNumber == 0x0
 344:ServerLLDN.c  **** 			(rec_beacon->Flags.txState == CONFIG_MODE && ack_received)) && associated == 0)
 345:ServerLLDN.c  **** 		{
 346:ServerLLDN.c  **** 	
 347:ServerLLDN.c  **** 			int ts_time =  ((p_var*sp + (m+ rec_beacon->TimeSlotSize  )*sm + macMinLIFSPeriod)/v_var)  / (SY
 348:ServerLLDN.c  **** 			int msg_wait_time = rec_beacon->Flags.numBaseMgmtTimeslots * rec_beacon->TimeSlotSize * 2; // sy
 349:ServerLLDN.c  **** 			printf("\n TimeSlotSize %d", rec_beacon->TimeSlotSize);
 350:ServerLLDN.c  **** 			#if MASTER_MACSC
 351:ServerLLDN.c  **** 				macsc_enable_manual_bts();
 352:ServerLLDN.c  **** 				macsc_set_cmp1_int_cb(send_message_timeHandler);
 353:ServerLLDN.c  **** 				macsc_enable_cmp_int(MACSC_CC1); 
 354:ServerLLDN.c  **** 				macsc_use_cmp(MACSC_RELATIVE_CMP, msg_wait_time - 250, MACSC_CC1);
 355:ServerLLDN.c  **** 			#else
 356:ServerLLDN.c  **** 				timer_init();
 357:ServerLLDN.c  **** 				timer_delay(msg_wait_time/2);
 358:ServerLLDN.c  **** 				hw_timer_setup_handler(send_message_timeHandler);
 359:ServerLLDN.c  **** 				timer_start();
 360:ServerLLDN.c  **** 			#endif
 361:ServerLLDN.c  **** 			appState = (rec_beacon->Flags.txState == DISC_MODE) ? APP_STATE_PREP_DISC_REPONSE : APP_STATE_PR
 362:ServerLLDN.c  **** 		}
 363:ServerLLDN.c  **** 		else if (rec_beacon->Flags.txState == RESET_MODE)
 364:ServerLLDN.c  **** 		{
 365:ServerLLDN.c  **** 			ack_received = 0;
 366:ServerLLDN.c  **** 			associated = 0;
 367:ServerLLDN.c  **** 		}
 368:ServerLLDN.c  **** 
 369:ServerLLDN.c  **** 		return true;
 370:ServerLLDN.c  **** 	}
 371:ServerLLDN.c  **** 	
 372:ServerLLDN.c  **** 	static bool appAckInd(NWK_DataInd_t *ind)
 373:ServerLLDN.c  **** 	{
 374:ServerLLDN.c  **** 		#if !MASTER_MACSC
 375:ServerLLDN.c  **** 		ind->data = ind->data - (uint8_t) 1;
 376:ServerLLDN.c  **** 		#endif
 377:ServerLLDN.c  **** 		NWK_ACKFormat_t *ackframe = (NWK_ACKFormat_t*)ind->data;
 378:ServerLLDN.c  **** 		if(PanId == ackframe->sourceId)
 379:ServerLLDN.c  **** 		{
 380:ServerLLDN.c  **** 			int pos = (int) APP_ADDR / 8;
 381:ServerLLDN.c  **** 			int bit_shift = 8 - APP_ADDR % 8;
 382:ServerLLDN.c  **** 			if( ackframe->ackFlags[pos] & 1 << bit_shift)	
 383:ServerLLDN.c  **** 			{
 384:ServerLLDN.c  **** 				printf("\n ack true");
 385:ServerLLDN.c  **** 				ack_received = true;
 386:ServerLLDN.c  **** 			}
 387:ServerLLDN.c  **** 		}
 388:ServerLLDN.c  **** 		return true;
 389:ServerLLDN.c  **** 	}
 390:ServerLLDN.c  **** 	
 391:ServerLLDN.c  **** 	static bool appCommandInd(NWK_DataInd_t *ind)
 392:ServerLLDN.c  **** 	{
 393:ServerLLDN.c  **** 		#if !MASTER_MACSC
 394:ServerLLDN.c  **** 		ind->data = ind->data - (uint8_t) 1;
 395:ServerLLDN.c  **** 		#endif
 396:ServerLLDN.c  **** 		
 397:ServerLLDN.c  **** 		if(ind->data[0] == LL_CONFIGURATION_REQUEST)
 398:ServerLLDN.c  **** 		{
 399:ServerLLDN.c  **** 			NWK_ConfigRequest_t *msg = (NWK_ConfigRequest_t*)ind->data;
 400:ServerLLDN.c  **** 			if(msg->macAddr == APP_ADDR)
 401:ServerLLDN.c  **** 			{
 402:ServerLLDN.c  **** 				PHY_SetChannel(msg->tx_channel);
 403:ServerLLDN.c  **** 				NWK_SetPanId(msg->s_macAddr);
 404:ServerLLDN.c  **** 				assTimeSlot = msg->assTimeSlot;
 405:ServerLLDN.c  **** 				n = msg->conf.tsDuration;
 406:ServerLLDN.c  **** 				associated = 1;
 407:ServerLLDN.c  **** 				printf("\nRecebeu conf request");
 408:ServerLLDN.c  **** 			}
 409:ServerLLDN.c  **** 		}
 410:ServerLLDN.c  **** 		return true;
 411:ServerLLDN.c  **** 	}
 412:ServerLLDN.c  **** 
 413:ServerLLDN.c  **** 	void appPrepareDiscoverResponse()
 414:ServerLLDN.c  **** 	{
 415:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 416:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_COMMAND_ENDPOINT;
 417:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_COMMAND_ENDPOINT;
 418:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_MAC_COMMAND;
 419:ServerLLDN.c  **** 		msgReq.data					= (uint8_t*)&msgDiscResponse;
 420:ServerLLDN.c  **** 		msgReq.size					= sizeof(msgDiscResponse);
 421:ServerLLDN.c  **** 	}
 422:ServerLLDN.c  **** 	
 423:ServerLLDN.c  **** 	void appPrepareConfigurationStatus()
 424:ServerLLDN.c  **** 	{		
 425:ServerLLDN.c  **** 		msgReq.dstAddr				= 0;
 426:ServerLLDN.c  **** 		msgReq.dstEndpoint			= APP_COMMAND_ENDPOINT;
 427:ServerLLDN.c  **** 		msgReq.srcEndpoint			= APP_COMMAND_ENDPOINT;
 428:ServerLLDN.c  **** 		msgReq.options				= NWK_OPT_MAC_COMMAND;
 429:ServerLLDN.c  **** 		msgReq.data					= (uint8_t*)&msgConfigStatus;
 430:ServerLLDN.c  **** 		msgReq.size					= sizeof(msgConfigStatus);
 431:ServerLLDN.c  **** 	}
 432:ServerLLDN.c  **** 	
 433:ServerLLDN.c  **** #endif // APP_COORDINATOR
 434:ServerLLDN.c  **** 
 435:ServerLLDN.c  **** static void appInit(void)
 436:ServerLLDN.c  **** {
 1814               		.loc 6 436 0
 1815               		.cfi_startproc
 1816 08ec CF93      		push r28
 1817               	.LCFI78:
 1818               		.cfi_def_cfa_offset 3
 1819               		.cfi_offset 28, -2
 1820 08ee DF93      		push r29
 1821               	.LCFI79:
 1822               		.cfi_def_cfa_offset 4
 1823               		.cfi_offset 29, -3
 1824 08f0 CDB7      		in r28,__SP_L__
 1825 08f2 DEB7      		in r29,__SP_H__
 1826               	.LCFI80:
 1827               		.cfi_def_cfa_register 28
 1828               	/* prologue: function */
 1829               	/* frame size = 0 */
 1830               	/* stack size = 2 */
 1831               	.L__stack_usage = 2
 437:ServerLLDN.c  **** 	NWK_SetAddr(APP_ADDR);
 1832               		.loc 6 437 0
 1833 08f4 80E0      		ldi r24,0
 1834 08f6 90E0      		ldi r25,0
 1835 08f8 0E94 0000 		call NWK_SetAddr
 438:ServerLLDN.c  **** 	PHY_SetChannel(APP_CHANNEL);
 1836               		.loc 6 438 0
 1837 08fc 8FE0      		ldi r24,lo8(15)
 1838 08fe 0E94 0000 		call PHY_SetChannel
 439:ServerLLDN.c  **** 	PHY_SetRxState(true);
 1839               		.loc 6 439 0
 1840 0902 81E0      		ldi r24,lo8(1)
 1841 0904 0E94 0000 		call PHY_SetRxState
 440:ServerLLDN.c  **** 		
 441:ServerLLDN.c  **** 	#if APP_COORDINATOR	 
 442:ServerLLDN.c  **** 		/* Timer used for delay between messages */
 443:ServerLLDN.c  **** 		tmrDelay.interval = 2;
 1842               		.loc 6 443 0
 1843 0908 82E0      		ldi r24,lo8(2)
 1844 090a 90E0      		ldi r25,0
 1845 090c A0E0      		ldi r26,0
 1846 090e B0E0      		ldi r27,0
 1847 0910 8093 0000 		sts tmrDelay+6,r24
 1848 0914 9093 0000 		sts tmrDelay+6+1,r25
 1849 0918 A093 0000 		sts tmrDelay+6+2,r26
 1850 091c B093 0000 		sts tmrDelay+6+3,r27
 444:ServerLLDN.c  **** 		tmrDelay.mode = SYS_TIMER_INTERVAL_MODE;
 1851               		.loc 6 444 0
 1852 0920 1092 0000 		sts tmrDelay+10,__zero_reg__
 445:ServerLLDN.c  **** 		tmrDelay.handler = tmrDelayHandler;
 1853               		.loc 6 445 0
 1854 0924 80E0      		ldi r24,lo8(gs(tmrDelayHandler))
 1855 0926 90E0      		ldi r25,hi8(gs(tmrDelayHandler))
 1856 0928 9093 0000 		sts tmrDelay+11+1,r25
 1857 092c 8093 0000 		sts tmrDelay+11,r24
 446:ServerLLDN.c  **** 	  
 447:ServerLLDN.c  **** 		/* 
 448:ServerLLDN.c  **** 		* Disable CSMA/CA
 449:ServerLLDN.c  **** 		* Disable auto ACK
 450:ServerLLDN.c  **** 		*/
 451:ServerLLDN.c  **** 		NWK_SetPanId(APP_PANID);
 1858               		.loc 6 451 0
 1859 0930 8EEF      		ldi r24,lo8(-2)
 1860 0932 9AEC      		ldi r25,lo8(-54)
 1861 0934 0E94 0000 		call NWK_SetPanId
 452:ServerLLDN.c  **** 		PanId = APP_PANID;
 1862               		.loc 6 452 0
 1863 0938 8EEF      		ldi r24,lo8(-2)
 1864 093a 8093 0000 		sts PanId,r24
 453:ServerLLDN.c  **** 		ACKFrame.sourceId = APP_PANID;
 1865               		.loc 6 453 0
 1866 093e 8EEF      		ldi r24,lo8(-2)
 1867 0940 8093 0000 		sts ACKFrame,r24
 454:ServerLLDN.c  **** 		PHY_SetTdmaMode(true);
 1868               		.loc 6 454 0
 1869 0944 81E0      		ldi r24,lo8(1)
 1870 0946 0E94 0000 		call PHY_SetTdmaMode
 455:ServerLLDN.c  **** 	NWK_OpenEndpoint(APP_COMMAND_ENDPOINT, appCommandInd);
 1871               		.loc 6 455 0
 1872 094a 60E0      		ldi r22,lo8(gs(appCommandInd))
 1873 094c 70E0      		ldi r23,hi8(gs(appCommandInd))
 1874 094e 83E0      		ldi r24,lo8(3)
 1875 0950 0E94 0000 		call NWK_OpenEndpoint
 456:ServerLLDN.c  **** 	#else
 457:ServerLLDN.c  **** 		/*
 458:ServerLLDN.c  **** 		 * Enable CSMA/CA
 459:ServerLLDN.c  **** 		 * Enable Random CSMA seed generator
 460:ServerLLDN.c  **** 		 */
 461:ServerLLDN.c  **** 		PHY_SetTdmaMode(false);
 462:ServerLLDN.c  **** 		// PHY_SetOptimizedCSMAValues();
 463:ServerLLDN.c  **** 		
 464:ServerLLDN.c  **** 		payloadSize = 0x01;
 465:ServerLLDN.c  **** 		NWK_OpenEndpoint(APP_BEACON_ENDPOINT, appBeaconInd);
 466:ServerLLDN.c  **** 		NWK_OpenEndpoint(APP_ACK_ENDPOINT, appAckInd);
 467:ServerLLDN.c  **** 		NWK_OpenEndpoint(APP_COMMAND_ENDPOINT, appCommandInd);
 468:ServerLLDN.c  **** 		/*
 469:ServerLLDN.c  **** 		* Configure interrupts callback functions
 470:ServerLLDN.c  **** 		*/
 471:ServerLLDN.c  **** 		
 472:ServerLLDN.c  **** 	#endif // APP_COORDENATOR
 473:ServerLLDN.c  **** 	PHY_SetPromiscuousMode(true);
 1876               		.loc 6 473 0
 1877 0954 81E0      		ldi r24,lo8(1)
 1878 0956 0E94 0000 		call PHY_SetPromiscuousMode
 474:ServerLLDN.c  **** 
 475:ServerLLDN.c  **** }
 1879               		.loc 6 475 0
 1880 095a 0000      		nop
 1881               	/* epilogue start */
 1882 095c DF91      		pop r29
 1883 095e CF91      		pop r28
 1884 0960 0895      		ret
 1885               		.cfi_endproc
 1886               	.LFE144:
 1888               		.section	.rodata
 1889               	.LC6:
 1890 0043 0A25 642C 		.string	"\n%d, %d"
 1890      2025 6400 
 1891               		.text
 1893               	APP_TaskHandler:
 1894               	.LFB145:
 476:ServerLLDN.c  **** 
 477:ServerLLDN.c  **** static void APP_TaskHandler(void)
 478:ServerLLDN.c  **** {
 1895               		.loc 6 478 0
 1896               		.cfi_startproc
 1897 0962 CF93      		push r28
 1898               	.LCFI81:
 1899               		.cfi_def_cfa_offset 3
 1900               		.cfi_offset 28, -2
 1901 0964 DF93      		push r29
 1902               	.LCFI82:
 1903               		.cfi_def_cfa_offset 4
 1904               		.cfi_offset 29, -3
 1905 0966 CDB7      		in r28,__SP_L__
 1906 0968 DEB7      		in r29,__SP_H__
 1907               	.LCFI83:
 1908               		.cfi_def_cfa_register 28
 1909               	/* prologue: function */
 1910               	/* frame size = 0 */
 1911               	/* stack size = 2 */
 1912               	.L__stack_usage = 2
 479:ServerLLDN.c  **** 	switch (appState){
 1913               		.loc 6 479 0
 1914 096a 8091 0000 		lds r24,appState
 1915 096e 882F      		mov r24,r24
 1916 0970 90E0      		ldi r25,0
 1917 0972 8230      		cpi r24,2
 1918 0974 9105      		cpc r25,__zero_reg__
 1919 0976 01F0      		breq .L53
 1920 0978 8330      		cpi r24,3
 1921 097a 9105      		cpc r25,__zero_reg__
 1922 097c 01F0      		breq .L54
 1923 097e 892B      		or r24,r25
 1924 0980 01F0      		breq .L55
 480:ServerLLDN.c  **** 		case APP_STATE_INITIAL:
 481:ServerLLDN.c  **** 		{
 482:ServerLLDN.c  **** 			appInit();
 483:ServerLLDN.c  **** 			#if APP_COORDINATOR
 484:ServerLLDN.c  **** 				appState = APP_STATE_ATT_PAN_STATE;
 485:ServerLLDN.c  **** 			#else
 486:ServerLLDN.c  **** 				appState = APP_STATE_IDLE;
 487:ServerLLDN.c  **** 			#endif
 488:ServerLLDN.c  **** 			break;
 489:ServerLLDN.c  **** 		}
 490:ServerLLDN.c  **** 		case APP_STATE_SEND:
 491:ServerLLDN.c  **** 		{
 492:ServerLLDN.c  **** 			appSendData();
 493:ServerLLDN.c  **** 			#if APP_COORDINATOR
 494:ServerLLDN.c  **** 				/* Every time a message is send updates coordinator to prepare next message */
 495:ServerLLDN.c  **** 				appState = APP_STATE_ATT_PAN_STATE;
 496:ServerLLDN.c  **** 			#else
 497:ServerLLDN.c  **** 				appState = APP_STATE_IDLE;
 498:ServerLLDN.c  **** 			#endif
 499:ServerLLDN.c  **** 			break;
 500:ServerLLDN.c  **** 		}
 501:ServerLLDN.c  **** 		#if APP_COORDINATOR // COORDINATOR SPECIFIC STATE MACHINE
 502:ServerLLDN.c  **** 		case APP_STATE_ATT_PAN_STATE:
 503:ServerLLDN.c  **** 		{
 504:ServerLLDN.c  **** 			switch(appPanState)
 505:ServerLLDN.c  **** 			{
 506:ServerLLDN.c  **** 				/* Prepare beacon to desassociate all nodes */
 507:ServerLLDN.c  **** 				case APP_PAN_STATE_RESET:
 508:ServerLLDN.c  **** 				{
 509:ServerLLDN.c  **** 					appPanReset();
 510:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 511:ServerLLDN.c  **** 					appState	= APP_STATE_SEND;
 512:ServerLLDN.c  **** 					cycles_counter = 0;
 513:ServerLLDN.c  **** 					break;
 514:ServerLLDN.c  **** 				}
 515:ServerLLDN.c  **** 				/* Prepare first Beacon of Discovery */
 516:ServerLLDN.c  **** 				case APP_PAN_STATE_DISC_INITIAL:
 517:ServerLLDN.c  **** 				{
 518:ServerLLDN.c  **** 					/* if nodes associated is equal to expected number of associated nodes stop association proces
 519:ServerLLDN.c  **** 					 * this implementation was done as is to be used in tests, for real network functionality 
 520:ServerLLDN.c  **** 					 * the number of max association processes must be done through macLLDNdiscoveryModeTimeout
 521:ServerLLDN.c  **** 					 */
 522:ServerLLDN.c  **** 					if(counter_associados == NODOS_ASSOCIADOS_ESPERADOS || cycles_counter >= 2)
 523:ServerLLDN.c  **** 					{	
 524:ServerLLDN.c  **** 						printf("\n%d, %d", cycles_counter, counter_associados);
 525:ServerLLDN.c  **** 						counter_associados = 0;
 526:ServerLLDN.c  **** 						/* if all nodes expected where associated stop beacon generation interruptions */
 527:ServerLLDN.c  **** 						macsc_disable_cmp_int(MACSC_CC1);
 528:ServerLLDN.c  **** 						macsc_disable_cmp_int(MACSC_CC2);
 529:ServerLLDN.c  **** 						msgReq.options = 0;
 530:ServerLLDN.c  **** 						/* set coordinator node to idle further implementation of online state must be done */
 531:ServerLLDN.c  **** 						appState = APP_STATE_IDLE;
 532:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_IDLE; // APP_PAN_STATE_ONLINE_INIT
 533:ServerLLDN.c  **** 						
 534:ServerLLDN.c  **** 					}
 535:ServerLLDN.c  **** 					/* if not all nodes expected where associated run through association process again */
 536:ServerLLDN.c  **** 					else 
 537:ServerLLDN.c  **** 					{
 538:ServerLLDN.c  **** 						/* prepare beacon message and start timers for beacon */
 539:ServerLLDN.c  **** 						appPanDiscInit();
 540:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 541:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_DISC_SECOND_BE;
 542:ServerLLDN.c  **** 					}
 543:ServerLLDN.c  **** 					break;
 544:ServerLLDN.c  **** 				}
 545:ServerLLDN.c  **** 				case APP_PAN_STATE_DISC_SECOND_BE:
 546:ServerLLDN.c  **** 				{
 547:ServerLLDN.c  **** 					/* Prepares message as: Discovery Beacon and Second Beacon */
 548:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_DISCOVERY_STATE | NWK_OPT_SECOND_BEACON ;
 549:ServerLLDN.c  **** 					msgReq.data = NULL;
 550:ServerLLDN.c  **** 					msgReq.size = 0;
 551:ServerLLDN.c  **** 					
 552:ServerLLDN.c  **** 					appState	= APP_PAN_STATE_DISC_PREPARE_ACK;
 553:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_PREPARE_ACK;
 554:ServerLLDN.c  **** 					break;
 555:ServerLLDN.c  **** 				}
 556:ServerLLDN.c  **** 				case APP_PAN_STATE_DISC_PREPARE_ACK:
 557:ServerLLDN.c  **** 				{
 558:ServerLLDN.c  **** 					/* This timer implements a delay between messages, 
 559:ServerLLDN.c  **** 					 * if not used the nodes are not able to receive the message
 560:ServerLLDN.c  **** 					 */
 561:ServerLLDN.c  **** 					appPanPrepareACK();
 562:ServerLLDN.c  **** 					SYS_TimerStart(&tmrDelay);
 563:ServerLLDN.c  **** 					
 564:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_CONFIG_INITIAL; 
 565:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 566:ServerLLDN.c  **** 					break;
 567:ServerLLDN.c  **** 				}
 568:ServerLLDN.c  **** 				case APP_PAN_STATE_CONFIG_INITIAL:
 569:ServerLLDN.c  **** 				{
 570:ServerLLDN.c  **** 					/* Prepares the message as: Configuration Beacon and First State Beacon */
 571:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_CONFIG_STATE;
 572:ServerLLDN.c  **** 					msgReq.data = NULL;
 573:ServerLLDN.c  **** 					msgReq.size = 0;
 574:ServerLLDN.c  **** 					
 575:ServerLLDN.c  **** 					appState	= APP_STATE_IDLE;
 576:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_CONFIG_SECOND_BEACON;
 577:ServerLLDN.c  **** 					break;
 578:ServerLLDN.c  **** 
 579:ServerLLDN.c  **** 				}
 580:ServerLLDN.c  **** 				case APP_PAN_STATE_CONFIG_SECOND_BEACON:
 581:ServerLLDN.c  **** 				{
 582:ServerLLDN.c  **** 					/* Prepares the message as: Configuration Beacon and Second State Beacon */
 583:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_CONFIG_STATE | NWK_OPT_SECOND_BEACON;
 584:ServerLLDN.c  **** 					msgReq.data = NULL;
 585:ServerLLDN.c  **** 					msgReq.size = 0;
 586:ServerLLDN.c  **** 					
 587:ServerLLDN.c  **** 					appState	= APP_STATE_IDLE;
 588:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 589:ServerLLDN.c  **** 					break;
 590:ServerLLDN.c  **** 				}
 591:ServerLLDN.c  **** 				case APP_PAN_STATE_SEND_CONF_REQUEST:
 592:ServerLLDN.c  **** 				{
 593:ServerLLDN.c  **** 
 594:ServerLLDN.c  **** 					if(conf_req_index > 0)
 595:ServerLLDN.c  **** 					{
 596:ServerLLDN.c  **** 						CopyToConfigRequest(conf_req_index);
 597:ServerLLDN.c  **** 						msgReq.options		= NWK_OPT_MAC_COMMAND;
 598:ServerLLDN.c  **** 						msgReq.data			= (uint8_t*)&config_request_frame;
 599:ServerLLDN.c  **** 						msgReq.size			= sizeof(NWK_ConfigRequest_t);
 600:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 601:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 602:ServerLLDN.c  **** 						conf_req_index--;
 603:ServerLLDN.c  **** 						counter_associados++;
 604:ServerLLDN.c  **** 						SYS_TimerStart(&tmrDelay);
 605:ServerLLDN.c  **** 					}
 606:ServerLLDN.c  **** 					else
 607:ServerLLDN.c  **** 					{
 608:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_CONFIG_THIRD_BEACON;
 609:ServerLLDN.c  **** 					}
 610:ServerLLDN.c  **** 					break;
 611:ServerLLDN.c  **** 				}
 612:ServerLLDN.c  **** 				case APP_PAN_STATE_CONFIG_THIRD_BEACON:
 613:ServerLLDN.c  **** 				{
 614:ServerLLDN.c  **** 					msgReq.options = NWK_OPT_LLDN_BEACON | NWK_OPT_CONFIG_STATE | NWK_OPT_THIRD_BEACON;
 615:ServerLLDN.c  **** 					msgReq.data = NULL;
 616:ServerLLDN.c  **** 					msgReq.size = 0;
 617:ServerLLDN.c  **** 					
 618:ServerLLDN.c  **** 					appState	= APP_STATE_IDLE;
 619:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 620:ServerLLDN.c  **** 					cycles_counter++;	
 621:ServerLLDN.c  **** 					
 622:ServerLLDN.c  **** 					break;
 623:ServerLLDN.c  **** 				}
 624:ServerLLDN.c  **** 				case APP_PAN_STATE_ONLINE_INITIAL:
 625:ServerLLDN.c  **** 				{
 626:ServerLLDN.c  **** 					appPanOnlineInit();
 627:ServerLLDN.c  **** 					break;
 628:ServerLLDN.c  **** 				}
 629:ServerLLDN.c  **** 				case APP_PAN_STATE_ONLINE_END_BE:
 630:ServerLLDN.c  **** 				{
 631:ServerLLDN.c  **** 					if(0)
 632:ServerLLDN.c  **** 					{
 633:ServerLLDN.c  **** 						// implementar as condies para entrar no processo de associao
 634:ServerLLDN.c  **** 					}
 635:ServerLLDN.c  **** 					else
 636:ServerLLDN.c  **** 					{
 637:ServerLLDN.c  **** 						// posso calcular esse valor no onlineinit, o tTS precisa ser recalculado, o seu valor muda n
 638:ServerLLDN.c  **** 						// pode voltar pro state_online_initial porque precisa reconfigurar os timers
 639:ServerLLDN.c  **** 						// precisa revisar o macsc_enable_manual_bts()
 640:ServerLLDN.c  **** 						/*
 641:ServerLLDN.c  **** 						int idle_time =  2 * numBaseTimeSlotperMgmt * (tTS) * 5 / (SYMBOL_TIME); // 5 is the total of
 642:ServerLLDN.c  **** 						macsc_set_cmp1_int_cb(lldn_server_beacon); // esta funo pode s mandar o beacon do online, 
 643:ServerLLDN.c  **** 						macsc_enable_manual_bts();
 644:ServerLLDN.c  **** 						macsc_enable_cmp_int(MACSC_CC1);
 645:ServerLLDN.c  **** 						macsc_use_cmp(MACSC_RELATIVE_CMP, idle_time, MACSC_CC1);
 646:ServerLLDN.c  **** 						*/
 647:ServerLLDN.c  **** 					}
 648:ServerLLDN.c  **** 					break;
 649:ServerLLDN.c  **** 				}
 650:ServerLLDN.c  **** 				case APP_PAN_STATE_IDLE:
 651:ServerLLDN.c  **** 				{
 652:ServerLLDN.c  **** 					msgReq.options = 0;
 653:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 654:ServerLLDN.c  **** 					break;
 655:ServerLLDN.c  **** 				}
 656:ServerLLDN.c  **** 			}
 657:ServerLLDN.c  **** 			break;	
 658:ServerLLDN.c  **** 		}
 659:ServerLLDN.c  **** 		#else // NODES SPECIFIC STATE MACHINE
 660:ServerLLDN.c  **** 		case APP_STATE_PREP_DISC_REPONSE:
 661:ServerLLDN.c  **** 		{
 662:ServerLLDN.c  **** 			appPrepareDiscoverResponse();
 663:ServerLLDN.c  **** 			appState = APP_STATE_IDLE;	
 664:ServerLLDN.c  **** 			break;
 665:ServerLLDN.c  **** 		}
 666:ServerLLDN.c  **** 		
 667:ServerLLDN.c  **** 		case APP_STATE_PREP_CONFIG_STATUS:
 668:ServerLLDN.c  **** 		{
 669:ServerLLDN.c  **** 			// se o nodo recebeu ack na fase do discovery prepara a mensagem de configuration status
 670:ServerLLDN.c  **** 			if(ack_received && rec_beacon->confSeqNumber == 0 && associated == 0) {
 671:ServerLLDN.c  **** 				appPrepareConfigurationStatus();
 672:ServerLLDN.c  **** 			}
 673:ServerLLDN.c  **** 			// se o nodo no recebeu desativa o timer e fica em idle
 674:ServerLLDN.c  **** 			else {
 675:ServerLLDN.c  **** 				#if MASTER_MACSC
 676:ServerLLDN.c  **** 				macsc_disable_cmp_int(MACSC_CC1);
 677:ServerLLDN.c  **** 				#else
 678:ServerLLDN.c  **** 				timer_stop();
 679:ServerLLDN.c  **** 				#endif
 680:ServerLLDN.c  **** 			}
 681:ServerLLDN.c  **** 			ack_received = 0;
 682:ServerLLDN.c  **** 			appState = APP_STATE_IDLE;
 683:ServerLLDN.c  **** 			break;
 684:ServerLLDN.c  **** 		}
 685:ServerLLDN.c  **** 		#endif
 686:ServerLLDN.c  **** 		default:
 687:ServerLLDN.c  **** 		{
 688:ServerLLDN.c  **** 			break;
 1925               		.loc 6 688 0
 1926 0982 00C0      		rjmp .L56
 1927               	.L55:
 482:ServerLLDN.c  **** 			#if APP_COORDINATOR
 1928               		.loc 6 482 0
 1929 0984 0E94 0000 		call appInit
 484:ServerLLDN.c  **** 			#else
 1930               		.loc 6 484 0
 1931 0988 83E0      		ldi r24,lo8(3)
 1932 098a 8093 0000 		sts appState,r24
 488:ServerLLDN.c  **** 		}
 1933               		.loc 6 488 0
 1934 098e 00C0      		rjmp .L56
 1935               	.L53:
 492:ServerLLDN.c  **** 			#if APP_COORDINATOR
 1936               		.loc 6 492 0
 1937 0990 0E94 0000 		call appSendData
 495:ServerLLDN.c  **** 			#else
 1938               		.loc 6 495 0
 1939 0994 83E0      		ldi r24,lo8(3)
 1940 0996 8093 0000 		sts appState,r24
 499:ServerLLDN.c  **** 		}
 1941               		.loc 6 499 0
 1942 099a 00C0      		rjmp .L56
 1943               	.L54:
 504:ServerLLDN.c  **** 			{
 1944               		.loc 6 504 0
 1945 099c 8091 0000 		lds r24,appPanState
 1946 09a0 882F      		mov r24,r24
 1947 09a2 90E0      		ldi r25,0
 1948 09a4 092E      		mov __tmp_reg__,r25
 1949 09a6 000C      		lsl r0
 1950 09a8 AA0B      		sbc r26,r26
 1951 09aa BB0B      		sbc r27,r27
 1952 09ac 40E0      		ldi r20,0
 1953 09ae 50E0      		ldi r21,0
 1954 09b0 2AE0      		ldi r18,lo8(10)
 1955 09b2 30E0      		ldi r19,0
 1956 09b4 841B      		sub r24,r20
 1957 09b6 950B      		sbc r25,r21
 1958 09b8 2817      		cp r18,r24
 1959 09ba 3907      		cpc r19,r25
 1960 09bc 00F4      		brsh .+2
 1961 09be 00C0      		rjmp .L75
 1962 09c0 8050      		subi r24,lo8(-(gs(.L59)))
 1963 09c2 9040      		sbci r25,hi8(-(gs(.L59)))
 1964 09c4 FC01      		movw r30,r24
 1965 09c6 0C94 0000 		jmp __tablejump2__
 1966               		.section	.progmem.gcc_sw_table,"a",@progbits
 1967               		.p2align	1
 1968               	.L59:
 1969 0000 0000      		.word gs(.L58)
 1970 0002 0000      		.word gs(.L60)
 1971 0004 0000      		.word gs(.L61)
 1972 0006 0000      		.word gs(.L62)
 1973 0008 0000      		.word gs(.L63)
 1974 000a 0000      		.word gs(.L64)
 1975 000c 0000      		.word gs(.L65)
 1976 000e 0000      		.word gs(.L66)
 1977 0010 0000      		.word gs(.L67)
 1978 0012 0000      		.word gs(.L68)
 1979 0014 0000      		.word gs(.L76)
 1980               		.text
 1981               	.L60:
 509:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 1982               		.loc 6 509 0
 1983 09ca 0E94 0000 		call appPanReset
 510:ServerLLDN.c  **** 					appState	= APP_STATE_SEND;
 1984               		.loc 6 510 0
 1985 09ce 82E0      		ldi r24,lo8(2)
 1986 09d0 8093 0000 		sts appPanState,r24
 511:ServerLLDN.c  **** 					cycles_counter = 0;
 1987               		.loc 6 511 0
 1988 09d4 82E0      		ldi r24,lo8(2)
 1989 09d6 8093 0000 		sts appState,r24
 512:ServerLLDN.c  **** 					break;
 1990               		.loc 6 512 0
 1991 09da 1092 0000 		sts cycles_counter,__zero_reg__
 513:ServerLLDN.c  **** 				}
 1992               		.loc 6 513 0
 1993 09de 00C0      		rjmp .L57
 1994               	.L61:
 522:ServerLLDN.c  **** 					{	
 1995               		.loc 6 522 0
 1996 09e0 8091 0000 		lds r24,counter_associados
 1997 09e4 9091 0000 		lds r25,counter_associados+1
 1998 09e8 0C97      		sbiw r24,12
 1999 09ea 01F0      		breq .L70
 522:ServerLLDN.c  **** 					{	
 2000               		.loc 6 522 0 is_stmt 0 discriminator 1
 2001 09ec 8091 0000 		lds r24,cycles_counter
 2002 09f0 8230      		cpi r24,lo8(2)
 2003 09f2 00F0      		brlo .L71
 2004               	.L70:
 524:ServerLLDN.c  **** 						counter_associados = 0;
 2005               		.loc 6 524 0 is_stmt 1
 2006 09f4 2091 0000 		lds r18,counter_associados
 2007 09f8 3091 0000 		lds r19,counter_associados+1
 2008 09fc 8091 0000 		lds r24,cycles_counter
 2009 0a00 882F      		mov r24,r24
 2010 0a02 90E0      		ldi r25,0
 2011 0a04 432F      		mov r20,r19
 2012 0a06 4F93      		push r20
 2013 0a08 2F93      		push r18
 2014 0a0a 292F      		mov r18,r25
 2015 0a0c 2F93      		push r18
 2016 0a0e 8F93      		push r24
 2017 0a10 80E0      		ldi r24,lo8(.LC6)
 2018 0a12 90E0      		ldi r25,hi8(.LC6)
 2019 0a14 892F      		mov r24,r25
 2020 0a16 8F93      		push r24
 2021 0a18 80E0      		ldi r24,lo8(.LC6)
 2022 0a1a 90E0      		ldi r25,hi8(.LC6)
 2023 0a1c 8F93      		push r24
 2024 0a1e 0E94 0000 		call printf
 2025 0a22 0F90      		pop __tmp_reg__
 2026 0a24 0F90      		pop __tmp_reg__
 2027 0a26 0F90      		pop __tmp_reg__
 2028 0a28 0F90      		pop __tmp_reg__
 2029 0a2a 0F90      		pop __tmp_reg__
 2030 0a2c 0F90      		pop __tmp_reg__
 525:ServerLLDN.c  **** 						/* if all nodes expected where associated stop beacon generation interruptions */
 2031               		.loc 6 525 0
 2032 0a2e 1092 0000 		sts counter_associados+1,__zero_reg__
 2033 0a32 1092 0000 		sts counter_associados,__zero_reg__
 527:ServerLLDN.c  **** 						macsc_disable_cmp_int(MACSC_CC2);
 2034               		.loc 6 527 0
 2035 0a36 81E0      		ldi r24,lo8(1)
 2036 0a38 0E94 0000 		call macsc_disable_cmp_int
 528:ServerLLDN.c  **** 						msgReq.options = 0;
 2037               		.loc 6 528 0
 2038 0a3c 82E0      		ldi r24,lo8(2)
 2039 0a3e 0E94 0000 		call macsc_disable_cmp_int
 529:ServerLLDN.c  **** 						/* set coordinator node to idle further implementation of online state must be done */
 2040               		.loc 6 529 0
 2041 0a42 1092 0000 		sts msgReq+9+1,__zero_reg__
 2042 0a46 1092 0000 		sts msgReq+9,__zero_reg__
 531:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_IDLE; // APP_PAN_STATE_ONLINE_INIT
 2043               		.loc 6 531 0
 2044 0a4a 81E0      		ldi r24,lo8(1)
 2045 0a4c 8093 0000 		sts appState,r24
 532:ServerLLDN.c  **** 						
 2046               		.loc 6 532 0
 2047 0a50 1092 0000 		sts appPanState,__zero_reg__
 543:ServerLLDN.c  **** 				}
 2048               		.loc 6 543 0
 2049 0a54 00C0      		rjmp .L57
 2050               	.L71:
 539:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 2051               		.loc 6 539 0
 2052 0a56 0E94 0000 		call appPanDiscInit
 540:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_DISC_SECOND_BE;
 2053               		.loc 6 540 0
 2054 0a5a 81E0      		ldi r24,lo8(1)
 2055 0a5c 8093 0000 		sts appState,r24
 541:ServerLLDN.c  **** 					}
 2056               		.loc 6 541 0
 2057 0a60 83E0      		ldi r24,lo8(3)
 2058 0a62 8093 0000 		sts appPanState,r24
 543:ServerLLDN.c  **** 				}
 2059               		.loc 6 543 0
 2060 0a66 00C0      		rjmp .L57
 2061               	.L62:
 548:ServerLLDN.c  **** 					msgReq.data = NULL;
 2062               		.loc 6 548 0
 2063 0a68 80E4      		ldi r24,lo8(64)
 2064 0a6a 99E0      		ldi r25,lo8(9)
 2065 0a6c 9093 0000 		sts msgReq+9+1,r25
 2066 0a70 8093 0000 		sts msgReq+9,r24
 549:ServerLLDN.c  **** 					msgReq.size = 0;
 2067               		.loc 6 549 0
 2068 0a74 1092 0000 		sts msgReq+13+1,__zero_reg__
 2069 0a78 1092 0000 		sts msgReq+13,__zero_reg__
 550:ServerLLDN.c  **** 					
 2070               		.loc 6 550 0
 2071 0a7c 1092 0000 		sts msgReq+15,__zero_reg__
 552:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_PREPARE_ACK;
 2072               		.loc 6 552 0
 2073 0a80 84E0      		ldi r24,lo8(4)
 2074 0a82 8093 0000 		sts appState,r24
 553:ServerLLDN.c  **** 					break;
 2075               		.loc 6 553 0
 2076 0a86 84E0      		ldi r24,lo8(4)
 2077 0a88 8093 0000 		sts appPanState,r24
 554:ServerLLDN.c  **** 				}
 2078               		.loc 6 554 0
 2079 0a8c 00C0      		rjmp .L57
 2080               	.L63:
 561:ServerLLDN.c  **** 					SYS_TimerStart(&tmrDelay);
 2081               		.loc 6 561 0
 2082 0a8e 0E94 0000 		call appPanPrepareACK
 562:ServerLLDN.c  **** 					
 2083               		.loc 6 562 0
 2084 0a92 80E0      		ldi r24,lo8(tmrDelay)
 2085 0a94 90E0      		ldi r25,hi8(tmrDelay)
 2086 0a96 0E94 0000 		call SYS_TimerStart
 564:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 2087               		.loc 6 564 0
 2088 0a9a 85E0      		ldi r24,lo8(5)
 2089 0a9c 8093 0000 		sts appPanState,r24
 565:ServerLLDN.c  **** 					break;
 2090               		.loc 6 565 0
 2091 0aa0 81E0      		ldi r24,lo8(1)
 2092 0aa2 8093 0000 		sts appState,r24
 566:ServerLLDN.c  **** 				}
 2093               		.loc 6 566 0
 2094 0aa6 00C0      		rjmp .L57
 2095               	.L64:
 571:ServerLLDN.c  **** 					msgReq.data = NULL;
 2096               		.loc 6 571 0
 2097 0aa8 80E4      		ldi r24,lo8(64)
 2098 0aaa 92E0      		ldi r25,lo8(2)
 2099 0aac 9093 0000 		sts msgReq+9+1,r25
 2100 0ab0 8093 0000 		sts msgReq+9,r24
 572:ServerLLDN.c  **** 					msgReq.size = 0;
 2101               		.loc 6 572 0
 2102 0ab4 1092 0000 		sts msgReq+13+1,__zero_reg__
 2103 0ab8 1092 0000 		sts msgReq+13,__zero_reg__
 573:ServerLLDN.c  **** 					
 2104               		.loc 6 573 0
 2105 0abc 1092 0000 		sts msgReq+15,__zero_reg__
 575:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_CONFIG_SECOND_BEACON;
 2106               		.loc 6 575 0
 2107 0ac0 81E0      		ldi r24,lo8(1)
 2108 0ac2 8093 0000 		sts appState,r24
 576:ServerLLDN.c  **** 					break;
 2109               		.loc 6 576 0
 2110 0ac6 87E0      		ldi r24,lo8(7)
 2111 0ac8 8093 0000 		sts appPanState,r24
 577:ServerLLDN.c  **** 
 2112               		.loc 6 577 0
 2113 0acc 00C0      		rjmp .L57
 2114               	.L66:
 583:ServerLLDN.c  **** 					msgReq.data = NULL;
 2115               		.loc 6 583 0
 2116 0ace 80E4      		ldi r24,lo8(64)
 2117 0ad0 9AE0      		ldi r25,lo8(10)
 2118 0ad2 9093 0000 		sts msgReq+9+1,r25
 2119 0ad6 8093 0000 		sts msgReq+9,r24
 584:ServerLLDN.c  **** 					msgReq.size = 0;
 2120               		.loc 6 584 0
 2121 0ada 1092 0000 		sts msgReq+13+1,__zero_reg__
 2122 0ade 1092 0000 		sts msgReq+13,__zero_reg__
 585:ServerLLDN.c  **** 					
 2123               		.loc 6 585 0
 2124 0ae2 1092 0000 		sts msgReq+15,__zero_reg__
 587:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 2125               		.loc 6 587 0
 2126 0ae6 81E0      		ldi r24,lo8(1)
 2127 0ae8 8093 0000 		sts appState,r24
 588:ServerLLDN.c  **** 					break;
 2128               		.loc 6 588 0
 2129 0aec 86E0      		ldi r24,lo8(6)
 2130 0aee 8093 0000 		sts appPanState,r24
 589:ServerLLDN.c  **** 				}
 2131               		.loc 6 589 0
 2132 0af2 00C0      		rjmp .L57
 2133               	.L65:
 594:ServerLLDN.c  **** 					{
 2134               		.loc 6 594 0
 2135 0af4 8091 0000 		lds r24,conf_req_index
 2136 0af8 9091 0000 		lds r25,conf_req_index+1
 2137 0afc 1816      		cp __zero_reg__,r24
 2138 0afe 1906      		cpc __zero_reg__,r25
 2139 0b00 04F4      		brge .L73
 596:ServerLLDN.c  **** 						msgReq.options		= NWK_OPT_MAC_COMMAND;
 2140               		.loc 6 596 0
 2141 0b02 8091 0000 		lds r24,conf_req_index
 2142 0b06 9091 0000 		lds r25,conf_req_index+1
 2143 0b0a 0E94 0000 		call CopyToConfigRequest
 597:ServerLLDN.c  **** 						msgReq.data			= (uint8_t*)&config_request_frame;
 2144               		.loc 6 597 0
 2145 0b0e 80E0      		ldi r24,0
 2146 0b10 90E8      		ldi r25,lo8(-128)
 2147 0b12 9093 0000 		sts msgReq+9+1,r25
 2148 0b16 8093 0000 		sts msgReq+9,r24
 598:ServerLLDN.c  **** 						msgReq.size			= sizeof(NWK_ConfigRequest_t);
 2149               		.loc 6 598 0
 2150 0b1a 80E0      		ldi r24,lo8(config_request_frame)
 2151 0b1c 90E0      		ldi r25,hi8(config_request_frame)
 2152 0b1e 9093 0000 		sts msgReq+13+1,r25
 2153 0b22 8093 0000 		sts msgReq+13,r24
 599:ServerLLDN.c  **** 						appState	= APP_STATE_IDLE;
 2154               		.loc 6 599 0
 2155 0b26 86E0      		ldi r24,lo8(6)
 2156 0b28 8093 0000 		sts msgReq+15,r24
 600:ServerLLDN.c  **** 						appPanState = APP_PAN_STATE_SEND_CONF_REQUEST;
 2157               		.loc 6 600 0
 2158 0b2c 81E0      		ldi r24,lo8(1)
 2159 0b2e 8093 0000 		sts appState,r24
 601:ServerLLDN.c  **** 						conf_req_index--;
 2160               		.loc 6 601 0
 2161 0b32 86E0      		ldi r24,lo8(6)
 2162 0b34 8093 0000 		sts appPanState,r24
 602:ServerLLDN.c  **** 						counter_associados++;
 2163               		.loc 6 602 0
 2164 0b38 8091 0000 		lds r24,conf_req_index
 2165 0b3c 9091 0000 		lds r25,conf_req_index+1
 2166 0b40 0197      		sbiw r24,1
 2167 0b42 9093 0000 		sts conf_req_index+1,r25
 2168 0b46 8093 0000 		sts conf_req_index,r24
 603:ServerLLDN.c  **** 						SYS_TimerStart(&tmrDelay);
 2169               		.loc 6 603 0
 2170 0b4a 8091 0000 		lds r24,counter_associados
 2171 0b4e 9091 0000 		lds r25,counter_associados+1
 2172 0b52 0196      		adiw r24,1
 2173 0b54 9093 0000 		sts counter_associados+1,r25
 2174 0b58 8093 0000 		sts counter_associados,r24
 604:ServerLLDN.c  **** 					}
 2175               		.loc 6 604 0
 2176 0b5c 80E0      		ldi r24,lo8(tmrDelay)
 2177 0b5e 90E0      		ldi r25,hi8(tmrDelay)
 2178 0b60 0E94 0000 		call SYS_TimerStart
 610:ServerLLDN.c  **** 				}
 2179               		.loc 6 610 0
 2180 0b64 00C0      		rjmp .L57
 2181               	.L73:
 608:ServerLLDN.c  **** 					}
 2182               		.loc 6 608 0
 2183 0b66 88E0      		ldi r24,lo8(8)
 2184 0b68 8093 0000 		sts appPanState,r24
 610:ServerLLDN.c  **** 				}
 2185               		.loc 6 610 0
 2186 0b6c 00C0      		rjmp .L57
 2187               	.L67:
 614:ServerLLDN.c  **** 					msgReq.data = NULL;
 2188               		.loc 6 614 0
 2189 0b6e 80E4      		ldi r24,lo8(64)
 2190 0b70 92E1      		ldi r25,lo8(18)
 2191 0b72 9093 0000 		sts msgReq+9+1,r25
 2192 0b76 8093 0000 		sts msgReq+9,r24
 615:ServerLLDN.c  **** 					msgReq.size = 0;
 2193               		.loc 6 615 0
 2194 0b7a 1092 0000 		sts msgReq+13+1,__zero_reg__
 2195 0b7e 1092 0000 		sts msgReq+13,__zero_reg__
 616:ServerLLDN.c  **** 					
 2196               		.loc 6 616 0
 2197 0b82 1092 0000 		sts msgReq+15,__zero_reg__
 618:ServerLLDN.c  **** 					appPanState = APP_PAN_STATE_DISC_INITIAL;
 2198               		.loc 6 618 0
 2199 0b86 81E0      		ldi r24,lo8(1)
 2200 0b88 8093 0000 		sts appState,r24
 619:ServerLLDN.c  **** 					cycles_counter++;	
 2201               		.loc 6 619 0
 2202 0b8c 82E0      		ldi r24,lo8(2)
 2203 0b8e 8093 0000 		sts appPanState,r24
 620:ServerLLDN.c  **** 					
 2204               		.loc 6 620 0
 2205 0b92 8091 0000 		lds r24,cycles_counter
 2206 0b96 8F5F      		subi r24,lo8(-(1))
 2207 0b98 8093 0000 		sts cycles_counter,r24
 622:ServerLLDN.c  **** 				}
 2208               		.loc 6 622 0
 2209 0b9c 00C0      		rjmp .L57
 2210               	.L68:
 626:ServerLLDN.c  **** 					break;
 2211               		.loc 6 626 0
 2212 0b9e 0E94 0000 		call appPanOnlineInit
 627:ServerLLDN.c  **** 				}
 2213               		.loc 6 627 0
 2214 0ba2 00C0      		rjmp .L57
 2215               	.L58:
 652:ServerLLDN.c  **** 					appState = APP_STATE_IDLE;
 2216               		.loc 6 652 0
 2217 0ba4 1092 0000 		sts msgReq+9+1,__zero_reg__
 2218 0ba8 1092 0000 		sts msgReq+9,__zero_reg__
 653:ServerLLDN.c  **** 					break;
 2219               		.loc 6 653 0
 2220 0bac 81E0      		ldi r24,lo8(1)
 2221 0bae 8093 0000 		sts appState,r24
 654:ServerLLDN.c  **** 				}
 2222               		.loc 6 654 0
 2223 0bb2 00C0      		rjmp .L57
 2224               	.L76:
 648:ServerLLDN.c  **** 				}
 2225               		.loc 6 648 0
 2226 0bb4 0000      		nop
 2227               	.L57:
 2228               	.L75:
 657:ServerLLDN.c  **** 		}
 2229               		.loc 6 657 0
 2230 0bb6 0000      		nop
 2231               	.L56:
 689:ServerLLDN.c  **** 		}
 690:ServerLLDN.c  **** 	}
 691:ServerLLDN.c  **** }
 2232               		.loc 6 691 0
 2233 0bb8 0000      		nop
 2234               	/* epilogue start */
 2235 0bba DF91      		pop r29
 2236 0bbc CF91      		pop r28
 2237 0bbe 0895      		ret
 2238               		.cfi_endproc
 2239               	.LFE145:
 2241               		.section	.rodata
 2242               	.LC0:
 2243 004b 00        		.byte	0
 2244 004c C2        		.byte	-62
 2245 004d 01        		.byte	1
 2246 004e 00        		.byte	0
 2247 004f 03        		.byte	3
 2248 0050 00        		.byte	0
 2249 0051 00        		.byte	0
 2250               		.text
 2251               	.global	main
 2253               	main:
 2254               	.LFB146:
 692:ServerLLDN.c  **** 
 693:ServerLLDN.c  **** 	/*****************************************************************************
 694:ServerLLDN.c  **** 	*****************************************************************************/
 695:ServerLLDN.c  **** 	int main(void)
 696:ServerLLDN.c  **** 	{
 2255               		.loc 6 696 0
 2256               		.cfi_startproc
 2257 0bc0 0F93      		push r16
 2258               	.LCFI84:
 2259               		.cfi_def_cfa_offset 3
 2260               		.cfi_offset 16, -2
 2261 0bc2 1F93      		push r17
 2262               	.LCFI85:
 2263               		.cfi_def_cfa_offset 4
 2264               		.cfi_offset 17, -3
 2265 0bc4 CF93      		push r28
 2266               	.LCFI86:
 2267               		.cfi_def_cfa_offset 5
 2268               		.cfi_offset 28, -4
 2269 0bc6 DF93      		push r29
 2270               	.LCFI87:
 2271               		.cfi_def_cfa_offset 6
 2272               		.cfi_offset 29, -5
 2273 0bc8 CDB7      		in r28,__SP_L__
 2274 0bca DEB7      		in r29,__SP_H__
 2275               	.LCFI88:
 2276               		.cfi_def_cfa_register 28
 2277 0bcc 2797      		sbiw r28,7
 2278               	.LCFI89:
 2279               		.cfi_def_cfa_offset 13
 2280 0bce 0FB6      		in __tmp_reg__,__SREG__
 2281 0bd0 F894      		cli
 2282 0bd2 DEBF      		out __SP_H__,r29
 2283 0bd4 0FBE      		out __SREG__,__tmp_reg__
 2284 0bd6 CDBF      		out __SP_L__,r28
 2285               	/* prologue: function */
 2286               	/* frame size = 7 */
 2287               	/* stack size = 11 */
 2288               	.L__stack_usage = 11
 697:ServerLLDN.c  **** 		sysclk_init();
 2289               		.loc 6 697 0
 2290 0bd8 0E94 0000 		call sysclk_init
 698:ServerLLDN.c  **** 		board_init();
 2291               		.loc 6 698 0
 2292 0bdc 0E94 0000 		call board_init
 699:ServerLLDN.c  **** 
 700:ServerLLDN.c  **** 		SYS_Init();
 2293               		.loc 6 700 0
 2294 0be0 0E94 0000 		call SYS_Init
 701:ServerLLDN.c  **** 		/* Disable CSMA/CA
 702:ServerLLDN.c  **** 		 * Disable auto ACK
 703:ServerLLDN.c  **** 		 * Enable Rx of LLDN Frame Type as described in 802.15.4e - 2012 
 704:ServerLLDN.c  **** 		 */
 705:ServerLLDN.c  **** 
 706:ServerLLDN.c  **** 		sm_init();
 2295               		.loc 6 706 0
 2296 0be4 0E94 0000 		call sm_init
 707:ServerLLDN.c  **** 
 708:ServerLLDN.c  **** 		// Initialize interrupt vector table support.
 709:ServerLLDN.c  **** 	#if (SIO2HOST_CHANNEL == SIO_USB)
 710:ServerLLDN.c  **** 		irq_initialize_vectors();
 711:ServerLLDN.c  **** 	#endif
 712:ServerLLDN.c  **** 		cpu_irq_enable();
 2297               		.loc 6 712 0
 2298               	/* #APP */
 2299               	 ;  712 "ServerLLDN.c" 1
 2300 0be8 7894      		sei
 2301               	 ;  0 "" 2
 713:ServerLLDN.c  **** 
 714:ServerLLDN.c  **** 	#if 1
 715:ServerLLDN.c  **** 	#if (SIO2HOST_CHANNEL == SIO_USB)
 716:ServerLLDN.c  **** 		stdio_usb_init();
 717:ServerLLDN.c  **** 	#else
 718:ServerLLDN.c  **** 		const usart_serial_options_t usart_serial_options =
 2302               		.loc 6 718 0
 2303               	/* #NOAPP */
 2304 0bea 27E0      		ldi r18,lo8(7)
 2305 0bec E0E0      		ldi r30,lo8(.LC0)
 2306 0bee F0E0      		ldi r31,hi8(.LC0)
 2307 0bf0 CE01      		movw r24,r28
 2308 0bf2 0196      		adiw r24,1
 2309 0bf4 DC01      		movw r26,r24
 2310               		0:
 2311 0bf6 0190      		ld r0,Z+
 2312 0bf8 0D92      		st X+,r0
 2313 0bfa 2A95      		dec r18
 2314 0bfc 01F4      		brne 0b
 719:ServerLLDN.c  **** 		{
 720:ServerLLDN.c  **** 			.baudrate     = USART_HOST_BAUDRATE,
 721:ServerLLDN.c  **** 			.charlength   = USART_HOST_CHAR_LENGTH,
 722:ServerLLDN.c  **** 			.paritytype   = USART_HOST_PARITY,
 723:ServerLLDN.c  **** 			.stopbits     = USART_HOST_STOP_BITS
 724:ServerLLDN.c  **** 		};
 725:ServerLLDN.c  **** 
 726:ServerLLDN.c  **** 		stdio_serial_init(USART_HOST, &usart_serial_options);
 2315               		.loc 6 726 0
 2316 0bfe CE01      		movw r24,r28
 2317 0c00 0196      		adiw r24,1
 2318 0c02 BC01      		movw r22,r24
 2319 0c04 80EC      		ldi r24,lo8(-64)
 2320 0c06 90E0      		ldi r25,0
 2321 0c08 0E94 0000 		call stdio_serial_init
 727:ServerLLDN.c  **** 		usart_double_baud_enable(USART_HOST);
 2322               		.loc 6 727 0
 2323 0c0c 80EC      		ldi r24,lo8(-64)
 2324 0c0e 90E0      		ldi r25,0
 2325 0c10 0E94 0000 		call usart_double_baud_enable
 728:ServerLLDN.c  **** 		usart_set_baudrate_precalculated(USART_HOST, USART_HOST_BAUDRATE, sysclk_get_source_clock_hz());
 2326               		.loc 6 728 0
 2327 0c14 0E94 0000 		call sysclk_get_source_clock_hz
 2328 0c18 DC01      		movw r26,r24
 2329 0c1a CB01      		movw r24,r22
 2330 0c1c 8C01      		movw r16,r24
 2331 0c1e 9D01      		movw r18,r26
 2332 0c20 40E0      		ldi r20,0
 2333 0c22 52EC      		ldi r21,lo8(-62)
 2334 0c24 61E0      		ldi r22,lo8(1)
 2335 0c26 70E0      		ldi r23,0
 2336 0c28 80EC      		ldi r24,lo8(-64)
 2337 0c2a 90E0      		ldi r25,0
 2338 0c2c 0E94 0000 		call usart_set_baudrate_precalculated
 2339               	.L78:
 729:ServerLLDN.c  **** 
 730:ServerLLDN.c  **** 	#endif
 731:ServerLLDN.c  **** 	#endif
 732:ServerLLDN.c  **** 		for(;;)
 733:ServerLLDN.c  **** 		{
 734:ServerLLDN.c  **** 			SYS_TaskHandler();
 2340               		.loc 6 734 0 discriminator 1
 2341 0c30 0E94 0000 		call SYS_TaskHandler
 735:ServerLLDN.c  **** 			APP_TaskHandler();
 2342               		.loc 6 735 0 discriminator 1
 2343 0c34 0E94 0000 		call APP_TaskHandler
 736:ServerLLDN.c  **** 		}
 2344               		.loc 6 736 0 discriminator 1
 2345 0c38 00C0      		rjmp .L78
 2346               		.cfi_endproc
 2347               	.LFE146:
 2349               	.Letext0:
 2350               		.file 7 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\avr8\\avr8-gnu-toolchain\\avr\\in
 2351               		.file 8 "../../../stack/LwMesh/TDMA/nwk/inc/nwkRx.h"
 2352               		.file 9 "../../../stack/LwMesh/TDMA/nwk/inc/nwkDataReq.h"
 2353               		.file 10 "../../../stack/LwMesh/TDMA/sys/inc/sysTimer.h"
 2354               		.file 11 "../../../platform/mega_rf/drivers/sleep/sleep.h"
 2355               		.file 12 "lldn.h"
 2356               		.file 13 "../../../platform/mega_rf/utils/status_codes.h"
 2357               		.file 14 "config/config.h"
 2358               		.file 15 "../../../platform/common/services/sleepmgr/mega_rf/sleepmgr.h"
DEFINED SYMBOLS
                            *ABS*:00000000 ServerLLDN.c
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:2      *ABS*:0000003e __SP_H__
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:3      *ABS*:0000003d __SP_L__
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:4      *ABS*:0000003f __SREG__
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:5      *ABS*:0000003b __RAMPZ__
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:6      *ABS*:00000000 __tmp_reg__
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:7      *ABS*:00000001 __zero_reg__
                            *COM*:00000001 n
                            *COM*:00000004 tTS
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:14     .text:00000000 sysclk_get_main_hz
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:51     .text:0000001a sysclk_get_source_clock_hz
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:88     .progmem.data.baudctrl_1mhz:00000000 baudctrl_1mhz
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:100    .progmem.data.baudctrl_8mhz:00000000 baudctrl_8mhz
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:112    .progmem.data.baudctrl_16mhz:00000000 baudctrl_16mhz
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:123    .text:00000034 usart_double_baud_enable
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:172    .text:00000062 usart_serial_init
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:267    .text:000000de usart_serial_putchar
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:311    .text:00000106 usart_serial_getchar
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:362    .text:0000013c stdio_serial_init
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:433    .text:0000019e macsc_enable_manual_bts
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:487    .bss.appState:00000000 appState
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:492    .bss.msgReq:00000000 msgReq
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:497    .bss.PanId:00000000 PanId
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:505    .text:000001d2 appSendData
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:567    .data.appPanState:00000000 appPanState
                            *COM*:000003f8 nodes_info_arr
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:574    .data.config_request_frame:00000000 config_request_frame
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:584    .bss.conf_req_list:00000000 conf_req_list
                            *COM*:000001fc conf_req_arr
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:591    .bss.conf_req_index:00000000 conf_req_index
                            *COM*:00000021 ACKFrame
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:598    .bss.ACKFrame_size:00000000 ACKFrame_size
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:604    .bss.beaconInterval:00000000 beaconInterval
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:610    .bss.macLLDNnumUplinkTS:00000000 macLLDNnumUplinkTS
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:615    .bss.tmrDelay:00000000 tmrDelay
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:621    .bss.counter_associados:00000000 counter_associados
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:627    .data.cycles_counter:00000000 cycles_counter
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:631    .text:0000021e tmrDelayHandler
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:671    .text:0000023e lldn_server_beacon
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:706    .text:00000258 downlink_delay_handler
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:746    .text:0000027c end_of_online_handler
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:786    .text:00000298 teste_handler
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:840    .text:000002d0 addToAckArray
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:990    .text:000003ae addConfRequestArray
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:1154   .text:000004e0 CopyToConfigRequest
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:1222   .text:0000052c appCommandInd
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:1369   .text:00000606 appPanPrepareACK
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:1421   .text:0000064c appPanReset
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:1546   .text:00000700 appPanDiscInit
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:1765   .text:000008b4 appPanOnlineInit
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:1812   .text:000008ec appInit
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:1893   .text:00000962 APP_TaskHandler
C:\Users\GUILHE~1\AppData\Local\Temp\ccOR8rkA.s:2253   .text:00000bc0 main

UNDEFINED SYMBOLS
usart_init_rs232
usart_putchar
usart_getchar
stdio_base
ptr_put
ptr_get
_read
_write
fdevopen
printf
NWK_DataReq
macsc_disable_cmp_int
__floatsisf
__addsf3
__divsf3
__fixunssfsi
__mulsf3
macsc_set_cmp1_int_cb
macsc_enable_cmp_int
macsc_use_cmp
macsc_set_cmp2_int_cb
NWK_SetAddr
PHY_SetChannel
PHY_SetRxState
NWK_SetPanId
PHY_SetTdmaMode
NWK_OpenEndpoint
PHY_SetPromiscuousMode
__tablejump2__
SYS_TimerStart
sysclk_init
board_init
SYS_Init
sm_init
usart_set_baudrate_precalculated
SYS_TaskHandler
__do_copy_data
__do_clear_bss
