   1              	 .cpu cortex-m4
   2              	 .eabi_attribute 20,1
   3              	 .eabi_attribute 21,1
   4              	 .eabi_attribute 23,3
   5              	 .eabi_attribute 24,1
   6              	 .eabi_attribute 25,1
   7              	 .eabi_attribute 26,1
   8              	 .eabi_attribute 30,6
   9              	 .eabi_attribute 34,1
  10              	 .eabi_attribute 18,4
  11              	 .file "spi.c"
  12              	 .text
  13              	.Ltext0:
  14              	 .cfi_sections .debug_frame
  15              	 .section .bss.cpu_irq_critical_section_counter,"aw",%nobits
  16              	 .align 2
  19              	cpu_irq_critical_section_counter:
  20 0000 00000000 	 .space 4
  21              	 .section .bss.cpu_irq_prev_interrupt_state,"aw",%nobits
  24              	cpu_irq_prev_interrupt_state:
  25 0000 00       	 .space 1
  26              	 .text
  27              	 .align 1
  28              	 .syntax unified
  29              	 .thumb
  30              	 .thumb_func
  31              	 .fpu softvfp
  33              	spi_get_peripheral_select_mode:
  34              	.LFB131:
  35              	 .file 1 "../../../platform/sam/drivers/spi/spi.h"
   1:../../../platform/sam/drivers/spi/spi.h **** /**
   2:../../../platform/sam/drivers/spi/spi.h ****  * \file
   3:../../../platform/sam/drivers/spi/spi.h ****  *
   4:../../../platform/sam/drivers/spi/spi.h ****  * \brief Serial Peripheral Interface (SPI) driver for SAM.
   5:../../../platform/sam/drivers/spi/spi.h ****  *
   6:../../../platform/sam/drivers/spi/spi.h ****  * Copyright (c) 2011-2014 Atmel Corporation. All rights reserved.
   7:../../../platform/sam/drivers/spi/spi.h ****  *
   8:../../../platform/sam/drivers/spi/spi.h ****  * \asf_license_start
   9:../../../platform/sam/drivers/spi/spi.h ****  *
  10:../../../platform/sam/drivers/spi/spi.h ****  * \page License
  11:../../../platform/sam/drivers/spi/spi.h ****  *
  12:../../../platform/sam/drivers/spi/spi.h ****  * Redistribution and use in source and binary forms, with or without
  13:../../../platform/sam/drivers/spi/spi.h ****  * modification, are permitted provided that the following conditions are met:
  14:../../../platform/sam/drivers/spi/spi.h ****  *
  15:../../../platform/sam/drivers/spi/spi.h ****  * 1. Redistributions of source code must retain the above copyright notice,
  16:../../../platform/sam/drivers/spi/spi.h ****  *    this list of conditions and the following disclaimer.
  17:../../../platform/sam/drivers/spi/spi.h ****  *
  18:../../../platform/sam/drivers/spi/spi.h ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  19:../../../platform/sam/drivers/spi/spi.h ****  *    this list of conditions and the following disclaimer in the documentation
  20:../../../platform/sam/drivers/spi/spi.h ****  *    and/or other materials provided with the distribution.
  21:../../../platform/sam/drivers/spi/spi.h ****  *
  22:../../../platform/sam/drivers/spi/spi.h ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  23:../../../platform/sam/drivers/spi/spi.h ****  *    from this software without specific prior written permission.
  24:../../../platform/sam/drivers/spi/spi.h ****  *
  25:../../../platform/sam/drivers/spi/spi.h ****  * 4. This software may only be redistributed and used in connection with an
  26:../../../platform/sam/drivers/spi/spi.h ****  *    Atmel microcontroller product.
  27:../../../platform/sam/drivers/spi/spi.h ****  *
  28:../../../platform/sam/drivers/spi/spi.h ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  29:../../../platform/sam/drivers/spi/spi.h ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  30:../../../platform/sam/drivers/spi/spi.h ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  31:../../../platform/sam/drivers/spi/spi.h ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  32:../../../platform/sam/drivers/spi/spi.h ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  33:../../../platform/sam/drivers/spi/spi.h ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  34:../../../platform/sam/drivers/spi/spi.h ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  35:../../../platform/sam/drivers/spi/spi.h ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  36:../../../platform/sam/drivers/spi/spi.h ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  37:../../../platform/sam/drivers/spi/spi.h ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  38:../../../platform/sam/drivers/spi/spi.h ****  * POSSIBILITY OF SUCH DAMAGE.
  39:../../../platform/sam/drivers/spi/spi.h ****  *
  40:../../../platform/sam/drivers/spi/spi.h ****  * \asf_license_stop
  41:../../../platform/sam/drivers/spi/spi.h ****  *
  42:../../../platform/sam/drivers/spi/spi.h ****  */
  43:../../../platform/sam/drivers/spi/spi.h **** 
  44:../../../platform/sam/drivers/spi/spi.h **** #ifndef SPI_H_INCLUDED
  45:../../../platform/sam/drivers/spi/spi.h **** #define SPI_H_INCLUDED
  46:../../../platform/sam/drivers/spi/spi.h **** 
  47:../../../platform/sam/drivers/spi/spi.h **** #include "compiler.h"
  48:../../../platform/sam/drivers/spi/spi.h **** 
  49:../../../platform/sam/drivers/spi/spi.h **** /// @cond 0
  50:../../../platform/sam/drivers/spi/spi.h **** /**INDENT-OFF**/
  51:../../../platform/sam/drivers/spi/spi.h **** #ifdef __cplusplus
  52:../../../platform/sam/drivers/spi/spi.h **** extern "C" {
  53:../../../platform/sam/drivers/spi/spi.h **** #endif
  54:../../../platform/sam/drivers/spi/spi.h **** /**INDENT-ON**/
  55:../../../platform/sam/drivers/spi/spi.h **** /// @endcond
  56:../../../platform/sam/drivers/spi/spi.h **** 
  57:../../../platform/sam/drivers/spi/spi.h **** /** Time-out value (number of attempts). */
  58:../../../platform/sam/drivers/spi/spi.h **** #define SPI_TIMEOUT       15000
  59:../../../platform/sam/drivers/spi/spi.h **** 
  60:../../../platform/sam/drivers/spi/spi.h **** /** Status codes used by the SPI driver. */
  61:../../../platform/sam/drivers/spi/spi.h **** typedef enum
  62:../../../platform/sam/drivers/spi/spi.h **** {
  63:../../../platform/sam/drivers/spi/spi.h **** 	SPI_ERROR = -1,
  64:../../../platform/sam/drivers/spi/spi.h **** 	SPI_OK = 0,
  65:../../../platform/sam/drivers/spi/spi.h **** 	SPI_ERROR_TIMEOUT = 1,
  66:../../../platform/sam/drivers/spi/spi.h **** 	SPI_ERROR_ARGUMENT,
  67:../../../platform/sam/drivers/spi/spi.h **** 	SPI_ERROR_OVERRUN,
  68:../../../platform/sam/drivers/spi/spi.h **** 	SPI_ERROR_MODE_FAULT,
  69:../../../platform/sam/drivers/spi/spi.h **** 	SPI_ERROR_OVERRUN_AND_MODE_FAULT
  70:../../../platform/sam/drivers/spi/spi.h **** } spi_status_t;
  71:../../../platform/sam/drivers/spi/spi.h **** 
  72:../../../platform/sam/drivers/spi/spi.h **** /** SPI Chip Select behavior modes while transferring. */
  73:../../../platform/sam/drivers/spi/spi.h **** typedef enum spi_cs_behavior {
  74:../../../platform/sam/drivers/spi/spi.h **** 	/** CS does not rise until a new transfer is requested on different chip select. */
  75:../../../platform/sam/drivers/spi/spi.h **** 	SPI_CS_KEEP_LOW = SPI_CSR_CSAAT,
  76:../../../platform/sam/drivers/spi/spi.h **** 	/** CS rises if there is no more data to transfer. */
  77:../../../platform/sam/drivers/spi/spi.h **** 	SPI_CS_RISE_NO_TX = 0,
  78:../../../platform/sam/drivers/spi/spi.h **** 	/** CS is de-asserted systematically during a time DLYBCS. */
  79:../../../platform/sam/drivers/spi/spi.h **** 	SPI_CS_RISE_FORCED = SPI_CSR_CSNAAT
  80:../../../platform/sam/drivers/spi/spi.h **** } spi_cs_behavior_t;
  81:../../../platform/sam/drivers/spi/spi.h **** 
  82:../../../platform/sam/drivers/spi/spi.h **** /**
  83:../../../platform/sam/drivers/spi/spi.h ****  * \brief Generate Peripheral Chip Select Value from Chip Select ID
  84:../../../platform/sam/drivers/spi/spi.h ****  * \note When chip select n is working, PCS bit n is set to low level.
  85:../../../platform/sam/drivers/spi/spi.h ****  *
  86:../../../platform/sam/drivers/spi/spi.h ****  * \param chip_sel_id The chip select number used
  87:../../../platform/sam/drivers/spi/spi.h ****  */
  88:../../../platform/sam/drivers/spi/spi.h **** #define spi_get_pcs(chip_sel_id) ((~(1u<<(chip_sel_id)))&0xF)
  89:../../../platform/sam/drivers/spi/spi.h **** 
  90:../../../platform/sam/drivers/spi/spi.h **** /**
  91:../../../platform/sam/drivers/spi/spi.h ****  * \brief Reset SPI and set it to Slave mode.
  92:../../../platform/sam/drivers/spi/spi.h ****  *
  93:../../../platform/sam/drivers/spi/spi.h ****  * \param p_spi Pointer to an SPI instance.
  94:../../../platform/sam/drivers/spi/spi.h ****  */
  95:../../../platform/sam/drivers/spi/spi.h **** static inline void spi_reset(Spi *p_spi)
  96:../../../platform/sam/drivers/spi/spi.h **** {
  97:../../../platform/sam/drivers/spi/spi.h **** 	p_spi->SPI_CR = SPI_CR_SWRST;
  98:../../../platform/sam/drivers/spi/spi.h **** }
  99:../../../platform/sam/drivers/spi/spi.h **** 
 100:../../../platform/sam/drivers/spi/spi.h **** /**
 101:../../../platform/sam/drivers/spi/spi.h ****  * \brief Enable SPI.
 102:../../../platform/sam/drivers/spi/spi.h ****  *
 103:../../../platform/sam/drivers/spi/spi.h ****  * \param p_spi Pointer to an SPI instance.
 104:../../../platform/sam/drivers/spi/spi.h ****  */
 105:../../../platform/sam/drivers/spi/spi.h **** static inline void spi_enable(Spi *p_spi)
 106:../../../platform/sam/drivers/spi/spi.h **** {
 107:../../../platform/sam/drivers/spi/spi.h **** 	p_spi->SPI_CR = SPI_CR_SPIEN;
 108:../../../platform/sam/drivers/spi/spi.h **** }
 109:../../../platform/sam/drivers/spi/spi.h **** 
 110:../../../platform/sam/drivers/spi/spi.h **** /**
 111:../../../platform/sam/drivers/spi/spi.h ****  * \brief Disable SPI.
 112:../../../platform/sam/drivers/spi/spi.h ****  *
 113:../../../platform/sam/drivers/spi/spi.h ****  * \note CS is de-asserted, which indicates that the last data is done, and user
 114:../../../platform/sam/drivers/spi/spi.h ****  * should check TX_EMPTY before disabling SPI.
 115:../../../platform/sam/drivers/spi/spi.h ****  *
 116:../../../platform/sam/drivers/spi/spi.h ****  * \param p_spi Pointer to an SPI instance.
 117:../../../platform/sam/drivers/spi/spi.h ****  */
 118:../../../platform/sam/drivers/spi/spi.h **** static inline void spi_disable(Spi *p_spi)
 119:../../../platform/sam/drivers/spi/spi.h **** {
 120:../../../platform/sam/drivers/spi/spi.h **** 	p_spi->SPI_CR = SPI_CR_SPIDIS;
 121:../../../platform/sam/drivers/spi/spi.h **** }
 122:../../../platform/sam/drivers/spi/spi.h **** 
 123:../../../platform/sam/drivers/spi/spi.h **** /**
 124:../../../platform/sam/drivers/spi/spi.h ****  * \brief Issue a LASTXFER command.
 125:../../../platform/sam/drivers/spi/spi.h ****  *  The next transfer is the last transfer and after that CS is de-asserted.
 126:../../../platform/sam/drivers/spi/spi.h ****  *
 127:../../../platform/sam/drivers/spi/spi.h ****  * \param p_spi Pointer to an SPI instance.
 128:../../../platform/sam/drivers/spi/spi.h ****  */
 129:../../../platform/sam/drivers/spi/spi.h **** static inline void spi_set_lastxfer(Spi *p_spi)
 130:../../../platform/sam/drivers/spi/spi.h **** {
 131:../../../platform/sam/drivers/spi/spi.h **** 	p_spi->SPI_CR = SPI_CR_LASTXFER;
 132:../../../platform/sam/drivers/spi/spi.h **** }
 133:../../../platform/sam/drivers/spi/spi.h **** 
 134:../../../platform/sam/drivers/spi/spi.h **** /**
 135:../../../platform/sam/drivers/spi/spi.h ****  * \brief Set SPI to Master mode.
 136:../../../platform/sam/drivers/spi/spi.h ****  *
 137:../../../platform/sam/drivers/spi/spi.h ****  * \param p_spi Pointer to an SPI instance.
 138:../../../platform/sam/drivers/spi/spi.h ****  */
 139:../../../platform/sam/drivers/spi/spi.h **** static inline void spi_set_master_mode(Spi *p_spi)
 140:../../../platform/sam/drivers/spi/spi.h **** {
 141:../../../platform/sam/drivers/spi/spi.h **** 	p_spi->SPI_MR |= SPI_MR_MSTR;
 142:../../../platform/sam/drivers/spi/spi.h **** }
 143:../../../platform/sam/drivers/spi/spi.h **** 
 144:../../../platform/sam/drivers/spi/spi.h **** /**
 145:../../../platform/sam/drivers/spi/spi.h ****  * \brief Set SPI to Slave mode.
 146:../../../platform/sam/drivers/spi/spi.h ****  *
 147:../../../platform/sam/drivers/spi/spi.h ****  * \param p_spi Pointer to an SPI instance.
 148:../../../platform/sam/drivers/spi/spi.h ****  */
 149:../../../platform/sam/drivers/spi/spi.h **** static inline void spi_set_slave_mode(Spi *p_spi)
 150:../../../platform/sam/drivers/spi/spi.h **** {
 151:../../../platform/sam/drivers/spi/spi.h **** 	p_spi->SPI_MR &= (~SPI_MR_MSTR);
 152:../../../platform/sam/drivers/spi/spi.h **** }
 153:../../../platform/sam/drivers/spi/spi.h **** 
 154:../../../platform/sam/drivers/spi/spi.h **** /**
 155:../../../platform/sam/drivers/spi/spi.h ****  * \brief Get SPI work mode.
 156:../../../platform/sam/drivers/spi/spi.h ****  *
 157:../../../platform/sam/drivers/spi/spi.h ****  * \param p_spi Pointer to an SPI instance.
 158:../../../platform/sam/drivers/spi/spi.h ****  *
 159:../../../platform/sam/drivers/spi/spi.h ****  * \return 1 for master mode, 0 for slave mode.
 160:../../../platform/sam/drivers/spi/spi.h ****  */
 161:../../../platform/sam/drivers/spi/spi.h **** static inline uint32_t spi_get_mode(Spi *p_spi)
 162:../../../platform/sam/drivers/spi/spi.h **** {
 163:../../../platform/sam/drivers/spi/spi.h **** 	if (p_spi->SPI_MR & SPI_MR_MSTR) {
 164:../../../platform/sam/drivers/spi/spi.h **** 		return 1;
 165:../../../platform/sam/drivers/spi/spi.h **** 	} else {
 166:../../../platform/sam/drivers/spi/spi.h **** 		return 0;
 167:../../../platform/sam/drivers/spi/spi.h **** 	}
 168:../../../platform/sam/drivers/spi/spi.h **** }
 169:../../../platform/sam/drivers/spi/spi.h **** 
 170:../../../platform/sam/drivers/spi/spi.h **** /**
 171:../../../platform/sam/drivers/spi/spi.h ****  * \brief Set Variable Peripheral Select.
 172:../../../platform/sam/drivers/spi/spi.h ****  * Peripheral Chip Select can be controlled by SPI_TDR.
 173:../../../platform/sam/drivers/spi/spi.h ****  *
 174:../../../platform/sam/drivers/spi/spi.h ****  * \param p_spi Pointer to an SPI instance.
 175:../../../platform/sam/drivers/spi/spi.h ****  */
 176:../../../platform/sam/drivers/spi/spi.h **** static inline void spi_set_variable_peripheral_select(Spi *p_spi)
 177:../../../platform/sam/drivers/spi/spi.h **** {
 178:../../../platform/sam/drivers/spi/spi.h **** 	p_spi->SPI_MR |= SPI_MR_PS;
 179:../../../platform/sam/drivers/spi/spi.h **** }
 180:../../../platform/sam/drivers/spi/spi.h **** 
 181:../../../platform/sam/drivers/spi/spi.h **** /**
 182:../../../platform/sam/drivers/spi/spi.h ****  * \brief Set Fixed Peripheral Select.
 183:../../../platform/sam/drivers/spi/spi.h ****  *  Peripheral Chip Select is controlled by SPI_MR.
 184:../../../platform/sam/drivers/spi/spi.h ****  *
 185:../../../platform/sam/drivers/spi/spi.h ****  * \param p_spi Pointer to an SPI instance.
 186:../../../platform/sam/drivers/spi/spi.h ****  */
 187:../../../platform/sam/drivers/spi/spi.h **** static inline void spi_set_fixed_peripheral_select(Spi *p_spi)
 188:../../../platform/sam/drivers/spi/spi.h **** {
 189:../../../platform/sam/drivers/spi/spi.h **** 	p_spi->SPI_MR &= (~SPI_MR_PS);
 190:../../../platform/sam/drivers/spi/spi.h **** }
 191:../../../platform/sam/drivers/spi/spi.h **** 
 192:../../../platform/sam/drivers/spi/spi.h **** /**
 193:../../../platform/sam/drivers/spi/spi.h ****  * \brief Get Peripheral Select mode.
 194:../../../platform/sam/drivers/spi/spi.h ****  *
 195:../../../platform/sam/drivers/spi/spi.h ****  * \param p_spi Pointer to an SPI instance.
 196:../../../platform/sam/drivers/spi/spi.h ****  *
 197:../../../platform/sam/drivers/spi/spi.h ****  * \return 1 for Variable mode, 0 for fixed mode.
 198:../../../platform/sam/drivers/spi/spi.h ****  */
 199:../../../platform/sam/drivers/spi/spi.h **** static inline uint32_t spi_get_peripheral_select_mode(Spi *p_spi)
 200:../../../platform/sam/drivers/spi/spi.h **** {
  36              	 .loc 1 200 0
  37              	 .cfi_startproc
  38              	 
  39              	 
  40              	 
  41 0000 80B4     	 push {r7}
  42              	.LCFI0:
  43              	 .cfi_def_cfa_offset 4
  44              	 .cfi_offset 7,-4
  45 0002 83B0     	 sub sp,sp,#12
  46              	.LCFI1:
  47              	 .cfi_def_cfa_offset 16
  48 0004 00AF     	 add r7,sp,#0
  49              	.LCFI2:
  50              	 .cfi_def_cfa_register 7
  51 0006 7860     	 str r0,[r7,#4]
 201:../../../platform/sam/drivers/spi/spi.h **** 	if (p_spi->SPI_MR & SPI_MR_PS) {
  52              	 .loc 1 201 0
  53 0008 7B68     	 ldr r3,[r7,#4]
  54 000a 5B68     	 ldr r3,[r3,#4]
  55 000c 03F00203 	 and r3,r3,#2
  56 0010 002B     	 cmp r3,#0
  57 0012 01D0     	 beq .L2
 202:../../../platform/sam/drivers/spi/spi.h **** 		return 1;
  58              	 .loc 1 202 0
  59 0014 0123     	 movs r3,#1
  60 0016 00E0     	 b .L3
  61              	.L2:
 203:../../../platform/sam/drivers/spi/spi.h **** 	} else {
 204:../../../platform/sam/drivers/spi/spi.h **** 		return 0;
  62              	 .loc 1 204 0
  63 0018 0023     	 movs r3,#0
  64              	.L3:
 205:../../../platform/sam/drivers/spi/spi.h **** 	}
 206:../../../platform/sam/drivers/spi/spi.h **** }
  65              	 .loc 1 206 0
  66 001a 1846     	 mov r0,r3
  67 001c 0C37     	 adds r7,r7,#12
  68              	.LCFI3:
  69              	 .cfi_def_cfa_offset 4
  70 001e BD46     	 mov sp,r7
  71              	.LCFI4:
  72              	 .cfi_def_cfa_register 13
  73              	 
  74 0020 80BC     	 pop {r7}
  75              	.LCFI5:
  76              	 .cfi_restore 7
  77              	 .cfi_def_cfa_offset 0
  78 0022 7047     	 bx lr
  79              	 .cfi_endproc
  80              	.LFE131:
  82              	 .align 1
  83              	 .global spi_enable_clock
  84              	 .syntax unified
  85              	 .thumb
  86              	 .thumb_func
  87              	 .fpu softvfp
  89              	spi_enable_clock:
  90              	.LFB213:
  91              	 .file 2 "../../../platform/sam/drivers/spi/spi.c"
   1:../../../platform/sam/drivers/spi/spi.c **** /**
   2:../../../platform/sam/drivers/spi/spi.c ****  * \file
   3:../../../platform/sam/drivers/spi/spi.c ****  *
   4:../../../platform/sam/drivers/spi/spi.c ****  * \brief Serial Peripheral Interface (SPI) driver for SAM.
   5:../../../platform/sam/drivers/spi/spi.c ****  *
   6:../../../platform/sam/drivers/spi/spi.c ****  * Copyright (c) 2011-2014 Atmel Corporation. All rights reserved.
   7:../../../platform/sam/drivers/spi/spi.c ****  *
   8:../../../platform/sam/drivers/spi/spi.c ****  * \asf_license_start
   9:../../../platform/sam/drivers/spi/spi.c ****  *
  10:../../../platform/sam/drivers/spi/spi.c ****  * \page License
  11:../../../platform/sam/drivers/spi/spi.c ****  *
  12:../../../platform/sam/drivers/spi/spi.c ****  * Redistribution and use in source and binary forms, with or without
  13:../../../platform/sam/drivers/spi/spi.c ****  * modification, are permitted provided that the following conditions are met:
  14:../../../platform/sam/drivers/spi/spi.c ****  *
  15:../../../platform/sam/drivers/spi/spi.c ****  * 1. Redistributions of source code must retain the above copyright notice,
  16:../../../platform/sam/drivers/spi/spi.c ****  *    this list of conditions and the following disclaimer.
  17:../../../platform/sam/drivers/spi/spi.c ****  *
  18:../../../platform/sam/drivers/spi/spi.c ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  19:../../../platform/sam/drivers/spi/spi.c ****  *    this list of conditions and the following disclaimer in the documentation
  20:../../../platform/sam/drivers/spi/spi.c ****  *    and/or other materials provided with the distribution.
  21:../../../platform/sam/drivers/spi/spi.c ****  *
  22:../../../platform/sam/drivers/spi/spi.c ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  23:../../../platform/sam/drivers/spi/spi.c ****  *    from this software without specific prior written permission.
  24:../../../platform/sam/drivers/spi/spi.c ****  *
  25:../../../platform/sam/drivers/spi/spi.c ****  * 4. This software may only be redistributed and used in connection with an
  26:../../../platform/sam/drivers/spi/spi.c ****  *    Atmel microcontroller product.
  27:../../../platform/sam/drivers/spi/spi.c ****  *
  28:../../../platform/sam/drivers/spi/spi.c ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  29:../../../platform/sam/drivers/spi/spi.c ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  30:../../../platform/sam/drivers/spi/spi.c ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  31:../../../platform/sam/drivers/spi/spi.c ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  32:../../../platform/sam/drivers/spi/spi.c ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  33:../../../platform/sam/drivers/spi/spi.c ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  34:../../../platform/sam/drivers/spi/spi.c ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  35:../../../platform/sam/drivers/spi/spi.c ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  36:../../../platform/sam/drivers/spi/spi.c ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  37:../../../platform/sam/drivers/spi/spi.c ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  38:../../../platform/sam/drivers/spi/spi.c ****  * POSSIBILITY OF SUCH DAMAGE.
  39:../../../platform/sam/drivers/spi/spi.c ****  *
  40:../../../platform/sam/drivers/spi/spi.c ****  * \asf_license_stop
  41:../../../platform/sam/drivers/spi/spi.c ****  *
  42:../../../platform/sam/drivers/spi/spi.c ****  */
  43:../../../platform/sam/drivers/spi/spi.c **** 
  44:../../../platform/sam/drivers/spi/spi.c **** #include "spi.h"
  45:../../../platform/sam/drivers/spi/spi.c **** #include "sysclk.h"
  46:../../../platform/sam/drivers/spi/spi.c **** 
  47:../../../platform/sam/drivers/spi/spi.c **** /**
  48:../../../platform/sam/drivers/spi/spi.c ****  * \defgroup sam_drivers_spi_group Serial Peripheral Interface (SPI)
  49:../../../platform/sam/drivers/spi/spi.c ****  *
  50:../../../platform/sam/drivers/spi/spi.c ****  * See \ref sam_spi_quickstart.
  51:../../../platform/sam/drivers/spi/spi.c ****  *
  52:../../../platform/sam/drivers/spi/spi.c ****  * The SPI circuit is a synchronous serial data link that provides communication
  53:../../../platform/sam/drivers/spi/spi.c ****  * with external devices in Master or Slave mode. Connection to Peripheral DMA
  54:../../../platform/sam/drivers/spi/spi.c ****  * Controller channel capabilities optimizes data transfers.
  55:../../../platform/sam/drivers/spi/spi.c ****  *
  56:../../../platform/sam/drivers/spi/spi.c ****  * @{
  57:../../../platform/sam/drivers/spi/spi.c ****  */
  58:../../../platform/sam/drivers/spi/spi.c **** #ifndef SPI_WPMR_WPKEY_PASSWD
  59:../../../platform/sam/drivers/spi/spi.c **** #define SPI_WPMR_WPKEY_PASSWD SPI_WPMR_WPKEY((uint32_t) 0x535049)
  60:../../../platform/sam/drivers/spi/spi.c **** #endif
  61:../../../platform/sam/drivers/spi/spi.c **** 
  62:../../../platform/sam/drivers/spi/spi.c **** /**
  63:../../../platform/sam/drivers/spi/spi.c ****  * \brief Enable SPI clock.
  64:../../../platform/sam/drivers/spi/spi.c ****  *
  65:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
  66:../../../platform/sam/drivers/spi/spi.c ****  */
  67:../../../platform/sam/drivers/spi/spi.c **** void spi_enable_clock(Spi *p_spi)
  68:../../../platform/sam/drivers/spi/spi.c **** {
  92              	 .loc 2 68 0
  93              	 .cfi_startproc
  94              	 
  95              	 
  96 0024 80B5     	 push {r7,lr}
  97              	.LCFI6:
  98              	 .cfi_def_cfa_offset 8
  99              	 .cfi_offset 7,-8
 100              	 .cfi_offset 14,-4
 101 0026 82B0     	 sub sp,sp,#8
 102              	.LCFI7:
 103              	 .cfi_def_cfa_offset 16
 104 0028 00AF     	 add r7,sp,#0
 105              	.LCFI8:
 106              	 .cfi_def_cfa_register 7
 107 002a 7860     	 str r0,[r7,#4]
  69:../../../platform/sam/drivers/spi/spi.c **** #if (SAM4S || SAM3S || SAM3N || SAM3U || SAM4E || SAM4N || SAMG)
  70:../../../platform/sam/drivers/spi/spi.c **** 	UNUSED(p_spi);
  71:../../../platform/sam/drivers/spi/spi.c **** 	sysclk_enable_peripheral_clock(ID_SPI);
  72:../../../platform/sam/drivers/spi/spi.c **** #elif (SAM3XA || SAM4C || SAM4CP || SAM4CM)
  73:../../../platform/sam/drivers/spi/spi.c **** 	if (p_spi == SPI0) {
  74:../../../platform/sam/drivers/spi/spi.c **** 		sysclk_enable_peripheral_clock(ID_SPI0);
  75:../../../platform/sam/drivers/spi/spi.c **** 	}
  76:../../../platform/sam/drivers/spi/spi.c **** 	#ifdef SPI1
  77:../../../platform/sam/drivers/spi/spi.c **** 	else if (p_spi == SPI1) {
  78:../../../platform/sam/drivers/spi/spi.c **** 		sysclk_enable_peripheral_clock(ID_SPI1);
  79:../../../platform/sam/drivers/spi/spi.c **** 	}
  80:../../../platform/sam/drivers/spi/spi.c **** 	#endif
  81:../../../platform/sam/drivers/spi/spi.c **** #elif SAM4L
  82:../../../platform/sam/drivers/spi/spi.c **** 	sysclk_enable_peripheral_clock(p_spi);
 108              	 .loc 2 82 0
 109 002c 7868     	 ldr r0,[r7,#4]
 110 002e 034B     	 ldr r3,.L5
 111 0030 9847     	 blx r3
 112              	.LVL0:
  83:../../../platform/sam/drivers/spi/spi.c **** #endif
  84:../../../platform/sam/drivers/spi/spi.c **** }
 113              	 .loc 2 84 0
 114 0032 00BF     	 nop
 115 0034 0837     	 adds r7,r7,#8
 116              	.LCFI9:
 117              	 .cfi_def_cfa_offset 8
 118 0036 BD46     	 mov sp,r7
 119              	.LCFI10:
 120              	 .cfi_def_cfa_register 13
 121              	 
 122 0038 80BD     	 pop {r7,pc}
 123              	.L6:
 124 003a 00BF     	 .align 2
 125              	.L5:
 126 003c 00000000 	 .word sysclk_enable_peripheral_clock
 127              	 .cfi_endproc
 128              	.LFE213:
 130              	 .align 1
 131              	 .global spi_disable_clock
 132              	 .syntax unified
 133              	 .thumb
 134              	 .thumb_func
 135              	 .fpu softvfp
 137              	spi_disable_clock:
 138              	.LFB214:
  85:../../../platform/sam/drivers/spi/spi.c **** 
  86:../../../platform/sam/drivers/spi/spi.c **** /**
  87:../../../platform/sam/drivers/spi/spi.c ****  * \brief Disable SPI clock.
  88:../../../platform/sam/drivers/spi/spi.c ****  *
  89:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
  90:../../../platform/sam/drivers/spi/spi.c ****  */
  91:../../../platform/sam/drivers/spi/spi.c **** void spi_disable_clock(Spi *p_spi)
  92:../../../platform/sam/drivers/spi/spi.c **** {
 139              	 .loc 2 92 0
 140              	 .cfi_startproc
 141              	 
 142              	 
 143 0040 80B5     	 push {r7,lr}
 144              	.LCFI11:
 145              	 .cfi_def_cfa_offset 8
 146              	 .cfi_offset 7,-8
 147              	 .cfi_offset 14,-4
 148 0042 82B0     	 sub sp,sp,#8
 149              	.LCFI12:
 150              	 .cfi_def_cfa_offset 16
 151 0044 00AF     	 add r7,sp,#0
 152              	.LCFI13:
 153              	 .cfi_def_cfa_register 7
 154 0046 7860     	 str r0,[r7,#4]
  93:../../../platform/sam/drivers/spi/spi.c **** #if (SAM4S || SAM3S || SAM3N || SAM3U || SAM4E || SAM4N || SAMG)
  94:../../../platform/sam/drivers/spi/spi.c **** 	UNUSED(p_spi);
  95:../../../platform/sam/drivers/spi/spi.c **** 	sysclk_disable_peripheral_clock(ID_SPI);
  96:../../../platform/sam/drivers/spi/spi.c **** #elif (SAM3XA || SAM4C || SAM4CP || SAM4CM)
  97:../../../platform/sam/drivers/spi/spi.c **** 	if (p_spi == SPI0) {
  98:../../../platform/sam/drivers/spi/spi.c **** 		sysclk_disable_peripheral_clock(ID_SPI0);
  99:../../../platform/sam/drivers/spi/spi.c **** 	}
 100:../../../platform/sam/drivers/spi/spi.c **** 	#ifdef SPI1
 101:../../../platform/sam/drivers/spi/spi.c **** 	else if (p_spi == SPI1) {
 102:../../../platform/sam/drivers/spi/spi.c **** 		sysclk_disable_peripheral_clock(ID_SPI1);
 103:../../../platform/sam/drivers/spi/spi.c **** 	}
 104:../../../platform/sam/drivers/spi/spi.c **** 	#endif
 105:../../../platform/sam/drivers/spi/spi.c **** #elif SAM4L
 106:../../../platform/sam/drivers/spi/spi.c **** 	sysclk_disable_peripheral_clock(p_spi);
 155              	 .loc 2 106 0
 156 0048 7868     	 ldr r0,[r7,#4]
 157 004a 034B     	 ldr r3,.L8
 158 004c 9847     	 blx r3
 159              	.LVL1:
 107:../../../platform/sam/drivers/spi/spi.c **** #endif
 108:../../../platform/sam/drivers/spi/spi.c **** }
 160              	 .loc 2 108 0
 161 004e 00BF     	 nop
 162 0050 0837     	 adds r7,r7,#8
 163              	.LCFI14:
 164              	 .cfi_def_cfa_offset 8
 165 0052 BD46     	 mov sp,r7
 166              	.LCFI15:
 167              	 .cfi_def_cfa_register 13
 168              	 
 169 0054 80BD     	 pop {r7,pc}
 170              	.L9:
 171 0056 00BF     	 .align 2
 172              	.L8:
 173 0058 00000000 	 .word sysclk_disable_peripheral_clock
 174              	 .cfi_endproc
 175              	.LFE214:
 177              	 .align 1
 178              	 .global spi_set_peripheral_chip_select_value
 179              	 .syntax unified
 180              	 .thumb
 181              	 .thumb_func
 182              	 .fpu softvfp
 184              	spi_set_peripheral_chip_select_value:
 185              	.LFB215:
 109:../../../platform/sam/drivers/spi/spi.c **** 
 110:../../../platform/sam/drivers/spi/spi.c **** /**
 111:../../../platform/sam/drivers/spi/spi.c ****  * \brief Set Peripheral Chip Select (PCS) value.
 112:../../../platform/sam/drivers/spi/spi.c ****  *
 113:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 114:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_value Peripheral Chip Select value.
 115:../../../platform/sam/drivers/spi/spi.c ****  *                 If PCS decode mode is not used, use \ref spi_get_pcs to build
 116:../../../platform/sam/drivers/spi/spi.c ****  *                 the value to use.
 117:../../../platform/sam/drivers/spi/spi.c ****  *                 On reset the decode mode is not enabled.
 118:../../../platform/sam/drivers/spi/spi.c ****  *                 The decode mode can be enabled/disabled by follow functions:
 119:../../../platform/sam/drivers/spi/spi.c ****  *                 \ref spi_enable_peripheral_select_decode,
 120:../../../platform/sam/drivers/spi/spi.c ****  *                 \ref spi_disable_peripheral_select_decode.
 121:../../../platform/sam/drivers/spi/spi.c ****  */
 122:../../../platform/sam/drivers/spi/spi.c **** void spi_set_peripheral_chip_select_value(Spi *p_spi, uint32_t ul_value)
 123:../../../platform/sam/drivers/spi/spi.c **** {
 186              	 .loc 2 123 0
 187              	 .cfi_startproc
 188              	 
 189              	 
 190              	 
 191 005c 80B4     	 push {r7}
 192              	.LCFI16:
 193              	 .cfi_def_cfa_offset 4
 194              	 .cfi_offset 7,-4
 195 005e 83B0     	 sub sp,sp,#12
 196              	.LCFI17:
 197              	 .cfi_def_cfa_offset 16
 198 0060 00AF     	 add r7,sp,#0
 199              	.LCFI18:
 200              	 .cfi_def_cfa_register 7
 201 0062 7860     	 str r0,[r7,#4]
 202 0064 3960     	 str r1,[r7]
 124:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_MR &= (~SPI_MR_PCS_Msk);
 203              	 .loc 2 124 0
 204 0066 7B68     	 ldr r3,[r7,#4]
 205 0068 5B68     	 ldr r3,[r3,#4]
 206 006a 23F47022 	 bic r2,r3,#983040
 207 006e 7B68     	 ldr r3,[r7,#4]
 208 0070 5A60     	 str r2,[r3,#4]
 125:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_MR |= SPI_MR_PCS(ul_value);
 209              	 .loc 2 125 0
 210 0072 7B68     	 ldr r3,[r7,#4]
 211 0074 5A68     	 ldr r2,[r3,#4]
 212 0076 3B68     	 ldr r3,[r7]
 213 0078 1B04     	 lsls r3,r3,#16
 214 007a 03F47023 	 and r3,r3,#983040
 215 007e 1A43     	 orrs r2,r2,r3
 216 0080 7B68     	 ldr r3,[r7,#4]
 217 0082 5A60     	 str r2,[r3,#4]
 126:../../../platform/sam/drivers/spi/spi.c **** }
 218              	 .loc 2 126 0
 219 0084 00BF     	 nop
 220 0086 0C37     	 adds r7,r7,#12
 221              	.LCFI19:
 222              	 .cfi_def_cfa_offset 4
 223 0088 BD46     	 mov sp,r7
 224              	.LCFI20:
 225              	 .cfi_def_cfa_register 13
 226              	 
 227 008a 80BC     	 pop {r7}
 228              	.LCFI21:
 229              	 .cfi_restore 7
 230              	 .cfi_def_cfa_offset 0
 231 008c 7047     	 bx lr
 232              	 .cfi_endproc
 233              	.LFE215:
 235              	 .align 1
 236              	 .global spi_set_delay_between_chip_select
 237              	 .syntax unified
 238              	 .thumb
 239              	 .thumb_func
 240              	 .fpu softvfp
 242              	spi_set_delay_between_chip_select:
 243              	.LFB216:
 127:../../../platform/sam/drivers/spi/spi.c **** 
 128:../../../platform/sam/drivers/spi/spi.c **** /**
 129:../../../platform/sam/drivers/spi/spi.c ****  * \brief Set delay between chip selects (in number of MCK clocks).
 130:../../../platform/sam/drivers/spi/spi.c ****  *  If DLYBCS <= 6, 6 MCK clocks will be inserted by default.
 131:../../../platform/sam/drivers/spi/spi.c ****  *
 132:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 133:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_delay Delay between chip selects (in number of MCK clocks).
 134:../../../platform/sam/drivers/spi/spi.c ****  */
 135:../../../platform/sam/drivers/spi/spi.c **** void spi_set_delay_between_chip_select(Spi *p_spi, uint32_t ul_delay)
 136:../../../platform/sam/drivers/spi/spi.c **** {
 244              	 .loc 2 136 0
 245              	 .cfi_startproc
 246              	 
 247              	 
 248              	 
 249 008e 80B4     	 push {r7}
 250              	.LCFI22:
 251              	 .cfi_def_cfa_offset 4
 252              	 .cfi_offset 7,-4
 253 0090 83B0     	 sub sp,sp,#12
 254              	.LCFI23:
 255              	 .cfi_def_cfa_offset 16
 256 0092 00AF     	 add r7,sp,#0
 257              	.LCFI24:
 258              	 .cfi_def_cfa_register 7
 259 0094 7860     	 str r0,[r7,#4]
 260 0096 3960     	 str r1,[r7]
 137:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_MR &= (~SPI_MR_DLYBCS_Msk);
 261              	 .loc 2 137 0
 262 0098 7B68     	 ldr r3,[r7,#4]
 263 009a 5B68     	 ldr r3,[r3,#4]
 264 009c 23F07F42 	 bic r2,r3,#-16777216
 265 00a0 7B68     	 ldr r3,[r7,#4]
 266 00a2 5A60     	 str r2,[r3,#4]
 138:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_MR |= SPI_MR_DLYBCS(ul_delay);
 267              	 .loc 2 138 0
 268 00a4 7B68     	 ldr r3,[r7,#4]
 269 00a6 5A68     	 ldr r2,[r3,#4]
 270 00a8 3B68     	 ldr r3,[r7]
 271 00aa 1B06     	 lsls r3,r3,#24
 272 00ac 1A43     	 orrs r2,r2,r3
 273 00ae 7B68     	 ldr r3,[r7,#4]
 274 00b0 5A60     	 str r2,[r3,#4]
 139:../../../platform/sam/drivers/spi/spi.c **** }
 275              	 .loc 2 139 0
 276 00b2 00BF     	 nop
 277 00b4 0C37     	 adds r7,r7,#12
 278              	.LCFI25:
 279              	 .cfi_def_cfa_offset 4
 280 00b6 BD46     	 mov sp,r7
 281              	.LCFI26:
 282              	 .cfi_def_cfa_register 13
 283              	 
 284 00b8 80BC     	 pop {r7}
 285              	.LCFI27:
 286              	 .cfi_restore 7
 287              	 .cfi_def_cfa_offset 0
 288 00ba 7047     	 bx lr
 289              	 .cfi_endproc
 290              	.LFE216:
 292              	 .align 1
 293              	 .global spi_read
 294              	 .syntax unified
 295              	 .thumb
 296              	 .thumb_func
 297              	 .fpu softvfp
 299              	spi_read:
 300              	.LFB217:
 140:../../../platform/sam/drivers/spi/spi.c **** 
 141:../../../platform/sam/drivers/spi/spi.c **** /**
 142:../../../platform/sam/drivers/spi/spi.c ****  * \brief Read the received data and it's peripheral chip select value.
 143:../../../platform/sam/drivers/spi/spi.c ****  * While SPI works in fixed peripheral select mode, the peripheral chip select
 144:../../../platform/sam/drivers/spi/spi.c ****  * value is meaningless.
 145:../../../platform/sam/drivers/spi/spi.c ****  *
 146:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 147:../../../platform/sam/drivers/spi/spi.c ****  * \param data Pointer to the location where to store the received data word.
 148:../../../platform/sam/drivers/spi/spi.c ****  * \param p_pcs Pointer to fill Peripheral Chip Select Value.
 149:../../../platform/sam/drivers/spi/spi.c ****  *
 150:../../../platform/sam/drivers/spi/spi.c ****  * \retval SPI_OK on Success.
 151:../../../platform/sam/drivers/spi/spi.c ****  * \retval SPI_ERROR_TIMEOUT on Time-out.
 152:../../../platform/sam/drivers/spi/spi.c ****  */
 153:../../../platform/sam/drivers/spi/spi.c **** spi_status_t spi_read(Spi *p_spi, uint16_t *us_data, uint8_t *p_pcs)
 154:../../../platform/sam/drivers/spi/spi.c **** {
 301              	 .loc 2 154 0
 302              	 .cfi_startproc
 303              	 
 304              	 
 305 00bc 80B5     	 push {r7,lr}
 306              	.LCFI28:
 307              	 .cfi_def_cfa_offset 8
 308              	 .cfi_offset 7,-8
 309              	 .cfi_offset 14,-4
 310 00be 86B0     	 sub sp,sp,#24
 311              	.LCFI29:
 312              	 .cfi_def_cfa_offset 32
 313 00c0 00AF     	 add r7,sp,#0
 314              	.LCFI30:
 315              	 .cfi_def_cfa_register 7
 316 00c2 F860     	 str r0,[r7,#12]
 317 00c4 B960     	 str r1,[r7,#8]
 318 00c6 7A60     	 str r2,[r7,#4]
 155:../../../platform/sam/drivers/spi/spi.c **** 	uint32_t timeout = SPI_TIMEOUT;
 319              	 .loc 2 155 0
 320 00c8 43F69823 	 movw r3,#15000
 321 00cc 7B61     	 str r3,[r7,#20]
 156:../../../platform/sam/drivers/spi/spi.c **** 	static uint32_t reg_value;
 157:../../../platform/sam/drivers/spi/spi.c **** 
 158:../../../platform/sam/drivers/spi/spi.c **** 	while (!(p_spi->SPI_SR & SPI_SR_RDRF)) {
 322              	 .loc 2 158 0
 323 00ce 06E0     	 b .L13
 324              	.L15:
 159:../../../platform/sam/drivers/spi/spi.c **** 		if (!timeout--) {
 325              	 .loc 2 159 0
 326 00d0 7B69     	 ldr r3,[r7,#20]
 327 00d2 5A1E     	 subs r2,r3,#1
 328 00d4 7A61     	 str r2,[r7,#20]
 329 00d6 002B     	 cmp r3,#0
 330 00d8 01D1     	 bne .L13
 160:../../../platform/sam/drivers/spi/spi.c **** 			return SPI_ERROR_TIMEOUT;
 331              	 .loc 2 160 0
 332 00da 0123     	 movs r3,#1
 333 00dc 1EE0     	 b .L14
 334              	.L13:
 158:../../../platform/sam/drivers/spi/spi.c **** 		if (!timeout--) {
 335              	 .loc 2 158 0
 336 00de FB68     	 ldr r3,[r7,#12]
 337 00e0 1B69     	 ldr r3,[r3,#16]
 338 00e2 03F00103 	 and r3,r3,#1
 339 00e6 002B     	 cmp r3,#0
 340 00e8 F2D0     	 beq .L15
 161:../../../platform/sam/drivers/spi/spi.c **** 		}
 162:../../../platform/sam/drivers/spi/spi.c **** 	}
 163:../../../platform/sam/drivers/spi/spi.c **** 
 164:../../../platform/sam/drivers/spi/spi.c **** 	reg_value = p_spi->SPI_RDR;
 341              	 .loc 2 164 0
 342 00ea FB68     	 ldr r3,[r7,#12]
 343 00ec 9B68     	 ldr r3,[r3,#8]
 344 00ee 0D4A     	 ldr r2,.L17
 345 00f0 1360     	 str r3,[r2]
 165:../../../platform/sam/drivers/spi/spi.c **** 	if (spi_get_peripheral_select_mode(p_spi)) {
 346              	 .loc 2 165 0
 347 00f2 F868     	 ldr r0,[r7,#12]
 348 00f4 FFF784FF 	 bl spi_get_peripheral_select_mode
 349 00f8 0346     	 mov r3,r0
 350 00fa 002B     	 cmp r3,#0
 351 00fc 08D0     	 beq .L16
 166:../../../platform/sam/drivers/spi/spi.c **** 		*p_pcs = (uint8_t) ((reg_value & SPI_RDR_PCS_Msk) >> SPI_RDR_PCS_Pos);
 352              	 .loc 2 166 0
 353 00fe 094B     	 ldr r3,.L17
 354 0100 1B68     	 ldr r3,[r3]
 355 0102 1B0C     	 lsrs r3,r3,#16
 356 0104 DBB2     	 uxtb r3,r3
 357 0106 03F00F03 	 and r3,r3,#15
 358 010a DAB2     	 uxtb r2,r3
 359 010c 7B68     	 ldr r3,[r7,#4]
 360 010e 1A70     	 strb r2,[r3]
 361              	.L16:
 167:../../../platform/sam/drivers/spi/spi.c **** 	}
 168:../../../platform/sam/drivers/spi/spi.c **** 	*us_data = (uint16_t) (reg_value & SPI_RDR_RD_Msk);
 362              	 .loc 2 168 0
 363 0110 044B     	 ldr r3,.L17
 364 0112 1B68     	 ldr r3,[r3]
 365 0114 9AB2     	 uxth r2,r3
 366 0116 BB68     	 ldr r3,[r7,#8]
 367 0118 1A80     	 strh r2,[r3]
 169:../../../platform/sam/drivers/spi/spi.c **** 
 170:../../../platform/sam/drivers/spi/spi.c **** 	return SPI_OK;
 368              	 .loc 2 170 0
 369 011a 0023     	 movs r3,#0
 370              	.L14:
 171:../../../platform/sam/drivers/spi/spi.c **** }
 371              	 .loc 2 171 0
 372 011c 1846     	 mov r0,r3
 373 011e 1837     	 adds r7,r7,#24
 374              	.LCFI31:
 375              	 .cfi_def_cfa_offset 8
 376 0120 BD46     	 mov sp,r7
 377              	.LCFI32:
 378              	 .cfi_def_cfa_register 13
 379              	 
 380 0122 80BD     	 pop {r7,pc}
 381              	.L18:
 382              	 .align 2
 383              	.L17:
 384 0124 00000000 	 .word reg_value.8778
 385              	 .cfi_endproc
 386              	.LFE217:
 388              	 .align 1
 389              	 .global spi_write
 390              	 .syntax unified
 391              	 .thumb
 392              	 .thumb_func
 393              	 .fpu softvfp
 395              	spi_write:
 396              	.LFB218:
 172:../../../platform/sam/drivers/spi/spi.c **** 
 173:../../../platform/sam/drivers/spi/spi.c **** /**
 174:../../../platform/sam/drivers/spi/spi.c ****  * \brief Write the transmitted data with specified peripheral chip select value.
 175:../../../platform/sam/drivers/spi/spi.c ****  *
 176:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 177:../../../platform/sam/drivers/spi/spi.c ****  * \param us_data The data to transmit.
 178:../../../platform/sam/drivers/spi/spi.c ****  * \param uc_pcs Peripheral Chip Select Value while SPI works in peripheral select
 179:../../../platform/sam/drivers/spi/spi.c ****  * mode, otherwise it's meaningless.
 180:../../../platform/sam/drivers/spi/spi.c ****  * \param uc_last Indicate whether this data is the last one while SPI is working
 181:../../../platform/sam/drivers/spi/spi.c ****  * in variable peripheral select mode.
 182:../../../platform/sam/drivers/spi/spi.c ****  *
 183:../../../platform/sam/drivers/spi/spi.c ****  * \retval SPI_OK on Success.
 184:../../../platform/sam/drivers/spi/spi.c ****  * \retval SPI_ERROR_TIMEOUT on Time-out.
 185:../../../platform/sam/drivers/spi/spi.c ****  */
 186:../../../platform/sam/drivers/spi/spi.c **** spi_status_t spi_write(Spi *p_spi, uint16_t us_data,
 187:../../../platform/sam/drivers/spi/spi.c **** 		uint8_t uc_pcs, uint8_t uc_last)
 188:../../../platform/sam/drivers/spi/spi.c **** {
 397              	 .loc 2 188 0
 398              	 .cfi_startproc
 399              	 
 400              	 
 401 0128 80B5     	 push {r7,lr}
 402              	.LCFI33:
 403              	 .cfi_def_cfa_offset 8
 404              	 .cfi_offset 7,-8
 405              	 .cfi_offset 14,-4
 406 012a 84B0     	 sub sp,sp,#16
 407              	.LCFI34:
 408              	 .cfi_def_cfa_offset 24
 409 012c 00AF     	 add r7,sp,#0
 410              	.LCFI35:
 411              	 .cfi_def_cfa_register 7
 412 012e 7860     	 str r0,[r7,#4]
 413 0130 0846     	 mov r0,r1
 414 0132 1146     	 mov r1,r2
 415 0134 1A46     	 mov r2,r3
 416 0136 0346     	 mov r3,r0
 417 0138 7B80     	 strh r3,[r7,#2]
 418 013a 0B46     	 mov r3,r1
 419 013c 7B70     	 strb r3,[r7,#1]
 420 013e 1346     	 mov r3,r2
 421 0140 3B70     	 strb r3,[r7]
 189:../../../platform/sam/drivers/spi/spi.c **** 	uint32_t timeout = SPI_TIMEOUT;
 422              	 .loc 2 189 0
 423 0142 43F69823 	 movw r3,#15000
 424 0146 FB60     	 str r3,[r7,#12]
 190:../../../platform/sam/drivers/spi/spi.c **** 	uint32_t value;
 191:../../../platform/sam/drivers/spi/spi.c **** 
 192:../../../platform/sam/drivers/spi/spi.c **** 	while (!(p_spi->SPI_SR & SPI_SR_TDRE)) {
 425              	 .loc 2 192 0
 426 0148 06E0     	 b .L20
 427              	.L22:
 193:../../../platform/sam/drivers/spi/spi.c **** 		if (!timeout--) {
 428              	 .loc 2 193 0
 429 014a FB68     	 ldr r3,[r7,#12]
 430 014c 5A1E     	 subs r2,r3,#1
 431 014e FA60     	 str r2,[r7,#12]
 432 0150 002B     	 cmp r3,#0
 433 0152 01D1     	 bne .L20
 194:../../../platform/sam/drivers/spi/spi.c **** 			return SPI_ERROR_TIMEOUT;
 434              	 .loc 2 194 0
 435 0154 0123     	 movs r3,#1
 436 0156 20E0     	 b .L21
 437              	.L20:
 192:../../../platform/sam/drivers/spi/spi.c **** 		if (!timeout--) {
 438              	 .loc 2 192 0
 439 0158 7B68     	 ldr r3,[r7,#4]
 440 015a 1B69     	 ldr r3,[r3,#16]
 441 015c 03F00203 	 and r3,r3,#2
 442 0160 002B     	 cmp r3,#0
 443 0162 F2D0     	 beq .L22
 195:../../../platform/sam/drivers/spi/spi.c **** 		}
 196:../../../platform/sam/drivers/spi/spi.c **** 	}
 197:../../../platform/sam/drivers/spi/spi.c **** 
 198:../../../platform/sam/drivers/spi/spi.c **** 	if (spi_get_peripheral_select_mode(p_spi)) {
 444              	 .loc 2 198 0
 445 0164 7868     	 ldr r0,[r7,#4]
 446 0166 FFF74BFF 	 bl spi_get_peripheral_select_mode
 447 016a 0346     	 mov r3,r0
 448 016c 002B     	 cmp r3,#0
 449 016e 0ED0     	 beq .L23
 199:../../../platform/sam/drivers/spi/spi.c **** 		value = SPI_TDR_TD(us_data) | SPI_TDR_PCS(uc_pcs);
 450              	 .loc 2 199 0
 451 0170 7A88     	 ldrh r2,[r7,#2]
 452 0172 7B78     	 ldrb r3,[r7,#1]
 453 0174 1B04     	 lsls r3,r3,#16
 454 0176 03F47023 	 and r3,r3,#983040
 455 017a 1343     	 orrs r3,r3,r2
 456 017c BB60     	 str r3,[r7,#8]
 200:../../../platform/sam/drivers/spi/spi.c **** 		if (uc_last) {
 457              	 .loc 2 200 0
 458 017e 3B78     	 ldrb r3,[r7]
 459 0180 002B     	 cmp r3,#0
 460 0182 06D0     	 beq .L25
 201:../../../platform/sam/drivers/spi/spi.c **** 			value |= SPI_TDR_LASTXFER;
 461              	 .loc 2 201 0
 462 0184 BB68     	 ldr r3,[r7,#8]
 463 0186 43F08073 	 orr r3,r3,#16777216
 464 018a BB60     	 str r3,[r7,#8]
 465 018c 01E0     	 b .L25
 466              	.L23:
 202:../../../platform/sam/drivers/spi/spi.c **** 		}
 203:../../../platform/sam/drivers/spi/spi.c **** 	} else {
 204:../../../platform/sam/drivers/spi/spi.c **** 		value = SPI_TDR_TD(us_data);
 467              	 .loc 2 204 0
 468 018e 7B88     	 ldrh r3,[r7,#2]
 469 0190 BB60     	 str r3,[r7,#8]
 470              	.L25:
 205:../../../platform/sam/drivers/spi/spi.c **** 	}
 206:../../../platform/sam/drivers/spi/spi.c **** 
 207:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_TDR = value;
 471              	 .loc 2 207 0
 472 0192 7B68     	 ldr r3,[r7,#4]
 473 0194 BA68     	 ldr r2,[r7,#8]
 474 0196 DA60     	 str r2,[r3,#12]
 208:../../../platform/sam/drivers/spi/spi.c **** 
 209:../../../platform/sam/drivers/spi/spi.c **** 	return SPI_OK;
 475              	 .loc 2 209 0
 476 0198 0023     	 movs r3,#0
 477              	.L21:
 210:../../../platform/sam/drivers/spi/spi.c **** }
 478              	 .loc 2 210 0
 479 019a 1846     	 mov r0,r3
 480 019c 1037     	 adds r7,r7,#16
 481              	.LCFI36:
 482              	 .cfi_def_cfa_offset 8
 483 019e BD46     	 mov sp,r7
 484              	.LCFI37:
 485              	 .cfi_def_cfa_register 13
 486              	 
 487 01a0 80BD     	 pop {r7,pc}
 488              	 .cfi_endproc
 489              	.LFE218:
 491              	 .align 1
 492              	 .global spi_set_clock_polarity
 493              	 .syntax unified
 494              	 .thumb
 495              	 .thumb_func
 496              	 .fpu softvfp
 498              	spi_set_clock_polarity:
 499              	.LFB219:
 211:../../../platform/sam/drivers/spi/spi.c **** 
 212:../../../platform/sam/drivers/spi/spi.c **** /**
 213:../../../platform/sam/drivers/spi/spi.c ****  * \brief Set clock default state.
 214:../../../platform/sam/drivers/spi/spi.c ****  *
 215:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 216:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_pcs_ch Peripheral Chip Select channel (0~3).
 217:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_polarity Default clock state is logical one(high)/zero(low).
 218:../../../platform/sam/drivers/spi/spi.c ****  */
 219:../../../platform/sam/drivers/spi/spi.c **** void spi_set_clock_polarity(Spi *p_spi, uint32_t ul_pcs_ch,
 220:../../../platform/sam/drivers/spi/spi.c **** 		uint32_t ul_polarity)
 221:../../../platform/sam/drivers/spi/spi.c **** {
 500              	 .loc 2 221 0
 501              	 .cfi_startproc
 502              	 
 503              	 
 504              	 
 505 01a2 80B4     	 push {r7}
 506              	.LCFI38:
 507              	 .cfi_def_cfa_offset 4
 508              	 .cfi_offset 7,-4
 509 01a4 85B0     	 sub sp,sp,#20
 510              	.LCFI39:
 511              	 .cfi_def_cfa_offset 24
 512 01a6 00AF     	 add r7,sp,#0
 513              	.LCFI40:
 514              	 .cfi_def_cfa_register 7
 515 01a8 F860     	 str r0,[r7,#12]
 516 01aa B960     	 str r1,[r7,#8]
 517 01ac 7A60     	 str r2,[r7,#4]
 222:../../../platform/sam/drivers/spi/spi.c **** 	if (ul_polarity) {
 518              	 .loc 2 222 0
 519 01ae 7B68     	 ldr r3,[r7,#4]
 520 01b0 002B     	 cmp r3,#0
 521 01b2 0CD0     	 beq .L27
 223:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] |= SPI_CSR_CPOL;
 522              	 .loc 2 223 0
 523 01b4 FB68     	 ldr r3,[r7,#12]
 524 01b6 BA68     	 ldr r2,[r7,#8]
 525 01b8 0C32     	 adds r2,r2,#12
 526 01ba 53F82230 	 ldr r3,[r3,r2,lsl#2]
 527 01be 43F00101 	 orr r1,r3,#1
 528 01c2 FB68     	 ldr r3,[r7,#12]
 529 01c4 BA68     	 ldr r2,[r7,#8]
 530 01c6 0C32     	 adds r2,r2,#12
 531 01c8 43F82210 	 str r1,[r3,r2,lsl#2]
 224:../../../platform/sam/drivers/spi/spi.c **** 	} else {
 225:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] &= (~SPI_CSR_CPOL);
 226:../../../platform/sam/drivers/spi/spi.c **** 	}
 227:../../../platform/sam/drivers/spi/spi.c **** }
 532              	 .loc 2 227 0
 533 01cc 0BE0     	 b .L29
 534              	.L27:
 225:../../../platform/sam/drivers/spi/spi.c **** 	}
 535              	 .loc 2 225 0
 536 01ce FB68     	 ldr r3,[r7,#12]
 537 01d0 BA68     	 ldr r2,[r7,#8]
 538 01d2 0C32     	 adds r2,r2,#12
 539 01d4 53F82230 	 ldr r3,[r3,r2,lsl#2]
 540 01d8 23F00101 	 bic r1,r3,#1
 541 01dc FB68     	 ldr r3,[r7,#12]
 542 01de BA68     	 ldr r2,[r7,#8]
 543 01e0 0C32     	 adds r2,r2,#12
 544 01e2 43F82210 	 str r1,[r3,r2,lsl#2]
 545              	.L29:
 546              	 .loc 2 227 0
 547 01e6 00BF     	 nop
 548 01e8 1437     	 adds r7,r7,#20
 549              	.LCFI41:
 550              	 .cfi_def_cfa_offset 4
 551 01ea BD46     	 mov sp,r7
 552              	.LCFI42:
 553              	 .cfi_def_cfa_register 13
 554              	 
 555 01ec 80BC     	 pop {r7}
 556              	.LCFI43:
 557              	 .cfi_restore 7
 558              	 .cfi_def_cfa_offset 0
 559 01ee 7047     	 bx lr
 560              	 .cfi_endproc
 561              	.LFE219:
 563              	 .align 1
 564              	 .global spi_set_clock_phase
 565              	 .syntax unified
 566              	 .thumb
 567              	 .thumb_func
 568              	 .fpu softvfp
 570              	spi_set_clock_phase:
 571              	.LFB220:
 228:../../../platform/sam/drivers/spi/spi.c **** 
 229:../../../platform/sam/drivers/spi/spi.c **** /**
 230:../../../platform/sam/drivers/spi/spi.c ****  * \brief Set Data Capture Phase.
 231:../../../platform/sam/drivers/spi/spi.c ****  *
 232:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 233:../../../platform/sam/drivers/spi/spi.c ****  *  \param ul_pcs_ch Peripheral Chip Select channel (0~3).
 234:../../../platform/sam/drivers/spi/spi.c ****  *  \param ul_phase Data capture on the rising/falling edge of clock.
 235:../../../platform/sam/drivers/spi/spi.c ****  */
 236:../../../platform/sam/drivers/spi/spi.c **** void spi_set_clock_phase(Spi *p_spi, uint32_t ul_pcs_ch, uint32_t ul_phase)
 237:../../../platform/sam/drivers/spi/spi.c **** {
 572              	 .loc 2 237 0
 573              	 .cfi_startproc
 574              	 
 575              	 
 576              	 
 577 01f0 80B4     	 push {r7}
 578              	.LCFI44:
 579              	 .cfi_def_cfa_offset 4
 580              	 .cfi_offset 7,-4
 581 01f2 85B0     	 sub sp,sp,#20
 582              	.LCFI45:
 583              	 .cfi_def_cfa_offset 24
 584 01f4 00AF     	 add r7,sp,#0
 585              	.LCFI46:
 586              	 .cfi_def_cfa_register 7
 587 01f6 F860     	 str r0,[r7,#12]
 588 01f8 B960     	 str r1,[r7,#8]
 589 01fa 7A60     	 str r2,[r7,#4]
 238:../../../platform/sam/drivers/spi/spi.c **** 	if (ul_phase) {
 590              	 .loc 2 238 0
 591 01fc 7B68     	 ldr r3,[r7,#4]
 592 01fe 002B     	 cmp r3,#0
 593 0200 0CD0     	 beq .L31
 239:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] |= SPI_CSR_NCPHA;
 594              	 .loc 2 239 0
 595 0202 FB68     	 ldr r3,[r7,#12]
 596 0204 BA68     	 ldr r2,[r7,#8]
 597 0206 0C32     	 adds r2,r2,#12
 598 0208 53F82230 	 ldr r3,[r3,r2,lsl#2]
 599 020c 43F00201 	 orr r1,r3,#2
 600 0210 FB68     	 ldr r3,[r7,#12]
 601 0212 BA68     	 ldr r2,[r7,#8]
 602 0214 0C32     	 adds r2,r2,#12
 603 0216 43F82210 	 str r1,[r3,r2,lsl#2]
 240:../../../platform/sam/drivers/spi/spi.c **** 	} else {
 241:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] &= (~SPI_CSR_NCPHA);
 242:../../../platform/sam/drivers/spi/spi.c **** 	}
 243:../../../platform/sam/drivers/spi/spi.c **** }
 604              	 .loc 2 243 0
 605 021a 0BE0     	 b .L33
 606              	.L31:
 241:../../../platform/sam/drivers/spi/spi.c **** 	}
 607              	 .loc 2 241 0
 608 021c FB68     	 ldr r3,[r7,#12]
 609 021e BA68     	 ldr r2,[r7,#8]
 610 0220 0C32     	 adds r2,r2,#12
 611 0222 53F82230 	 ldr r3,[r3,r2,lsl#2]
 612 0226 23F00201 	 bic r1,r3,#2
 613 022a FB68     	 ldr r3,[r7,#12]
 614 022c BA68     	 ldr r2,[r7,#8]
 615 022e 0C32     	 adds r2,r2,#12
 616 0230 43F82210 	 str r1,[r3,r2,lsl#2]
 617              	.L33:
 618              	 .loc 2 243 0
 619 0234 00BF     	 nop
 620 0236 1437     	 adds r7,r7,#20
 621              	.LCFI47:
 622              	 .cfi_def_cfa_offset 4
 623 0238 BD46     	 mov sp,r7
 624              	.LCFI48:
 625              	 .cfi_def_cfa_register 13
 626              	 
 627 023a 80BC     	 pop {r7}
 628              	.LCFI49:
 629              	 .cfi_restore 7
 630              	 .cfi_def_cfa_offset 0
 631 023c 7047     	 bx lr
 632              	 .cfi_endproc
 633              	.LFE220:
 635              	 .align 1
 636              	 .global spi_configure_cs_behavior
 637              	 .syntax unified
 638              	 .thumb
 639              	 .thumb_func
 640              	 .fpu softvfp
 642              	spi_configure_cs_behavior:
 643              	.LFB221:
 244:../../../platform/sam/drivers/spi/spi.c **** 
 245:../../../platform/sam/drivers/spi/spi.c **** /**
 246:../../../platform/sam/drivers/spi/spi.c ****  * \brief Configure CS behavior for SPI transfer (\ref spi_cs_behavior_t).
 247:../../../platform/sam/drivers/spi/spi.c ****  *
 248:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 249:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_pcs_ch Peripheral Chip Select channel (0~3).
 250:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_cs_behavior Behavior of the Chip Select after transfer.
 251:../../../platform/sam/drivers/spi/spi.c ****  */
 252:../../../platform/sam/drivers/spi/spi.c **** void spi_configure_cs_behavior(Spi *p_spi, uint32_t ul_pcs_ch,
 253:../../../platform/sam/drivers/spi/spi.c **** 		uint32_t ul_cs_behavior)
 254:../../../platform/sam/drivers/spi/spi.c **** {
 644              	 .loc 2 254 0
 645              	 .cfi_startproc
 646              	 
 647              	 
 648              	 
 649 023e 80B4     	 push {r7}
 650              	.LCFI50:
 651              	 .cfi_def_cfa_offset 4
 652              	 .cfi_offset 7,-4
 653 0240 85B0     	 sub sp,sp,#20
 654              	.LCFI51:
 655              	 .cfi_def_cfa_offset 24
 656 0242 00AF     	 add r7,sp,#0
 657              	.LCFI52:
 658              	 .cfi_def_cfa_register 7
 659 0244 F860     	 str r0,[r7,#12]
 660 0246 B960     	 str r1,[r7,#8]
 661 0248 7A60     	 str r2,[r7,#4]
 255:../../../platform/sam/drivers/spi/spi.c **** 	if (ul_cs_behavior == SPI_CS_RISE_FORCED) {
 662              	 .loc 2 255 0
 663 024a 7B68     	 ldr r3,[r7,#4]
 664 024c 042B     	 cmp r3,#4
 665 024e 18D1     	 bne .L35
 256:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] &= (~SPI_CSR_CSAAT);
 666              	 .loc 2 256 0
 667 0250 FB68     	 ldr r3,[r7,#12]
 668 0252 BA68     	 ldr r2,[r7,#8]
 669 0254 0C32     	 adds r2,r2,#12
 670 0256 53F82230 	 ldr r3,[r3,r2,lsl#2]
 671 025a 23F00801 	 bic r1,r3,#8
 672 025e FB68     	 ldr r3,[r7,#12]
 673 0260 BA68     	 ldr r2,[r7,#8]
 674 0262 0C32     	 adds r2,r2,#12
 675 0264 43F82210 	 str r1,[r3,r2,lsl#2]
 257:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] |= SPI_CSR_CSNAAT;
 676              	 .loc 2 257 0
 677 0268 FB68     	 ldr r3,[r7,#12]
 678 026a BA68     	 ldr r2,[r7,#8]
 679 026c 0C32     	 adds r2,r2,#12
 680 026e 53F82230 	 ldr r3,[r3,r2,lsl#2]
 681 0272 43F00401 	 orr r1,r3,#4
 682 0276 FB68     	 ldr r3,[r7,#12]
 683 0278 BA68     	 ldr r2,[r7,#8]
 684 027a 0C32     	 adds r2,r2,#12
 685 027c 43F82210 	 str r1,[r3,r2,lsl#2]
 258:../../../platform/sam/drivers/spi/spi.c **** 	} else if (ul_cs_behavior == SPI_CS_RISE_NO_TX) {
 259:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] &= (~SPI_CSR_CSAAT);
 260:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] &= (~SPI_CSR_CSNAAT);
 261:../../../platform/sam/drivers/spi/spi.c **** 	} else if (ul_cs_behavior == SPI_CS_KEEP_LOW) {
 262:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] |= SPI_CSR_CSAAT;
 263:../../../platform/sam/drivers/spi/spi.c **** 	}
 264:../../../platform/sam/drivers/spi/spi.c **** }
 686              	 .loc 2 264 0
 687 0280 2AE0     	 b .L38
 688              	.L35:
 258:../../../platform/sam/drivers/spi/spi.c **** 	} else if (ul_cs_behavior == SPI_CS_RISE_NO_TX) {
 689              	 .loc 2 258 0
 690 0282 7B68     	 ldr r3,[r7,#4]
 691 0284 002B     	 cmp r3,#0
 692 0286 18D1     	 bne .L37
 259:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] &= (~SPI_CSR_CSNAAT);
 693              	 .loc 2 259 0
 694 0288 FB68     	 ldr r3,[r7,#12]
 695 028a BA68     	 ldr r2,[r7,#8]
 696 028c 0C32     	 adds r2,r2,#12
 697 028e 53F82230 	 ldr r3,[r3,r2,lsl#2]
 698 0292 23F00801 	 bic r1,r3,#8
 699 0296 FB68     	 ldr r3,[r7,#12]
 700 0298 BA68     	 ldr r2,[r7,#8]
 701 029a 0C32     	 adds r2,r2,#12
 702 029c 43F82210 	 str r1,[r3,r2,lsl#2]
 260:../../../platform/sam/drivers/spi/spi.c **** 	} else if (ul_cs_behavior == SPI_CS_KEEP_LOW) {
 703              	 .loc 2 260 0
 704 02a0 FB68     	 ldr r3,[r7,#12]
 705 02a2 BA68     	 ldr r2,[r7,#8]
 706 02a4 0C32     	 adds r2,r2,#12
 707 02a6 53F82230 	 ldr r3,[r3,r2,lsl#2]
 708 02aa 23F00401 	 bic r1,r3,#4
 709 02ae FB68     	 ldr r3,[r7,#12]
 710 02b0 BA68     	 ldr r2,[r7,#8]
 711 02b2 0C32     	 adds r2,r2,#12
 712 02b4 43F82210 	 str r1,[r3,r2,lsl#2]
 713              	 .loc 2 264 0
 714 02b8 0EE0     	 b .L38
 715              	.L37:
 261:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_CSR[ul_pcs_ch] |= SPI_CSR_CSAAT;
 716              	 .loc 2 261 0
 717 02ba 7B68     	 ldr r3,[r7,#4]
 718 02bc 082B     	 cmp r3,#8
 719 02be 0BD1     	 bne .L38
 262:../../../platform/sam/drivers/spi/spi.c **** 	}
 720              	 .loc 2 262 0
 721 02c0 FB68     	 ldr r3,[r7,#12]
 722 02c2 BA68     	 ldr r2,[r7,#8]
 723 02c4 0C32     	 adds r2,r2,#12
 724 02c6 53F82230 	 ldr r3,[r3,r2,lsl#2]
 725 02ca 43F00801 	 orr r1,r3,#8
 726 02ce FB68     	 ldr r3,[r7,#12]
 727 02d0 BA68     	 ldr r2,[r7,#8]
 728 02d2 0C32     	 adds r2,r2,#12
 729 02d4 43F82210 	 str r1,[r3,r2,lsl#2]
 730              	.L38:
 731              	 .loc 2 264 0
 732 02d8 00BF     	 nop
 733 02da 1437     	 adds r7,r7,#20
 734              	.LCFI53:
 735              	 .cfi_def_cfa_offset 4
 736 02dc BD46     	 mov sp,r7
 737              	.LCFI54:
 738              	 .cfi_def_cfa_register 13
 739              	 
 740 02de 80BC     	 pop {r7}
 741              	.LCFI55:
 742              	 .cfi_restore 7
 743              	 .cfi_def_cfa_offset 0
 744 02e0 7047     	 bx lr
 745              	 .cfi_endproc
 746              	.LFE221:
 748              	 .align 1
 749              	 .global spi_set_bits_per_transfer
 750              	 .syntax unified
 751              	 .thumb
 752              	 .thumb_func
 753              	 .fpu softvfp
 755              	spi_set_bits_per_transfer:
 756              	.LFB222:
 265:../../../platform/sam/drivers/spi/spi.c **** 
 266:../../../platform/sam/drivers/spi/spi.c **** /**
 267:../../../platform/sam/drivers/spi/spi.c ****  * \brief Set number of bits per transfer.
 268:../../../platform/sam/drivers/spi/spi.c ****  *
 269:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 270:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_pcs_ch Peripheral Chip Select channel (0~3).
 271:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_bits Number of bits (8~16), use the pattern defined
 272:../../../platform/sam/drivers/spi/spi.c ****  *        in the device header file.
 273:../../../platform/sam/drivers/spi/spi.c ****  */
 274:../../../platform/sam/drivers/spi/spi.c **** void spi_set_bits_per_transfer(Spi *p_spi, uint32_t ul_pcs_ch,
 275:../../../platform/sam/drivers/spi/spi.c **** 		uint32_t ul_bits)
 276:../../../platform/sam/drivers/spi/spi.c **** {
 757              	 .loc 2 276 0
 758              	 .cfi_startproc
 759              	 
 760              	 
 761              	 
 762 02e2 80B4     	 push {r7}
 763              	.LCFI56:
 764              	 .cfi_def_cfa_offset 4
 765              	 .cfi_offset 7,-4
 766 02e4 85B0     	 sub sp,sp,#20
 767              	.LCFI57:
 768              	 .cfi_def_cfa_offset 24
 769 02e6 00AF     	 add r7,sp,#0
 770              	.LCFI58:
 771              	 .cfi_def_cfa_register 7
 772 02e8 F860     	 str r0,[r7,#12]
 773 02ea B960     	 str r1,[r7,#8]
 774 02ec 7A60     	 str r2,[r7,#4]
 277:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_CSR[ul_pcs_ch] &= (~SPI_CSR_BITS_Msk);
 775              	 .loc 2 277 0
 776 02ee FB68     	 ldr r3,[r7,#12]
 777 02f0 BA68     	 ldr r2,[r7,#8]
 778 02f2 0C32     	 adds r2,r2,#12
 779 02f4 53F82230 	 ldr r3,[r3,r2,lsl#2]
 780 02f8 23F0F001 	 bic r1,r3,#240
 781 02fc FB68     	 ldr r3,[r7,#12]
 782 02fe BA68     	 ldr r2,[r7,#8]
 783 0300 0C32     	 adds r2,r2,#12
 784 0302 43F82210 	 str r1,[r3,r2,lsl#2]
 278:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_CSR[ul_pcs_ch] |= ul_bits;
 785              	 .loc 2 278 0
 786 0306 FB68     	 ldr r3,[r7,#12]
 787 0308 BA68     	 ldr r2,[r7,#8]
 788 030a 0C32     	 adds r2,r2,#12
 789 030c 53F82220 	 ldr r2,[r3,r2,lsl#2]
 790 0310 7B68     	 ldr r3,[r7,#4]
 791 0312 42EA0301 	 orr r1,r2,r3
 792 0316 FB68     	 ldr r3,[r7,#12]
 793 0318 BA68     	 ldr r2,[r7,#8]
 794 031a 0C32     	 adds r2,r2,#12
 795 031c 43F82210 	 str r1,[r3,r2,lsl#2]
 279:../../../platform/sam/drivers/spi/spi.c **** }
 796              	 .loc 2 279 0
 797 0320 00BF     	 nop
 798 0322 1437     	 adds r7,r7,#20
 799              	.LCFI59:
 800              	 .cfi_def_cfa_offset 4
 801 0324 BD46     	 mov sp,r7
 802              	.LCFI60:
 803              	 .cfi_def_cfa_register 13
 804              	 
 805 0326 80BC     	 pop {r7}
 806              	.LCFI61:
 807              	 .cfi_restore 7
 808              	 .cfi_def_cfa_offset 0
 809 0328 7047     	 bx lr
 810              	 .cfi_endproc
 811              	.LFE222:
 813              	 .align 1
 814              	 .global spi_calc_baudrate_div
 815              	 .syntax unified
 816              	 .thumb
 817              	 .thumb_func
 818              	 .fpu softvfp
 820              	spi_calc_baudrate_div:
 821              	.LFB223:
 280:../../../platform/sam/drivers/spi/spi.c **** 
 281:../../../platform/sam/drivers/spi/spi.c **** /**
 282:../../../platform/sam/drivers/spi/spi.c ****  * \brief Calculate the baudrate divider.
 283:../../../platform/sam/drivers/spi/spi.c ****  *
 284:../../../platform/sam/drivers/spi/spi.c ****  * \param baudrate Baudrate value.
 285:../../../platform/sam/drivers/spi/spi.c ****  * \param mck      SPI module input clock frequency (MCK clock, Hz).
 286:../../../platform/sam/drivers/spi/spi.c ****  *
 287:../../../platform/sam/drivers/spi/spi.c ****  * \return Divider or error code.
 288:../../../platform/sam/drivers/spi/spi.c ****  *   \retval > 0  Success.
 289:../../../platform/sam/drivers/spi/spi.c ****  *   \retval < 0  Error.
 290:../../../platform/sam/drivers/spi/spi.c ****  */
 291:../../../platform/sam/drivers/spi/spi.c **** int16_t spi_calc_baudrate_div(const uint32_t baudrate, uint32_t mck)
 292:../../../platform/sam/drivers/spi/spi.c **** {
 822              	 .loc 2 292 0
 823              	 .cfi_startproc
 824              	 
 825              	 
 826              	 
 827 032a 80B4     	 push {r7}
 828              	.LCFI62:
 829              	 .cfi_def_cfa_offset 4
 830              	 .cfi_offset 7,-4
 831 032c 85B0     	 sub sp,sp,#20
 832              	.LCFI63:
 833              	 .cfi_def_cfa_offset 24
 834 032e 00AF     	 add r7,sp,#0
 835              	.LCFI64:
 836              	 .cfi_def_cfa_register 7
 837 0330 7860     	 str r0,[r7,#4]
 838 0332 3960     	 str r1,[r7]
 293:../../../platform/sam/drivers/spi/spi.c **** 	int baud_div = div_ceil(mck, baudrate);
 839              	 .loc 2 293 0
 840 0334 3A68     	 ldr r2,[r7]
 841 0336 7B68     	 ldr r3,[r7,#4]
 842 0338 1344     	 add r3,r3,r2
 843 033a 5A1E     	 subs r2,r3,#1
 844 033c 7B68     	 ldr r3,[r7,#4]
 845 033e B2FBF3F3 	 udiv r3,r2,r3
 846 0342 FB60     	 str r3,[r7,#12]
 294:../../../platform/sam/drivers/spi/spi.c **** 
 295:../../../platform/sam/drivers/spi/spi.c **** 	/* The value of baud_div is from 1 to 255 in the SCBR field. */
 296:../../../platform/sam/drivers/spi/spi.c **** 	if (baud_div <= 0 || baud_div > 255) {
 847              	 .loc 2 296 0
 848 0344 FB68     	 ldr r3,[r7,#12]
 849 0346 002B     	 cmp r3,#0
 850 0348 02DD     	 ble .L41
 851              	 .loc 2 296 0 is_stmt 0 discriminator 1
 852 034a FB68     	 ldr r3,[r7,#12]
 853 034c FF2B     	 cmp r3,#255
 854 034e 02DD     	 ble .L42
 855              	.L41:
 297:../../../platform/sam/drivers/spi/spi.c **** 		return -1;
 856              	 .loc 2 297 0 is_stmt 1
 857 0350 4FF0FF33 	 mov r3,#-1
 858 0354 01E0     	 b .L43
 859              	.L42:
 298:../../../platform/sam/drivers/spi/spi.c **** 	}
 299:../../../platform/sam/drivers/spi/spi.c **** 
 300:../../../platform/sam/drivers/spi/spi.c **** 	return baud_div;
 860              	 .loc 2 300 0
 861 0356 FB68     	 ldr r3,[r7,#12]
 862 0358 1BB2     	 sxth r3,r3
 863              	.L43:
 301:../../../platform/sam/drivers/spi/spi.c **** }
 864              	 .loc 2 301 0
 865 035a 1846     	 mov r0,r3
 866 035c 1437     	 adds r7,r7,#20
 867              	.LCFI65:
 868              	 .cfi_def_cfa_offset 4
 869 035e BD46     	 mov sp,r7
 870              	.LCFI66:
 871              	 .cfi_def_cfa_register 13
 872              	 
 873 0360 80BC     	 pop {r7}
 874              	.LCFI67:
 875              	 .cfi_restore 7
 876              	 .cfi_def_cfa_offset 0
 877 0362 7047     	 bx lr
 878              	 .cfi_endproc
 879              	.LFE223:
 881              	 .align 1
 882              	 .global spi_set_baudrate_div
 883              	 .syntax unified
 884              	 .thumb
 885              	 .thumb_func
 886              	 .fpu softvfp
 888              	spi_set_baudrate_div:
 889              	.LFB224:
 302:../../../platform/sam/drivers/spi/spi.c **** 
 303:../../../platform/sam/drivers/spi/spi.c **** /**
 304:../../../platform/sam/drivers/spi/spi.c ****  * \brief Set Serial Clock Baud Rate divider value (SCBR).
 305:../../../platform/sam/drivers/spi/spi.c ****  *
 306:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 307:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_pcs_ch Peripheral Chip Select channel (0~3).
 308:../../../platform/sam/drivers/spi/spi.c ****  * \param uc_baudrate_divider Baudrate divider from MCK.
 309:../../../platform/sam/drivers/spi/spi.c ****  */
 310:../../../platform/sam/drivers/spi/spi.c **** void spi_set_baudrate_div(Spi *p_spi, uint32_t ul_pcs_ch,
 311:../../../platform/sam/drivers/spi/spi.c **** 		uint8_t uc_baudrate_divider)
 312:../../../platform/sam/drivers/spi/spi.c **** {
 890              	 .loc 2 312 0
 891              	 .cfi_startproc
 892              	 
 893              	 
 894              	 
 895 0364 80B4     	 push {r7}
 896              	.LCFI68:
 897              	 .cfi_def_cfa_offset 4
 898              	 .cfi_offset 7,-4
 899 0366 85B0     	 sub sp,sp,#20
 900              	.LCFI69:
 901              	 .cfi_def_cfa_offset 24
 902 0368 00AF     	 add r7,sp,#0
 903              	.LCFI70:
 904              	 .cfi_def_cfa_register 7
 905 036a F860     	 str r0,[r7,#12]
 906 036c B960     	 str r1,[r7,#8]
 907 036e 1346     	 mov r3,r2
 908 0370 FB71     	 strb r3,[r7,#7]
 313:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_CSR[ul_pcs_ch] &= (~SPI_CSR_SCBR_Msk);
 909              	 .loc 2 313 0
 910 0372 FB68     	 ldr r3,[r7,#12]
 911 0374 BA68     	 ldr r2,[r7,#8]
 912 0376 0C32     	 adds r2,r2,#12
 913 0378 53F82230 	 ldr r3,[r3,r2,lsl#2]
 914 037c 23F47F41 	 bic r1,r3,#65280
 915 0380 FB68     	 ldr r3,[r7,#12]
 916 0382 BA68     	 ldr r2,[r7,#8]
 917 0384 0C32     	 adds r2,r2,#12
 918 0386 43F82210 	 str r1,[r3,r2,lsl#2]
 314:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_CSR[ul_pcs_ch] |= SPI_CSR_SCBR(uc_baudrate_divider);
 919              	 .loc 2 314 0
 920 038a FB68     	 ldr r3,[r7,#12]
 921 038c BA68     	 ldr r2,[r7,#8]
 922 038e 0C32     	 adds r2,r2,#12
 923 0390 53F82220 	 ldr r2,[r3,r2,lsl#2]
 924 0394 FB79     	 ldrb r3,[r7,#7]
 925 0396 1B02     	 lsls r3,r3,#8
 926 0398 9BB2     	 uxth r3,r3
 927 039a 42EA0301 	 orr r1,r2,r3
 928 039e FB68     	 ldr r3,[r7,#12]
 929 03a0 BA68     	 ldr r2,[r7,#8]
 930 03a2 0C32     	 adds r2,r2,#12
 931 03a4 43F82210 	 str r1,[r3,r2,lsl#2]
 315:../../../platform/sam/drivers/spi/spi.c **** }
 932              	 .loc 2 315 0
 933 03a8 00BF     	 nop
 934 03aa 1437     	 adds r7,r7,#20
 935              	.LCFI71:
 936              	 .cfi_def_cfa_offset 4
 937 03ac BD46     	 mov sp,r7
 938              	.LCFI72:
 939              	 .cfi_def_cfa_register 13
 940              	 
 941 03ae 80BC     	 pop {r7}
 942              	.LCFI73:
 943              	 .cfi_restore 7
 944              	 .cfi_def_cfa_offset 0
 945 03b0 7047     	 bx lr
 946              	 .cfi_endproc
 947              	.LFE224:
 949              	 .align 1
 950              	 .global spi_set_transfer_delay
 951              	 .syntax unified
 952              	 .thumb
 953              	 .thumb_func
 954              	 .fpu softvfp
 956              	spi_set_transfer_delay:
 957              	.LFB225:
 316:../../../platform/sam/drivers/spi/spi.c **** 
 317:../../../platform/sam/drivers/spi/spi.c **** /**
 318:../../../platform/sam/drivers/spi/spi.c ****  * \brief Configure timing for SPI transfer.
 319:../../../platform/sam/drivers/spi/spi.c ****  *
 320:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 321:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_pcs_ch Peripheral Chip Select channel (0~3).
 322:../../../platform/sam/drivers/spi/spi.c ****  * \param uc_dlybs Delay before SPCK (in number of MCK clocks).
 323:../../../platform/sam/drivers/spi/spi.c ****  * \param uc_dlybct Delay between consecutive transfers (in number of MCK clocks).
 324:../../../platform/sam/drivers/spi/spi.c ****  */
 325:../../../platform/sam/drivers/spi/spi.c **** void spi_set_transfer_delay(Spi *p_spi, uint32_t ul_pcs_ch,
 326:../../../platform/sam/drivers/spi/spi.c **** 		uint8_t uc_dlybs, uint8_t uc_dlybct)
 327:../../../platform/sam/drivers/spi/spi.c **** {
 958              	 .loc 2 327 0
 959              	 .cfi_startproc
 960              	 
 961              	 
 962              	 
 963 03b2 80B4     	 push {r7}
 964              	.LCFI74:
 965              	 .cfi_def_cfa_offset 4
 966              	 .cfi_offset 7,-4
 967 03b4 85B0     	 sub sp,sp,#20
 968              	.LCFI75:
 969              	 .cfi_def_cfa_offset 24
 970 03b6 00AF     	 add r7,sp,#0
 971              	.LCFI76:
 972              	 .cfi_def_cfa_register 7
 973 03b8 F860     	 str r0,[r7,#12]
 974 03ba B960     	 str r1,[r7,#8]
 975 03bc 1146     	 mov r1,r2
 976 03be 1A46     	 mov r2,r3
 977 03c0 0B46     	 mov r3,r1
 978 03c2 FB71     	 strb r3,[r7,#7]
 979 03c4 1346     	 mov r3,r2
 980 03c6 BB71     	 strb r3,[r7,#6]
 328:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_CSR[ul_pcs_ch] &= ~(SPI_CSR_DLYBS_Msk | SPI_CSR_DLYBCT_Msk);
 981              	 .loc 2 328 0
 982 03c8 FB68     	 ldr r3,[r7,#12]
 983 03ca BA68     	 ldr r2,[r7,#8]
 984 03cc 0C32     	 adds r2,r2,#12
 985 03ce 53F82230 	 ldr r3,[r3,r2,lsl#2]
 986 03d2 99B2     	 uxth r1,r3
 987 03d4 FB68     	 ldr r3,[r7,#12]
 988 03d6 BA68     	 ldr r2,[r7,#8]
 989 03d8 0C32     	 adds r2,r2,#12
 990 03da 43F82210 	 str r1,[r3,r2,lsl#2]
 329:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_CSR[ul_pcs_ch] |= SPI_CSR_DLYBS(uc_dlybs)
 991              	 .loc 2 329 0
 992 03de FB68     	 ldr r3,[r7,#12]
 993 03e0 BA68     	 ldr r2,[r7,#8]
 994 03e2 0C32     	 adds r2,r2,#12
 995 03e4 53F82220 	 ldr r2,[r3,r2,lsl#2]
 996 03e8 FB79     	 ldrb r3,[r7,#7]
 997 03ea 1B04     	 lsls r3,r3,#16
 998 03ec 03F47F03 	 and r3,r3,#16711680
 330:../../../platform/sam/drivers/spi/spi.c **** 			| SPI_CSR_DLYBCT(uc_dlybct);
 999              	 .loc 2 330 0
 1000 03f0 B979     	 ldrb r1,[r7,#6]
 1001 03f2 0906     	 lsls r1,r1,#24
 1002 03f4 0B43     	 orrs r3,r3,r1
 329:../../../platform/sam/drivers/spi/spi.c **** 	p_spi->SPI_CSR[ul_pcs_ch] |= SPI_CSR_DLYBS(uc_dlybs)
 1003              	 .loc 2 329 0
 1004 03f6 42EA0301 	 orr r1,r2,r3
 1005 03fa FB68     	 ldr r3,[r7,#12]
 1006 03fc BA68     	 ldr r2,[r7,#8]
 1007 03fe 0C32     	 adds r2,r2,#12
 1008 0400 43F82210 	 str r1,[r3,r2,lsl#2]
 331:../../../platform/sam/drivers/spi/spi.c **** }
 1009              	 .loc 2 331 0
 1010 0404 00BF     	 nop
 1011 0406 1437     	 adds r7,r7,#20
 1012              	.LCFI77:
 1013              	 .cfi_def_cfa_offset 4
 1014 0408 BD46     	 mov sp,r7
 1015              	.LCFI78:
 1016              	 .cfi_def_cfa_register 13
 1017              	 
 1018 040a 80BC     	 pop {r7}
 1019              	.LCFI79:
 1020              	 .cfi_restore 7
 1021              	 .cfi_def_cfa_offset 0
 1022 040c 7047     	 bx lr
 1023              	 .cfi_endproc
 1024              	.LFE225:
 1026              	 .align 1
 1027              	 .global spi_set_writeprotect
 1028              	 .syntax unified
 1029              	 .thumb
 1030              	 .thumb_func
 1031              	 .fpu softvfp
 1033              	spi_set_writeprotect:
 1034              	.LFB226:
 332:../../../platform/sam/drivers/spi/spi.c **** 
 333:../../../platform/sam/drivers/spi/spi.c **** 
 334:../../../platform/sam/drivers/spi/spi.c **** /**
 335:../../../platform/sam/drivers/spi/spi.c ****  * \brief Enable or disable write protection of SPI registers.
 336:../../../platform/sam/drivers/spi/spi.c ****  *
 337:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 338:../../../platform/sam/drivers/spi/spi.c ****  * \param ul_enable 1 to enable, 0 to disable.
 339:../../../platform/sam/drivers/spi/spi.c ****  */
 340:../../../platform/sam/drivers/spi/spi.c **** void spi_set_writeprotect(Spi *p_spi, uint32_t ul_enable)
 341:../../../platform/sam/drivers/spi/spi.c **** {
 1035              	 .loc 2 341 0
 1036              	 .cfi_startproc
 1037              	 
 1038              	 
 1039              	 
 1040 040e 80B4     	 push {r7}
 1041              	.LCFI80:
 1042              	 .cfi_def_cfa_offset 4
 1043              	 .cfi_offset 7,-4
 1044 0410 83B0     	 sub sp,sp,#12
 1045              	.LCFI81:
 1046              	 .cfi_def_cfa_offset 16
 1047 0412 00AF     	 add r7,sp,#0
 1048              	.LCFI82:
 1049              	 .cfi_def_cfa_register 7
 1050 0414 7860     	 str r0,[r7,#4]
 1051 0416 3960     	 str r1,[r7]
 342:../../../platform/sam/drivers/spi/spi.c **** #if SAM4L
 343:../../../platform/sam/drivers/spi/spi.c **** 	if (ul_enable) {
 1052              	 .loc 2 343 0
 1053 0418 3B68     	 ldr r3,[r7]
 1054 041a 002B     	 cmp r3,#0
 1055 041c 04D0     	 beq .L47
 344:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_WPCR = SPI_WPCR_SPIWPKEY_VALUE | SPI_WPCR_SPIWPEN;
 1056              	 .loc 2 344 0
 1057 041e 7B68     	 ldr r3,[r7,#4]
 1058 0420 064A     	 ldr r2,.L50
 1059 0422 C3F8E420 	 str r2,[r3,#228]
 345:../../../platform/sam/drivers/spi/spi.c **** 	} else {
 346:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_WPCR = SPI_WPCR_SPIWPKEY_VALUE;
 347:../../../platform/sam/drivers/spi/spi.c **** 	}
 348:../../../platform/sam/drivers/spi/spi.c **** #else
 349:../../../platform/sam/drivers/spi/spi.c **** 	if (ul_enable) {
 350:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_WPMR = SPI_WPMR_WPKEY_PASSWD | SPI_WPMR_WPEN;
 351:../../../platform/sam/drivers/spi/spi.c **** 	} else {
 352:../../../platform/sam/drivers/spi/spi.c **** 		p_spi->SPI_WPMR = SPI_WPMR_WPKEY_PASSWD;
 353:../../../platform/sam/drivers/spi/spi.c **** 	}
 354:../../../platform/sam/drivers/spi/spi.c **** #endif
 355:../../../platform/sam/drivers/spi/spi.c **** }
 1060              	 .loc 2 355 0
 1061 0426 03E0     	 b .L49
 1062              	.L47:
 346:../../../platform/sam/drivers/spi/spi.c **** 	}
 1063              	 .loc 2 346 0
 1064 0428 7B68     	 ldr r3,[r7,#4]
 1065 042a 054A     	 ldr r2,.L50+4
 1066 042c C3F8E420 	 str r2,[r3,#228]
 1067              	.L49:
 1068              	 .loc 2 355 0
 1069 0430 00BF     	 nop
 1070 0432 0C37     	 adds r7,r7,#12
 1071              	.LCFI83:
 1072              	 .cfi_def_cfa_offset 4
 1073 0434 BD46     	 mov sp,r7
 1074              	.LCFI84:
 1075              	 .cfi_def_cfa_register 13
 1076              	 
 1077 0436 80BC     	 pop {r7}
 1078              	.LCFI85:
 1079              	 .cfi_restore 7
 1080              	 .cfi_def_cfa_offset 0
 1081 0438 7047     	 bx lr
 1082              	.L51:
 1083 043a 00BF     	 .align 2
 1084              	.L50:
 1085 043c 01495053 	 .word 1397770497
 1086 0440 00495053 	 .word 1397770496
 1087              	 .cfi_endproc
 1088              	.LFE226:
 1090              	 .align 1
 1091              	 .global spi_get_writeprotect_status
 1092              	 .syntax unified
 1093              	 .thumb
 1094              	 .thumb_func
 1095              	 .fpu softvfp
 1097              	spi_get_writeprotect_status:
 1098              	.LFB227:
 356:../../../platform/sam/drivers/spi/spi.c **** 
 357:../../../platform/sam/drivers/spi/spi.c **** /**
 358:../../../platform/sam/drivers/spi/spi.c ****  * \brief Indicate write protect status.
 359:../../../platform/sam/drivers/spi/spi.c ****  *
 360:../../../platform/sam/drivers/spi/spi.c ****  * \param p_spi Pointer to an SPI instance.
 361:../../../platform/sam/drivers/spi/spi.c ****  *
 362:../../../platform/sam/drivers/spi/spi.c ****  * \return SPI_WPSR value.
 363:../../../platform/sam/drivers/spi/spi.c ****  */
 364:../../../platform/sam/drivers/spi/spi.c **** uint32_t spi_get_writeprotect_status(Spi *p_spi)
 365:../../../platform/sam/drivers/spi/spi.c **** {
 1099              	 .loc 2 365 0
 1100              	 .cfi_startproc
 1101              	 
 1102              	 
 1103              	 
 1104 0444 80B4     	 push {r7}
 1105              	.LCFI86:
 1106              	 .cfi_def_cfa_offset 4
 1107              	 .cfi_offset 7,-4
 1108 0446 83B0     	 sub sp,sp,#12
 1109              	.LCFI87:
 1110              	 .cfi_def_cfa_offset 16
 1111 0448 00AF     	 add r7,sp,#0
 1112              	.LCFI88:
 1113              	 .cfi_def_cfa_register 7
 1114 044a 7860     	 str r0,[r7,#4]
 366:../../../platform/sam/drivers/spi/spi.c **** 	return p_spi->SPI_WPSR;
 1115              	 .loc 2 366 0
 1116 044c 7B68     	 ldr r3,[r7,#4]
 1117 044e D3F8E830 	 ldr r3,[r3,#232]
 367:../../../platform/sam/drivers/spi/spi.c **** }
 1118              	 .loc 2 367 0
 1119 0452 1846     	 mov r0,r3
 1120 0454 0C37     	 adds r7,r7,#12
 1121              	.LCFI89:
 1122              	 .cfi_def_cfa_offset 4
 1123 0456 BD46     	 mov sp,r7
 1124              	.LCFI90:
 1125              	 .cfi_def_cfa_register 13
 1126              	 
 1127 0458 80BC     	 pop {r7}
 1128              	.LCFI91:
 1129              	 .cfi_restore 7
 1130              	 .cfi_def_cfa_offset 0
 1131 045a 7047     	 bx lr
 1132              	 .cfi_endproc
 1133              	.LFE227:
 1135              	 .section .bss.reg_value.8778,"aw",%nobits
 1136              	 .align 2
 1139              	reg_value.8778:
 1140 0000 00000000 	 .space 4
 1141              	 .text
 1142              	.Letext0:
 1143              	 .file 3 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\machine\\_default_types.h"
 1144              	 .file 4 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\sys\\_stdint.h"
 1145              	 .file 5 "../../../platform/sam/utils/cmsis/sam4l/include/sam4lc4b.h"
 1146              	 .file 6 "../../../platform/thirdparty/CMSIS/include/core_cm4.h"
 1147              	 .file 7 "../../../platform/sam/utils/cmsis/sam4l/source/templates/system_sam4l.h"
 1148              	 .file 8 "../../../platform/sam/utils/cmsis/sam4l/include/component/component_spi.h"
 1149              	 .file 9 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\sys\\lock.h"
 1150              	 .file 10 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\sys\\_types.h"
 1151              	 .file 11 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\lib\\gcc\\arm-none-eabi\\6.3.1\\include\\stddef.h"
 1152              	 .file 12 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\sys\\reent.h"
 1153              	 .file 13 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\stdlib.h"
 1154              	 .file 14 "../../../platform/common/utils/interrupt/interrupt_sam_nvic.h"
 1155              	 .file 15 "../../../platform/sam/utils/compiler.h"
 1156              	 .file 16 "../../../platform/common/services/usb/usb_protocol.h"
 1157              	 .file 17 "../../../platform/common/services/usb/udc/udi.h"
 1158              	 .file 18 "../../../platform/common/services/usb/udc/udc_desc.h"
 1159              	 .file 19 "../../../platform/common/services/usb/udc/udd.h"
 1160              	 .file 20 "../../../platform/common/services/usb/class/cdc/device/udi_cdc.h"
 1161              	 .file 21 "../../../platform/common/utils/stdio/stdio_usb/stdio_usb.h"
 1162              	 .file 22 "../../../platform/common/services/clock/sam4l/sysclk.h"
DEFINED SYMBOLS
                            *ABS*:00000000 spi.c
    {standard input}:16     .bss.cpu_irq_critical_section_counter:00000000 $d
    {standard input}:19     .bss.cpu_irq_critical_section_counter:00000000 cpu_irq_critical_section_counter
    {standard input}:24     .bss.cpu_irq_prev_interrupt_state:00000000 cpu_irq_prev_interrupt_state
    {standard input}:25     .bss.cpu_irq_prev_interrupt_state:00000000 $d
    {standard input}:27     .text:00000000 $t
    {standard input}:33     .text:00000000 spi_get_peripheral_select_mode
    {standard input}:89     .text:00000024 spi_enable_clock
    {standard input}:126    .text:0000003c $d
    {standard input}:130    .text:00000040 $t
    {standard input}:137    .text:00000040 spi_disable_clock
    {standard input}:173    .text:00000058 $d
    {standard input}:177    .text:0000005c $t
    {standard input}:184    .text:0000005c spi_set_peripheral_chip_select_value
    {standard input}:242    .text:0000008e spi_set_delay_between_chip_select
    {standard input}:299    .text:000000bc spi_read
    {standard input}:384    .text:00000124 $d
    {standard input}:1139   .bss.reg_value.8778:00000000 reg_value.8778
    {standard input}:388    .text:00000128 $t
    {standard input}:395    .text:00000128 spi_write
    {standard input}:498    .text:000001a2 spi_set_clock_polarity
    {standard input}:570    .text:000001f0 spi_set_clock_phase
    {standard input}:642    .text:0000023e spi_configure_cs_behavior
    {standard input}:755    .text:000002e2 spi_set_bits_per_transfer
    {standard input}:820    .text:0000032a spi_calc_baudrate_div
    {standard input}:888    .text:00000364 spi_set_baudrate_div
    {standard input}:956    .text:000003b2 spi_set_transfer_delay
    {standard input}:1033   .text:0000040e spi_set_writeprotect
    {standard input}:1085   .text:0000043c $d
    {standard input}:1090   .text:00000444 $t
    {standard input}:1097   .text:00000444 spi_get_writeprotect_status
    {standard input}:1136   .bss.reg_value.8778:00000000 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
sysclk_enable_peripheral_clock
sysclk_disable_peripheral_clock
