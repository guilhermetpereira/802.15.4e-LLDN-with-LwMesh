   1              	 .cpu cortex-m4
   2              	 .eabi_attribute 20,1
   3              	 .eabi_attribute 21,1
   4              	 .eabi_attribute 23,3
   5              	 .eabi_attribute 24,1
   6              	 .eabi_attribute 25,1
   7              	 .eabi_attribute 26,1
   8              	 .eabi_attribute 30,6
   9              	 .eabi_attribute 34,1
  10              	 .eabi_attribute 18,4
  11              	 .file "sal.c"
  12              	 .text
  13              	.Ltext0:
  14              	 .cfi_sections .debug_frame
  15              	 .section .bss.cpu_irq_critical_section_counter,"aw",%nobits
  16              	 .align 2
  19              	cpu_irq_critical_section_counter:
  20 0000 00000000 	 .space 4
  21              	 .section .bss.cpu_irq_prev_interrupt_state,"aw",%nobits
  24              	cpu_irq_prev_interrupt_state:
  25 0000 00       	 .space 1
  26              	 .section .bss.setup_flag,"aw",%nobits
  29              	setup_flag:
  30 0000 00       	 .space 1
  31              	 .section .bss.dec_initialized,"aw",%nobits
  34              	dec_initialized:
  35 0000 00       	 .space 1
  36              	 .section .bss.aes_buf,"aw",%nobits
  37              	 .align 2
  40              	aes_buf:
  41 0000 00000000 	 .space 18
  41      00000000 
  41      00000000 
  41      00000000 
  41      0000
  42              	 .section .data.last_dir,"aw",%progbits
  45              	last_dir:
  46 0000 02       	 .byte 2
  47              	 .section .bss.enc_key,"aw",%nobits
  48              	 .align 2
  51              	enc_key:
  52 0000 00000000 	 .space 16
  52      00000000 
  52      00000000 
  52      00000000 
  53              	 .section .bss.dec_key,"aw",%nobits
  54              	 .align 2
  57              	dec_key:
  58 0000 00000000 	 .space 16
  58      00000000 
  58      00000000 
  58      00000000 
  59              	 .text
  60              	 .align 1
  61              	 .global sal_init
  62              	 .syntax unified
  63              	 .thumb
  64              	 .thumb_func
  65              	 .fpu softvfp
  67              	sal_init:
  68              	.LFB223:
  69              	 .file 1 "../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c"
   1:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /**
   2:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @file sal.c
   3:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
   4:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @brief Low-level crypto API for an AES unit implemented in AT86RF2xx
   5:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
   6:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * Copyright (c) 2013-2014 Atmel Corporation. All rights reserved.
   7:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
   8:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * \asf_license_start
   9:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
  10:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * \page License
  11:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
  12:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * Redistribution and use in source and binary forms, with or without
  13:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * modification, are permitted provided that the following conditions are met:
  14:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
  15:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * 1. Redistributions of source code must retain the above copyright notice,
  16:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *    this list of conditions and the following disclaimer.
  17:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
  18:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  19:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *    this list of conditions and the following disclaimer in the documentation
  20:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *    and/or other materials provided with the distribution.
  21:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
  22:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * 3. The name of Atmel may not be used to endorse or promote products derived
  23:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *    from this software without specific prior written permission.
  24:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
  25:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * 4. This software may only be redistributed and used in connection with an
  26:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *    Atmel microcontroller product.
  27:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
  28:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * THIS SOFTWARE IS PROVIDED BY ATMEL "AS IS" AND ANY EXPRESS OR IMPLIED
  29:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  30:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT ARE
  31:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * EXPRESSLY AND SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR
  32:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  33:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
  34:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  35:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  36:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
  37:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  38:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * POSSIBILITY OF SUCH DAMAGE.
  39:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
  40:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * \asf_license_stop
  41:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  */
  42:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  43:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /**
  44:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @author
  45:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *      Atmel Corporation: http://www.atmel.com
  46:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *      Support email: avr@atmel.com
  47:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  */
  48:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  49:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /*
  50:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * Copyright (c) 2013-2014, Atmel Corporation All rights reserved.
  51:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
  52:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * Licensed under Atmel's Limited License Agreement --> EULA.txt
  53:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  */
  54:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  55:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* === Includes ============================================================ */
  56:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  57:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** #include "trx_access.h"
  58:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** #include "sal_types.h"
  59:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** #if (SAL_TYPE == AT86RF2xx)
  60:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** #include <string.h>
  61:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** #include "sal.h"
  62:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** # include "delay.h"
  63:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  64:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* === Macros ============================================================== */
  65:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  66:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** #define AES_RY_BIT                  (1)     /* AES_RY: poll on finished op */
  67:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** #define AES_DIR_VOID                (AES_DIR_ENCRYPT + AES_DIR_DECRYPT + 1)
  68:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* Must be different from both summands */
  69:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  70:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** #define _SR_MASK(addr, mask, pos, val)     (((uint8_t)val << pos) & mask)
  71:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** #define SR_MASK(SR, val)                   _SR_MASK(SR, val)
  72:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  73:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* === Types =============================================================== */
  74:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  75:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* === Globals ============================================================= */
  76:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  77:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* True after sal_aes_setup(). */
  78:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** static bool setup_flag;
  79:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* True if decryption key is actual and was computed. */
  80:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** static bool dec_initialized = false;
  81:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* Buffer written over SPI to AES unit. */
  82:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** static uint8_t aes_buf[AES_BLOCKSIZE + 2];
  83:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* Last value of "dir" parameter in sal_aes_setup(). */
  84:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** static uint8_t last_dir = AES_DIR_VOID;
  85:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* Actual encryption key. */
  86:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** static uint8_t enc_key[AES_KEYSIZE];
  87:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* Actual decryption key (valid if last_dir == AES_DIR_DECRYPT). */
  88:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** static uint8_t dec_key[AES_KEYSIZE];
  89:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  90:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /* === Implementation ====================================================== */
  91:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
  92:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /**
  93:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @brief Initialization of SAL.
  94:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
  95:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * This functions initializes the SAL.
  96:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  */
  97:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** void sal_init(void)
  98:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** {
  70              	 .loc 1 98 0
  71              	 .cfi_startproc
  72              	 
  73              	 
  74              	 
  75 0000 80B4     	 push {r7}
  76              	.LCFI0:
  77              	 .cfi_def_cfa_offset 4
  78              	 .cfi_offset 7,-4
  79 0002 00AF     	 add r7,sp,#0
  80              	.LCFI1:
  81              	 .cfi_def_cfa_register 7
  99:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** }
  82              	 .loc 1 99 0
  83 0004 00BF     	 nop
  84 0006 BD46     	 mov sp,r7
  85              	.LCFI2:
  86              	 .cfi_def_cfa_register 13
  87              	 
  88 0008 80BC     	 pop {r7}
  89              	.LCFI3:
  90              	 .cfi_restore 7
  91              	 .cfi_def_cfa_offset 0
  92 000a 7047     	 bx lr
  93              	 .cfi_endproc
  94              	.LFE223:
  96              	 .align 1
  97              	 .global sal_aes_setup
  98              	 .syntax unified
  99              	 .thumb
 100              	 .thumb_func
 101              	 .fpu softvfp
 103              	sal_aes_setup:
 104              	.LFB224:
 100:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 101:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /**
 102:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @brief Setup AES unit
 103:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
 104:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * This function perform the following tasks as part of the setup of the
 105:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * AES unit: key initialization, set encryption direction and encryption mode.
 106:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
 107:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * In general, the contents of SRAM buffer is destroyed. When using
 108:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * sal_aes_wrrd(), sal_aes_read() needs to be called in order to get the result
 109:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * of the last AES operation before you may call sal_aes_setup() again.
 110:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
 111:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @param[in] key AES key or NULL (NULL: use last key)
 112:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @param[in] enc_mode  AES_MODE_ECB or AES_MODE_CBC
 113:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @param[in] dir AES_DIR_ENCRYPT or AES_DIR_DECRYPT
 114:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
 115:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @return  False if some parameter was illegal, true else
 116:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  */
 117:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** bool sal_aes_setup(uint8_t *key,
 118:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		uint8_t enc_mode,
 119:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		uint8_t dir)
 120:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** {
 105              	 .loc 1 120 0
 106              	 .cfi_startproc
 107              	 
 108              	 
 109 000c B0B5     	 push {r4,r5,r7,lr}
 110              	.LCFI4:
 111              	 .cfi_def_cfa_offset 16
 112              	 .cfi_offset 4,-16
 113              	 .cfi_offset 5,-12
 114              	 .cfi_offset 7,-8
 115              	 .cfi_offset 14,-4
 116 000e 86B0     	 sub sp,sp,#24
 117              	.LCFI5:
 118              	 .cfi_def_cfa_offset 40
 119 0010 00AF     	 add r7,sp,#0
 120              	.LCFI6:
 121              	 .cfi_def_cfa_register 7
 122 0012 7860     	 str r0,[r7,#4]
 123 0014 0B46     	 mov r3,r1
 124 0016 FB70     	 strb r3,[r7,#3]
 125 0018 1346     	 mov r3,r2
 126 001a BB70     	 strb r3,[r7,#2]
 121:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	if (key != NULL) {
 127              	 .loc 1 121 0
 128 001c 7B68     	 ldr r3,[r7,#4]
 129 001e 002B     	 cmp r3,#0
 130 0020 1BD0     	 beq .L3
 122:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		/* Setup key. */
 123:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		dec_initialized = false;
 131              	 .loc 1 123 0
 132 0022 584B     	 ldr r3,.L19
 133 0024 0022     	 movs r2,#0
 134 0026 1A70     	 strb r2,[r3]
 124:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 125:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		last_dir = AES_DIR_VOID;
 135              	 .loc 1 125 0
 136 0028 574B     	 ldr r3,.L19+4
 137 002a 0222     	 movs r2,#2
 138 002c 1A70     	 strb r2,[r3]
 126:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 127:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		/* Save key for later use after decryption or sleep. */
 128:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		memcpy(enc_key, key, AES_KEYSIZE);
 139              	 .loc 1 128 0
 140 002e 574A     	 ldr r2,.L19+8
 141 0030 7B68     	 ldr r3,[r7,#4]
 142 0032 1446     	 mov r4,r2
 143 0034 1868     	 ldr r0,[r3]
 144 0036 5968     	 ldr r1,[r3,#4]
 145 0038 9A68     	 ldr r2,[r3,#8]
 146 003a DB68     	 ldr r3,[r3,#12]
 147 003c 0FC4     	 stmia r4!,{r0,r1,r2,r3}
 129:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 130:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		/* Set subregister AES_MODE (Bits 4:6 in AES_CON) to 1: KEY
 131:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		 * SETUP. */
 132:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		aes_buf[0] = SR_MASK(SR_AES_MODE, AES_MODE_KEY);
 148              	 .loc 1 132 0
 149 003e 544B     	 ldr r3,.L19+12
 150 0040 1022     	 movs r2,#16
 151 0042 1A70     	 strb r2,[r3]
 133:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 134:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		/* Fill in key. */
 135:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		memcpy(aes_buf + 1, key, AES_KEYSIZE);
 152              	 .loc 1 135 0
 153 0044 534B     	 ldr r3,.L19+16
 154 0046 1022     	 movs r2,#16
 155 0048 7968     	 ldr r1,[r7,#4]
 156 004a 1846     	 mov r0,r3
 157 004c 524B     	 ldr r3,.L19+20
 158 004e 9847     	 blx r3
 159              	.LVL0:
 136:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 137:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		/* Write to SRAM in one step. */
 138:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		trx_sram_write((AES_BASE_ADDR + RG_AES_CTRL), aes_buf,
 160              	 .loc 1 138 0
 161 0050 1122     	 movs r2,#17
 162 0052 4F49     	 ldr r1,.L19+12
 163 0054 8320     	 movs r0,#131
 164 0056 514B     	 ldr r3,.L19+24
 165 0058 9847     	 blx r3
 166              	.LVL1:
 167              	.L3:
 139:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				AES_BLOCKSIZE + 1);
 140:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	}
 141:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 142:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	/* Set encryption direction. */
 143:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	switch (dir) {
 168              	 .loc 1 143 0
 169 005a BB78     	 ldrb r3,[r7,#2]
 170 005c 002B     	 cmp r3,#0
 171 005e 02D0     	 beq .L5
 172 0060 012B     	 cmp r3,#1
 173 0062 16D0     	 beq .L6
 174 0064 51E0     	 b .L15
 175              	.L5:
 144:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	case AES_DIR_ENCRYPT:
 145:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		if (last_dir == AES_DIR_DECRYPT) {
 176              	 .loc 1 145 0
 177 0066 484B     	 ldr r3,.L19+4
 178 0068 1B78     	 ldrb r3,[r3]
 179 006a 012B     	 cmp r3,#1
 180 006c 4FD1     	 bne .L17
 146:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			/*
 147:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			 * If the last operation was decryption, the encryption
 148:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			 * key must be stored in enc_key, so re-initialize it.
 149:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			 */
 150:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			aes_buf[0] = SR_MASK(SR_AES_MODE, AES_MODE_KEY);
 181              	 .loc 1 150 0
 182 006e 484B     	 ldr r3,.L19+12
 183 0070 1022     	 movs r2,#16
 184 0072 1A70     	 strb r2,[r3]
 151:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 152:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			/* Fill in key. */
 153:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			memcpy(aes_buf + 1, enc_key, AES_KEYSIZE);
 185              	 .loc 1 153 0
 186 0074 474A     	 ldr r2,.L19+16
 187 0076 454B     	 ldr r3,.L19+8
 188 0078 1446     	 mov r4,r2
 189 007a 1D46     	 mov r5,r3
 190 007c 0FCD     	 ldmia r5!,{r0,r1,r2,r3}
 191 007e 2060     	 str r0,[r4]
 192 0080 6160     	 str r1,[r4,#4]
 193 0082 A260     	 str r2,[r4,#8]
 194 0084 E360     	 str r3,[r4,#12]
 154:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 155:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			/* Write to SRAM in one step. */
 156:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			trx_sram_write((AES_BASE_ADDR + RG_AES_CTRL),
 195              	 .loc 1 156 0
 196 0086 1122     	 movs r2,#17
 197 0088 4149     	 ldr r1,.L19+12
 198 008a 8320     	 movs r0,#131
 199 008c 434B     	 ldr r3,.L19+24
 200 008e 9847     	 blx r3
 201              	.LVL2:
 157:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 					aes_buf, AES_BLOCKSIZE + 1);
 158:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		}
 159:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 160:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		break;
 202              	 .loc 1 160 0
 203 0090 3DE0     	 b .L17
 204              	.L6:
 161:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 162:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	case AES_DIR_DECRYPT:
 163:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		if (last_dir != AES_DIR_DECRYPT) {
 205              	 .loc 1 163 0
 206 0092 3D4B     	 ldr r3,.L19+4
 207 0094 1B78     	 ldrb r3,[r3]
 208 0096 012B     	 cmp r3,#1
 209 0098 3BD0     	 beq .L18
 164:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			aes_buf[0] = SR_MASK(SR_AES_MODE, AES_MODE_KEY);
 210              	 .loc 1 164 0
 211 009a 3D4B     	 ldr r3,.L19+12
 212 009c 1022     	 movs r2,#16
 213 009e 1A70     	 strb r2,[r3]
 165:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 166:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			if (!dec_initialized) {
 214              	 .loc 1 166 0
 215 00a0 384B     	 ldr r3,.L19
 216 00a2 1B78     	 ldrb r3,[r3]
 217 00a4 83F00103 	 eor r3,r3,#1
 218 00a8 DBB2     	 uxtb r3,r3
 219 00aa 002B     	 cmp r3,#0
 220 00ac 1BD0     	 beq .L10
 221              	.LBB2:
 167:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				uint8_t dummy[AES_BLOCKSIZE];
 168:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 169:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				/* Compute decryption key and initialize unit
 170:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				 * with it. */
 171:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 172:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				/* Dummy ECB encryption. */
 173:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				aes_buf[0] = SR_MASK(SR_AES_MODE, AES_MODE_ECB);
 222              	 .loc 1 173 0
 223 00ae 384B     	 ldr r3,.L19+12
 224 00b0 0022     	 movs r2,#0
 225 00b2 1A70     	 strb r2,[r3]
 174:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				aes_buf[AES_BLOCKSIZE + 1] = SR_MASK(
 226              	 .loc 1 174 0
 227 00b4 364B     	 ldr r3,.L19+12
 228 00b6 8022     	 movs r2,#128
 229 00b8 5A74     	 strb r2,[r3,#17]
 175:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 						SR_AES_MODE, AES_MODE_ECB) |
 176:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 						SR_MASK(SR_AES_REQUEST,
 177:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 						AES_REQUEST);
 178:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 179:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				setup_flag = true; /* Needed in sal_aes_wrrd().
 230              	 .loc 1 179 0
 231 00ba 394B     	 ldr r3,.L19+28
 232 00bc 0122     	 movs r2,#1
 233 00be 1A70     	 strb r2,[r3]
 180:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				                   **/
 181:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				sal_aes_wrrd(dummy, NULL);
 234              	 .loc 1 181 0
 235 00c0 07F10803 	 add r3,r7,#8
 236 00c4 0021     	 movs r1,#0
 237 00c6 1846     	 mov r0,r3
 238 00c8 FFF7FEFF 	 bl sal_aes_wrrd
 182:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 183:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				/* Read last round key: */
 184:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 185:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				/* Set to key mode. */
 186:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				aes_buf[0] = SR_MASK(SR_AES_MODE, AES_MODE_KEY);
 239              	 .loc 1 186 0
 240 00cc 304B     	 ldr r3,.L19+12
 241 00ce 1022     	 movs r2,#16
 242 00d0 1A70     	 strb r2,[r3]
 187:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				trx_sram_write(
 243              	 .loc 1 187 0
 244 00d2 0122     	 movs r2,#1
 245 00d4 2E49     	 ldr r1,.L19+12
 246 00d6 8320     	 movs r0,#131
 247 00d8 304B     	 ldr r3,.L19+24
 248 00da 9847     	 blx r3
 249              	.LVL3:
 188:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 						(AES_BASE_ADDR + RG_AES_CTRL),
 189:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 						aes_buf, 1);
 190:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 191:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				/* Read the key. */
 192:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				trx_sram_read((AES_BASE_ADDR +
 250              	 .loc 1 192 0
 251 00dc 1022     	 movs r2,#16
 252 00de 3149     	 ldr r1,.L19+32
 253 00e0 8420     	 movs r0,#132
 254 00e2 314B     	 ldr r3,.L19+36
 255 00e4 9847     	 blx r3
 256              	.LVL4:
 257              	.L10:
 258              	.LBE2:
 193:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 						RG_AES_STATE_KEY_0), dec_key,
 194:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 						AES_KEYSIZE);
 195:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			}
 196:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 197:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			/*
 198:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			 * Now the decryption key is computed resp. known,
 199:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			 * simply re-initialize the unit;
 200:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			 * aes_buf[0] is AES_MODE_KEY
 201:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			 */
 202:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 203:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			/* Fill in key. */
 204:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			memcpy(aes_buf + 1, dec_key, AES_KEYSIZE);
 259              	 .loc 1 204 0
 260 00e6 2B4A     	 ldr r2,.L19+16
 261 00e8 2E4B     	 ldr r3,.L19+32
 262 00ea 1446     	 mov r4,r2
 263 00ec 1D46     	 mov r5,r3
 264 00ee 0FCD     	 ldmia r5!,{r0,r1,r2,r3}
 265 00f0 2060     	 str r0,[r4]
 266 00f2 6160     	 str r1,[r4,#4]
 267 00f4 A260     	 str r2,[r4,#8]
 268 00f6 E360     	 str r3,[r4,#12]
 205:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 206:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			/* Write to SRAM in one step. */
 207:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			trx_sram_write((AES_BASE_ADDR + RG_AES_CTRL),
 269              	 .loc 1 207 0
 270 00f8 1122     	 movs r2,#17
 271 00fa 2549     	 ldr r1,.L19+12
 272 00fc 8320     	 movs r0,#131
 273 00fe 274B     	 ldr r3,.L19+24
 274 0100 9847     	 blx r3
 275              	.LVL5:
 208:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 					aes_buf, AES_BLOCKSIZE + 1);
 209:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 210:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			dec_initialized = true;
 276              	 .loc 1 210 0
 277 0102 204B     	 ldr r3,.L19
 278 0104 0122     	 movs r2,#1
 279 0106 1A70     	 strb r2,[r3]
 211:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		}
 212:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 213:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		break;
 280              	 .loc 1 213 0
 281 0108 03E0     	 b .L18
 282              	.L15:
 214:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 215:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	default:
 216:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		return false;
 283              	 .loc 1 216 0
 284 010a 0023     	 movs r3,#0
 285 010c 36E0     	 b .L11
 286              	.L17:
 160:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 287              	 .loc 1 160 0
 288 010e 00BF     	 nop
 289 0110 00E0     	 b .L8
 290              	.L18:
 213:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 291              	 .loc 1 213 0
 292 0112 00BF     	 nop
 293              	.L8:
 217:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	}
 218:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 219:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	last_dir = dir;
 294              	 .loc 1 219 0
 295 0114 1C4A     	 ldr r2,.L19+4
 296 0116 BB78     	 ldrb r3,[r7,#2]
 297 0118 1370     	 strb r3,[r2]
 220:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 221:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	/* Set encryption mode. */
 222:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	switch (enc_mode) {
 298              	 .loc 1 222 0
 299 011a FB78     	 ldrb r3,[r7,#3]
 300 011c 002B     	 cmp r3,#0
 301 011e 01D0     	 beq .L13
 302 0120 022B     	 cmp r3,#2
 303 0122 2AD1     	 bne .L16
 304              	.L13:
 223:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	case AES_MODE_ECB:
 224:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	case AES_MODE_CBC:
 225:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	{
 226:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		aes_buf[0] = SR_MASK(SR_AES_MODE, enc_mode) |
 305              	 .loc 1 226 0
 306 0124 FB78     	 ldrb r3,[r7,#3]
 307 0126 1B01     	 lsls r3,r3,#4
 308 0128 5BB2     	 sxtb r3,r3
 309 012a 03F07003 	 and r3,r3,#112
 310 012e 5AB2     	 sxtb r2,r3
 227:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				SR_MASK(SR_AES_DIR, dir);
 311              	 .loc 1 227 0
 312 0130 BB78     	 ldrb r3,[r7,#2]
 313 0132 DB00     	 lsls r3,r3,#3
 314 0134 5BB2     	 sxtb r3,r3
 315 0136 03F00803 	 and r3,r3,#8
 316 013a 5BB2     	 sxtb r3,r3
 226:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				SR_MASK(SR_AES_DIR, dir);
 317              	 .loc 1 226 0
 318 013c 1343     	 orrs r3,r3,r2
 319 013e 5BB2     	 sxtb r3,r3
 320 0140 DAB2     	 uxtb r2,r3
 321 0142 134B     	 ldr r3,.L19+12
 322 0144 1A70     	 strb r2,[r3]
 228:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		aes_buf[AES_BLOCKSIZE + 1] = SR_MASK(SR_AES_MODE, enc_mode) |
 323              	 .loc 1 228 0
 324 0146 FB78     	 ldrb r3,[r7,#3]
 325 0148 1B01     	 lsls r3,r3,#4
 326 014a 5BB2     	 sxtb r3,r3
 327 014c 03F07003 	 and r3,r3,#112
 328 0150 5AB2     	 sxtb r2,r3
 229:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				SR_MASK(SR_AES_DIR, dir) |
 329              	 .loc 1 229 0
 330 0152 BB78     	 ldrb r3,[r7,#2]
 331 0154 DB00     	 lsls r3,r3,#3
 332 0156 5BB2     	 sxtb r3,r3
 333 0158 03F00803 	 and r3,r3,#8
 334 015c 5BB2     	 sxtb r3,r3
 228:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		aes_buf[AES_BLOCKSIZE + 1] = SR_MASK(SR_AES_MODE, enc_mode) |
 335              	 .loc 1 228 0
 336 015e 1343     	 orrs r3,r3,r2
 337 0160 5BB2     	 sxtb r3,r3
 338              	 .loc 1 229 0
 339 0162 63F07F03 	 orn r3,r3,#127
 340 0166 5BB2     	 sxtb r3,r3
 341 0168 DAB2     	 uxtb r2,r3
 228:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		aes_buf[AES_BLOCKSIZE + 1] = SR_MASK(SR_AES_MODE, enc_mode) |
 342              	 .loc 1 228 0
 343 016a 094B     	 ldr r3,.L19+12
 344 016c 5A74     	 strb r2,[r3,#17]
 230:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				SR_MASK(SR_AES_REQUEST, AES_REQUEST);
 231:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	}
 232:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	break;
 345              	 .loc 1 232 0
 346 016e 00BF     	 nop
 233:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 234:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	default:
 235:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		return (false);
 236:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	}
 237:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 238:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	setup_flag = true;
 347              	 .loc 1 238 0
 348 0170 0B4B     	 ldr r3,.L19+28
 349 0172 0122     	 movs r2,#1
 350 0174 1A70     	 strb r2,[r3]
 239:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 240:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	return (true);
 351              	 .loc 1 240 0
 352 0176 0123     	 movs r3,#1
 353 0178 00E0     	 b .L11
 354              	.L16:
 235:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	}
 355              	 .loc 1 235 0
 356 017a 0023     	 movs r3,#0
 357              	.L11:
 241:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** }
 358              	 .loc 1 241 0
 359 017c 1846     	 mov r0,r3
 360 017e 1837     	 adds r7,r7,#24
 361              	.LCFI7:
 362              	 .cfi_def_cfa_offset 16
 363 0180 BD46     	 mov sp,r7
 364              	.LCFI8:
 365              	 .cfi_def_cfa_register 13
 366              	 
 367 0182 B0BD     	 pop {r4,r5,r7,pc}
 368              	.L20:
 369              	 .align 2
 370              	.L19:
 371 0184 00000000 	 .word dec_initialized
 372 0188 00000000 	 .word last_dir
 373 018c 00000000 	 .word enc_key
 374 0190 00000000 	 .word aes_buf
 375 0194 01000000 	 .word aes_buf+1
 376 0198 00000000 	 .word memcpy
 377 019c 00000000 	 .word trx_sram_write
 378 01a0 00000000 	 .word setup_flag
 379 01a4 00000000 	 .word dec_key
 380 01a8 00000000 	 .word trx_sram_read
 381              	 .cfi_endproc
 382              	.LFE224:
 384              	 .align 1
 385              	 .global sal_aes_restart
 386              	 .syntax unified
 387              	 .thumb
 388              	 .thumb_func
 389              	 .fpu softvfp
 391              	sal_aes_restart:
 392              	.LFB225:
 242:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 243:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /**
 244:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @brief Re-inits key and state after a sleep or TRX reset
 245:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
 246:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * This function re-initializes the AES key and the state of the
 247:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * AES engine after TRX sleep or reset.
 248:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * The contents of AES registers AES_CON and AES_CON_MIRROR
 249:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * are restored, the next AES operation started with sal_aes_wrrd()
 250:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * will be executed correctly.
 251:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * However, the contents of SRAM buffers is destroyed, in general.
 252:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * When using sal_aes_wrrd(), call sal_aes_read() to get the result
 253:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * of the last AES operation BEFORE you put the transceiver unit to
 254:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * sleep state!
 255:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  */
 256:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** void sal_aes_restart(void)
 257:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** {
 393              	 .loc 1 257 0
 394              	 .cfi_startproc
 395              	 
 396              	 
 397 01ac 80B5     	 push {r7,lr}
 398              	.LCFI9:
 399              	 .cfi_def_cfa_offset 8
 400              	 .cfi_offset 7,-8
 401              	 .cfi_offset 14,-4
 402 01ae 82B0     	 sub sp,sp,#8
 403              	.LCFI10:
 404              	 .cfi_def_cfa_offset 16
 405 01b0 00AF     	 add r7,sp,#0
 406              	.LCFI11:
 407              	 .cfi_def_cfa_register 7
 258:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	/*
 259:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 * AT86RF212 & AT86RF231 loose the key information after a sleep
 260:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 * cycle, so the security information needs to be re-written
 261:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 * to the transceiver.
 262:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 * This is not required anymore for SPI transceivers beyond
 263:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 * these two mentioned transceivers.
 264:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 */
 265:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	uint8_t *keyp;
 266:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	uint8_t save_cmd;
 267:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	if (last_dir == AES_DIR_ENCRYPT) {
 408              	 .loc 1 267 0
 409 01b2 124B     	 ldr r3,.L24
 410 01b4 1B78     	 ldrb r3,[r3]
 411 01b6 002B     	 cmp r3,#0
 412 01b8 02D1     	 bne .L22
 268:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		keyp = enc_key;
 413              	 .loc 1 268 0
 414 01ba 114B     	 ldr r3,.L24+4
 415 01bc 7B60     	 str r3,[r7,#4]
 416 01be 01E0     	 b .L23
 417              	.L22:
 269:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	} else {
 270:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		keyp = dec_key;
 418              	 .loc 1 270 0
 419 01c0 104B     	 ldr r3,.L24+8
 420 01c2 7B60     	 str r3,[r7,#4]
 421              	.L23:
 271:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	}
 272:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 273:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	save_cmd = aes_buf[0];
 422              	 .loc 1 273 0
 423 01c4 104B     	 ldr r3,.L24+12
 424 01c6 1B78     	 ldrb r3,[r3]
 425 01c8 FB70     	 strb r3,[r7,#3]
 274:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	aes_buf[0] = SR_MASK(SR_AES_MODE, AES_MODE_KEY);
 426              	 .loc 1 274 0
 427 01ca 0F4B     	 ldr r3,.L24+12
 428 01cc 1022     	 movs r2,#16
 429 01ce 1A70     	 strb r2,[r3]
 275:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 276:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	/* Fill in key. */
 277:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	memcpy(aes_buf + 1, keyp, AES_KEYSIZE);
 430              	 .loc 1 277 0
 431 01d0 0E4B     	 ldr r3,.L24+16
 432 01d2 1022     	 movs r2,#16
 433 01d4 7968     	 ldr r1,[r7,#4]
 434 01d6 1846     	 mov r0,r3
 435 01d8 0D4B     	 ldr r3,.L24+20
 436 01da 9847     	 blx r3
 437              	.LVL6:
 278:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 279:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	/* Write to SRAM in one step. */
 280:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	trx_sram_write((AES_BASE_ADDR + RG_AES_CTRL), aes_buf,
 438              	 .loc 1 280 0
 439 01dc 1122     	 movs r2,#17
 440 01de 0A49     	 ldr r1,.L24+12
 441 01e0 8320     	 movs r0,#131
 442 01e2 0C4B     	 ldr r3,.L24+24
 443 01e4 9847     	 blx r3
 444              	.LVL7:
 281:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			AES_BLOCKSIZE + 1);
 282:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 283:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	aes_buf[0] = save_cmd;
 445              	 .loc 1 283 0
 446 01e6 084A     	 ldr r2,.L24+12
 447 01e8 FB78     	 ldrb r3,[r7,#3]
 448 01ea 1370     	 strb r3,[r2]
 284:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	setup_flag = true;
 449              	 .loc 1 284 0
 450 01ec 0A4B     	 ldr r3,.L24+28
 451 01ee 0122     	 movs r2,#1
 452 01f0 1A70     	 strb r2,[r3]
 285:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** }
 453              	 .loc 1 285 0
 454 01f2 00BF     	 nop
 455 01f4 0837     	 adds r7,r7,#8
 456              	.LCFI12:
 457              	 .cfi_def_cfa_offset 8
 458 01f6 BD46     	 mov sp,r7
 459              	.LCFI13:
 460              	 .cfi_def_cfa_register 13
 461              	 
 462 01f8 80BD     	 pop {r7,pc}
 463              	.L25:
 464 01fa 00BF     	 .align 2
 465              	.L24:
 466 01fc 00000000 	 .word last_dir
 467 0200 00000000 	 .word enc_key
 468 0204 00000000 	 .word dec_key
 469 0208 00000000 	 .word aes_buf
 470 020c 01000000 	 .word aes_buf+1
 471 0210 00000000 	 .word memcpy
 472 0214 00000000 	 .word trx_sram_write
 473 0218 00000000 	 .word setup_flag
 474              	 .cfi_endproc
 475              	.LFE225:
 477              	 .align 1
 478              	 .global _sal_aes_clean_up
 479              	 .syntax unified
 480              	 .thumb
 481              	 .thumb_func
 482              	 .fpu softvfp
 484              	_sal_aes_clean_up:
 485              	.LFB226:
 286:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 287:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /**
 288:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @brief Cleans up the SAL/AES after STB has been finished
 289:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  */
 290:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** void _sal_aes_clean_up(void)
 291:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** {
 486              	 .loc 1 291 0
 487              	 .cfi_startproc
 488              	 
 489              	 
 490              	 
 491 021c 80B4     	 push {r7}
 492              	.LCFI14:
 493              	 .cfi_def_cfa_offset 4
 494              	 .cfi_offset 7,-4
 495 021e 00AF     	 add r7,sp,#0
 496              	.LCFI15:
 497              	 .cfi_def_cfa_register 7
 292:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** }
 498              	 .loc 1 292 0
 499 0220 00BF     	 nop
 500 0222 BD46     	 mov sp,r7
 501              	.LCFI16:
 502              	 .cfi_def_cfa_register 13
 503              	 
 504 0224 80BC     	 pop {r7}
 505              	.LCFI17:
 506              	 .cfi_restore 7
 507              	 .cfi_def_cfa_offset 0
 508 0226 7047     	 bx lr
 509              	 .cfi_endproc
 510              	.LFE226:
 512              	 .align 1
 513              	 .global sal_aes_wrrd
 514              	 .syntax unified
 515              	 .thumb
 516              	 .thumb_func
 517              	 .fpu softvfp
 519              	sal_aes_wrrd:
 520              	.LFB227:
 293:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 294:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /**
 295:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @brief Writes data, reads previous result and does the AES en/decryption
 296:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
 297:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * The function returns after the AES operation is finished.
 298:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
 299:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * When sal_aes_wrrd() is called several times in sequence, from the
 300:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * second call onwards, odata contains the result of the previous operation.
 301:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * To obtain the last result, you must call sal_aes_read() at the end.
 302:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * Please note that any call of sal_aes_setup() as well as putting
 303:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * the transceiver to sleep state destroys the SRAM contents,
 304:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * i.e. the next call of sal_aes_wrrd() yields no meaningful result.
 305:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
 306:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @param[in]  idata  AES block to be en/decrypted
 307:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @param[out] odata  Result of previous operation
 308:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *                    (odata may be NULL or equal to idata)
 309:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  */
 310:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** void sal_aes_wrrd(uint8_t *idata, uint8_t *odata)
 311:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** {
 521              	 .loc 1 311 0
 522              	 .cfi_startproc
 523              	 
 524              	 
 525 0228 80B5     	 push {r7,lr}
 526              	.LCFI18:
 527              	 .cfi_def_cfa_offset 8
 528              	 .cfi_offset 7,-8
 529              	 .cfi_offset 14,-4
 530 022a 84B0     	 sub sp,sp,#16
 531              	.LCFI19:
 532              	 .cfi_def_cfa_offset 24
 533 022c 00AF     	 add r7,sp,#0
 534              	.LCFI20:
 535              	 .cfi_def_cfa_register 7
 536 022e 7860     	 str r0,[r7,#4]
 537 0230 3960     	 str r1,[r7]
 312:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	uint8_t save_cmd;
 313:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 314:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	/*
 315:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 * Write data and start the operation.
 316:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 * AES_MODE in aes_buf[0] and aes_buf[AES_BLOCKSIZE+1] as well as
 317:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 * AES_REQUEST in aes_buf[AES_BLOCKSIZE+1]
 318:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 * were set before in sal_aes_setup()
 319:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	 */
 320:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	memcpy(aes_buf + 1, idata, AES_BLOCKSIZE);
 538              	 .loc 1 320 0
 539 0232 174B     	 ldr r3,.L31
 540 0234 1022     	 movs r2,#16
 541 0236 7968     	 ldr r1,[r7,#4]
 542 0238 1846     	 mov r0,r3
 543 023a 164B     	 ldr r3,.L31+4
 544 023c 9847     	 blx r3
 545              	.LVL8:
 321:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 322:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	/* trx_aes_wrrd() overwrites aes_buf, the last byte must be saved.
 323:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	**/
 324:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	save_cmd = aes_buf[AES_BLOCKSIZE + 1];
 546              	 .loc 1 324 0
 547 023e 164B     	 ldr r3,.L31+8
 548 0240 5B7C     	 ldrb r3,[r3,#17]
 549 0242 FB73     	 strb r3,[r7,#15]
 325:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 326:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	if (setup_flag) {
 550              	 .loc 1 326 0
 551 0244 154B     	 ldr r3,.L31+12
 552 0246 1B78     	 ldrb r3,[r3]
 553 0248 002B     	 cmp r3,#0
 554 024a 08D0     	 beq .L28
 327:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		trx_aes_wrrd((AES_BASE_ADDR + RG_AES_CTRL), aes_buf,
 555              	 .loc 1 327 0
 556 024c 1222     	 movs r2,#18
 557 024e 1249     	 ldr r1,.L31+8
 558 0250 8320     	 movs r0,#131
 559 0252 134B     	 ldr r3,.L31+16
 560 0254 9847     	 blx r3
 561              	.LVL9:
 328:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				AES_BLOCKSIZE + 2);
 329:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 330:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		setup_flag = false;
 562              	 .loc 1 330 0
 563 0256 114B     	 ldr r3,.L31+12
 564 0258 0022     	 movs r2,#0
 565 025a 1A70     	 strb r2,[r3]
 566 025c 05E0     	 b .L29
 567              	.L28:
 331:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	} else {
 332:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		trx_aes_wrrd((AES_BASE_ADDR + RG_AES_STATE_KEY_0),
 568              	 .loc 1 332 0
 569 025e 0C4B     	 ldr r3,.L31
 570 0260 1122     	 movs r2,#17
 571 0262 1946     	 mov r1,r3
 572 0264 8420     	 movs r0,#132
 573 0266 0E4B     	 ldr r3,.L31+16
 574 0268 9847     	 blx r3
 575              	.LVL10:
 576              	.L29:
 333:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 				aes_buf + 1, AES_BLOCKSIZE + 1);
 334:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	}
 335:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 336:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	/* Restore the result. */
 337:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	if (odata != NULL) {
 577              	 .loc 1 337 0
 578 026a 3B68     	 ldr r3,[r7]
 579 026c 002B     	 cmp r3,#0
 580 026e 05D0     	 beq .L30
 338:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 		memcpy(odata, aes_buf + 1, AES_BLOCKSIZE);
 581              	 .loc 1 338 0
 582 0270 074B     	 ldr r3,.L31
 583 0272 1022     	 movs r2,#16
 584 0274 1946     	 mov r1,r3
 585 0276 3868     	 ldr r0,[r7]
 586 0278 064B     	 ldr r3,.L31+4
 587 027a 9847     	 blx r3
 588              	.LVL11:
 589              	.L30:
 339:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	}
 340:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 341:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	aes_buf[AES_BLOCKSIZE + 1] = save_cmd;
 590              	 .loc 1 341 0
 591 027c 064A     	 ldr r2,.L31+8
 592 027e FB7B     	 ldrb r3,[r7,#15]
 593 0280 5374     	 strb r3,[r2,#17]
 342:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 343:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	/* Wait for the operation to finish for 24 us. */
 344:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	delay_us(24);
 594              	 .loc 1 344 0
 595 0282 5320     	 movs r0,#83
 596 0284 074B     	 ldr r3,.L31+20
 597 0286 9847     	 blx r3
 598              	.LVL12:
 345:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** }
 599              	 .loc 1 345 0
 600 0288 00BF     	 nop
 601 028a 1037     	 adds r7,r7,#16
 602              	.LCFI21:
 603              	 .cfi_def_cfa_offset 8
 604 028c BD46     	 mov sp,r7
 605              	.LCFI22:
 606              	 .cfi_def_cfa_register 13
 607              	 
 608 028e 80BD     	 pop {r7,pc}
 609              	.L32:
 610              	 .align 2
 611              	.L31:
 612 0290 01000000 	 .word aes_buf+1
 613 0294 00000000 	 .word memcpy
 614 0298 00000000 	 .word aes_buf
 615 029c 00000000 	 .word setup_flag
 616 02a0 00000000 	 .word trx_aes_wrrd
 617 02a4 00000000 	 .word portable_delay_cycles
 618              	 .cfi_endproc
 619              	.LFE227:
 621              	 .align 1
 622              	 .global sal_aes_read
 623              	 .syntax unified
 624              	 .thumb
 625              	 .thumb_func
 626              	 .fpu softvfp
 628              	sal_aes_read:
 629              	.LFB228:
 346:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 
 347:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** /**
 348:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @brief Reads the result of previous AES en/decryption
 349:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
 350:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * This function returns the result of the previous AES operation,
 351:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * so this function is needed in order to get the last result
 352:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * of a series of sal_aes_wrrd() calls.
 353:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  *
 354:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  * @param[out] data     - result of previous operation
 355:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c ****  */
 356:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** void sal_aes_read(uint8_t *data)
 357:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** {
 630              	 .loc 1 357 0
 631              	 .cfi_startproc
 632              	 
 633              	 
 634 02a8 80B5     	 push {r7,lr}
 635              	.LCFI23:
 636              	 .cfi_def_cfa_offset 8
 637              	 .cfi_offset 7,-8
 638              	 .cfi_offset 14,-4
 639 02aa 82B0     	 sub sp,sp,#8
 640              	.LCFI24:
 641              	 .cfi_def_cfa_offset 16
 642 02ac 00AF     	 add r7,sp,#0
 643              	.LCFI25:
 644              	 .cfi_def_cfa_register 7
 645 02ae 7860     	 str r0,[r7,#4]
 358:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 	trx_sram_read((AES_BASE_ADDR + RG_AES_STATE_KEY_0), data,
 646              	 .loc 1 358 0
 647 02b0 1022     	 movs r2,#16
 648 02b2 7968     	 ldr r1,[r7,#4]
 649 02b4 8420     	 movs r0,#132
 650 02b6 034B     	 ldr r3,.L34
 651 02b8 9847     	 blx r3
 652              	.LVL13:
 359:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** 			AES_BLOCKSIZE);
 360:../../../stack/LwMesh/TDMA/services/sal/at86rf2xx/src/sal.c **** }
 653              	 .loc 1 360 0
 654 02ba 00BF     	 nop
 655 02bc 0837     	 adds r7,r7,#8
 656              	.LCFI26:
 657              	 .cfi_def_cfa_offset 8
 658 02be BD46     	 mov sp,r7
 659              	.LCFI27:
 660              	 .cfi_def_cfa_register 13
 661              	 
 662 02c0 80BD     	 pop {r7,pc}
 663              	.L35:
 664 02c2 00BF     	 .align 2
 665              	.L34:
 666 02c4 00000000 	 .word trx_sram_read
 667              	 .cfi_endproc
 668              	.LFE228:
 670              	.Letext0:
 671              	 .file 2 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\machine\\_default_types.h"
 672              	 .file 3 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\sys\\_stdint.h"
 673              	 .file 4 "../../../platform/thirdparty/CMSIS/include/core_cm4.h"
 674              	 .file 5 "../../../platform/sam/utils/cmsis/sam4l/source/templates/system_sam4l.h"
 675              	 .file 6 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\sys\\lock.h"
 676              	 .file 7 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\sys\\_types.h"
 677              	 .file 8 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\lib\\gcc\\arm-none-eabi\\6.3.1\\include\\stddef.h"
 678              	 .file 9 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\sys\\reent.h"
 679              	 .file 10 "c:\\program files (x86)\\atmel\\studio\\7.0\\toolchain\\arm\\arm-gnu-toolchain\\arm-none-eabi\\include\\stdlib.h"
 680              	 .file 11 "../../../platform/common/utils/interrupt/interrupt_sam_nvic.h"
 681              	 .file 12 "../../../platform/sam/utils/compiler.h"
 682              	 .file 13 "../../../platform/common/services/usb/usb_protocol.h"
 683              	 .file 14 "../../../platform/common/services/usb/udc/udi.h"
 684              	 .file 15 "../../../platform/common/services/usb/udc/udc_desc.h"
 685              	 .file 16 "../../../platform/common/services/usb/udc/udd.h"
 686              	 .file 17 "../../../platform/common/services/usb/class/cdc/device/udi_cdc.h"
 687              	 .file 18 "../../../platform/common/utils/stdio/stdio_usb/stdio_usb.h"
 688              	 .file 19 "../../../stack/LwMesh/TDMA/services/trx_access/trx_access.h"
 689              	 .file 20 "../../../platform/common/services/delay/sam/cycle_counter.h"
 690              	 .file 21 "<built-in>"
DEFINED SYMBOLS
                            *ABS*:00000000 sal.c
    {standard input}:16     .bss.cpu_irq_critical_section_counter:00000000 $d
    {standard input}:19     .bss.cpu_irq_critical_section_counter:00000000 cpu_irq_critical_section_counter
    {standard input}:24     .bss.cpu_irq_prev_interrupt_state:00000000 cpu_irq_prev_interrupt_state
    {standard input}:25     .bss.cpu_irq_prev_interrupt_state:00000000 $d
    {standard input}:29     .bss.setup_flag:00000000 setup_flag
    {standard input}:30     .bss.setup_flag:00000000 $d
    {standard input}:34     .bss.dec_initialized:00000000 dec_initialized
    {standard input}:35     .bss.dec_initialized:00000000 $d
    {standard input}:37     .bss.aes_buf:00000000 $d
    {standard input}:40     .bss.aes_buf:00000000 aes_buf
    {standard input}:45     .data.last_dir:00000000 last_dir
    {standard input}:48     .bss.enc_key:00000000 $d
    {standard input}:51     .bss.enc_key:00000000 enc_key
    {standard input}:54     .bss.dec_key:00000000 $d
    {standard input}:57     .bss.dec_key:00000000 dec_key
    {standard input}:60     .text:00000000 $t
    {standard input}:67     .text:00000000 sal_init
    {standard input}:103    .text:0000000c sal_aes_setup
    {standard input}:519    .text:00000228 sal_aes_wrrd
    {standard input}:371    .text:00000184 $d
    {standard input}:384    .text:000001ac $t
    {standard input}:391    .text:000001ac sal_aes_restart
    {standard input}:466    .text:000001fc $d
    {standard input}:477    .text:0000021c $t
    {standard input}:484    .text:0000021c _sal_aes_clean_up
    {standard input}:612    .text:00000290 $d
    {standard input}:621    .text:000002a8 $t
    {standard input}:628    .text:000002a8 sal_aes_read
    {standard input}:666    .text:000002c4 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
memcpy
trx_sram_write
trx_sram_read
trx_aes_wrrd
portable_delay_cycles
